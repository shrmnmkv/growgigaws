var I5=Object.defineProperty;var T5=(t,e,n)=>e in t?I5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var at=(t,e,n)=>T5(t,typeof e!="symbol"?e+"":e,n);function bF(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var Ic=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function R5(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var wF={exports:{}},Cy={},CF={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vf=Symbol.for("react.element"),A5=Symbol.for("react.portal"),D5=Symbol.for("react.fragment"),O5=Symbol.for("react.strict_mode"),F5=Symbol.for("react.profiler"),P5=Symbol.for("react.provider"),_5=Symbol.for("react.context"),M5=Symbol.for("react.forward_ref"),L5=Symbol.for("react.suspense"),j5=Symbol.for("react.memo"),B5=Symbol.for("react.lazy"),O$=Symbol.iterator;function z5(t){return t===null||typeof t!="object"?null:(t=O$&&t[O$]||t["@@iterator"],typeof t=="function"?t:null)}var SF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kF=Object.assign,NF={};function hd(t,e,n){this.props=t,this.context=e,this.refs=NF,this.updater=n||SF}hd.prototype.isReactComponent={};hd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};hd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function EF(){}EF.prototype=hd.prototype;function bS(t,e,n){this.props=t,this.context=e,this.refs=NF,this.updater=n||SF}var wS=bS.prototype=new EF;wS.constructor=bS;kF(wS,hd.prototype);wS.isPureReactComponent=!0;var F$=Array.isArray,$F=Object.prototype.hasOwnProperty,CS={current:null},IF={key:!0,ref:!0,__self:!0,__source:!0};function TF(t,e,n){var s,r={},o=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)$F.call(e,s)&&!IF.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:Vf,type:t,key:o,ref:i,props:r,_owner:CS.current}}function U5(t,e){return{$$typeof:Vf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function SS(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vf}function V5(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var P$=/\/+/g;function ob(t,e){return typeof t=="object"&&t!==null&&t.key!=null?V5(""+t.key):e.toString(36)}function Cg(t,e,n,s,r){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Vf:case A5:i=!0}}if(i)return i=t,r=r(i),t=s===""?"."+ob(i,0):s,F$(r)?(n="",t!=null&&(n=t.replace(P$,"$&/")+"/"),Cg(r,e,n,"",function(c){return c})):r!=null&&(SS(r)&&(r=U5(r,n+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(P$,"$&/")+"/")+t)),e.push(r)),1;if(i=0,s=s===""?".":s+":",F$(t))for(var a=0;a<t.length;a++){o=t[a];var l=s+ob(o,a);i+=Cg(o,e,n,l,r)}else if(l=z5(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=s+ob(o,a++),i+=Cg(o,e,n,l,r);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Em(t,e,n){if(t==null)return t;var s=[],r=0;return Cg(t,s,"","",function(o){return e.call(n,o,r++)}),s}function W5(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cr={current:null},Sg={transition:null},H5={ReactCurrentDispatcher:cr,ReactCurrentBatchConfig:Sg,ReactCurrentOwner:CS};function RF(){throw Error("act(...) is not supported in production builds of React.")}yt.Children={map:Em,forEach:function(t,e,n){Em(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Em(t,function(){e++}),e},toArray:function(t){return Em(t,function(e){return e})||[]},only:function(t){if(!SS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};yt.Component=hd;yt.Fragment=D5;yt.Profiler=F5;yt.PureComponent=bS;yt.StrictMode=O5;yt.Suspense=L5;yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H5;yt.act=RF;yt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=kF({},t.props),r=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=CS.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)$F.call(e,l)&&!IF.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:Vf,type:t.type,key:r,ref:o,props:s,_owner:i}};yt.createContext=function(t){return t={$$typeof:_5,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:P5,_context:t},t.Consumer=t};yt.createElement=TF;yt.createFactory=function(t){var e=TF.bind(null,t);return e.type=t,e};yt.createRef=function(){return{current:null}};yt.forwardRef=function(t){return{$$typeof:M5,render:t}};yt.isValidElement=SS;yt.lazy=function(t){return{$$typeof:B5,_payload:{_status:-1,_result:t},_init:W5}};yt.memo=function(t,e){return{$$typeof:j5,type:t,compare:e===void 0?null:e}};yt.startTransition=function(t){var e=Sg.transition;Sg.transition={};try{t()}finally{Sg.transition=e}};yt.unstable_act=RF;yt.useCallback=function(t,e){return cr.current.useCallback(t,e)};yt.useContext=function(t){return cr.current.useContext(t)};yt.useDebugValue=function(){};yt.useDeferredValue=function(t){return cr.current.useDeferredValue(t)};yt.useEffect=function(t,e){return cr.current.useEffect(t,e)};yt.useId=function(){return cr.current.useId()};yt.useImperativeHandle=function(t,e,n){return cr.current.useImperativeHandle(t,e,n)};yt.useInsertionEffect=function(t,e){return cr.current.useInsertionEffect(t,e)};yt.useLayoutEffect=function(t,e){return cr.current.useLayoutEffect(t,e)};yt.useMemo=function(t,e){return cr.current.useMemo(t,e)};yt.useReducer=function(t,e,n){return cr.current.useReducer(t,e,n)};yt.useRef=function(t){return cr.current.useRef(t)};yt.useState=function(t){return cr.current.useState(t)};yt.useSyncExternalStore=function(t,e,n){return cr.current.useSyncExternalStore(t,e,n)};yt.useTransition=function(){return cr.current.useTransition()};yt.version="18.3.1";CF.exports=yt;var S=CF.exports;const tt=dd(S),Q1=bF({__proto__:null,default:tt},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G5=S,q5=Symbol.for("react.element"),K5=Symbol.for("react.fragment"),X5=Object.prototype.hasOwnProperty,Y5=G5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J5={key:!0,ref:!0,__self:!0,__source:!0};function AF(t,e,n){var s,r={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)X5.call(e,s)&&!J5.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:q5,type:t,key:o,ref:i,props:r,_owner:Y5.current}}Cy.Fragment=K5;Cy.jsx=AF;Cy.jsxs=AF;wF.exports=Cy;var p=wF.exports,DF={exports:{}},Jr={},OF={exports:{}},FF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(R,j){var G=R.length;R.push(j);e:for(;0<G;){var O=G-1>>>1,B=R[O];if(0<r(B,j))R[O]=j,R[G]=B,G=O;else break e}}function n(R){return R.length===0?null:R[0]}function s(R){if(R.length===0)return null;var j=R[0],G=R.pop();if(G!==j){R[0]=G;e:for(var O=0,B=R.length,z=B>>>1;O<z;){var K=2*(O+1)-1,J=R[K],re=K+1,de=R[re];if(0>r(J,G))re<B&&0>r(de,J)?(R[O]=de,R[re]=G,O=re):(R[O]=J,R[K]=G,O=K);else if(re<B&&0>r(de,G))R[O]=de,R[re]=G,O=re;else break e}}return j}function r(R,j){var G=R.sortIndex-j.sortIndex;return G!==0?G:R.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(R){for(var j=n(c);j!==null;){if(j.callback===null)s(c);else if(j.startTime<=R)s(c),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(c)}}function w(R){if(g=!1,b(R),!m)if(n(l)!==null)m=!0,D(C);else{var j=n(c);j!==null&&W(w,j.startTime-R)}}function C(R,j){m=!1,g&&(g=!1,x(E),E=-1),f=!0;var G=h;try{for(b(j),d=n(l);d!==null&&(!(d.expirationTime>j)||R&&!A());){var O=d.callback;if(typeof O=="function"){d.callback=null,h=d.priorityLevel;var B=O(d.expirationTime<=j);j=t.unstable_now(),typeof B=="function"?d.callback=B:d===n(l)&&s(l),b(j)}else s(l);d=n(l)}if(d!==null)var z=!0;else{var K=n(c);K!==null&&W(w,K.startTime-j),z=!1}return z}finally{d=null,h=G,f=!1}}var k=!1,N=null,E=-1,$=5,I=-1;function A(){return!(t.unstable_now()-I<$)}function P(){if(N!==null){var R=t.unstable_now();I=R;var j=!0;try{j=N(!0,R)}finally{j?_():(k=!1,N=null)}}else k=!1}var _;if(typeof v=="function")_=function(){v(P)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,V=U.port2;U.port1.onmessage=P,_=function(){V.postMessage(null)}}else _=function(){y(P,0)};function D(R){N=R,k||(k=!0,_())}function W(R,j){E=y(function(){R(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,D(C))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(R){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var G=h;h=j;try{return R()}finally{h=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,j){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var G=h;h=R;try{return j()}finally{h=G}},t.unstable_scheduleCallback=function(R,j,G){var O=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?O+G:O):G=O,R){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=G+B,R={id:u++,callback:j,priorityLevel:R,startTime:G,expirationTime:B,sortIndex:-1},G>O?(R.sortIndex=G,e(c,R),n(l)===null&&R===n(c)&&(g?(x(E),E=-1):g=!0,W(w,G-O))):(R.sortIndex=B,e(l,R),m||f||(m=!0,D(C))),R},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(R){var j=h;return function(){var G=h;h=j;try{return R.apply(this,arguments)}finally{h=G}}}})(FF);OF.exports=FF;var Z5=OF.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q5=S,qr=Z5;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PF=new Set,Kh={};function Tc(t,e){Pu(t,e),Pu(t+"Capture",e)}function Pu(t,e){for(Kh[t]=e,t=0;t<e.length;t++)PF.add(e[t])}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ew=Object.prototype.hasOwnProperty,e8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_$={},M$={};function t8(t){return ew.call(M$,t)?!0:ew.call(_$,t)?!1:e8.test(t)?M$[t]=!0:(_$[t]=!0,!1)}function n8(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function s8(t,e,n,s){if(e===null||typeof e>"u"||n8(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ur(t,e,n,s,r,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var ys={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ys[t]=new ur(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ys[e]=new ur(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ys[t]=new ur(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ys[t]=new ur(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ys[t]=new ur(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ys[t]=new ur(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ys[t]=new ur(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ys[t]=new ur(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ys[t]=new ur(t,5,!1,t.toLowerCase(),null,!1,!1)});var kS=/[\-:]([a-z])/g;function NS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(kS,NS);ys[e]=new ur(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(kS,NS);ys[e]=new ur(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(kS,NS);ys[e]=new ur(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ys[t]=new ur(t,1,!1,t.toLowerCase(),null,!1,!1)});ys.xlinkHref=new ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ys[t]=new ur(t,1,!1,t.toLowerCase(),null,!0,!0)});function ES(t,e,n,s){var r=ys.hasOwnProperty(e)?ys[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(s8(e,n,r,s)&&(n=null),s||r===null?t8(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var oa=Q5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$m=Symbol.for("react.element"),iu=Symbol.for("react.portal"),au=Symbol.for("react.fragment"),$S=Symbol.for("react.strict_mode"),tw=Symbol.for("react.profiler"),_F=Symbol.for("react.provider"),MF=Symbol.for("react.context"),IS=Symbol.for("react.forward_ref"),nw=Symbol.for("react.suspense"),sw=Symbol.for("react.suspense_list"),TS=Symbol.for("react.memo"),va=Symbol.for("react.lazy"),LF=Symbol.for("react.offscreen"),L$=Symbol.iterator;function Hd(t){return t===null||typeof t!="object"?null:(t=L$&&t[L$]||t["@@iterator"],typeof t=="function"?t:null)}var hn=Object.assign,ib;function hh(t){if(ib===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ib=e&&e[1]||""}return`
`+ib+t}var ab=!1;function lb(t,e){if(!t||ab)return"";ab=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),o=s.stack.split(`
`),i=r.length-1,a=o.length-1;1<=i&&0<=a&&r[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(r[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||r[i]!==o[a]){var l=`
`+r[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{ab=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?hh(t):""}function r8(t){switch(t.tag){case 5:return hh(t.type);case 16:return hh("Lazy");case 13:return hh("Suspense");case 19:return hh("SuspenseList");case 0:case 2:case 15:return t=lb(t.type,!1),t;case 11:return t=lb(t.type.render,!1),t;case 1:return t=lb(t.type,!0),t;default:return""}}function rw(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case au:return"Fragment";case iu:return"Portal";case tw:return"Profiler";case $S:return"StrictMode";case nw:return"Suspense";case sw:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case MF:return(t.displayName||"Context")+".Consumer";case _F:return(t._context.displayName||"Context")+".Provider";case IS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case TS:return e=t.displayName||null,e!==null?e:rw(t.type)||"Memo";case va:e=t._payload,t=t._init;try{return rw(t(e))}catch{}}return null}function o8(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rw(e);case 8:return e===$S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ya(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jF(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function i8(t){var e=jF(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Im(t){t._valueTracker||(t._valueTracker=i8(t))}function BF(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=jF(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Kg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ow(t,e){var n=e.checked;return hn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function j$(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Ya(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function zF(t,e){e=e.checked,e!=null&&ES(t,"checked",e,!1)}function iw(t,e){zF(t,e);var n=Ya(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?aw(t,e.type,n):e.hasOwnProperty("defaultValue")&&aw(t,e.type,Ya(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function B$(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function aw(t,e,n){(e!=="number"||Kg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fh=Array.isArray;function wu(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Ya(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function lw(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return hn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function z$(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ye(92));if(fh(n)){if(1<n.length)throw Error(ye(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ya(n)}}function UF(t,e){var n=Ya(e.value),s=Ya(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function U$(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function VF(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cw(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?VF(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tm,WF=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tm=Tm||document.createElement("div"),Tm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Xh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Nh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a8=["Webkit","ms","Moz","O"];Object.keys(Nh).forEach(function(t){a8.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Nh[e]=Nh[t]})});function HF(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Nh.hasOwnProperty(t)&&Nh[t]?(""+e).trim():e+"px"}function GF(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=HF(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var l8=hn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uw(t,e){if(e){if(l8[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function dw(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hw=null;function RS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fw=null,Cu=null,Su=null;function V$(t){if(t=Gf(t)){if(typeof fw!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=$y(e),fw(t.stateNode,t.type,e))}}function qF(t){Cu?Su?Su.push(t):Su=[t]:Cu=t}function KF(){if(Cu){var t=Cu,e=Su;if(Su=Cu=null,V$(t),e)for(t=0;t<e.length;t++)V$(e[t])}}function XF(t,e){return t(e)}function YF(){}var cb=!1;function JF(t,e,n){if(cb)return t(e,n);cb=!0;try{return XF(t,e,n)}finally{cb=!1,(Cu!==null||Su!==null)&&(YF(),KF())}}function Yh(t,e){var n=t.stateNode;if(n===null)return null;var s=$y(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ye(231,e,typeof n));return n}var pw=!1;if(Gi)try{var Gd={};Object.defineProperty(Gd,"passive",{get:function(){pw=!0}}),window.addEventListener("test",Gd,Gd),window.removeEventListener("test",Gd,Gd)}catch{pw=!1}function c8(t,e,n,s,r,o,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Eh=!1,Xg=null,Yg=!1,mw=null,u8={onError:function(t){Eh=!0,Xg=t}};function d8(t,e,n,s,r,o,i,a,l){Eh=!1,Xg=null,c8.apply(u8,arguments)}function h8(t,e,n,s,r,o,i,a,l){if(d8.apply(this,arguments),Eh){if(Eh){var c=Xg;Eh=!1,Xg=null}else throw Error(ye(198));Yg||(Yg=!0,mw=c)}}function Rc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ZF(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function W$(t){if(Rc(t)!==t)throw Error(ye(188))}function f8(t){var e=t.alternate;if(!e){if(e=Rc(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return W$(r),t;if(o===s)return W$(r),e;o=o.sibling}throw Error(ye(188))}if(n.return!==s.return)n=r,s=o;else{for(var i=!1,a=r.child;a;){if(a===n){i=!0,n=r,s=o;break}if(a===s){i=!0,s=r,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,s=r;break}if(a===s){i=!0,s=o,n=r;break}a=a.sibling}if(!i)throw Error(ye(189))}}if(n.alternate!==s)throw Error(ye(190))}if(n.tag!==3)throw Error(ye(188));return n.stateNode.current===n?t:e}function QF(t){return t=f8(t),t!==null?e3(t):null}function e3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=e3(t);if(e!==null)return e;t=t.sibling}return null}var t3=qr.unstable_scheduleCallback,H$=qr.unstable_cancelCallback,p8=qr.unstable_shouldYield,m8=qr.unstable_requestPaint,En=qr.unstable_now,g8=qr.unstable_getCurrentPriorityLevel,AS=qr.unstable_ImmediatePriority,n3=qr.unstable_UserBlockingPriority,Jg=qr.unstable_NormalPriority,x8=qr.unstable_LowPriority,s3=qr.unstable_IdlePriority,Sy=null,hi=null;function y8(t){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(Sy,t,void 0,(t.current.flags&128)===128)}catch{}}var jo=Math.clz32?Math.clz32:w8,v8=Math.log,b8=Math.LN2;function w8(t){return t>>>=0,t===0?32:31-(v8(t)/b8|0)|0}var Rm=64,Am=4194304;function ph(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zg(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~r;a!==0?s=ph(a):(o&=i,o!==0&&(s=ph(o)))}else i=n&~r,i!==0?s=ph(i):o!==0&&(s=ph(o));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-jo(e),r=1<<n,s|=t[n],e&=~r;return s}function C8(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S8(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-jo(o),a=1<<i,l=r[i];l===-1?(!(a&n)||a&s)&&(r[i]=C8(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function gw(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function r3(){var t=Rm;return Rm<<=1,!(Rm&4194240)&&(Rm=64),t}function ub(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-jo(e),t[e]=n}function k8(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-jo(n),o=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~o}}function DS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-jo(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var Pt=0;function o3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var i3,OS,a3,l3,c3,xw=!1,Dm=[],Pa=null,_a=null,Ma=null,Jh=new Map,Zh=new Map,Sa=[],N8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G$(t,e){switch(t){case"focusin":case"focusout":Pa=null;break;case"dragenter":case"dragleave":_a=null;break;case"mouseover":case"mouseout":Ma=null;break;case"pointerover":case"pointerout":Jh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zh.delete(e.pointerId)}}function qd(t,e,n,s,r,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[r]},e!==null&&(e=Gf(e),e!==null&&OS(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function E8(t,e,n,s,r){switch(e){case"focusin":return Pa=qd(Pa,t,e,n,s,r),!0;case"dragenter":return _a=qd(_a,t,e,n,s,r),!0;case"mouseover":return Ma=qd(Ma,t,e,n,s,r),!0;case"pointerover":var o=r.pointerId;return Jh.set(o,qd(Jh.get(o)||null,t,e,n,s,r)),!0;case"gotpointercapture":return o=r.pointerId,Zh.set(o,qd(Zh.get(o)||null,t,e,n,s,r)),!0}return!1}function u3(t){var e=Ml(t.target);if(e!==null){var n=Rc(e);if(n!==null){if(e=n.tag,e===13){if(e=ZF(n),e!==null){t.blockedOn=e,c3(t.priority,function(){a3(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=yw(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);hw=s,n.target.dispatchEvent(s),hw=null}else return e=Gf(n),e!==null&&OS(e),t.blockedOn=n,!1;e.shift()}return!0}function q$(t,e,n){kg(t)&&n.delete(e)}function $8(){xw=!1,Pa!==null&&kg(Pa)&&(Pa=null),_a!==null&&kg(_a)&&(_a=null),Ma!==null&&kg(Ma)&&(Ma=null),Jh.forEach(q$),Zh.forEach(q$)}function Kd(t,e){t.blockedOn===e&&(t.blockedOn=null,xw||(xw=!0,qr.unstable_scheduleCallback(qr.unstable_NormalPriority,$8)))}function Qh(t){function e(r){return Kd(r,t)}if(0<Dm.length){Kd(Dm[0],t);for(var n=1;n<Dm.length;n++){var s=Dm[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Pa!==null&&Kd(Pa,t),_a!==null&&Kd(_a,t),Ma!==null&&Kd(Ma,t),Jh.forEach(e),Zh.forEach(e),n=0;n<Sa.length;n++)s=Sa[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Sa.length&&(n=Sa[0],n.blockedOn===null);)u3(n),n.blockedOn===null&&Sa.shift()}var ku=oa.ReactCurrentBatchConfig,Qg=!0;function I8(t,e,n,s){var r=Pt,o=ku.transition;ku.transition=null;try{Pt=1,FS(t,e,n,s)}finally{Pt=r,ku.transition=o}}function T8(t,e,n,s){var r=Pt,o=ku.transition;ku.transition=null;try{Pt=4,FS(t,e,n,s)}finally{Pt=r,ku.transition=o}}function FS(t,e,n,s){if(Qg){var r=yw(t,e,n,s);if(r===null)bb(t,e,s,ex,n),G$(t,s);else if(E8(r,t,e,n,s))s.stopPropagation();else if(G$(t,s),e&4&&-1<N8.indexOf(t)){for(;r!==null;){var o=Gf(r);if(o!==null&&i3(o),o=yw(t,e,n,s),o===null&&bb(t,e,s,ex,n),o===r)break;r=o}r!==null&&s.stopPropagation()}else bb(t,e,s,null,n)}}var ex=null;function yw(t,e,n,s){if(ex=null,t=RS(s),t=Ml(t),t!==null)if(e=Rc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ZF(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ex=t,null}function d3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g8()){case AS:return 1;case n3:return 4;case Jg:case x8:return 16;case s3:return 536870912;default:return 16}default:return 16}}var $a=null,PS=null,Ng=null;function h3(){if(Ng)return Ng;var t,e=PS,n=e.length,s,r="value"in $a?$a.value:$a.textContent,o=r.length;for(t=0;t<n&&e[t]===r[t];t++);var i=n-t;for(s=1;s<=i&&e[n-s]===r[o-s];s++);return Ng=r.slice(t,1<s?1-s:void 0)}function Eg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Om(){return!0}function K$(){return!1}function Zr(t){function e(n,s,r,o,i){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Om:K$,this.isPropagationStopped=K$,this}return hn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Om)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Om)},persist:function(){},isPersistent:Om}),e}var fd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_S=Zr(fd),Hf=hn({},fd,{view:0,detail:0}),R8=Zr(Hf),db,hb,Xd,ky=hn({},Hf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:MS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xd&&(Xd&&t.type==="mousemove"?(db=t.screenX-Xd.screenX,hb=t.screenY-Xd.screenY):hb=db=0,Xd=t),db)},movementY:function(t){return"movementY"in t?t.movementY:hb}}),X$=Zr(ky),A8=hn({},ky,{dataTransfer:0}),D8=Zr(A8),O8=hn({},Hf,{relatedTarget:0}),fb=Zr(O8),F8=hn({},fd,{animationName:0,elapsedTime:0,pseudoElement:0}),P8=Zr(F8),_8=hn({},fd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),M8=Zr(_8),L8=hn({},fd,{data:0}),Y$=Zr(L8),j8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function U8(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=z8[t])?!!e[t]:!1}function MS(){return U8}var V8=hn({},Hf,{key:function(t){if(t.key){var e=j8[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Eg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?B8[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:MS,charCode:function(t){return t.type==="keypress"?Eg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Eg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),W8=Zr(V8),H8=hn({},ky,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),J$=Zr(H8),G8=hn({},Hf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:MS}),q8=Zr(G8),K8=hn({},fd,{propertyName:0,elapsedTime:0,pseudoElement:0}),X8=Zr(K8),Y8=hn({},ky,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),J8=Zr(Y8),Z8=[9,13,27,32],LS=Gi&&"CompositionEvent"in window,$h=null;Gi&&"documentMode"in document&&($h=document.documentMode);var Q8=Gi&&"TextEvent"in window&&!$h,f3=Gi&&(!LS||$h&&8<$h&&11>=$h),Z$=" ",Q$=!1;function p3(t,e){switch(t){case"keyup":return Z8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function m3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var lu=!1;function eH(t,e){switch(t){case"compositionend":return m3(e);case"keypress":return e.which!==32?null:(Q$=!0,Z$);case"textInput":return t=e.data,t===Z$&&Q$?null:t;default:return null}}function tH(t,e){if(lu)return t==="compositionend"||!LS&&p3(t,e)?(t=h3(),Ng=PS=$a=null,lu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return f3&&e.locale!=="ko"?null:e.data;default:return null}}var nH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nH[t.type]:e==="textarea"}function g3(t,e,n,s){qF(s),e=tx(e,"onChange"),0<e.length&&(n=new _S("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Ih=null,ef=null;function sH(t){$3(t,0)}function Ny(t){var e=du(t);if(BF(e))return t}function rH(t,e){if(t==="change")return e}var x3=!1;if(Gi){var pb;if(Gi){var mb="oninput"in document;if(!mb){var tI=document.createElement("div");tI.setAttribute("oninput","return;"),mb=typeof tI.oninput=="function"}pb=mb}else pb=!1;x3=pb&&(!document.documentMode||9<document.documentMode)}function nI(){Ih&&(Ih.detachEvent("onpropertychange",y3),ef=Ih=null)}function y3(t){if(t.propertyName==="value"&&Ny(ef)){var e=[];g3(e,ef,t,RS(t)),JF(sH,e)}}function oH(t,e,n){t==="focusin"?(nI(),Ih=e,ef=n,Ih.attachEvent("onpropertychange",y3)):t==="focusout"&&nI()}function iH(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ny(ef)}function aH(t,e){if(t==="click")return Ny(e)}function lH(t,e){if(t==="input"||t==="change")return Ny(e)}function cH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wo=typeof Object.is=="function"?Object.is:cH;function tf(t,e){if(Wo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!ew.call(e,r)||!Wo(t[r],e[r]))return!1}return!0}function sI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rI(t,e){var n=sI(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sI(n)}}function v3(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?v3(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function b3(){for(var t=window,e=Kg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Kg(t.document)}return e}function jS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uH(t){var e=b3(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&v3(n.ownerDocument.documentElement,n)){if(s!==null&&jS(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(s.start,r);s=s.end===void 0?o:Math.min(s.end,r),!t.extend&&o>s&&(r=s,s=o,o=r),r=rI(n,o);var i=rI(n,s);r&&i&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),o>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var dH=Gi&&"documentMode"in document&&11>=document.documentMode,cu=null,vw=null,Th=null,bw=!1;function oI(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bw||cu==null||cu!==Kg(s)||(s=cu,"selectionStart"in s&&jS(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Th&&tf(Th,s)||(Th=s,s=tx(vw,"onSelect"),0<s.length&&(e=new _S("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=cu)))}function Fm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var uu={animationend:Fm("Animation","AnimationEnd"),animationiteration:Fm("Animation","AnimationIteration"),animationstart:Fm("Animation","AnimationStart"),transitionend:Fm("Transition","TransitionEnd")},gb={},w3={};Gi&&(w3=document.createElement("div").style,"AnimationEvent"in window||(delete uu.animationend.animation,delete uu.animationiteration.animation,delete uu.animationstart.animation),"TransitionEvent"in window||delete uu.transitionend.transition);function Ey(t){if(gb[t])return gb[t];if(!uu[t])return t;var e=uu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in w3)return gb[t]=e[n];return t}var C3=Ey("animationend"),S3=Ey("animationiteration"),k3=Ey("animationstart"),N3=Ey("transitionend"),E3=new Map,iI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ll(t,e){E3.set(t,e),Tc(e,[t])}for(var xb=0;xb<iI.length;xb++){var yb=iI[xb],hH=yb.toLowerCase(),fH=yb[0].toUpperCase()+yb.slice(1);ll(hH,"on"+fH)}ll(C3,"onAnimationEnd");ll(S3,"onAnimationIteration");ll(k3,"onAnimationStart");ll("dblclick","onDoubleClick");ll("focusin","onFocus");ll("focusout","onBlur");ll(N3,"onTransitionEnd");Pu("onMouseEnter",["mouseout","mouseover"]);Pu("onMouseLeave",["mouseout","mouseover"]);Pu("onPointerEnter",["pointerout","pointerover"]);Pu("onPointerLeave",["pointerout","pointerover"]);Tc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pH=new Set("cancel close invalid load scroll toggle".split(" ").concat(mh));function aI(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,h8(s,e,void 0,t),t.currentTarget=null}function $3(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var o=void 0;if(e)for(var i=s.length-1;0<=i;i--){var a=s[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;aI(r,a,c),o=l}else for(i=0;i<s.length;i++){if(a=s[i],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;aI(r,a,c),o=l}}}if(Yg)throw t=mw,Yg=!1,mw=null,t}function Zt(t,e){var n=e[Nw];n===void 0&&(n=e[Nw]=new Set);var s=t+"__bubble";n.has(s)||(I3(e,t,2,!1),n.add(s))}function vb(t,e,n){var s=0;e&&(s|=4),I3(n,t,s,e)}var Pm="_reactListening"+Math.random().toString(36).slice(2);function nf(t){if(!t[Pm]){t[Pm]=!0,PF.forEach(function(n){n!=="selectionchange"&&(pH.has(n)||vb(n,!1,t),vb(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Pm]||(e[Pm]=!0,vb("selectionchange",!1,e))}}function I3(t,e,n,s){switch(d3(e)){case 1:var r=I8;break;case 4:r=T8;break;default:r=FS}n=r.bind(null,e,n,t),r=void 0,!pw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function bb(t,e,n,s,r){var o=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(i===4)for(i=s.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;i=i.return}for(;a!==null;){if(i=Ml(a),i===null)return;if(l=i.tag,l===5||l===6){s=o=i;continue e}a=a.parentNode}}s=s.return}JF(function(){var c=o,u=RS(n),d=[];e:{var h=E3.get(t);if(h!==void 0){var f=_S,m=t;switch(t){case"keypress":if(Eg(n)===0)break e;case"keydown":case"keyup":f=W8;break;case"focusin":m="focus",f=fb;break;case"focusout":m="blur",f=fb;break;case"beforeblur":case"afterblur":f=fb;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=X$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=D8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=q8;break;case C3:case S3:case k3:f=P8;break;case N3:f=X8;break;case"scroll":f=R8;break;case"wheel":f=J8;break;case"copy":case"cut":case"paste":f=M8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=J$}var g=(e&4)!==0,y=!g&&t==="scroll",x=g?h!==null?h+"Capture":null:h;g=[];for(var v=c,b;v!==null;){b=v;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,x!==null&&(w=Yh(v,x),w!=null&&g.push(sf(v,w,b)))),y)break;v=v.return}0<g.length&&(h=new f(h,m,null,n,u),d.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==hw&&(m=n.relatedTarget||n.fromElement)&&(Ml(m)||m[qi]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=c,m=m?Ml(m):null,m!==null&&(y=Rc(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=c),f!==m)){if(g=X$,w="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=J$,w="onPointerLeave",x="onPointerEnter",v="pointer"),y=f==null?h:du(f),b=m==null?h:du(m),h=new g(w,v+"leave",f,n,u),h.target=y,h.relatedTarget=b,w=null,Ml(u)===c&&(g=new g(x,v+"enter",m,n,u),g.target=b,g.relatedTarget=y,w=g),y=w,f&&m)t:{for(g=f,x=m,v=0,b=g;b;b=Gc(b))v++;for(b=0,w=x;w;w=Gc(w))b++;for(;0<v-b;)g=Gc(g),v--;for(;0<b-v;)x=Gc(x),b--;for(;v--;){if(g===x||x!==null&&g===x.alternate)break t;g=Gc(g),x=Gc(x)}g=null}else g=null;f!==null&&lI(d,h,f,g,!1),m!==null&&y!==null&&lI(d,y,m,g,!0)}}e:{if(h=c?du(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var C=rH;else if(eI(h))if(x3)C=lH;else{C=iH;var k=oH}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=aH);if(C&&(C=C(t,c))){g3(d,C,n,u);break e}k&&k(t,h,c),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&aw(h,"number",h.value)}switch(k=c?du(c):window,t){case"focusin":(eI(k)||k.contentEditable==="true")&&(cu=k,vw=c,Th=null);break;case"focusout":Th=vw=cu=null;break;case"mousedown":bw=!0;break;case"contextmenu":case"mouseup":case"dragend":bw=!1,oI(d,n,u);break;case"selectionchange":if(dH)break;case"keydown":case"keyup":oI(d,n,u)}var N;if(LS)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else lu?p3(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(f3&&n.locale!=="ko"&&(lu||E!=="onCompositionStart"?E==="onCompositionEnd"&&lu&&(N=h3()):($a=u,PS="value"in $a?$a.value:$a.textContent,lu=!0)),k=tx(c,E),0<k.length&&(E=new Y$(E,t,null,n,u),d.push({event:E,listeners:k}),N?E.data=N:(N=m3(n),N!==null&&(E.data=N)))),(N=Q8?eH(t,n):tH(t,n))&&(c=tx(c,"onBeforeInput"),0<c.length&&(u=new Y$("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=N))}$3(d,e)})}function sf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function tx(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=Yh(t,n),o!=null&&s.unshift(sf(t,o,r)),o=Yh(t,e),o!=null&&s.push(sf(t,o,r))),t=t.return}return s}function Gc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function lI(t,e,n,s,r){for(var o=e._reactName,i=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=Yh(n,o),l!=null&&i.unshift(sf(n,l,a))):r||(l=Yh(n,o),l!=null&&i.push(sf(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var mH=/\r\n?/g,gH=/\u0000|\uFFFD/g;function cI(t){return(typeof t=="string"?t:""+t).replace(mH,`
`).replace(gH,"")}function _m(t,e,n){if(e=cI(e),cI(t)!==e&&n)throw Error(ye(425))}function nx(){}var ww=null,Cw=null;function Sw(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var kw=typeof setTimeout=="function"?setTimeout:void 0,xH=typeof clearTimeout=="function"?clearTimeout:void 0,uI=typeof Promise=="function"?Promise:void 0,yH=typeof queueMicrotask=="function"?queueMicrotask:typeof uI<"u"?function(t){return uI.resolve(null).then(t).catch(vH)}:kw;function vH(t){setTimeout(function(){throw t})}function wb(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),Qh(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Qh(e)}function La(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function dI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var pd=Math.random().toString(36).slice(2),ui="__reactFiber$"+pd,rf="__reactProps$"+pd,qi="__reactContainer$"+pd,Nw="__reactEvents$"+pd,bH="__reactListeners$"+pd,wH="__reactHandles$"+pd;function Ml(t){var e=t[ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[qi]||n[ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=dI(t);t!==null;){if(n=t[ui])return n;t=dI(t)}return e}t=n,n=t.parentNode}return null}function Gf(t){return t=t[ui]||t[qi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function du(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function $y(t){return t[rf]||null}var Ew=[],hu=-1;function cl(t){return{current:t}}function en(t){0>hu||(t.current=Ew[hu],Ew[hu]=null,hu--)}function qt(t,e){hu++,Ew[hu]=t.current,t.current=e}var Ja={},Vs=cl(Ja),Cr=cl(!1),rc=Ja;function _u(t,e){var n=t.type.contextTypes;if(!n)return Ja;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=e[o];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Sr(t){return t=t.childContextTypes,t!=null}function sx(){en(Cr),en(Vs)}function hI(t,e,n){if(Vs.current!==Ja)throw Error(ye(168));qt(Vs,e),qt(Cr,n)}function T3(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(ye(108,o8(t)||"Unknown",r));return hn({},n,s)}function rx(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ja,rc=Vs.current,qt(Vs,t),qt(Cr,Cr.current),!0}function fI(t,e,n){var s=t.stateNode;if(!s)throw Error(ye(169));n?(t=T3(t,e,rc),s.__reactInternalMemoizedMergedChildContext=t,en(Cr),en(Vs),qt(Vs,t)):en(Cr),qt(Cr,n)}var Di=null,Iy=!1,Cb=!1;function R3(t){Di===null?Di=[t]:Di.push(t)}function CH(t){Iy=!0,R3(t)}function ul(){if(!Cb&&Di!==null){Cb=!0;var t=0,e=Pt;try{var n=Di;for(Pt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Di=null,Iy=!1}catch(r){throw Di!==null&&(Di=Di.slice(t+1)),t3(AS,ul),r}finally{Pt=e,Cb=!1}}return null}var fu=[],pu=0,ox=null,ix=0,lo=[],co=0,oc=null,Li=1,ji="";function Tl(t,e){fu[pu++]=ix,fu[pu++]=ox,ox=t,ix=e}function A3(t,e,n){lo[co++]=Li,lo[co++]=ji,lo[co++]=oc,oc=t;var s=Li;t=ji;var r=32-jo(s)-1;s&=~(1<<r),n+=1;var o=32-jo(e)+r;if(30<o){var i=r-r%5;o=(s&(1<<i)-1).toString(32),s>>=i,r-=i,Li=1<<32-jo(e)+r|n<<r|s,ji=o+t}else Li=1<<o|n<<r|s,ji=t}function BS(t){t.return!==null&&(Tl(t,1),A3(t,1,0))}function zS(t){for(;t===ox;)ox=fu[--pu],fu[pu]=null,ix=fu[--pu],fu[pu]=null;for(;t===oc;)oc=lo[--co],lo[co]=null,ji=lo[--co],lo[co]=null,Li=lo[--co],lo[co]=null}var Vr=null,Br=null,rn=!1,Fo=null;function D3(t,e){var n=ho(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function pI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Vr=t,Br=La(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Vr=t,Br=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=oc!==null?{id:Li,overflow:ji}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ho(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Vr=t,Br=null,!0):!1;default:return!1}}function $w(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Iw(t){if(rn){var e=Br;if(e){var n=e;if(!pI(t,e)){if($w(t))throw Error(ye(418));e=La(n.nextSibling);var s=Vr;e&&pI(t,e)?D3(s,n):(t.flags=t.flags&-4097|2,rn=!1,Vr=t)}}else{if($w(t))throw Error(ye(418));t.flags=t.flags&-4097|2,rn=!1,Vr=t}}}function mI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Vr=t}function Mm(t){if(t!==Vr)return!1;if(!rn)return mI(t),rn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Sw(t.type,t.memoizedProps)),e&&(e=Br)){if($w(t))throw O3(),Error(ye(418));for(;e;)D3(t,e),e=La(e.nextSibling)}if(mI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Br=La(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Br=null}}else Br=Vr?La(t.stateNode.nextSibling):null;return!0}function O3(){for(var t=Br;t;)t=La(t.nextSibling)}function Mu(){Br=Vr=null,rn=!1}function US(t){Fo===null?Fo=[t]:Fo.push(t)}var SH=oa.ReactCurrentBatchConfig;function Yd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ye(309));var s=n.stateNode}if(!s)throw Error(ye(147,t));var r=s,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=r.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(ye(284));if(!n._owner)throw Error(ye(290,t))}return t}function Lm(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function gI(t){var e=t._init;return e(t._payload)}function F3(t){function e(x,v){if(t){var b=x.deletions;b===null?(x.deletions=[v],x.flags|=16):b.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function s(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function r(x,v){return x=Ua(x,v),x.index=0,x.sibling=null,x}function o(x,v,b){return x.index=b,t?(b=x.alternate,b!==null?(b=b.index,b<v?(x.flags|=2,v):b):(x.flags|=2,v)):(x.flags|=1048576,v)}function i(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,v,b,w){return v===null||v.tag!==6?(v=Tb(b,x.mode,w),v.return=x,v):(v=r(v,b),v.return=x,v)}function l(x,v,b,w){var C=b.type;return C===au?u(x,v,b.props.children,w,b.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===va&&gI(C)===v.type)?(w=r(v,b.props),w.ref=Yd(x,v,b),w.return=x,w):(w=Og(b.type,b.key,b.props,null,x.mode,w),w.ref=Yd(x,v,b),w.return=x,w)}function c(x,v,b,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=Rb(b,x.mode,w),v.return=x,v):(v=r(v,b.children||[]),v.return=x,v)}function u(x,v,b,w,C){return v===null||v.tag!==7?(v=Kl(b,x.mode,w,C),v.return=x,v):(v=r(v,b),v.return=x,v)}function d(x,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Tb(""+v,x.mode,b),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $m:return b=Og(v.type,v.key,v.props,null,x.mode,b),b.ref=Yd(x,null,v),b.return=x,b;case iu:return v=Rb(v,x.mode,b),v.return=x,v;case va:var w=v._init;return d(x,w(v._payload),b)}if(fh(v)||Hd(v))return v=Kl(v,x.mode,b,null),v.return=x,v;Lm(x,v)}return null}function h(x,v,b,w){var C=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:a(x,v,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $m:return b.key===C?l(x,v,b,w):null;case iu:return b.key===C?c(x,v,b,w):null;case va:return C=b._init,h(x,v,C(b._payload),w)}if(fh(b)||Hd(b))return C!==null?null:u(x,v,b,w,null);Lm(x,b)}return null}function f(x,v,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(b)||null,a(v,x,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case $m:return x=x.get(w.key===null?b:w.key)||null,l(v,x,w,C);case iu:return x=x.get(w.key===null?b:w.key)||null,c(v,x,w,C);case va:var k=w._init;return f(x,v,b,k(w._payload),C)}if(fh(w)||Hd(w))return x=x.get(b)||null,u(v,x,w,C,null);Lm(v,w)}return null}function m(x,v,b,w){for(var C=null,k=null,N=v,E=v=0,$=null;N!==null&&E<b.length;E++){N.index>E?($=N,N=null):$=N.sibling;var I=h(x,N,b[E],w);if(I===null){N===null&&(N=$);break}t&&N&&I.alternate===null&&e(x,N),v=o(I,v,E),k===null?C=I:k.sibling=I,k=I,N=$}if(E===b.length)return n(x,N),rn&&Tl(x,E),C;if(N===null){for(;E<b.length;E++)N=d(x,b[E],w),N!==null&&(v=o(N,v,E),k===null?C=N:k.sibling=N,k=N);return rn&&Tl(x,E),C}for(N=s(x,N);E<b.length;E++)$=f(N,x,E,b[E],w),$!==null&&(t&&$.alternate!==null&&N.delete($.key===null?E:$.key),v=o($,v,E),k===null?C=$:k.sibling=$,k=$);return t&&N.forEach(function(A){return e(x,A)}),rn&&Tl(x,E),C}function g(x,v,b,w){var C=Hd(b);if(typeof C!="function")throw Error(ye(150));if(b=C.call(b),b==null)throw Error(ye(151));for(var k=C=null,N=v,E=v=0,$=null,I=b.next();N!==null&&!I.done;E++,I=b.next()){N.index>E?($=N,N=null):$=N.sibling;var A=h(x,N,I.value,w);if(A===null){N===null&&(N=$);break}t&&N&&A.alternate===null&&e(x,N),v=o(A,v,E),k===null?C=A:k.sibling=A,k=A,N=$}if(I.done)return n(x,N),rn&&Tl(x,E),C;if(N===null){for(;!I.done;E++,I=b.next())I=d(x,I.value,w),I!==null&&(v=o(I,v,E),k===null?C=I:k.sibling=I,k=I);return rn&&Tl(x,E),C}for(N=s(x,N);!I.done;E++,I=b.next())I=f(N,x,E,I.value,w),I!==null&&(t&&I.alternate!==null&&N.delete(I.key===null?E:I.key),v=o(I,v,E),k===null?C=I:k.sibling=I,k=I);return t&&N.forEach(function(P){return e(x,P)}),rn&&Tl(x,E),C}function y(x,v,b,w){if(typeof b=="object"&&b!==null&&b.type===au&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case $m:e:{for(var C=b.key,k=v;k!==null;){if(k.key===C){if(C=b.type,C===au){if(k.tag===7){n(x,k.sibling),v=r(k,b.props.children),v.return=x,x=v;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===va&&gI(C)===k.type){n(x,k.sibling),v=r(k,b.props),v.ref=Yd(x,k,b),v.return=x,x=v;break e}n(x,k);break}else e(x,k);k=k.sibling}b.type===au?(v=Kl(b.props.children,x.mode,w,b.key),v.return=x,x=v):(w=Og(b.type,b.key,b.props,null,x.mode,w),w.ref=Yd(x,v,b),w.return=x,x=w)}return i(x);case iu:e:{for(k=b.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){n(x,v.sibling),v=r(v,b.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=Rb(b,x.mode,w),v.return=x,x=v}return i(x);case va:return k=b._init,y(x,v,k(b._payload),w)}if(fh(b))return m(x,v,b,w);if(Hd(b))return g(x,v,b,w);Lm(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(n(x,v.sibling),v=r(v,b),v.return=x,x=v):(n(x,v),v=Tb(b,x.mode,w),v.return=x,x=v),i(x)):n(x,v)}return y}var Lu=F3(!0),P3=F3(!1),ax=cl(null),lx=null,mu=null,VS=null;function WS(){VS=mu=lx=null}function HS(t){var e=ax.current;en(ax),t._currentValue=e}function Tw(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Nu(t,e){lx=t,VS=mu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yr=!0),t.firstContext=null)}function vo(t){var e=t._currentValue;if(VS!==t)if(t={context:t,memoizedValue:e,next:null},mu===null){if(lx===null)throw Error(ye(308));mu=t,lx.dependencies={lanes:0,firstContext:t}}else mu=mu.next=t;return e}var Ll=null;function GS(t){Ll===null?Ll=[t]:Ll.push(t)}function _3(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,GS(e)):(n.next=r.next,r.next=n),e.interleaved=n,Ki(t,s)}function Ki(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ba=!1;function qS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function M3(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ja(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,$t&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Ki(t,n)}return r=s.interleaved,r===null?(e.next=e,GS(s)):(e.next=r.next,r.next=e),s.interleaved=e,Ki(t,n)}function $g(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,DS(t,n)}}function xI(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?r=o=e:o=o.next=e}else r=o=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function cx(t,e,n,s){var r=t.updateQueue;ba=!1;var o=r.firstBaseUpdate,i=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,i===null?o=c:i.next=c,i=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==i&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=r.baseState;i=0,u=c=l=null,a=o;do{var h=a.lane,f=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(h=e,f=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){d=m.call(f,d,h);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(f,d,h):m,h==null)break e;d=hn({},d,h);break e;case 2:ba=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,i|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do i|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);ac|=i,t.lanes=i,t.memoizedState=d}}function yI(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(ye(191,r));r.call(s)}}}var qf={},fi=cl(qf),of=cl(qf),af=cl(qf);function jl(t){if(t===qf)throw Error(ye(174));return t}function KS(t,e){switch(qt(af,e),qt(of,t),qt(fi,qf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cw(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=cw(e,t)}en(fi),qt(fi,e)}function ju(){en(fi),en(of),en(af)}function L3(t){jl(af.current);var e=jl(fi.current),n=cw(e,t.type);e!==n&&(qt(of,t),qt(fi,n))}function XS(t){of.current===t&&(en(fi),en(of))}var cn=cl(0);function ux(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Sb=[];function YS(){for(var t=0;t<Sb.length;t++)Sb[t]._workInProgressVersionPrimary=null;Sb.length=0}var Ig=oa.ReactCurrentDispatcher,kb=oa.ReactCurrentBatchConfig,ic=0,dn=null,Hn=null,ss=null,dx=!1,Rh=!1,lf=0,kH=0;function $s(){throw Error(ye(321))}function JS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Wo(t[n],e[n]))return!1;return!0}function ZS(t,e,n,s,r,o){if(ic=o,dn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ig.current=t===null||t.memoizedState===null?IH:TH,t=n(s,r),Rh){o=0;do{if(Rh=!1,lf=0,25<=o)throw Error(ye(301));o+=1,ss=Hn=null,e.updateQueue=null,Ig.current=RH,t=n(s,r)}while(Rh)}if(Ig.current=hx,e=Hn!==null&&Hn.next!==null,ic=0,ss=Hn=dn=null,dx=!1,e)throw Error(ye(300));return t}function QS(){var t=lf!==0;return lf=0,t}function ni(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?dn.memoizedState=ss=t:ss=ss.next=t,ss}function bo(){if(Hn===null){var t=dn.alternate;t=t!==null?t.memoizedState:null}else t=Hn.next;var e=ss===null?dn.memoizedState:ss.next;if(e!==null)ss=e,Hn=t;else{if(t===null)throw Error(ye(310));Hn=t,t={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},ss===null?dn.memoizedState=ss=t:ss=ss.next=t}return ss}function cf(t,e){return typeof e=="function"?e(t):e}function Nb(t){var e=bo(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var s=Hn,r=s.baseQueue,o=n.pending;if(o!==null){if(r!==null){var i=r.next;r.next=o.next,o.next=i}s.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,s=s.baseState;var a=i=null,l=null,c=o;do{var u=c.lane;if((ic&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,i=s):l=l.next=d,dn.lanes|=u,ac|=u}c=c.next}while(c!==null&&c!==o);l===null?i=s:l.next=a,Wo(s,e.memoizedState)||(yr=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do o=r.lane,dn.lanes|=o,ac|=o,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Eb(t){var e=bo(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,o=e.memoizedState;if(r!==null){n.pending=null;var i=r=r.next;do o=t(o,i.action),i=i.next;while(i!==r);Wo(o,e.memoizedState)||(yr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,s]}function j3(){}function B3(t,e){var n=dn,s=bo(),r=e(),o=!Wo(s.memoizedState,r);if(o&&(s.memoizedState=r,yr=!0),s=s.queue,ek(V3.bind(null,n,s,t),[t]),s.getSnapshot!==e||o||ss!==null&&ss.memoizedState.tag&1){if(n.flags|=2048,uf(9,U3.bind(null,n,s,r,e),void 0,null),as===null)throw Error(ye(349));ic&30||z3(n,e,r)}return r}function z3(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=dn.updateQueue,e===null?(e={lastEffect:null,stores:null},dn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function U3(t,e,n,s){e.value=n,e.getSnapshot=s,W3(e)&&H3(t)}function V3(t,e,n){return n(function(){W3(e)&&H3(t)})}function W3(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Wo(t,n)}catch{return!0}}function H3(t){var e=Ki(t,1);e!==null&&Bo(e,t,1,-1)}function vI(t){var e=ni();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cf,lastRenderedState:t},e.queue=t,t=t.dispatch=$H.bind(null,dn,t),[e.memoizedState,t]}function uf(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=dn.updateQueue,e===null?(e={lastEffect:null,stores:null},dn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function G3(){return bo().memoizedState}function Tg(t,e,n,s){var r=ni();dn.flags|=t,r.memoizedState=uf(1|e,n,void 0,s===void 0?null:s)}function Ty(t,e,n,s){var r=bo();s=s===void 0?null:s;var o=void 0;if(Hn!==null){var i=Hn.memoizedState;if(o=i.destroy,s!==null&&JS(s,i.deps)){r.memoizedState=uf(e,n,o,s);return}}dn.flags|=t,r.memoizedState=uf(1|e,n,o,s)}function bI(t,e){return Tg(8390656,8,t,e)}function ek(t,e){return Ty(2048,8,t,e)}function q3(t,e){return Ty(4,2,t,e)}function K3(t,e){return Ty(4,4,t,e)}function X3(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Y3(t,e,n){return n=n!=null?n.concat([t]):null,Ty(4,4,X3.bind(null,e,t),n)}function tk(){}function J3(t,e){var n=bo();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&JS(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function Z3(t,e){var n=bo();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&JS(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function Q3(t,e,n){return ic&21?(Wo(n,e)||(n=r3(),dn.lanes|=n,ac|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yr=!0),t.memoizedState=n)}function NH(t,e){var n=Pt;Pt=n!==0&&4>n?n:4,t(!0);var s=kb.transition;kb.transition={};try{t(!1),e()}finally{Pt=n,kb.transition=s}}function eP(){return bo().memoizedState}function EH(t,e,n){var s=za(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},tP(t))nP(e,n);else if(n=_3(t,e,n,s),n!==null){var r=rr();Bo(n,t,s,r),sP(n,e,s)}}function $H(t,e,n){var s=za(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(tP(t))nP(e,r);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(r.hasEagerState=!0,r.eagerState=a,Wo(a,i)){var l=e.interleaved;l===null?(r.next=r,GS(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=_3(t,e,r,s),n!==null&&(r=rr(),Bo(n,t,s,r),sP(n,e,s))}}function tP(t){var e=t.alternate;return t===dn||e!==null&&e===dn}function nP(t,e){Rh=dx=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function sP(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,DS(t,n)}}var hx={readContext:vo,useCallback:$s,useContext:$s,useEffect:$s,useImperativeHandle:$s,useInsertionEffect:$s,useLayoutEffect:$s,useMemo:$s,useReducer:$s,useRef:$s,useState:$s,useDebugValue:$s,useDeferredValue:$s,useTransition:$s,useMutableSource:$s,useSyncExternalStore:$s,useId:$s,unstable_isNewReconciler:!1},IH={readContext:vo,useCallback:function(t,e){return ni().memoizedState=[t,e===void 0?null:e],t},useContext:vo,useEffect:bI,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Tg(4194308,4,X3.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Tg(4194308,4,t,e)},useInsertionEffect:function(t,e){return Tg(4,2,t,e)},useMemo:function(t,e){var n=ni();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=ni();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=EH.bind(null,dn,t),[s.memoizedState,t]},useRef:function(t){var e=ni();return t={current:t},e.memoizedState=t},useState:vI,useDebugValue:tk,useDeferredValue:function(t){return ni().memoizedState=t},useTransition:function(){var t=vI(!1),e=t[0];return t=NH.bind(null,t[1]),ni().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=dn,r=ni();if(rn){if(n===void 0)throw Error(ye(407));n=n()}else{if(n=e(),as===null)throw Error(ye(349));ic&30||z3(s,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,bI(V3.bind(null,s,o,t),[t]),s.flags|=2048,uf(9,U3.bind(null,s,o,n,e),void 0,null),n},useId:function(){var t=ni(),e=as.identifierPrefix;if(rn){var n=ji,s=Li;n=(s&~(1<<32-jo(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=lf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=kH++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},TH={readContext:vo,useCallback:J3,useContext:vo,useEffect:ek,useImperativeHandle:Y3,useInsertionEffect:q3,useLayoutEffect:K3,useMemo:Z3,useReducer:Nb,useRef:G3,useState:function(){return Nb(cf)},useDebugValue:tk,useDeferredValue:function(t){var e=bo();return Q3(e,Hn.memoizedState,t)},useTransition:function(){var t=Nb(cf)[0],e=bo().memoizedState;return[t,e]},useMutableSource:j3,useSyncExternalStore:B3,useId:eP,unstable_isNewReconciler:!1},RH={readContext:vo,useCallback:J3,useContext:vo,useEffect:ek,useImperativeHandle:Y3,useInsertionEffect:q3,useLayoutEffect:K3,useMemo:Z3,useReducer:Eb,useRef:G3,useState:function(){return Eb(cf)},useDebugValue:tk,useDeferredValue:function(t){var e=bo();return Hn===null?e.memoizedState=t:Q3(e,Hn.memoizedState,t)},useTransition:function(){var t=Eb(cf)[0],e=bo().memoizedState;return[t,e]},useMutableSource:j3,useSyncExternalStore:B3,useId:eP,unstable_isNewReconciler:!1};function Do(t,e){if(t&&t.defaultProps){e=hn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Rw(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:hn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ry={isMounted:function(t){return(t=t._reactInternals)?Rc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=rr(),r=za(t),o=zi(s,r);o.payload=e,n!=null&&(o.callback=n),e=ja(t,o,r),e!==null&&(Bo(e,t,r,s),$g(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=rr(),r=za(t),o=zi(s,r);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ja(t,o,r),e!==null&&(Bo(e,t,r,s),$g(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rr(),s=za(t),r=zi(n,s);r.tag=2,e!=null&&(r.callback=e),e=ja(t,r,s),e!==null&&(Bo(e,t,s,n),$g(e,t,s))}};function wI(t,e,n,s,r,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,o,i):e.prototype&&e.prototype.isPureReactComponent?!tf(n,s)||!tf(r,o):!0}function rP(t,e,n){var s=!1,r=Ja,o=e.contextType;return typeof o=="object"&&o!==null?o=vo(o):(r=Sr(e)?rc:Vs.current,s=e.contextTypes,o=(s=s!=null)?_u(t,r):Ja),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ry,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function CI(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Ry.enqueueReplaceState(e,e.state,null)}function Aw(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},qS(t);var o=e.contextType;typeof o=="object"&&o!==null?r.context=vo(o):(o=Sr(e)?rc:Vs.current,r.context=_u(t,o)),r.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Rw(t,e,o,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Ry.enqueueReplaceState(r,r.state,null),cx(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Bu(t,e){try{var n="",s=e;do n+=r8(s),s=s.return;while(s);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:r,digest:null}}function $b(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dw(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var AH=typeof WeakMap=="function"?WeakMap:Map;function oP(t,e,n){n=zi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){px||(px=!0,Uw=s),Dw(t,e)},n}function iP(t,e,n){n=zi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){Dw(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Dw(t,e),typeof s!="function"&&(Ba===null?Ba=new Set([this]):Ba.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function SI(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new AH;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=HH.bind(null,t,e,n),e.then(t,t))}function kI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function NI(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zi(-1,1),e.tag=2,ja(n,e,1))),n.lanes|=1),t)}var DH=oa.ReactCurrentOwner,yr=!1;function Js(t,e,n,s){e.child=t===null?P3(e,null,n,s):Lu(e,t.child,n,s)}function EI(t,e,n,s,r){n=n.render;var o=e.ref;return Nu(e,r),s=ZS(t,e,n,s,o,r),n=QS(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Xi(t,e,r)):(rn&&n&&BS(e),e.flags|=1,Js(t,e,s,r),e.child)}function $I(t,e,n,s,r){if(t===null){var o=n.type;return typeof o=="function"&&!ck(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,aP(t,e,o,s,r)):(t=Og(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&r)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:tf,n(i,s)&&t.ref===e.ref)return Xi(t,e,r)}return e.flags|=1,t=Ua(o,s),t.ref=e.ref,t.return=e,e.child=t}function aP(t,e,n,s,r){if(t!==null){var o=t.memoizedProps;if(tf(o,s)&&t.ref===e.ref)if(yr=!1,e.pendingProps=s=o,(t.lanes&r)!==0)t.flags&131072&&(yr=!0);else return e.lanes=t.lanes,Xi(t,e,r)}return Ow(t,e,n,s,r)}function lP(t,e,n){var s=e.pendingProps,r=s.children,o=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(xu,_r),_r|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qt(xu,_r),_r|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:n,qt(xu,_r),_r|=s}else o!==null?(s=o.baseLanes|n,e.memoizedState=null):s=n,qt(xu,_r),_r|=s;return Js(t,e,r,n),e.child}function cP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ow(t,e,n,s,r){var o=Sr(n)?rc:Vs.current;return o=_u(e,o),Nu(e,r),n=ZS(t,e,n,s,o,r),s=QS(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Xi(t,e,r)):(rn&&s&&BS(e),e.flags|=1,Js(t,e,n,r),e.child)}function II(t,e,n,s,r){if(Sr(n)){var o=!0;rx(e)}else o=!1;if(Nu(e,r),e.stateNode===null)Rg(t,e),rP(e,n,s),Aw(e,n,s,r),s=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=vo(c):(c=Sr(n)?rc:Vs.current,c=_u(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==s||l!==c)&&CI(e,i,s,c),ba=!1;var h=e.memoizedState;i.state=h,cx(e,s,i,r),l=e.memoizedState,a!==s||h!==l||Cr.current||ba?(typeof u=="function"&&(Rw(e,n,u,s),l=e.memoizedState),(a=ba||wI(e,n,a,s,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),i.props=s,i.state=l,i.context=c,s=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,M3(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Do(e.type,a),i.props=c,d=e.pendingProps,h=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=vo(l):(l=Sr(n)?rc:Vs.current,l=_u(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&CI(e,i,s,l),ba=!1,h=e.memoizedState,i.state=h,cx(e,s,i,r);var m=e.memoizedState;a!==d||h!==m||Cr.current||ba?(typeof f=="function"&&(Rw(e,n,f,s),m=e.memoizedState),(c=ba||wI(e,n,c,s,h,m,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,m,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,m,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=m),i.props=s,i.state=m,i.context=l,s=c):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return Fw(t,e,n,s,o,r)}function Fw(t,e,n,s,r,o){cP(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return r&&fI(e,n,!1),Xi(t,e,o);s=e.stateNode,DH.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=Lu(e,t.child,null,o),e.child=Lu(e,null,a,o)):Js(t,e,a,o),e.memoizedState=s.state,r&&fI(e,n,!0),e.child}function uP(t){var e=t.stateNode;e.pendingContext?hI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&hI(t,e.context,!1),KS(t,e.containerInfo)}function TI(t,e,n,s,r){return Mu(),US(r),e.flags|=256,Js(t,e,n,s),e.child}var Pw={dehydrated:null,treeContext:null,retryLane:0};function _w(t){return{baseLanes:t,cachePool:null,transitions:null}}function dP(t,e,n){var s=e.pendingProps,r=cn.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),qt(cn,r&1),t===null)return Iw(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,o?(s=e.mode,o=e.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Oy(i,s,0,null),t=Kl(t,s,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=_w(n),e.memoizedState=Pw,t):nk(e,i));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return OH(t,e,i,s,a,r,n);if(o){o=s.fallback,i=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(i&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Ua(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?o=Ua(a,o):(o=Kl(o,i,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,i=t.child.memoizedState,i=i===null?_w(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=Pw,s}return o=t.child,t=o.sibling,s=Ua(o,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function nk(t,e){return e=Oy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jm(t,e,n,s){return s!==null&&US(s),Lu(e,t.child,null,n),t=nk(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function OH(t,e,n,s,r,o,i){if(n)return e.flags&256?(e.flags&=-257,s=$b(Error(ye(422))),jm(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=s.fallback,r=e.mode,s=Oy({mode:"visible",children:s.children},r,0,null),o=Kl(o,r,i,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,e.mode&1&&Lu(e,t.child,null,i),e.child.memoizedState=_w(i),e.memoizedState=Pw,o);if(!(e.mode&1))return jm(t,e,i,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,o=Error(ye(419)),s=$b(o,s,void 0),jm(t,e,i,s)}if(a=(i&t.childLanes)!==0,yr||a){if(s=as,s!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|i)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,Ki(t,r),Bo(s,t,r,-1))}return lk(),s=$b(Error(ye(421))),jm(t,e,i,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=GH.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,Br=La(r.nextSibling),Vr=e,rn=!0,Fo=null,t!==null&&(lo[co++]=Li,lo[co++]=ji,lo[co++]=oc,Li=t.id,ji=t.overflow,oc=e),e=nk(e,s.children),e.flags|=4096,e)}function RI(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Tw(t.return,e,n)}function Ib(t,e,n,s,r){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=r)}function hP(t,e,n){var s=e.pendingProps,r=s.revealOrder,o=s.tail;if(Js(t,e,s.children,n),s=cn.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&RI(t,n,e);else if(t.tag===19)RI(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(qt(cn,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&ux(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Ib(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&ux(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Ib(e,!0,n,null,o);break;case"together":Ib(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Xi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ac|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,n=Ua(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ua(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function FH(t,e,n){switch(e.tag){case 3:uP(e),Mu();break;case 5:L3(e);break;case 1:Sr(e.type)&&rx(e);break;case 4:KS(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;qt(ax,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(qt(cn,cn.current&1),e.flags|=128,null):n&e.child.childLanes?dP(t,e,n):(qt(cn,cn.current&1),t=Xi(t,e,n),t!==null?t.sibling:null);qt(cn,cn.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return hP(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),qt(cn,cn.current),s)break;return null;case 22:case 23:return e.lanes=0,lP(t,e,n)}return Xi(t,e,n)}var fP,Mw,pP,mP;fP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Mw=function(){};pP=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,jl(fi.current);var o=null;switch(n){case"input":r=ow(t,r),s=ow(t,s),o=[];break;case"select":r=hn({},r,{value:void 0}),s=hn({},s,{value:void 0}),o=[];break;case"textarea":r=lw(t,r),s=lw(t,s),o=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=nx)}uw(n,s);var i;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Kh.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Kh.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Zt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};mP=function(t,e,n,s){n!==s&&(e.flags|=4)};function Jd(t,e){if(!rn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Is(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function PH(t,e,n){var s=e.pendingProps;switch(zS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Is(e),null;case 1:return Sr(e.type)&&sx(),Is(e),null;case 3:return s=e.stateNode,ju(),en(Cr),en(Vs),YS(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Mm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Fo!==null&&(Hw(Fo),Fo=null))),Mw(t,e),Is(e),null;case 5:XS(e);var r=jl(af.current);if(n=e.type,t!==null&&e.stateNode!=null)pP(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ye(166));return Is(e),null}if(t=jl(fi.current),Mm(e)){s=e.stateNode,n=e.type;var o=e.memoizedProps;switch(s[ui]=e,s[rf]=o,t=(e.mode&1)!==0,n){case"dialog":Zt("cancel",s),Zt("close",s);break;case"iframe":case"object":case"embed":Zt("load",s);break;case"video":case"audio":for(r=0;r<mh.length;r++)Zt(mh[r],s);break;case"source":Zt("error",s);break;case"img":case"image":case"link":Zt("error",s),Zt("load",s);break;case"details":Zt("toggle",s);break;case"input":j$(s,o),Zt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},Zt("invalid",s);break;case"textarea":z$(s,o),Zt("invalid",s)}uw(n,o),r=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?s.textContent!==a&&(o.suppressHydrationWarning!==!0&&_m(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&_m(s.textContent,a,t),r=["children",""+a]):Kh.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Zt("scroll",s)}switch(n){case"input":Im(s),B$(s,o,!0);break;case"textarea":Im(s),U$(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=nx)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=VF(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(n,{is:s.is}):(t=i.createElement(n),n==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,n),t[ui]=e,t[rf]=s,fP(t,e,!1,!1),e.stateNode=t;e:{switch(i=dw(n,s),n){case"dialog":Zt("cancel",t),Zt("close",t),r=s;break;case"iframe":case"object":case"embed":Zt("load",t),r=s;break;case"video":case"audio":for(r=0;r<mh.length;r++)Zt(mh[r],t);r=s;break;case"source":Zt("error",t),r=s;break;case"img":case"image":case"link":Zt("error",t),Zt("load",t),r=s;break;case"details":Zt("toggle",t),r=s;break;case"input":j$(t,s),r=ow(t,s),Zt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=hn({},s,{value:void 0}),Zt("invalid",t);break;case"textarea":z$(t,s),r=lw(t,s),Zt("invalid",t);break;default:r=s}uw(n,r),a=r;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?GF(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&WF(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Xh(t,l):typeof l=="number"&&Xh(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Kh.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Zt("scroll",t):l!=null&&ES(t,o,l,i))}switch(n){case"input":Im(t),B$(t,s,!1);break;case"textarea":Im(t),U$(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Ya(s.value));break;case"select":t.multiple=!!s.multiple,o=s.value,o!=null?wu(t,!!s.multiple,o,!1):s.defaultValue!=null&&wu(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=nx)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Is(e),null;case 6:if(t&&e.stateNode!=null)mP(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ye(166));if(n=jl(af.current),jl(fi.current),Mm(e)){if(s=e.stateNode,n=e.memoizedProps,s[ui]=e,(o=s.nodeValue!==n)&&(t=Vr,t!==null))switch(t.tag){case 3:_m(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_m(s.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[ui]=e,e.stateNode=s}return Is(e),null;case 13:if(en(cn),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rn&&Br!==null&&e.mode&1&&!(e.flags&128))O3(),Mu(),e.flags|=98560,o=!1;else if(o=Mm(e),s!==null&&s.dehydrated!==null){if(t===null){if(!o)throw Error(ye(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ye(317));o[ui]=e}else Mu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Is(e),o=!1}else Fo!==null&&(Hw(Fo),Fo=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||cn.current&1?Kn===0&&(Kn=3):lk())),e.updateQueue!==null&&(e.flags|=4),Is(e),null);case 4:return ju(),Mw(t,e),t===null&&nf(e.stateNode.containerInfo),Is(e),null;case 10:return HS(e.type._context),Is(e),null;case 17:return Sr(e.type)&&sx(),Is(e),null;case 19:if(en(cn),o=e.memoizedState,o===null)return Is(e),null;if(s=(e.flags&128)!==0,i=o.rendering,i===null)if(s)Jd(o,!1);else{if(Kn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ux(t),i!==null){for(e.flags|=128,Jd(o,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)o=n,t=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return qt(cn,cn.current&1|2),e.child}t=t.sibling}o.tail!==null&&En()>zu&&(e.flags|=128,s=!0,Jd(o,!1),e.lanes=4194304)}else{if(!s)if(t=ux(i),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Jd(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!rn)return Is(e),null}else 2*En()-o.renderingStartTime>zu&&n!==1073741824&&(e.flags|=128,s=!0,Jd(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=En(),e.sibling=null,n=cn.current,qt(cn,s?n&1|2:n&1),e):(Is(e),null);case 22:case 23:return ak(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?_r&1073741824&&(Is(e),e.subtreeFlags&6&&(e.flags|=8192)):Is(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function _H(t,e){switch(zS(e),e.tag){case 1:return Sr(e.type)&&sx(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ju(),en(Cr),en(Vs),YS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return XS(e),null;case 13:if(en(cn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));Mu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return en(cn),null;case 4:return ju(),null;case 10:return HS(e.type._context),null;case 22:case 23:return ak(),null;case 24:return null;default:return null}}var Bm=!1,_s=!1,MH=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function gu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){mn(t,e,s)}else n.current=null}function Lw(t,e,n){try{n()}catch(s){mn(t,e,s)}}var AI=!1;function LH(t,e){if(ww=Qg,t=b3(),jS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=i+r),d!==o||s!==0&&d.nodeType!==3||(l=i+s),d.nodeType===3&&(i+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=i),h===o&&++u===s&&(l=i),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Cw={focusedElem:t,selectionRange:n},Qg=!1,Oe=e;Oe!==null;)if(e=Oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Oe=t;else for(;Oe!==null;){e=Oe;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?g:Do(e.type,g),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(w){mn(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Oe=t;break}Oe=e.return}return m=AI,AI=!1,m}function Ah(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,o!==void 0&&Lw(e,n,o)}r=r.next}while(r!==s)}}function Ay(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function jw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gP(t){var e=t.alternate;e!==null&&(t.alternate=null,gP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ui],delete e[rf],delete e[Nw],delete e[bH],delete e[wH])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function xP(t){return t.tag===5||t.tag===3||t.tag===4}function DI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||xP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bw(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=nx));else if(s!==4&&(t=t.child,t!==null))for(Bw(t,e,n),t=t.sibling;t!==null;)Bw(t,e,n),t=t.sibling}function zw(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(zw(t,e,n),t=t.sibling;t!==null;)zw(t,e,n),t=t.sibling}var ps=null,Oo=!1;function fa(t,e,n){for(n=n.child;n!==null;)yP(t,e,n),n=n.sibling}function yP(t,e,n){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(Sy,n)}catch{}switch(n.tag){case 5:_s||gu(n,e);case 6:var s=ps,r=Oo;ps=null,fa(t,e,n),ps=s,Oo=r,ps!==null&&(Oo?(t=ps,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ps.removeChild(n.stateNode));break;case 18:ps!==null&&(Oo?(t=ps,n=n.stateNode,t.nodeType===8?wb(t.parentNode,n):t.nodeType===1&&wb(t,n),Qh(t)):wb(ps,n.stateNode));break;case 4:s=ps,r=Oo,ps=n.stateNode.containerInfo,Oo=!0,fa(t,e,n),ps=s,Oo=r;break;case 0:case 11:case 14:case 15:if(!_s&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var o=r,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Lw(n,e,i),r=r.next}while(r!==s)}fa(t,e,n);break;case 1:if(!_s&&(gu(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){mn(n,e,a)}fa(t,e,n);break;case 21:fa(t,e,n);break;case 22:n.mode&1?(_s=(s=_s)||n.memoizedState!==null,fa(t,e,n),_s=s):fa(t,e,n);break;default:fa(t,e,n)}}function OI(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new MH),e.forEach(function(s){var r=qH.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Io(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:ps=a.stateNode,Oo=!1;break e;case 3:ps=a.stateNode.containerInfo,Oo=!0;break e;case 4:ps=a.stateNode.containerInfo,Oo=!0;break e}a=a.return}if(ps===null)throw Error(ye(160));yP(o,i,r),ps=null,Oo=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){mn(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vP(e,t),e=e.sibling}function vP(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Io(e,t),Jo(t),s&4){try{Ah(3,t,t.return),Ay(3,t)}catch(g){mn(t,t.return,g)}try{Ah(5,t,t.return)}catch(g){mn(t,t.return,g)}}break;case 1:Io(e,t),Jo(t),s&512&&n!==null&&gu(n,n.return);break;case 5:if(Io(e,t),Jo(t),s&512&&n!==null&&gu(n,n.return),t.flags&32){var r=t.stateNode;try{Xh(r,"")}catch(g){mn(t,t.return,g)}}if(s&4&&(r=t.stateNode,r!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&zF(r,o),dw(a,i);var c=dw(a,o);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?GF(r,d):u==="dangerouslySetInnerHTML"?WF(r,d):u==="children"?Xh(r,d):ES(r,u,d,c)}switch(a){case"input":iw(r,o);break;case"textarea":UF(r,o);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?wu(r,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?wu(r,!!o.multiple,o.defaultValue,!0):wu(r,!!o.multiple,o.multiple?[]:"",!1))}r[rf]=o}catch(g){mn(t,t.return,g)}}break;case 6:if(Io(e,t),Jo(t),s&4){if(t.stateNode===null)throw Error(ye(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(g){mn(t,t.return,g)}}break;case 3:if(Io(e,t),Jo(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Qh(e.containerInfo)}catch(g){mn(t,t.return,g)}break;case 4:Io(e,t),Jo(t);break;case 13:Io(e,t),Jo(t),r=t.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(ok=En())),s&4&&OI(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(_s=(c=_s)||u,Io(e,t),_s=c):Io(e,t),Jo(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Oe=t,u=t.child;u!==null;){for(d=Oe=u;Oe!==null;){switch(h=Oe,f=h.child,h.tag){case 0:case 11:case 14:case 15:Ah(4,h,h.return);break;case 1:gu(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){mn(s,n,g)}}break;case 5:gu(h,h.return);break;case 22:if(h.memoizedState!==null){PI(d);continue}}f!==null?(f.return=h,Oe=f):PI(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=HF("display",i))}catch(g){mn(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){mn(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Io(e,t),Jo(t),s&4&&OI(t);break;case 21:break;default:Io(e,t),Jo(t)}}function Jo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(xP(n)){var s=n;break e}n=n.return}throw Error(ye(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Xh(r,""),s.flags&=-33);var o=DI(t);zw(t,o,r);break;case 3:case 4:var i=s.stateNode.containerInfo,a=DI(t);Bw(t,a,i);break;default:throw Error(ye(161))}}catch(l){mn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function jH(t,e,n){Oe=t,bP(t)}function bP(t,e,n){for(var s=(t.mode&1)!==0;Oe!==null;){var r=Oe,o=r.child;if(r.tag===22&&s){var i=r.memoizedState!==null||Bm;if(!i){var a=r.alternate,l=a!==null&&a.memoizedState!==null||_s;a=Bm;var c=_s;if(Bm=i,(_s=l)&&!c)for(Oe=r;Oe!==null;)i=Oe,l=i.child,i.tag===22&&i.memoizedState!==null?_I(r):l!==null?(l.return=i,Oe=l):_I(r);for(;o!==null;)Oe=o,bP(o),o=o.sibling;Oe=r,Bm=a,_s=c}FI(t)}else r.subtreeFlags&8772&&o!==null?(o.return=r,Oe=o):FI(t)}}function FI(t){for(;Oe!==null;){var e=Oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:_s||Ay(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!_s)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Do(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&yI(e,o,s);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}yI(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Qh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}_s||e.flags&512&&jw(e)}catch(h){mn(e,e.return,h)}}if(e===t){Oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Oe=n;break}Oe=e.return}}function PI(t){for(;Oe!==null;){var e=Oe;if(e===t){Oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Oe=n;break}Oe=e.return}}function _I(t){for(;Oe!==null;){var e=Oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ay(4,e)}catch(l){mn(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){mn(e,r,l)}}var o=e.return;try{jw(e)}catch(l){mn(e,o,l)}break;case 5:var i=e.return;try{jw(e)}catch(l){mn(e,i,l)}}}catch(l){mn(e,e.return,l)}if(e===t){Oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Oe=a;break}Oe=e.return}}var BH=Math.ceil,fx=oa.ReactCurrentDispatcher,sk=oa.ReactCurrentOwner,yo=oa.ReactCurrentBatchConfig,$t=0,as=null,Pn=null,xs=0,_r=0,xu=cl(0),Kn=0,df=null,ac=0,Dy=0,rk=0,Dh=null,mr=null,ok=0,zu=1/0,Ai=null,px=!1,Uw=null,Ba=null,zm=!1,Ia=null,mx=0,Oh=0,Vw=null,Ag=-1,Dg=0;function rr(){return $t&6?En():Ag!==-1?Ag:Ag=En()}function za(t){return t.mode&1?$t&2&&xs!==0?xs&-xs:SH.transition!==null?(Dg===0&&(Dg=r3()),Dg):(t=Pt,t!==0||(t=window.event,t=t===void 0?16:d3(t.type)),t):1}function Bo(t,e,n,s){if(50<Oh)throw Oh=0,Vw=null,Error(ye(185));Wf(t,n,s),(!($t&2)||t!==as)&&(t===as&&(!($t&2)&&(Dy|=n),Kn===4&&ka(t,xs)),kr(t,s),n===1&&$t===0&&!(e.mode&1)&&(zu=En()+500,Iy&&ul()))}function kr(t,e){var n=t.callbackNode;S8(t,e);var s=Zg(t,t===as?xs:0);if(s===0)n!==null&&H$(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&H$(n),e===1)t.tag===0?CH(MI.bind(null,t)):R3(MI.bind(null,t)),yH(function(){!($t&6)&&ul()}),n=null;else{switch(o3(s)){case 1:n=AS;break;case 4:n=n3;break;case 16:n=Jg;break;case 536870912:n=s3;break;default:n=Jg}n=IP(n,wP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wP(t,e){if(Ag=-1,Dg=0,$t&6)throw Error(ye(327));var n=t.callbackNode;if(Eu()&&t.callbackNode!==n)return null;var s=Zg(t,t===as?xs:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=gx(t,s);else{e=s;var r=$t;$t|=2;var o=SP();(as!==t||xs!==e)&&(Ai=null,zu=En()+500,ql(t,e));do try{VH();break}catch(a){CP(t,a)}while(!0);WS(),fx.current=o,$t=r,Pn!==null?e=0:(as=null,xs=0,e=Kn)}if(e!==0){if(e===2&&(r=gw(t),r!==0&&(s=r,e=Ww(t,r))),e===1)throw n=df,ql(t,0),ka(t,s),kr(t,En()),n;if(e===6)ka(t,s);else{if(r=t.current.alternate,!(s&30)&&!zH(r)&&(e=gx(t,s),e===2&&(o=gw(t),o!==0&&(s=o,e=Ww(t,o))),e===1))throw n=df,ql(t,0),ka(t,s),kr(t,En()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(ye(345));case 2:Rl(t,mr,Ai);break;case 3:if(ka(t,s),(s&130023424)===s&&(e=ok+500-En(),10<e)){if(Zg(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){rr(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=kw(Rl.bind(null,t,mr,Ai),e);break}Rl(t,mr,Ai);break;case 4:if(ka(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var i=31-jo(s);o=1<<i,i=e[i],i>r&&(r=i),s&=~o}if(s=r,s=En()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*BH(s/1960))-s,10<s){t.timeoutHandle=kw(Rl.bind(null,t,mr,Ai),s);break}Rl(t,mr,Ai);break;case 5:Rl(t,mr,Ai);break;default:throw Error(ye(329))}}}return kr(t,En()),t.callbackNode===n?wP.bind(null,t):null}function Ww(t,e){var n=Dh;return t.current.memoizedState.isDehydrated&&(ql(t,e).flags|=256),t=gx(t,e),t!==2&&(e=mr,mr=n,e!==null&&Hw(e)),t}function Hw(t){mr===null?mr=t:mr.push.apply(mr,t)}function zH(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],o=r.getSnapshot;r=r.value;try{if(!Wo(o(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ka(t,e){for(e&=~rk,e&=~Dy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-jo(e),s=1<<n;t[n]=-1,e&=~s}}function MI(t){if($t&6)throw Error(ye(327));Eu();var e=Zg(t,0);if(!(e&1))return kr(t,En()),null;var n=gx(t,e);if(t.tag!==0&&n===2){var s=gw(t);s!==0&&(e=s,n=Ww(t,s))}if(n===1)throw n=df,ql(t,0),ka(t,e),kr(t,En()),n;if(n===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rl(t,mr,Ai),kr(t,En()),null}function ik(t,e){var n=$t;$t|=1;try{return t(e)}finally{$t=n,$t===0&&(zu=En()+500,Iy&&ul())}}function lc(t){Ia!==null&&Ia.tag===0&&!($t&6)&&Eu();var e=$t;$t|=1;var n=yo.transition,s=Pt;try{if(yo.transition=null,Pt=1,t)return t()}finally{Pt=s,yo.transition=n,$t=e,!($t&6)&&ul()}}function ak(){_r=xu.current,en(xu)}function ql(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,xH(n)),Pn!==null)for(n=Pn.return;n!==null;){var s=n;switch(zS(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&sx();break;case 3:ju(),en(Cr),en(Vs),YS();break;case 5:XS(s);break;case 4:ju();break;case 13:en(cn);break;case 19:en(cn);break;case 10:HS(s.type._context);break;case 22:case 23:ak()}n=n.return}if(as=t,Pn=t=Ua(t.current,null),xs=_r=e,Kn=0,df=null,rk=Dy=ac=0,mr=Dh=null,Ll!==null){for(e=0;e<Ll.length;e++)if(n=Ll[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,o=n.pending;if(o!==null){var i=o.next;o.next=r,s.next=i}n.pending=s}Ll=null}return t}function CP(t,e){do{var n=Pn;try{if(WS(),Ig.current=hx,dx){for(var s=dn.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}dx=!1}if(ic=0,ss=Hn=dn=null,Rh=!1,lf=0,sk.current=null,n===null||n.return===null){Kn=1,df=e,Pn=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=xs,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=kI(i);if(f!==null){f.flags&=-257,NI(f,i,a,o,e),f.mode&1&&SI(o,c,e),e=f,l=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){SI(o,c,e),lk();break e}l=Error(ye(426))}}else if(rn&&a.mode&1){var y=kI(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),NI(y,i,a,o,e),US(Bu(l,a));break e}}o=l=Bu(l,a),Kn!==4&&(Kn=2),Dh===null?Dh=[o]:Dh.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var x=oP(o,l,e);xI(o,x);break e;case 1:a=l;var v=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ba===null||!Ba.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=iP(o,a,e);xI(o,w);break e}}o=o.return}while(o!==null)}NP(n)}catch(C){e=C,Pn===n&&n!==null&&(Pn=n=n.return);continue}break}while(!0)}function SP(){var t=fx.current;return fx.current=hx,t===null?hx:t}function lk(){(Kn===0||Kn===3||Kn===2)&&(Kn=4),as===null||!(ac&268435455)&&!(Dy&268435455)||ka(as,xs)}function gx(t,e){var n=$t;$t|=2;var s=SP();(as!==t||xs!==e)&&(Ai=null,ql(t,e));do try{UH();break}catch(r){CP(t,r)}while(!0);if(WS(),$t=n,fx.current=s,Pn!==null)throw Error(ye(261));return as=null,xs=0,Kn}function UH(){for(;Pn!==null;)kP(Pn)}function VH(){for(;Pn!==null&&!p8();)kP(Pn)}function kP(t){var e=$P(t.alternate,t,_r);t.memoizedProps=t.pendingProps,e===null?NP(t):Pn=e,sk.current=null}function NP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_H(n,e),n!==null){n.flags&=32767,Pn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kn=6,Pn=null;return}}else if(n=PH(n,e,_r),n!==null){Pn=n;return}if(e=e.sibling,e!==null){Pn=e;return}Pn=e=t}while(e!==null);Kn===0&&(Kn=5)}function Rl(t,e,n){var s=Pt,r=yo.transition;try{yo.transition=null,Pt=1,WH(t,e,n,s)}finally{yo.transition=r,Pt=s}return null}function WH(t,e,n,s){do Eu();while(Ia!==null);if($t&6)throw Error(ye(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(k8(t,o),t===as&&(Pn=as=null,xs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zm||(zm=!0,IP(Jg,function(){return Eu(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=yo.transition,yo.transition=null;var i=Pt;Pt=1;var a=$t;$t|=4,sk.current=null,LH(t,n),vP(n,t),uH(Cw),Qg=!!ww,Cw=ww=null,t.current=n,jH(n),m8(),$t=a,Pt=i,yo.transition=o}else t.current=n;if(zm&&(zm=!1,Ia=t,mx=r),o=t.pendingLanes,o===0&&(Ba=null),y8(n.stateNode),kr(t,En()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(px)throw px=!1,t=Uw,Uw=null,t;return mx&1&&t.tag!==0&&Eu(),o=t.pendingLanes,o&1?t===Vw?Oh++:(Oh=0,Vw=t):Oh=0,ul(),null}function Eu(){if(Ia!==null){var t=o3(mx),e=yo.transition,n=Pt;try{if(yo.transition=null,Pt=16>t?16:t,Ia===null)var s=!1;else{if(t=Ia,Ia=null,mx=0,$t&6)throw Error(ye(331));var r=$t;for($t|=4,Oe=t.current;Oe!==null;){var o=Oe,i=o.child;if(Oe.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Oe=c;Oe!==null;){var u=Oe;switch(u.tag){case 0:case 11:case 15:Ah(8,u,o)}var d=u.child;if(d!==null)d.return=u,Oe=d;else for(;Oe!==null;){u=Oe;var h=u.sibling,f=u.return;if(gP(u),u===c){Oe=null;break}if(h!==null){h.return=f,Oe=h;break}Oe=f}}}var m=o.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Oe=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Oe=i;else e:for(;Oe!==null;){if(o=Oe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ah(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,Oe=x;break e}Oe=o.return}}var v=t.current;for(Oe=v;Oe!==null;){i=Oe;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,Oe=b;else e:for(i=v;Oe!==null;){if(a=Oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ay(9,a)}}catch(C){mn(a,a.return,C)}if(a===i){Oe=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,Oe=w;break e}Oe=a.return}}if($t=r,ul(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(Sy,t)}catch{}s=!0}return s}finally{Pt=n,yo.transition=e}}return!1}function LI(t,e,n){e=Bu(n,e),e=oP(t,e,1),t=ja(t,e,1),e=rr(),t!==null&&(Wf(t,1,e),kr(t,e))}function mn(t,e,n){if(t.tag===3)LI(t,t,n);else for(;e!==null;){if(e.tag===3){LI(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ba===null||!Ba.has(s))){t=Bu(n,t),t=iP(e,t,1),e=ja(e,t,1),t=rr(),e!==null&&(Wf(e,1,t),kr(e,t));break}}e=e.return}}function HH(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=rr(),t.pingedLanes|=t.suspendedLanes&n,as===t&&(xs&n)===n&&(Kn===4||Kn===3&&(xs&130023424)===xs&&500>En()-ok?ql(t,0):rk|=n),kr(t,e)}function EP(t,e){e===0&&(t.mode&1?(e=Am,Am<<=1,!(Am&130023424)&&(Am=4194304)):e=1);var n=rr();t=Ki(t,e),t!==null&&(Wf(t,e,n),kr(t,n))}function GH(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),EP(t,n)}function qH(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ye(314))}s!==null&&s.delete(e),EP(t,n)}var $P;$P=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Cr.current)yr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yr=!1,FH(t,e,n);yr=!!(t.flags&131072)}else yr=!1,rn&&e.flags&1048576&&A3(e,ix,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Rg(t,e),t=e.pendingProps;var r=_u(e,Vs.current);Nu(e,n),r=ZS(null,e,s,t,r,n);var o=QS();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Sr(s)?(o=!0,rx(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,qS(e),r.updater=Ry,e.stateNode=r,r._reactInternals=e,Aw(e,s,t,n),e=Fw(null,e,s,!0,o,n)):(e.tag=0,rn&&o&&BS(e),Js(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Rg(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=XH(s),t=Do(s,t),r){case 0:e=Ow(null,e,s,t,n);break e;case 1:e=II(null,e,s,t,n);break e;case 11:e=EI(null,e,s,t,n);break e;case 14:e=$I(null,e,s,Do(s.type,t),n);break e}throw Error(ye(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Do(s,r),Ow(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Do(s,r),II(t,e,s,r,n);case 3:e:{if(uP(e),t===null)throw Error(ye(387));s=e.pendingProps,o=e.memoizedState,r=o.element,M3(t,e),cx(e,s,null,n);var i=e.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=Bu(Error(ye(423)),e),e=TI(t,e,s,n,r);break e}else if(s!==r){r=Bu(Error(ye(424)),e),e=TI(t,e,s,n,r);break e}else for(Br=La(e.stateNode.containerInfo.firstChild),Vr=e,rn=!0,Fo=null,n=P3(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Mu(),s===r){e=Xi(t,e,n);break e}Js(t,e,s,n)}e=e.child}return e;case 5:return L3(e),t===null&&Iw(e),s=e.type,r=e.pendingProps,o=t!==null?t.memoizedProps:null,i=r.children,Sw(s,r)?i=null:o!==null&&Sw(s,o)&&(e.flags|=32),cP(t,e),Js(t,e,i,n),e.child;case 6:return t===null&&Iw(e),null;case 13:return dP(t,e,n);case 4:return KS(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Lu(e,null,s,n):Js(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Do(s,r),EI(t,e,s,r,n);case 7:return Js(t,e,e.pendingProps,n),e.child;case 8:return Js(t,e,e.pendingProps.children,n),e.child;case 12:return Js(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,o=e.memoizedProps,i=r.value,qt(ax,s._currentValue),s._currentValue=i,o!==null)if(Wo(o.value,i)){if(o.children===r.children&&!Cr.current){e=Xi(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(o.tag===1){l=zi(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Tw(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(ye(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),Tw(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Js(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Nu(e,n),r=vo(r),s=s(r),e.flags|=1,Js(t,e,s,n),e.child;case 14:return s=e.type,r=Do(s,e.pendingProps),r=Do(s.type,r),$I(t,e,s,r,n);case 15:return aP(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Do(s,r),Rg(t,e),e.tag=1,Sr(s)?(t=!0,rx(e)):t=!1,Nu(e,n),rP(e,s,r),Aw(e,s,r,n),Fw(null,e,s,!0,t,n);case 19:return hP(t,e,n);case 22:return lP(t,e,n)}throw Error(ye(156,e.tag))};function IP(t,e){return t3(t,e)}function KH(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ho(t,e,n,s){return new KH(t,e,n,s)}function ck(t){return t=t.prototype,!(!t||!t.isReactComponent)}function XH(t){if(typeof t=="function")return ck(t)?1:0;if(t!=null){if(t=t.$$typeof,t===IS)return 11;if(t===TS)return 14}return 2}function Ua(t,e){var n=t.alternate;return n===null?(n=ho(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Og(t,e,n,s,r,o){var i=2;if(s=t,typeof t=="function")ck(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case au:return Kl(n.children,r,o,e);case $S:i=8,r|=8;break;case tw:return t=ho(12,n,e,r|2),t.elementType=tw,t.lanes=o,t;case nw:return t=ho(13,n,e,r),t.elementType=nw,t.lanes=o,t;case sw:return t=ho(19,n,e,r),t.elementType=sw,t.lanes=o,t;case LF:return Oy(n,r,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _F:i=10;break e;case MF:i=9;break e;case IS:i=11;break e;case TS:i=14;break e;case va:i=16,s=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=ho(i,n,e,r),e.elementType=t,e.type=s,e.lanes=o,e}function Kl(t,e,n,s){return t=ho(7,t,s,e),t.lanes=n,t}function Oy(t,e,n,s){return t=ho(22,t,s,e),t.elementType=LF,t.lanes=n,t.stateNode={isHidden:!1},t}function Tb(t,e,n){return t=ho(6,t,null,e),t.lanes=n,t}function Rb(t,e,n){return e=ho(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YH(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ub(0),this.expirationTimes=ub(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ub(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function uk(t,e,n,s,r,o,i,a,l){return t=new YH(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ho(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qS(o),t}function JH(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:iu,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function TP(t){if(!t)return Ja;t=t._reactInternals;e:{if(Rc(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Sr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var n=t.type;if(Sr(n))return T3(t,n,e)}return e}function RP(t,e,n,s,r,o,i,a,l){return t=uk(n,s,!0,t,r,o,i,a,l),t.context=TP(null),n=t.current,s=rr(),r=za(n),o=zi(s,r),o.callback=e??null,ja(n,o,r),t.current.lanes=r,Wf(t,r,s),kr(t,s),t}function Fy(t,e,n,s){var r=e.current,o=rr(),i=za(r);return n=TP(n),e.context===null?e.context=n:e.pendingContext=n,e=zi(o,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=ja(r,e,i),t!==null&&(Bo(t,r,i,o),$g(t,r,i)),i}function xx(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function jI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function dk(t,e){jI(t,e),(t=t.alternate)&&jI(t,e)}function ZH(){return null}var AP=typeof reportError=="function"?reportError:function(t){console.error(t)};function hk(t){this._internalRoot=t}Py.prototype.render=hk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));Fy(t,e,null,null)};Py.prototype.unmount=hk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;lc(function(){Fy(null,t,null,null)}),e[qi]=null}};function Py(t){this._internalRoot=t}Py.prototype.unstable_scheduleHydration=function(t){if(t){var e=l3();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Sa.length&&e!==0&&e<Sa[n].priority;n++);Sa.splice(n,0,t),n===0&&u3(t)}};function fk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _y(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function BI(){}function QH(t,e,n,s,r){if(r){if(typeof s=="function"){var o=s;s=function(){var c=xx(i);o.call(c)}}var i=RP(e,s,t,0,null,!1,!1,"",BI);return t._reactRootContainer=i,t[qi]=i.current,nf(t.nodeType===8?t.parentNode:t),lc(),i}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=xx(l);a.call(c)}}var l=uk(t,0,!1,null,null,!1,!1,"",BI);return t._reactRootContainer=l,t[qi]=l.current,nf(t.nodeType===8?t.parentNode:t),lc(function(){Fy(e,l,n,s)}),l}function My(t,e,n,s,r){var o=n._reactRootContainer;if(o){var i=o;if(typeof r=="function"){var a=r;r=function(){var l=xx(i);a.call(l)}}Fy(e,i,t,r)}else i=QH(n,e,t,r,s);return xx(i)}i3=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ph(e.pendingLanes);n!==0&&(DS(e,n|1),kr(e,En()),!($t&6)&&(zu=En()+500,ul()))}break;case 13:lc(function(){var s=Ki(t,1);if(s!==null){var r=rr();Bo(s,t,1,r)}}),dk(t,1)}};OS=function(t){if(t.tag===13){var e=Ki(t,134217728);if(e!==null){var n=rr();Bo(e,t,134217728,n)}dk(t,134217728)}};a3=function(t){if(t.tag===13){var e=za(t),n=Ki(t,e);if(n!==null){var s=rr();Bo(n,t,e,s)}dk(t,e)}};l3=function(){return Pt};c3=function(t,e){var n=Pt;try{return Pt=t,e()}finally{Pt=n}};fw=function(t,e,n){switch(e){case"input":if(iw(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=$y(s);if(!r)throw Error(ye(90));BF(s),iw(s,r)}}}break;case"textarea":UF(t,n);break;case"select":e=n.value,e!=null&&wu(t,!!n.multiple,e,!1)}};XF=ik;YF=lc;var eG={usingClientEntryPoint:!1,Events:[Gf,du,$y,qF,KF,ik]},Zd={findFiberByHostInstance:Ml,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tG={bundleType:Zd.bundleType,version:Zd.version,rendererPackageName:Zd.rendererPackageName,rendererConfig:Zd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=QF(t),t===null?null:t.stateNode},findFiberByHostInstance:Zd.findFiberByHostInstance||ZH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Um=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Um.isDisabled&&Um.supportsFiber)try{Sy=Um.inject(tG),hi=Um}catch{}}Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eG;Jr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fk(e))throw Error(ye(200));return JH(t,e,null,n)};Jr.createRoot=function(t,e){if(!fk(t))throw Error(ye(299));var n=!1,s="",r=AP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=uk(t,1,!1,null,null,n,!1,s,r),t[qi]=e.current,nf(t.nodeType===8?t.parentNode:t),new hk(e)};Jr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=QF(e),t=t===null?null:t.stateNode,t};Jr.flushSync=function(t){return lc(t)};Jr.hydrate=function(t,e,n){if(!_y(e))throw Error(ye(200));return My(null,t,e,!0,n)};Jr.hydrateRoot=function(t,e,n){if(!fk(t))throw Error(ye(405));var s=n!=null&&n.hydratedSources||null,r=!1,o="",i=AP;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=RP(e,null,t,1,n??null,r,!1,o,i),t[qi]=e.current,nf(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Py(e)};Jr.render=function(t,e,n){if(!_y(e))throw Error(ye(200));return My(null,t,e,!1,n)};Jr.unmountComponentAtNode=function(t){if(!_y(t))throw Error(ye(40));return t._reactRootContainer?(lc(function(){My(null,null,t,!1,function(){t._reactRootContainer=null,t[qi]=null})}),!0):!1};Jr.unstable_batchedUpdates=ik;Jr.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!_y(n))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return My(t,e,n,!1,s)};Jr.version="18.3.1-next-f1338f8080-20240426";function DP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DP)}catch(t){console.error(t)}}DP(),DF.exports=Jr;var pk=DF.exports;const yu=dd(pk);var OP,zI=pk;OP=zI.createRoot,zI.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hf(){return hf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},hf.apply(this,arguments)}var Ta;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ta||(Ta={}));const UI="popstate";function nG(t){t===void 0&&(t={});function e(s,r){let{pathname:o,search:i,hash:a}=s.location;return Gw("",{pathname:o,search:i,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:yx(r)}return rG(e,n,null,t)}function Tn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function FP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sG(){return Math.random().toString(36).substr(2,8)}function VI(t,e){return{usr:t.state,key:t.key,idx:e}}function Gw(t,e,n,s){return n===void 0&&(n=null),hf({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?md(e):e,{state:n,key:e&&e.key||s||sG()})}function yx(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function md(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function rG(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:o=!1}=s,i=r.history,a=Ta.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(hf({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function d(){a=Ta.Pop;let y=u(),x=y==null?null:y-c;c=y,l&&l({action:a,location:g.location,delta:x})}function h(y,x){a=Ta.Push;let v=Gw(g.location,y,x);c=u()+1;let b=VI(v,c),w=g.createHref(v);try{i.pushState(b,"",w)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;r.location.assign(w)}o&&l&&l({action:a,location:g.location,delta:1})}function f(y,x){a=Ta.Replace;let v=Gw(g.location,y,x);c=u();let b=VI(v,c),w=g.createHref(v);i.replaceState(b,"",w),o&&l&&l({action:a,location:g.location,delta:0})}function m(y){let x=r.location.origin!=="null"?r.location.origin:r.location.href,v=typeof y=="string"?y:yx(y);return v=v.replace(/ $/,"%20"),Tn(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let g={get action(){return a},get location(){return t(r,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(UI,d),l=y,()=>{r.removeEventListener(UI,d),l=null}},createHref(y){return e(r,y)},createURL:m,encodeLocation(y){let x=m(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:f,go(y){return i.go(y)}};return g}var WI;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(WI||(WI={}));function oG(t,e,n){return n===void 0&&(n="/"),iG(t,e,n)}function iG(t,e,n,s){let r=typeof e=="string"?md(e):e,o=mk(r.pathname||"/",n);if(o==null)return null;let i=PP(t);aG(i);let a=null;for(let l=0;a==null&&l<i.length;++l){let c=vG(o);a=gG(i[l],c)}return a}function PP(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(o,i,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};l.relativePath.startsWith("/")&&(Tn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=Va([s,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(Tn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),PP(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:pG(c,o.index),routesMeta:u})};return t.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))r(o,i);else for(let l of _P(o.path))r(o,i,l)}),e}function _P(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(s.length===0)return r?[o,""]:[o];let i=_P(s.join("/")),a=[];return a.push(...i.map(l=>l===""?o:[o,l].join("/"))),r&&a.push(...i),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function aG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:mG(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const lG=/^:[\w-]+$/,cG=3,uG=2,dG=1,hG=10,fG=-2,HI=t=>t==="*";function pG(t,e){let n=t.split("/"),s=n.length;return n.some(HI)&&(s+=fG),e&&(s+=uG),n.filter(r=>!HI(r)).reduce((r,o)=>r+(lG.test(o)?cG:o===""?dG:hG),s)}function mG(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function gG(t,e,n){let{routesMeta:s}=t,r={},o="/",i=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=xG({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:Va([o,d.pathname]),pathnameBase:SG(Va([o,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(o=Va([o,d.pathnameBase]))}return i}function xG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=yG(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let o=r[0],i=o.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let g=a[d]||"";i=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const m=a[d];return f&&!m?c[h]=void 0:c[h]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:t}}function yG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),FP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function vG(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return FP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function mk(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function bG(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?md(t):t;return{pathname:n?n.startsWith("/")?n:wG(n,e):e,search:kG(s),hash:NG(r)}}function wG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Ab(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function CG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function gk(t,e){let n=CG(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function xk(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=md(t):(r=hf({},t),Tn(!r.pathname||!r.pathname.includes("?"),Ab("?","pathname","search",r)),Tn(!r.pathname||!r.pathname.includes("#"),Ab("#","pathname","hash",r)),Tn(!r.search||!r.search.includes("#"),Ab("#","search","hash",r)));let o=t===""||r.pathname==="",i=o?"/":r.pathname,a;if(i==null)a=n;else{let d=e.length-1;if(!s&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;r.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=bG(r,a),c=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Va=t=>t.join("/").replace(/\/\/+/g,"/"),SG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),kG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,NG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function EG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const MP=["post","put","patch","delete"];new Set(MP);const $G=["get",...MP];new Set($G);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ff(){return ff=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},ff.apply(this,arguments)}const yk=S.createContext(null),IG=S.createContext(null),dl=S.createContext(null),Ly=S.createContext(null),ia=S.createContext({outlet:null,matches:[],isDataRoute:!1}),LP=S.createContext(null);function TG(t,e){let{relative:n}=e===void 0?{}:e;gd()||Tn(!1);let{basename:s,navigator:r}=S.useContext(dl),{hash:o,pathname:i,search:a}=BP(t,{relative:n}),l=i;return s!=="/"&&(l=i==="/"?s:Va([s,i])),r.createHref({pathname:l,search:a,hash:o})}function gd(){return S.useContext(Ly)!=null}function xd(){return gd()||Tn(!1),S.useContext(Ly).location}function jP(t){S.useContext(dl).static||S.useLayoutEffect(t)}function Dr(){let{isDataRoute:t}=S.useContext(ia);return t?UG():RG()}function RG(){gd()||Tn(!1);let t=S.useContext(yk),{basename:e,future:n,navigator:s}=S.useContext(dl),{matches:r}=S.useContext(ia),{pathname:o}=xd(),i=JSON.stringify(gk(r,n.v7_relativeSplatPath)),a=S.useRef(!1);return jP(()=>{a.current=!0}),S.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let d=xk(c,JSON.parse(i),o,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Va([e,d.pathname])),(u.replace?s.replace:s.push)(d,u.state,u)},[e,s,i,o,t])}function yd(){let{matches:t}=S.useContext(ia),e=t[t.length-1];return e?e.params:{}}function BP(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=S.useContext(dl),{matches:r}=S.useContext(ia),{pathname:o}=xd(),i=JSON.stringify(gk(r,s.v7_relativeSplatPath));return S.useMemo(()=>xk(t,JSON.parse(i),o,n==="path"),[t,i,o,n])}function AG(t,e){return DG(t,e)}function DG(t,e,n,s){gd()||Tn(!1);let{navigator:r,static:o}=S.useContext(dl),{matches:i}=S.useContext(ia),a=i[i.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=xd(),d;if(e){var h;let x=typeof e=="string"?md(e):e;c==="/"||(h=x.pathname)!=null&&h.startsWith(c)||Tn(!1),d=x}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let x=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=oG(t,{pathname:m}),y=MG(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:Va([c,r.encodeLocation?r.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:Va([c,r.encodeLocation?r.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n,s);return e&&y?S.createElement(Ly.Provider,{value:{location:ff({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ta.Pop}},y):y}function OG(){let t=zG(),e=EG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),n?S.createElement("pre",{style:r},n):null,null)}const FG=S.createElement(OG,null);class PG extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?S.createElement(ia.Provider,{value:this.props.routeContext},S.createElement(LP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _G(t){let{routeContext:e,match:n,children:s}=t,r=S.useContext(yk);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(ia.Provider,{value:e},s)}function MG(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=s)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||Tn(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=n,m=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||m){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,d,h)=>{let f,m=!1,g=null,y=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||FG,l&&(c<0&&h===0?(VG("route-fallback"),m=!0,y=null):c===h&&(m=!0,y=d.route.hydrateFallbackElement||null)));let x=e.concat(i.slice(0,h+1)),v=()=>{let b;return f?b=g:m?b=y:d.route.Component?b=S.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=u,S.createElement(_G,{match:d,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?S.createElement(PG,{location:n.location,revalidation:n.revalidation,component:g,error:f,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var zP=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(zP||{}),UP=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(UP||{});function LG(t){let e=S.useContext(yk);return e||Tn(!1),e}function jG(t){let e=S.useContext(IG);return e||Tn(!1),e}function BG(t){let e=S.useContext(ia);return e||Tn(!1),e}function VP(t){let e=BG(),n=e.matches[e.matches.length-1];return n.route.id||Tn(!1),n.route.id}function zG(){var t;let e=S.useContext(LP),n=jG(),s=VP();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function UG(){let{router:t}=LG(zP.UseNavigateStable),e=VP(UP.UseNavigateStable),n=S.useRef(!1);return jP(()=>{n.current=!0}),S.useCallback(function(r,o){o===void 0&&(o={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,ff({fromRouteId:e},o)))},[t,e])}const GI={};function VG(t,e,n){GI[t]||(GI[t]=!0)}function WG(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function HG(t){let{to:e,replace:n,state:s,relative:r}=t;gd()||Tn(!1);let{future:o,static:i}=S.useContext(dl),{matches:a}=S.useContext(ia),{pathname:l}=xd(),c=Dr(),u=xk(e,gk(a,o.v7_relativeSplatPath),l,r==="path"),d=JSON.stringify(u);return S.useEffect(()=>c(JSON.parse(d),{replace:n,state:s,relative:r}),[c,d,r,n,s]),null}function ln(t){Tn(!1)}function GG(t){let{basename:e="/",children:n=null,location:s,navigationType:r=Ta.Pop,navigator:o,static:i=!1,future:a}=t;gd()&&Tn(!1);let l=e.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:l,navigator:o,static:i,future:ff({v7_relativeSplatPath:!1},a)}),[l,a,o,i]);typeof s=="string"&&(s=md(s));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:m="default"}=s,g=S.useMemo(()=>{let y=mk(u,l);return y==null?null:{location:{pathname:y,search:d,hash:h,state:f,key:m},navigationType:r}},[l,u,d,h,f,m,r]);return g==null?null:S.createElement(dl.Provider,{value:c},S.createElement(Ly.Provider,{children:n,value:g}))}function WP(t){let{children:e,location:n}=t;return AG(qw(e),n)}new Promise(()=>{});function qw(t,e){e===void 0&&(e=[]);let n=[];return S.Children.forEach(t,(s,r)=>{if(!S.isValidElement(s))return;let o=[...e,r];if(s.type===S.Fragment){n.push.apply(n,qw(s.props.children,o));return}s.type!==ln&&Tn(!1),!s.props.index||!s.props.children||Tn(!1);let i={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=qw(s.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kw(){return Kw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Kw.apply(this,arguments)}function qG(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,o;for(o=0;o<s.length;o++)r=s[o],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function KG(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function XG(t,e){return t.button===0&&(!e||e==="_self")&&!KG(t)}function Xw(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(r=>[n,r]):[[n,s]])},[]))}function YG(t,e){let n=Xw(t);return e&&e.forEach((s,r)=>{n.has(r)||e.getAll(r).forEach(o=>{n.append(r,o)})}),n}const JG=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ZG="6";try{window.__reactRouterVersion=ZG}catch{}const QG="startTransition",qI=Q1[QG];function e7(t){let{basename:e,children:n,future:s,window:r}=t,o=S.useRef();o.current==null&&(o.current=nG({window:r,v5Compat:!0}));let i=o.current,[a,l]=S.useState({action:i.action,location:i.location}),{v7_startTransition:c}=s||{},u=S.useCallback(d=>{c&&qI?qI(()=>l(d)):l(d)},[l,c]);return S.useLayoutEffect(()=>i.listen(u),[i,u]),S.useEffect(()=>WG(s),[s]),S.createElement(GG,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:i,future:s})}const t7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",n7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ms=S.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:o,replace:i,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=qG(e,JG),{basename:f}=S.useContext(dl),m,g=!1;if(typeof c=="string"&&n7.test(c)&&(m=c,t7))try{let b=new URL(window.location.href),w=c.startsWith("//")?new URL(b.protocol+c):new URL(c),C=mk(w.pathname,f);w.origin===b.origin&&C!=null?c=C+w.search+w.hash:g=!0}catch{}let y=TG(c,{relative:r}),x=s7(c,{replace:i,state:a,target:l,preventScrollReset:u,relative:r,viewTransition:d});function v(b){s&&s(b),b.defaultPrevented||x(b)}return S.createElement("a",Kw({},h,{href:m||y,onClick:g||o?s:v,ref:n,target:l}))});var KI;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(KI||(KI={}));var XI;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(XI||(XI={}));function s7(t,e){let{target:n,replace:s,state:r,preventScrollReset:o,relative:i,viewTransition:a}=e===void 0?{}:e,l=Dr(),c=xd(),u=BP(t,{relative:i});return S.useCallback(d=>{if(XG(d,n)){d.preventDefault();let h=s!==void 0?s:yx(c)===yx(u);l(t,{replace:h,state:r,preventScrollReset:o,relative:i,viewTransition:a})}},[c,l,u,s,r,n,t,o,i,a])}function r7(t){let e=S.useRef(Xw(t)),n=S.useRef(!1),s=xd(),r=S.useMemo(()=>YG(s.search,n.current?null:e.current),[s.search]),o=Dr(),i=S.useCallback((a,l)=>{const c=Xw(typeof a=="function"?a(r):a);n.current=!0,o("?"+c,l)},[o,r]);return[r,i]}function HP(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=HP(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function Ra(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=HP(t))&&(s&&(s+=" "),s+=e);return s}const pf=t=>typeof t=="number"&&!isNaN(t),Xl=t=>typeof t=="string",zr=t=>typeof t=="function",Fg=t=>Xl(t)||zr(t)?t:null,Yw=t=>S.isValidElement(t)||Xl(t)||zr(t)||pf(t);function o7(t,e,n){n===void 0&&(n=300);const{scrollHeight:s,style:r}=t;requestAnimationFrame(()=>{r.minHeight="initial",r.height=s+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(e,n)})})}function jy(t){let{enter:e,exit:n,appendPosition:s=!1,collapse:r=!0,collapseDuration:o=300}=t;return function(i){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:d,isIn:h,playToast:f}=i;const m=s?`${e}--${l}`:e,g=s?`${n}--${l}`:n,y=S.useRef(0);return S.useLayoutEffect(()=>{const x=d.current,v=m.split(" "),b=w=>{w.target===d.current&&(f(),x.removeEventListener("animationend",b),x.removeEventListener("animationcancel",b),y.current===0&&w.type!=="animationcancel"&&x.classList.remove(...v))};x.classList.add(...v),x.addEventListener("animationend",b),x.addEventListener("animationcancel",b)},[]),S.useEffect(()=>{const x=d.current,v=()=>{x.removeEventListener("animationend",v),r?o7(x,u,o):u()};h||(c?v():(y.current=1,x.className+=` ${g}`,x.addEventListener("animationend",v)))},[h]),tt.createElement(tt.Fragment,null,a)}}function YI(t,e){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const nr=new Map;let mf=[];const Jw=new Set,i7=t=>Jw.forEach(e=>e(t)),GP=()=>nr.size>0;function qP(t,e){var n;if(e)return!((n=nr.get(e))==null||!n.isToastActive(t));let s=!1;return nr.forEach(r=>{r.isToastActive(t)&&(s=!0)}),s}function KP(t,e){Yw(t)&&(GP()||mf.push({content:t,options:e}),nr.forEach(n=>{n.buildToast(t,e)}))}function JI(t,e){nr.forEach(n=>{e!=null&&e!=null&&e.containerId?(e==null?void 0:e.containerId)===n.id&&n.toggle(t,e==null?void 0:e.id):n.toggle(t,e==null?void 0:e.id)})}function a7(t){const{subscribe:e,getSnapshot:n,setProps:s}=S.useRef(function(o){const i=o.containerId||1;return{subscribe(a){const l=function(u,d,h){let f=1,m=0,g=[],y=[],x=[],v=d;const b=new Map,w=new Set,C=()=>{x=Array.from(b.values()),w.forEach(E=>E())},k=E=>{y=E==null?[]:y.filter($=>$!==E),C()},N=E=>{const{toastId:$,onOpen:I,updateId:A,children:P}=E.props,_=A==null;E.staleId&&b.delete(E.staleId),b.set($,E),y=[...y,E.props.toastId].filter(U=>U!==E.staleId),C(),h(YI(E,_?"added":"updated")),_&&zr(I)&&I(S.isValidElement(P)&&P.props)};return{id:u,props:v,observe:E=>(w.add(E),()=>w.delete(E)),toggle:(E,$)=>{b.forEach(I=>{$!=null&&$!==I.props.toastId||zr(I.toggle)&&I.toggle(E)})},removeToast:k,toasts:b,clearQueue:()=>{m-=g.length,g=[]},buildToast:(E,$)=>{if((B=>{let{containerId:z,toastId:K,updateId:J}=B;const re=z?z!==u:u!==1,de=b.has(K)&&J==null;return re||de})($))return;const{toastId:I,updateId:A,data:P,staleId:_,delay:U}=$,V=()=>{k(I)},D=A==null;D&&m++;const W={...v,style:v.toastStyle,key:f++,...Object.fromEntries(Object.entries($).filter(B=>{let[z,K]=B;return K!=null})),toastId:I,updateId:A,data:P,closeToast:V,isIn:!1,className:Fg($.className||v.toastClassName),bodyClassName:Fg($.bodyClassName||v.bodyClassName),progressClassName:Fg($.progressClassName||v.progressClassName),autoClose:!$.isLoading&&(R=$.autoClose,j=v.autoClose,R===!1||pf(R)&&R>0?R:j),deleteToast(){const B=b.get(I),{onClose:z,children:K}=B.props;zr(z)&&z(S.isValidElement(K)&&K.props),h(YI(B,"removed")),b.delete(I),m--,m<0&&(m=0),g.length>0?N(g.shift()):C()}};var R,j;W.closeButton=v.closeButton,$.closeButton===!1||Yw($.closeButton)?W.closeButton=$.closeButton:$.closeButton===!0&&(W.closeButton=!Yw(v.closeButton)||v.closeButton);let G=E;S.isValidElement(E)&&!Xl(E.type)?G=S.cloneElement(E,{closeToast:V,toastProps:W,data:P}):zr(E)&&(G=E({closeToast:V,toastProps:W,data:P}));const O={content:G,props:W,staleId:_};v.limit&&v.limit>0&&m>v.limit&&D?g.push(O):pf(U)?setTimeout(()=>{N(O)},U):N(O)},setProps(E){v=E},setToggle:(E,$)=>{b.get(E).toggle=$},isToastActive:E=>y.some($=>$===E),getSnapshot:()=>x}}(i,o,i7);nr.set(i,l);const c=l.observe(a);return mf.forEach(u=>KP(u.content,u.options)),mf=[],()=>{c(),nr.delete(i)}},setProps(a){var l;(l=nr.get(i))==null||l.setProps(a)},getSnapshot(){var a;return(a=nr.get(i))==null?void 0:a.getSnapshot()}}}(t)).current;s(t);const r=S.useSyncExternalStore(e,n,n);return{getToastToRender:function(o){if(!r)return[];const i=new Map;return t.newestOnTop&&r.reverse(),r.forEach(a=>{const{position:l}=a.props;i.has(l)||i.set(l,[]),i.get(l).push(a)}),Array.from(i,a=>o(a[0],a[1]))},isToastActive:qP,count:r==null?void 0:r.length}}function l7(t){const[e,n]=S.useState(!1),[s,r]=S.useState(!1),o=S.useRef(null),i=S.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:u,closeOnClick:d}=t;var h,f;function m(){n(!0)}function g(){n(!1)}function y(b){const w=o.current;i.canDrag&&w&&(i.didMove=!0,e&&g(),i.delta=t.draggableDirection==="x"?b.clientX-i.start:b.clientY-i.start,i.start!==b.clientX&&(i.canCloseOnClick=!1),w.style.transform=`translate3d(${t.draggableDirection==="x"?`${i.delta}px, var(--y)`:`0, calc(${i.delta}px + var(--y))`},0)`,w.style.opacity=""+(1-Math.abs(i.delta/i.removalDistance)))}function x(){document.removeEventListener("pointermove",y),document.removeEventListener("pointerup",x);const b=o.current;if(i.canDrag&&i.didMove&&b){if(i.canDrag=!1,Math.abs(i.delta)>i.removalDistance)return r(!0),t.closeToast(),void t.collapseAll();b.style.transition="transform 0.2s, opacity 0.2s",b.style.removeProperty("transform"),b.style.removeProperty("opacity")}}(f=nr.get((h={id:t.toastId,containerId:t.containerId,fn:n}).containerId||1))==null||f.setToggle(h.id,h.fn),S.useEffect(()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||g(),window.addEventListener("focus",m),window.addEventListener("blur",g),()=>{window.removeEventListener("focus",m),window.removeEventListener("blur",g)}},[t.pauseOnFocusLoss]);const v={onPointerDown:function(b){if(t.draggable===!0||t.draggable===b.pointerType){i.didMove=!1,document.addEventListener("pointermove",y),document.addEventListener("pointerup",x);const w=o.current;i.canCloseOnClick=!0,i.canDrag=!0,w.style.transition="none",t.draggableDirection==="x"?(i.start=b.clientX,i.removalDistance=w.offsetWidth*(t.draggablePercent/100)):(i.start=b.clientY,i.removalDistance=w.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(b){const{top:w,bottom:C,left:k,right:N}=o.current.getBoundingClientRect();b.nativeEvent.type!=="touchend"&&t.pauseOnHover&&b.clientX>=k&&b.clientX<=N&&b.clientY>=w&&b.clientY<=C?g():m()}};return a&&l&&(v.onMouseEnter=g,t.stacked||(v.onMouseLeave=m)),d&&(v.onClick=b=>{u&&u(b),i.canCloseOnClick&&c()}),{playToast:m,pauseToast:g,isRunning:e,preventExitTransition:s,toastRef:o,eventHandlers:v}}function c7(t){let{delay:e,isRunning:n,closeToast:s,type:r="default",hide:o,className:i,style:a,controlledProgress:l,progress:c,rtl:u,isIn:d,theme:h}=t;const f=o||l&&c===0,m={...a,animationDuration:`${e}ms`,animationPlayState:n?"running":"paused"};l&&(m.transform=`scaleX(${c})`);const g=Ra("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":u}),y=zr(i)?i({rtl:u,type:r,defaultClassName:g}):Ra(g,i),x={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{d&&s()}};return tt.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},tt.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${r}`}),tt.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:y,style:m,...x}))}let u7=1;const XP=()=>""+u7++;function d7(t){return t&&(Xl(t.toastId)||pf(t.toastId))?t.toastId:XP()}function Fh(t,e){return KP(t,e),e.toastId}function vx(t,e){return{...e,type:e&&e.type||t,toastId:d7(e)}}function Vm(t){return(e,n)=>Fh(e,vx(t,n))}function bt(t,e){return Fh(t,vx("default",e))}bt.loading=(t,e)=>Fh(t,vx("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),bt.promise=function(t,e,n){let s,{pending:r,error:o,success:i}=e;r&&(s=Xl(r)?bt.loading(r,n):bt.loading(r.render,{...n,...r}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,d,h)=>{if(d==null)return void bt.dismiss(s);const f={type:u,...a,...n,data:h},m=Xl(d)?{render:d}:d;return s?bt.update(s,{...f,...m}):bt(m.render,{...f,...m}),h},c=zr(t)?t():t;return c.then(u=>l("success",i,u)).catch(u=>l("error",o,u)),c},bt.success=Vm("success"),bt.info=Vm("info"),bt.error=Vm("error"),bt.warning=Vm("warning"),bt.warn=bt.warning,bt.dark=(t,e)=>Fh(t,vx("default",{theme:"dark",...e})),bt.dismiss=function(t){(function(e){var n;if(GP()){if(e==null||Xl(n=e)||pf(n))nr.forEach(s=>{s.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const s=nr.get(e.containerId);s?s.removeToast(e.id):nr.forEach(r=>{r.removeToast(e.id)})}}else mf=mf.filter(s=>e!=null&&s.options.toastId!==e)})(t)},bt.clearWaitingQueue=function(t){t===void 0&&(t={}),nr.forEach(e=>{!e.props.limit||t.containerId&&e.id!==t.containerId||e.clearQueue()})},bt.isActive=qP,bt.update=function(t,e){e===void 0&&(e={});const n=((s,r)=>{var o;let{containerId:i}=r;return(o=nr.get(i||1))==null?void 0:o.toasts.get(s)})(t,e);if(n){const{props:s,content:r}=n,o={delay:100,...s,...e,toastId:e.toastId||t,updateId:XP()};o.toastId!==t&&(o.staleId=t);const i=o.render||r;delete o.render,Fh(i,o)}},bt.done=t=>{bt.update(t,{progress:1})},bt.onChange=function(t){return Jw.add(t),()=>{Jw.delete(t)}},bt.play=t=>JI(!0,t),bt.pause=t=>JI(!1,t);const h7=typeof window<"u"?S.useLayoutEffect:S.useEffect,Wm=t=>{let{theme:e,type:n,isLoading:s,...r}=t;return tt.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${n})`,...r})},Db={info:function(t){return tt.createElement(Wm,{...t},tt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return tt.createElement(Wm,{...t},tt.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return tt.createElement(Wm,{...t},tt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return tt.createElement(Wm,{...t},tt.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return tt.createElement("div",{className:"Toastify__spinner"})}},f7=t=>{const{isRunning:e,preventExitTransition:n,toastRef:s,eventHandlers:r,playToast:o}=l7(t),{closeButton:i,children:a,autoClose:l,onClick:c,type:u,hideProgressBar:d,closeToast:h,transition:f,position:m,className:g,style:y,bodyClassName:x,bodyStyle:v,progressClassName:b,progressStyle:w,updateId:C,role:k,progress:N,rtl:E,toastId:$,deleteToast:I,isIn:A,isLoading:P,closeOnClick:_,theme:U}=t,V=Ra("Toastify__toast",`Toastify__toast-theme--${U}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":_}),D=zr(g)?g({rtl:E,position:m,type:u,defaultClassName:V}):Ra(V,g),W=function(O){let{theme:B,type:z,isLoading:K,icon:J}=O,re=null;const de={theme:B,type:z};return J===!1||(zr(J)?re=J({...de,isLoading:K}):S.isValidElement(J)?re=S.cloneElement(J,de):K?re=Db.spinner():(pe=>pe in Db)(z)&&(re=Db[z](de))),re}(t),R=!!N||!l,j={closeToast:h,type:u,theme:U};let G=null;return i===!1||(G=zr(i)?i(j):S.isValidElement(i)?S.cloneElement(i,j):function(O){let{closeToast:B,theme:z,ariaLabel:K="close"}=O;return tt.createElement("button",{className:`Toastify__close-button Toastify__close-button--${z}`,type:"button",onClick:J=>{J.stopPropagation(),B(J)},"aria-label":K},tt.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},tt.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(j)),tt.createElement(f,{isIn:A,done:I,position:m,preventExitTransition:n,nodeRef:s,playToast:o},tt.createElement("div",{id:$,onClick:c,"data-in":A,className:D,...r,style:y,ref:s},tt.createElement("div",{...A&&{role:k},className:zr(x)?x({type:u}):Ra("Toastify__toast-body",x),style:v},W!=null&&tt.createElement("div",{className:Ra("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!P})},W),tt.createElement("div",null,a)),G,tt.createElement(c7,{...C&&!R?{key:`pb-${C}`}:{},rtl:E,theme:U,delay:l,isRunning:e,isIn:A,closeToast:h,hide:d,type:u,style:w,className:b,controlledProgress:R,progress:N||0})))},By=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}},p7=jy(By("bounce",!0));jy(By("slide",!0));jy(By("zoom"));jy(By("flip"));const m7={position:"top-right",transition:p7,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function g7(t){let e={...m7,...t};const n=t.stacked,[s,r]=S.useState(!0),o=S.useRef(null),{getToastToRender:i,isToastActive:a,count:l}=a7(e),{className:c,style:u,rtl:d,containerId:h}=e;function f(g){const y=Ra("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":d});return zr(c)?c({position:g,rtl:d,defaultClassName:y}):Ra(y,Fg(c))}function m(){n&&(r(!0),bt.play())}return h7(()=>{if(n){var g;const y=o.current.querySelectorAll('[data-in="true"]'),x=12,v=(g=e.position)==null?void 0:g.includes("top");let b=0,w=0;Array.from(y).reverse().forEach((C,k)=>{const N=C;N.classList.add("Toastify__toast--stacked"),k>0&&(N.dataset.collapsed=`${s}`),N.dataset.pos||(N.dataset.pos=v?"top":"bot");const E=b*(s?.2:1)+(s?0:x*k);N.style.setProperty("--y",`${v?E:-1*E}px`),N.style.setProperty("--g",`${x}`),N.style.setProperty("--s",""+(1-(s?w:0))),b+=N.offsetHeight,w+=.025})}},[s,l,n]),tt.createElement("div",{ref:o,className:"Toastify",id:h,onMouseEnter:()=>{n&&(r(!1),bt.pause())},onMouseLeave:m},i((g,y)=>{const x=y.length?{...u}:{...u,pointerEvents:"none"};return tt.createElement("div",{className:f(g),style:x,key:`container-${g}`},y.map(v=>{let{content:b,props:w}=v;return tt.createElement(f7,{...w,stacked:n,collapseAll:m,isIn:a(w.toastId,w.containerId),style:w.style,key:`toast-${w.key}`},b)}))}))}let x7={data:""},y7=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||x7,v7=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,b7=/\/\*[^]*?\*\/|  +/g,ZI=/\n+/g,Na=(t,e)=>{let n="",s="",r="";for(let o in t){let i=t[o];o[0]=="@"?o[1]=="i"?n=o+" "+i+";":s+=o[1]=="f"?Na(i,o):o+"{"+Na(i,o[1]=="k"?"":e)+"}":typeof i=="object"?s+=Na(i,e?e.replace(/([^,])+/g,a=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):o):i!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Na.p?Na.p(o,i):o+":"+i+";")}return n+(e&&r?e+"{"+r+"}":r)+s},Ri={},YP=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+YP(t[n]);return e}return t},w7=(t,e,n,s,r)=>{let o=YP(t),i=Ri[o]||(Ri[o]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(o));if(!Ri[i]){let l=o!==t?t:(c=>{let u,d,h=[{}];for(;u=v7.exec(c.replace(b7,""));)u[4]?h.shift():u[3]?(d=u[3].replace(ZI," ").trim(),h.unshift(h[0][d]=h[0][d]||{})):h[0][u[1]]=u[2].replace(ZI," ").trim();return h[0]})(t);Ri[i]=Na(r?{["@keyframes "+i]:l}:l,n?"":"."+i)}let a=n&&Ri.g?Ri.g:null;return n&&(Ri.g=Ri[i]),((l,c,u,d)=>{d?c.data=c.data.replace(d,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(Ri[i],e,s,a),i},C7=(t,e,n)=>t.reduce((s,r,o)=>{let i=e[o];if(i&&i.call){let a=i(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;i=l?"."+l:a&&typeof a=="object"?a.props?"":Na(a,""):a===!1?"":a}return s+r+(i??"")},"");function zy(t){let e=this||{},n=t.call?t(e.p):t;return w7(n.unshift?n.raw?C7(n,[].slice.call(arguments,1),e.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):n,y7(e.target),e.g,e.o,e.k)}let JP,Zw,Qw;zy.bind({g:1});let Yi=zy.bind({k:1});function S7(t,e,n,s){Na.p=e,JP=t,Zw=n,Qw=s}function hl(t,e){let n=this||{};return function(){let s=arguments;function r(o,i){let a=Object.assign({},o),l=a.className||r.className;n.p=Object.assign({theme:Zw&&Zw()},a),n.o=/ *go\d+/.test(l),a.className=zy.apply(n,s)+(l?" "+l:"");let c=t;return t[0]&&(c=a.as||t,delete a.as),Qw&&c[0]&&Qw(a),JP(c,a)}return r}}var k7=t=>typeof t=="function",bx=(t,e)=>k7(t)?t(e):t,N7=(()=>{let t=0;return()=>(++t).toString()})(),ZP=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),E7=20,QP=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,E7)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:n}=e;return QP(t,{type:t.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let r=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+r}))}}},Pg=[],Bl={toasts:[],pausedAt:void 0},Ac=t=>{Bl=QP(Bl,t),Pg.forEach(e=>{e(Bl)})},$7={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},I7=(t={})=>{let[e,n]=S.useState(Bl),s=S.useRef(Bl);S.useEffect(()=>(s.current!==Bl&&n(Bl),Pg.push(n),()=>{let o=Pg.indexOf(n);o>-1&&Pg.splice(o,1)}),[]);let r=e.toasts.map(o=>{var i,a,l;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((i=t[o.type])==null?void 0:i.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((a=t[o.type])==null?void 0:a.duration)||(t==null?void 0:t.duration)||$7[o.type],style:{...t.style,...(l=t[o.type])==null?void 0:l.style,...o.style}}});return{...e,toasts:r}},T7=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||N7()}),Kf=t=>(e,n)=>{let s=T7(e,t,n);return Ac({type:2,toast:s}),s.id},xe=(t,e)=>Kf("blank")(t,e);xe.error=Kf("error");xe.success=Kf("success");xe.loading=Kf("loading");xe.custom=Kf("custom");xe.dismiss=t=>{Ac({type:3,toastId:t})};xe.remove=t=>Ac({type:4,toastId:t});xe.promise=(t,e,n)=>{let s=xe.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(r=>{let o=e.success?bx(e.success,r):void 0;return o?xe.success(o,{id:s,...n,...n==null?void 0:n.success}):xe.dismiss(s),r}).catch(r=>{let o=e.error?bx(e.error,r):void 0;o?xe.error(o,{id:s,...n,...n==null?void 0:n.error}):xe.dismiss(s)}),t};var R7=(t,e)=>{Ac({type:1,toast:{id:t,height:e}})},A7=()=>{Ac({type:5,time:Date.now()})},Ph=new Map,D7=1e3,O7=(t,e=D7)=>{if(Ph.has(t))return;let n=setTimeout(()=>{Ph.delete(t),Ac({type:4,toastId:t})},e);Ph.set(t,n)},F7=t=>{let{toasts:e,pausedAt:n}=I7(t);S.useEffect(()=>{if(n)return;let o=Date.now(),i=e.map(a=>{if(a.duration===1/0)return;let l=(a.duration||0)+a.pauseDuration-(o-a.createdAt);if(l<0){a.visible&&xe.dismiss(a.id);return}return setTimeout(()=>xe.dismiss(a.id),l)});return()=>{i.forEach(a=>a&&clearTimeout(a))}},[e,n]);let s=S.useCallback(()=>{n&&Ac({type:6,time:Date.now()})},[n]),r=S.useCallback((o,i)=>{let{reverseOrder:a=!1,gutter:l=8,defaultPosition:c}=i||{},u=e.filter(f=>(f.position||c)===(o.position||c)&&f.height),d=u.findIndex(f=>f.id===o.id),h=u.filter((f,m)=>m<d&&f.visible).length;return u.filter(f=>f.visible).slice(...a?[h+1]:[0,h]).reduce((f,m)=>f+(m.height||0)+l,0)},[e]);return S.useEffect(()=>{e.forEach(o=>{if(o.dismissed)O7(o.id,o.removeDelay);else{let i=Ph.get(o.id);i&&(clearTimeout(i),Ph.delete(o.id))}})},[e]),{toasts:e,handlers:{updateHeight:R7,startPause:A7,endPause:s,calculateOffset:r}}},P7=Yi`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,_7=Yi`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,M7=Yi`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,L7=hl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${P7} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${_7} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${M7} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,j7=Yi`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,B7=hl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${j7} 1s linear infinite;
`,z7=Yi`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,U7=Yi`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,V7=hl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${z7} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${U7} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,W7=hl("div")`
  position: absolute;
`,H7=hl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,G7=Yi`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,q7=hl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${G7} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,K7=({toast:t})=>{let{icon:e,type:n,iconTheme:s}=t;return e!==void 0?typeof e=="string"?S.createElement(q7,null,e):e:n==="blank"?null:S.createElement(H7,null,S.createElement(B7,{...s}),n!=="loading"&&S.createElement(W7,null,n==="error"?S.createElement(L7,{...s}):S.createElement(V7,{...s})))},X7=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Y7=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,J7="0%{opacity:0;} 100%{opacity:1;}",Z7="0%{opacity:1;} 100%{opacity:0;}",Q7=hl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,e9=hl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,t9=(t,e)=>{let n=t.includes("top")?1:-1,[s,r]=ZP()?[J7,Z7]:[X7(n),Y7(n)];return{animation:e?`${Yi(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Yi(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},n9=S.memo(({toast:t,position:e,style:n,children:s})=>{let r=t.height?t9(t.position||e||"top-center",t.visible):{opacity:0},o=S.createElement(K7,{toast:t}),i=S.createElement(e9,{...t.ariaProps},bx(t.message,t));return S.createElement(Q7,{className:t.className,style:{...r,...n,...t.style}},typeof s=="function"?s({icon:o,message:i}):S.createElement(S.Fragment,null,o,i))});S7(S.createElement);var s9=({id:t,className:e,style:n,onHeightUpdate:s,children:r})=>{let o=S.useCallback(i=>{if(i){let a=()=>{let l=i.getBoundingClientRect().height;s(t,l)};a(),new MutationObserver(a).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return S.createElement("div",{ref:o,className:e,style:n},r)},r9=(t,e)=>{let n=t.includes("top"),s=n?{top:0}:{bottom:0},r=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:ZP()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...s,...r}},o9=zy`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Hm=16,i9=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:s,children:r,containerStyle:o,containerClassName:i})=>{let{toasts:a,handlers:l}=F7(n);return S.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Hm,left:Hm,right:Hm,bottom:Hm,pointerEvents:"none",...o},className:i,onMouseEnter:l.startPause,onMouseLeave:l.endPause},a.map(c=>{let u=c.position||e,d=l.calculateOffset(c,{reverseOrder:t,gutter:s,defaultPosition:e}),h=r9(u,d);return S.createElement(s9,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?o9:"",style:h},c.type==="custom"?bx(c.message,c):r?r(c):S.createElement(n9,{toast:c,position:u}))}))};class gh extends Error{}gh.prototype.name="InvalidTokenError";function a9(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,n)=>{let s=n.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function l9(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return a9(e)}catch{return atob(e)}}function c9(t,e){if(typeof t!="string")throw new gh("Invalid token specified: must be a string");e||(e={});const n=e.header===!0?0:1,s=t.split(".")[n];if(typeof s!="string")throw new gh(`Invalid token specified: missing part #${n+1}`);let r;try{r=l9(s)}catch(o){throw new gh(`Invalid token specified: invalid base64 for part #${n+1} (${o.message})`)}try{return JSON.parse(r)}catch(o){throw new gh(`Invalid token specified: invalid json for part #${n+1} (${o.message})`)}}function e_(t,e){return function(){return t.apply(e,arguments)}}const{toString:u9}=Object.prototype,{getPrototypeOf:vk}=Object,Uy=(t=>e=>{const n=u9.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ko=t=>(t=t.toLowerCase(),e=>Uy(e)===t),Vy=t=>e=>typeof e===t,{isArray:vd}=Array,gf=Vy("undefined");function d9(t){return t!==null&&!gf(t)&&t.constructor!==null&&!gf(t.constructor)&&Wr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const t_=Ko("ArrayBuffer");function h9(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&t_(t.buffer),e}const f9=Vy("string"),Wr=Vy("function"),n_=Vy("number"),Wy=t=>t!==null&&typeof t=="object",p9=t=>t===!0||t===!1,_g=t=>{if(Uy(t)!=="object")return!1;const e=vk(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},m9=Ko("Date"),g9=Ko("File"),x9=Ko("Blob"),y9=Ko("FileList"),v9=t=>Wy(t)&&Wr(t.pipe),b9=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Wr(t.append)&&((e=Uy(t))==="formdata"||e==="object"&&Wr(t.toString)&&t.toString()==="[object FormData]"))},w9=Ko("URLSearchParams"),[C9,S9,k9,N9]=["ReadableStream","Request","Response","Headers"].map(Ko),E9=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xf(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),vd(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{const o=n?Object.getOwnPropertyNames(t):Object.keys(t),i=o.length;let a;for(s=0;s<i;s++)a=o[s],e.call(null,t[a],a,t)}}function s_(t,e){e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const zl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,r_=t=>!gf(t)&&t!==zl;function eC(){const{caseless:t}=r_(this)&&this||{},e={},n=(s,r)=>{const o=t&&s_(e,r)||r;_g(e[o])&&_g(s)?e[o]=eC(e[o],s):_g(s)?e[o]=eC({},s):vd(s)?e[o]=s.slice():e[o]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&Xf(arguments[s],n);return e}const $9=(t,e,n,{allOwnKeys:s}={})=>(Xf(e,(r,o)=>{n&&Wr(r)?t[o]=e_(r,n):t[o]=r},{allOwnKeys:s}),t),I9=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),T9=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},R9=(t,e,n,s)=>{let r,o,i;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),o=r.length;o-- >0;)i=r[o],(!s||s(i,t,e))&&!a[i]&&(e[i]=t[i],a[i]=!0);t=n!==!1&&vk(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},A9=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},D9=t=>{if(!t)return null;if(vd(t))return t;let e=t.length;if(!n_(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},O9=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&vk(Uint8Array)),F9=(t,e)=>{const s=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=s.next())&&!r.done;){const o=r.value;e.call(t,o[0],o[1])}},P9=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},_9=Ko("HTMLFormElement"),M9=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),QI=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),L9=Ko("RegExp"),o_=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Xf(n,(r,o)=>{let i;(i=e(r,o,t))!==!1&&(s[o]=i||r)}),Object.defineProperties(t,s)},j9=t=>{o_(t,(e,n)=>{if(Wr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(Wr(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},B9=(t,e)=>{const n={},s=r=>{r.forEach(o=>{n[o]=!0})};return vd(t)?s(t):s(String(t).split(e)),n},z9=()=>{},U9=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function V9(t){return!!(t&&Wr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const W9=t=>{const e=new Array(10),n=(s,r)=>{if(Wy(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[r]=s;const o=vd(s)?[]:{};return Xf(s,(i,a)=>{const l=n(i,r+1);!gf(l)&&(o[a]=l)}),e[r]=void 0,o}}return s};return n(t,0)},H9=Ko("AsyncFunction"),G9=t=>t&&(Wy(t)||Wr(t))&&Wr(t.then)&&Wr(t.catch),i_=((t,e)=>t?setImmediate:e?((n,s)=>(zl.addEventListener("message",({source:r,data:o})=>{r===zl&&o===n&&s.length&&s.shift()()},!1),r=>{s.push(r),zl.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Wr(zl.postMessage)),q9=typeof queueMicrotask<"u"?queueMicrotask.bind(zl):typeof process<"u"&&process.nextTick||i_,ae={isArray:vd,isArrayBuffer:t_,isBuffer:d9,isFormData:b9,isArrayBufferView:h9,isString:f9,isNumber:n_,isBoolean:p9,isObject:Wy,isPlainObject:_g,isReadableStream:C9,isRequest:S9,isResponse:k9,isHeaders:N9,isUndefined:gf,isDate:m9,isFile:g9,isBlob:x9,isRegExp:L9,isFunction:Wr,isStream:v9,isURLSearchParams:w9,isTypedArray:O9,isFileList:y9,forEach:Xf,merge:eC,extend:$9,trim:E9,stripBOM:I9,inherits:T9,toFlatObject:R9,kindOf:Uy,kindOfTest:Ko,endsWith:A9,toArray:D9,forEachEntry:F9,matchAll:P9,isHTMLForm:_9,hasOwnProperty:QI,hasOwnProp:QI,reduceDescriptors:o_,freezeMethods:j9,toObjectSet:B9,toCamelCase:M9,noop:z9,toFiniteNumber:U9,findKey:s_,global:zl,isContextDefined:r_,isSpecCompliantForm:V9,toJSONObject:W9,isAsyncFn:H9,isThenable:G9,setImmediate:i_,asap:q9};function ct(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}ae.inherits(ct,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ae.toJSONObject(this.config),code:this.code,status:this.status}}});const a_=ct.prototype,l_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{l_[t]={value:t}});Object.defineProperties(ct,l_);Object.defineProperty(a_,"isAxiosError",{value:!0});ct.from=(t,e,n,s,r,o)=>{const i=Object.create(a_);return ae.toFlatObject(t,i,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),ct.call(i,t.message,e,n,s,r),i.cause=t,i.name=t.name,o&&Object.assign(i,o),i};const K9=null;function tC(t){return ae.isPlainObject(t)||ae.isArray(t)}function c_(t){return ae.endsWith(t,"[]")?t.slice(0,-2):t}function eT(t,e,n){return t?t.concat(e).map(function(r,o){return r=c_(r),!n&&o?"["+r+"]":r}).join(n?".":""):e}function X9(t){return ae.isArray(t)&&!t.some(tC)}const Y9=ae.toFlatObject(ae,{},null,function(e){return/^is[A-Z]/.test(e)});function Hy(t,e,n){if(!ae.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=ae.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!ae.isUndefined(y[g])});const s=n.metaTokens,r=n.visitor||u,o=n.dots,i=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&ae.isSpecCompliantForm(e);if(!ae.isFunction(r))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(ae.isDate(m))return m.toISOString();if(!l&&ae.isBlob(m))throw new ct("Blob is not supported. Use a Buffer instead.");return ae.isArrayBuffer(m)||ae.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,g,y){let x=m;if(m&&!y&&typeof m=="object"){if(ae.endsWith(g,"{}"))g=s?g:g.slice(0,-2),m=JSON.stringify(m);else if(ae.isArray(m)&&X9(m)||(ae.isFileList(m)||ae.endsWith(g,"[]"))&&(x=ae.toArray(m)))return g=c_(g),x.forEach(function(b,w){!(ae.isUndefined(b)||b===null)&&e.append(i===!0?eT([g],w,o):i===null?g:g+"[]",c(b))}),!1}return tC(m)?!0:(e.append(eT(y,g,o),c(m)),!1)}const d=[],h=Object.assign(Y9,{defaultVisitor:u,convertValue:c,isVisitable:tC});function f(m,g){if(!ae.isUndefined(m)){if(d.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));d.push(m),ae.forEach(m,function(x,v){(!(ae.isUndefined(x)||x===null)&&r.call(e,x,ae.isString(v)?v.trim():v,g,h))===!0&&f(x,g?g.concat(v):[v])}),d.pop()}}if(!ae.isObject(t))throw new TypeError("data must be an object");return f(t),e}function tT(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function bk(t,e){this._pairs=[],t&&Hy(t,this,e)}const u_=bk.prototype;u_.append=function(e,n){this._pairs.push([e,n])};u_.toString=function(e){const n=e?function(s){return e.call(this,s,tT)}:tT;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function J9(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function d_(t,e,n){if(!e)return t;const s=n&&n.encode||J9;ae.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let o;if(r?o=r(e,n):o=ae.isURLSearchParams(e)?e.toString():new bk(e,n).toString(s),o){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class nT{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ae.forEach(this.handlers,function(s){s!==null&&e(s)})}}const h_={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Z9=typeof URLSearchParams<"u"?URLSearchParams:bk,Q9=typeof FormData<"u"?FormData:null,eq=typeof Blob<"u"?Blob:null,tq={isBrowser:!0,classes:{URLSearchParams:Z9,FormData:Q9,Blob:eq},protocols:["http","https","file","blob","url","data"]},wk=typeof window<"u"&&typeof document<"u",nC=typeof navigator=="object"&&navigator||void 0,nq=wk&&(!nC||["ReactNative","NativeScript","NS"].indexOf(nC.product)<0),sq=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",rq=wk&&window.location.href||"http://localhost",oq=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wk,hasStandardBrowserEnv:nq,hasStandardBrowserWebWorkerEnv:sq,navigator:nC,origin:rq},Symbol.toStringTag,{value:"Module"})),Ls={...oq,...tq};function iq(t,e){return Hy(t,new Ls.classes.URLSearchParams,Object.assign({visitor:function(n,s,r,o){return Ls.isNode&&ae.isBuffer(n)?(this.append(s,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function aq(t){return ae.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function lq(t){const e={},n=Object.keys(t);let s;const r=n.length;let o;for(s=0;s<r;s++)o=n[s],e[o]=t[o];return e}function f_(t){function e(n,s,r,o){let i=n[o++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),l=o>=n.length;return i=!i&&ae.isArray(r)?r.length:i,l?(ae.hasOwnProp(r,i)?r[i]=[r[i],s]:r[i]=s,!a):((!r[i]||!ae.isObject(r[i]))&&(r[i]=[]),e(n,s,r[i],o)&&ae.isArray(r[i])&&(r[i]=lq(r[i])),!a)}if(ae.isFormData(t)&&ae.isFunction(t.entries)){const n={};return ae.forEachEntry(t,(s,r)=>{e(aq(s),r,n,0)}),n}return null}function cq(t,e,n){if(ae.isString(t))try{return(e||JSON.parse)(t),ae.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const Yf={transitional:h_,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,o=ae.isObject(e);if(o&&ae.isHTMLForm(e)&&(e=new FormData(e)),ae.isFormData(e))return r?JSON.stringify(f_(e)):e;if(ae.isArrayBuffer(e)||ae.isBuffer(e)||ae.isStream(e)||ae.isFile(e)||ae.isBlob(e)||ae.isReadableStream(e))return e;if(ae.isArrayBufferView(e))return e.buffer;if(ae.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return iq(e,this.formSerializer).toString();if((a=ae.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Hy(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||r?(n.setContentType("application/json",!1),cq(e)):e}],transformResponse:[function(e){const n=this.transitional||Yf.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(ae.isResponse(e)||ae.isReadableStream(e))return e;if(e&&ae.isString(e)&&(s&&!this.responseType||r)){const i=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(i)throw a.name==="SyntaxError"?ct.from(a,ct.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ls.classes.FormData,Blob:Ls.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ae.forEach(["delete","get","head","post","put","patch"],t=>{Yf.headers[t]={}});const uq=ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),dq=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(i){r=i.indexOf(":"),n=i.substring(0,r).trim().toLowerCase(),s=i.substring(r+1).trim(),!(!n||e[n]&&uq[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},sT=Symbol("internals");function Qd(t){return t&&String(t).trim().toLowerCase()}function Mg(t){return t===!1||t==null?t:ae.isArray(t)?t.map(Mg):String(t)}function hq(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const fq=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ob(t,e,n,s,r){if(ae.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!ae.isString(e)){if(ae.isString(s))return e.indexOf(s)!==-1;if(ae.isRegExp(s))return s.test(e)}}function pq(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function mq(t,e){const n=ae.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,o,i){return this[s].call(this,e,r,o,i)},configurable:!0})})}let Nr=class{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function o(a,l,c){const u=Qd(l);if(!u)throw new Error("header name must be a non-empty string");const d=ae.findKey(r,u);(!d||r[d]===void 0||c===!0||c===void 0&&r[d]!==!1)&&(r[d||l]=Mg(a))}const i=(a,l)=>ae.forEach(a,(c,u)=>o(c,u,l));if(ae.isPlainObject(e)||e instanceof this.constructor)i(e,n);else if(ae.isString(e)&&(e=e.trim())&&!fq(e))i(dq(e),n);else if(ae.isHeaders(e))for(const[a,l]of e.entries())o(l,a,s);else e!=null&&o(n,e,s);return this}get(e,n){if(e=Qd(e),e){const s=ae.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return hq(r);if(ae.isFunction(n))return n.call(this,r,s);if(ae.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Qd(e),e){const s=ae.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||Ob(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function o(i){if(i=Qd(i),i){const a=ae.findKey(s,i);a&&(!n||Ob(s,s[a],a,n))&&(delete s[a],r=!0)}}return ae.isArray(e)?e.forEach(o):o(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const o=n[s];(!e||Ob(this,this[o],o,e,!0))&&(delete this[o],r=!0)}return r}normalize(e){const n=this,s={};return ae.forEach(this,(r,o)=>{const i=ae.findKey(s,o);if(i){n[i]=Mg(r),delete n[o];return}const a=e?pq(o):String(o).trim();a!==o&&delete n[o],n[a]=Mg(r),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return ae.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&ae.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[sT]=this[sT]={accessors:{}}).accessors,r=this.prototype;function o(i){const a=Qd(i);s[a]||(mq(r,i),s[a]=!0)}return ae.isArray(e)?e.forEach(o):o(e),this}};Nr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ae.reduceDescriptors(Nr.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});ae.freezeMethods(Nr);function Fb(t,e){const n=this||Yf,s=e||n,r=Nr.from(s.headers);let o=s.data;return ae.forEach(t,function(a){o=a.call(n,o,r.normalize(),e?e.status:void 0)}),r.normalize(),o}function p_(t){return!!(t&&t.__CANCEL__)}function bd(t,e,n){ct.call(this,t??"canceled",ct.ERR_CANCELED,e,n),this.name="CanceledError"}ae.inherits(bd,ct,{__CANCEL__:!0});function m_(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new ct("Request failed with status code "+n.status,[ct.ERR_BAD_REQUEST,ct.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function gq(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function xq(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,o=0,i;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=s[o];i||(i=c),n[r]=l,s[r]=c;let d=o,h=0;for(;d!==r;)h+=n[d++],d=d%t;if(r=(r+1)%t,r===o&&(o=(o+1)%t),c-i<e)return;const f=u&&c-u;return f?Math.round(h*1e3/f):void 0}}function yq(t,e){let n=0,s=1e3/e,r,o;const i=(c,u=Date.now())=>{n=u,r=null,o&&(clearTimeout(o),o=null),t.apply(null,c)};return[(...c)=>{const u=Date.now(),d=u-n;d>=s?i(c,u):(r=c,o||(o=setTimeout(()=>{o=null,i(r)},s-d)))},()=>r&&i(r)]}const wx=(t,e,n=3)=>{let s=0;const r=xq(50,250);return yq(o=>{const i=o.loaded,a=o.lengthComputable?o.total:void 0,l=i-s,c=r(l),u=i<=a;s=i;const d={loaded:i,total:a,progress:a?i/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-i)/c:void 0,event:o,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(d)},n)},rT=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},oT=t=>(...e)=>ae.asap(()=>t(...e)),vq=Ls.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Ls.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Ls.origin),Ls.navigator&&/(msie|trident)/i.test(Ls.navigator.userAgent)):()=>!0,bq=Ls.hasStandardBrowserEnv?{write(t,e,n,s,r,o){const i=[t+"="+encodeURIComponent(e)];ae.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),ae.isString(s)&&i.push("path="+s),ae.isString(r)&&i.push("domain="+r),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function wq(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Cq(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function g_(t,e,n){let s=!wq(e);return t&&(s||n==!1)?Cq(t,e):e}const iT=t=>t instanceof Nr?{...t}:t;function cc(t,e){e=e||{};const n={};function s(c,u,d,h){return ae.isPlainObject(c)&&ae.isPlainObject(u)?ae.merge.call({caseless:h},c,u):ae.isPlainObject(u)?ae.merge({},u):ae.isArray(u)?u.slice():u}function r(c,u,d,h){if(ae.isUndefined(u)){if(!ae.isUndefined(c))return s(void 0,c,d,h)}else return s(c,u,d,h)}function o(c,u){if(!ae.isUndefined(u))return s(void 0,u)}function i(c,u){if(ae.isUndefined(u)){if(!ae.isUndefined(c))return s(void 0,c)}else return s(void 0,u)}function a(c,u,d){if(d in e)return s(c,u);if(d in t)return s(void 0,c)}const l={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(c,u,d)=>r(iT(c),iT(u),d,!0)};return ae.forEach(Object.keys(Object.assign({},t,e)),function(u){const d=l[u]||r,h=d(t[u],e[u],u);ae.isUndefined(h)&&d!==a||(n[u]=h)}),n}const x_=t=>{const e=cc({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:o,headers:i,auth:a}=e;e.headers=i=Nr.from(i),e.url=d_(g_(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(ae.isFormData(n)){if(Ls.hasStandardBrowserEnv||Ls.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((l=i.getContentType())!==!1){const[c,...u]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];i.setContentType([c||"multipart/form-data",...u].join("; "))}}if(Ls.hasStandardBrowserEnv&&(s&&ae.isFunction(s)&&(s=s(e)),s||s!==!1&&vq(e.url))){const c=r&&o&&bq.read(o);c&&i.set(r,c)}return e},Sq=typeof XMLHttpRequest<"u",kq=Sq&&function(t){return new Promise(function(n,s){const r=x_(t);let o=r.data;const i=Nr.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,u,d,h,f,m;function g(){f&&f(),m&&m(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let y=new XMLHttpRequest;y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout;function x(){if(!y)return;const b=Nr.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),C={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:t,request:y};m_(function(N){n(N),g()},function(N){s(N),g()},C),y=null}"onloadend"in y?y.onloadend=x:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(x)},y.onabort=function(){y&&(s(new ct("Request aborted",ct.ECONNABORTED,t,y)),y=null)},y.onerror=function(){s(new ct("Network Error",ct.ERR_NETWORK,t,y)),y=null},y.ontimeout=function(){let w=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const C=r.transitional||h_;r.timeoutErrorMessage&&(w=r.timeoutErrorMessage),s(new ct(w,C.clarifyTimeoutError?ct.ETIMEDOUT:ct.ECONNABORTED,t,y)),y=null},o===void 0&&i.setContentType(null),"setRequestHeader"in y&&ae.forEach(i.toJSON(),function(w,C){y.setRequestHeader(C,w)}),ae.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),a&&a!=="json"&&(y.responseType=r.responseType),c&&([h,m]=wx(c,!0),y.addEventListener("progress",h)),l&&y.upload&&([d,f]=wx(l),y.upload.addEventListener("progress",d),y.upload.addEventListener("loadend",f)),(r.cancelToken||r.signal)&&(u=b=>{y&&(s(!b||b.type?new bd(null,t,y):b),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const v=gq(r.url);if(v&&Ls.protocols.indexOf(v)===-1){s(new ct("Unsupported protocol "+v+":",ct.ERR_BAD_REQUEST,t));return}y.send(o||null)})},Nq=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const o=function(c){if(!r){r=!0,a();const u=c instanceof Error?c:this.reason;s.abort(u instanceof ct?u:new bd(u instanceof Error?u.message:u))}};let i=e&&setTimeout(()=>{i=null,o(new ct(`timeout ${e} of ms exceeded`,ct.ETIMEDOUT))},e);const a=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(o):c.removeEventListener("abort",o)}),t=null)};t.forEach(c=>c.addEventListener("abort",o));const{signal:l}=s;return l.unsubscribe=()=>ae.asap(a),l}},Eq=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},$q=async function*(t,e){for await(const n of Iq(t))yield*Eq(n,e)},Iq=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},aT=(t,e,n,s)=>{const r=$q(t,e);let o=0,i,a=l=>{i||(i=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await r.next();if(c){a(),l.close();return}let d=u.byteLength;if(n){let h=o+=d;n(h)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},Gy=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",y_=Gy&&typeof ReadableStream=="function",Tq=Gy&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),v_=(t,...e)=>{try{return!!t(...e)}catch{return!1}},Rq=y_&&v_(()=>{let t=!1;const e=new Request(Ls.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),lT=64*1024,sC=y_&&v_(()=>ae.isReadableStream(new Response("").body)),Cx={stream:sC&&(t=>t.body)};Gy&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Cx[e]&&(Cx[e]=ae.isFunction(t[e])?n=>n[e]():(n,s)=>{throw new ct(`Response type '${e}' is not supported`,ct.ERR_NOT_SUPPORT,s)})})})(new Response);const Aq=async t=>{if(t==null)return 0;if(ae.isBlob(t))return t.size;if(ae.isSpecCompliantForm(t))return(await new Request(Ls.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(ae.isArrayBufferView(t)||ae.isArrayBuffer(t))return t.byteLength;if(ae.isURLSearchParams(t)&&(t=t+""),ae.isString(t))return(await Tq(t)).byteLength},Dq=async(t,e)=>{const n=ae.toFiniteNumber(t.getContentLength());return n??Aq(e)},Oq=Gy&&(async t=>{let{url:e,method:n,data:s,signal:r,cancelToken:o,timeout:i,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:h}=x_(t);c=c?(c+"").toLowerCase():"text";let f=Nq([r,o&&o.toAbortSignal()],i),m;const g=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let y;try{if(l&&Rq&&n!=="get"&&n!=="head"&&(y=await Dq(u,s))!==0){let C=new Request(e,{method:"POST",body:s,duplex:"half"}),k;if(ae.isFormData(s)&&(k=C.headers.get("content-type"))&&u.setContentType(k),C.body){const[N,E]=rT(y,wx(oT(l)));s=aT(C.body,lT,N,E)}}ae.isString(d)||(d=d?"include":"omit");const x="credentials"in Request.prototype;m=new Request(e,{...h,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:x?d:void 0});let v=await fetch(m);const b=sC&&(c==="stream"||c==="response");if(sC&&(a||b&&g)){const C={};["status","statusText","headers"].forEach($=>{C[$]=v[$]});const k=ae.toFiniteNumber(v.headers.get("content-length")),[N,E]=a&&rT(k,wx(oT(a),!0))||[];v=new Response(aT(v.body,lT,N,()=>{E&&E(),g&&g()}),C)}c=c||"text";let w=await Cx[ae.findKey(Cx,c)||"text"](v,t);return!b&&g&&g(),await new Promise((C,k)=>{m_(C,k,{data:w,headers:Nr.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:m})})}catch(x){throw g&&g(),x&&x.name==="TypeError"&&/fetch/i.test(x.message)?Object.assign(new ct("Network Error",ct.ERR_NETWORK,t,m),{cause:x.cause||x}):ct.from(x,x&&x.code,t,m)}}),rC={http:K9,xhr:kq,fetch:Oq};ae.forEach(rC,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const cT=t=>`- ${t}`,Fq=t=>ae.isFunction(t)||t===null||t===!1,b_={getAdapter:t=>{t=ae.isArray(t)?t:[t];const{length:e}=t;let n,s;const r={};for(let o=0;o<e;o++){n=t[o];let i;if(s=n,!Fq(n)&&(s=rC[(i=String(n)).toLowerCase()],s===void 0))throw new ct(`Unknown adapter '${i}'`);if(s)break;r[i||"#"+o]=s}if(!s){const o=Object.entries(r).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let i=e?o.length>1?`since :
`+o.map(cT).join(`
`):" "+cT(o[0]):"as no adapter specified";throw new ct("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return s},adapters:rC};function Pb(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new bd(null,t)}function uT(t){return Pb(t),t.headers=Nr.from(t.headers),t.data=Fb.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),b_.getAdapter(t.adapter||Yf.adapter)(t).then(function(s){return Pb(t),s.data=Fb.call(t,t.transformResponse,s),s.headers=Nr.from(s.headers),s},function(s){return p_(s)||(Pb(t),s&&s.response&&(s.response.data=Fb.call(t,t.transformResponse,s.response),s.response.headers=Nr.from(s.response.headers))),Promise.reject(s)})}const w_="1.8.4",qy={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{qy[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const dT={};qy.transitional=function(e,n,s){function r(o,i){return"[Axios v"+w_+"] Transitional option '"+o+"'"+i+(s?". "+s:"")}return(o,i,a)=>{if(e===!1)throw new ct(r(i," has been removed"+(n?" in "+n:"")),ct.ERR_DEPRECATED);return n&&!dT[i]&&(dT[i]=!0,console.warn(r(i," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,i,a):!0}};qy.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function Pq(t,e,n){if(typeof t!="object")throw new ct("options must be an object",ct.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const o=s[r],i=e[o];if(i){const a=t[o],l=a===void 0||i(a,o,t);if(l!==!0)throw new ct("option "+o+" must be "+l,ct.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ct("Unknown option "+o,ct.ERR_BAD_OPTION)}}const Lg={assertOptions:Pq,validators:qy},Zo=Lg.validators;let Yl=class{constructor(e){this.defaults=e,this.interceptors={request:new nT,response:new nT}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=cc(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:o}=n;s!==void 0&&Lg.assertOptions(s,{silentJSONParsing:Zo.transitional(Zo.boolean),forcedJSONParsing:Zo.transitional(Zo.boolean),clarifyTimeoutError:Zo.transitional(Zo.boolean)},!1),r!=null&&(ae.isFunction(r)?n.paramsSerializer={serialize:r}:Lg.assertOptions(r,{encode:Zo.function,serialize:Zo.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Lg.assertOptions(n,{baseUrl:Zo.spelling("baseURL"),withXsrfToken:Zo.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=o&&ae.merge(o.common,o[n.method]);o&&ae.forEach(["delete","get","head","post","put","patch","common"],m=>{delete o[m]}),n.headers=Nr.concat(i,o);const a=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let u,d=0,h;if(!l){const m=[uT.bind(this),void 0];for(m.unshift.apply(m,a),m.push.apply(m,c),h=m.length,u=Promise.resolve(n);d<h;)u=u.then(m[d++],m[d++]);return u}h=a.length;let f=n;for(d=0;d<h;){const m=a[d++],g=a[d++];try{f=m(f)}catch(y){g.call(this,y);break}}try{u=uT.call(this,f)}catch(m){return Promise.reject(m)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=cc(this.defaults,e);const n=g_(e.baseURL,e.url,e.allowAbsoluteUrls);return d_(n,e.params,e.paramsSerializer)}};ae.forEach(["delete","get","head","options"],function(e){Yl.prototype[e]=function(n,s){return this.request(cc(s||{},{method:e,url:n,data:(s||{}).data}))}});ae.forEach(["post","put","patch"],function(e){function n(s){return function(o,i,a){return this.request(cc(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}Yl.prototype[e]=n(),Yl.prototype[e+"Form"]=n(!0)});let _q=class C_{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const s=this;this.promise.then(r=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](r);s._listeners=null}),this.promise.then=r=>{let o;const i=new Promise(a=>{s.subscribe(a),o=a}).then(r);return i.cancel=function(){s.unsubscribe(o)},i},e(function(o,i,a){s.reason||(s.reason=new bd(o,i,a),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new C_(function(r){e=r}),cancel:e}}};function Mq(t){return function(n){return t.apply(null,n)}}function Lq(t){return ae.isObject(t)&&t.isAxiosError===!0}const oC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(oC).forEach(([t,e])=>{oC[e]=t});function S_(t){const e=new Yl(t),n=e_(Yl.prototype.request,e);return ae.extend(n,Yl.prototype,e,{allOwnKeys:!0}),ae.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return S_(cc(t,r))},n}const fn=S_(Yf);fn.Axios=Yl;fn.CanceledError=bd;fn.CancelToken=_q;fn.isCancel=p_;fn.VERSION=w_;fn.toFormData=Hy;fn.AxiosError=ct;fn.Cancel=fn.CanceledError;fn.all=function(e){return Promise.all(e)};fn.spread=Mq;fn.isAxiosError=Lq;fn.mergeConfig=cc;fn.AxiosHeaders=Nr;fn.formToJSON=t=>f_(ae.isHTMLForm(t)?new FormData(t):t);fn.getAdapter=b_.getAdapter;fn.HttpStatusCode=oC;fn.default=fn;const{Axios:xPe,AxiosError:yPe,CanceledError:vPe,isCancel:bPe,CancelToken:wPe,VERSION:CPe,all:SPe,Cancel:kPe,isAxiosError:NPe,spread:EPe,toFormData:$Pe,AxiosHeaders:IPe,HttpStatusCode:TPe,formToJSON:RPe,getAdapter:APe,mergeConfig:DPe}=fn,We=fn.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}});We.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t.withCredentials=!0,console.log(`API Request: ${t.method.toUpperCase()} ${t.baseURL}${t.url}`,{headers:t.headers,data:t.data}),t},t=>(console.error("Request configuration error:",t),Promise.reject(t)));We.interceptors.response.use(t=>(console.log(`API Response: ${t.status} ${t.config.method.toUpperCase()} ${t.config.url}`,{data:t.data}),t),t=>{var e,n,s,r,o,i,a,l;if(fn.isCancel(t)||t.name==="AbortError"||t.code==="ERR_CANCELED")return Promise.reject(t);if(console.error("API Error:",{message:t.message,url:(e=t.config)==null?void 0:e.url,method:(n=t.config)==null?void 0:n.method,status:(s=t.response)==null?void 0:s.status,data:(r=t.response)==null?void 0:r.data,headers:(o=t.response)==null?void 0:o.headers}),t.response){const c=((i=t.response.data)==null?void 0:i.message)||"An error occurred";(l=(a=t.config)==null?void 0:a.url)!=null&&l.includes("/fix-status")||xe.error(c),t.response.status===401?(localStorage.removeItem("token"),window.location.href="/login"):t.response.status===404&&console.error(`API endpoint not found: ${t.config.method.toUpperCase()} ${t.config.url}`)}else t.request?(console.error("Network error - no response received:",t.request),xe.error("Unable to connect to server. Please check your connection.")):(console.error("API Error:",t.message),xe.error("An unexpected error occurred."));return Promise.reject(t)});const k_=S.createContext(null),Hs=()=>S.useContext(k_);function jq({children:t}){const[e,n]=S.useState(null),[s,r]=S.useState(!0),[o,i]=S.useState(localStorage.getItem("token"));S.useEffect(()=>{if(o)try{const d=c9(o);d.exp*1e3>Date.now()?n(d):(localStorage.removeItem("token"),i(null))}catch{localStorage.removeItem("token"),i(null)}r(!1)},[o]);const u={user:e,token:o,login:async(d,h)=>{var f,m;try{const g=await We.post("/auth/login",{email:d,password:h}),{token:y,user:x}=g.data;return localStorage.setItem("token",y),i(y),n(x),bt.success("Welcome back!"),!0}catch(g){return bt.error(((m=(f=g.response)==null?void 0:f.data)==null?void 0:m.message)||"Login failed"),!1}},register:async d=>{var h,f;try{const m=await We.post("/auth/register",d),{token:g,user:y}=m.data;return localStorage.setItem("token",g),i(g),n(y),bt.success("Registration successful!"),!0}catch(m){return bt.error(((f=(h=m.response)==null?void 0:h.data)==null?void 0:f.message)||"Registration failed"),!1}},logout:()=>{localStorage.removeItem("token"),i(null),n(null),bt.success("Logged out successfully")},loading:s};return p.jsx(k_.Provider,{value:u,children:!s&&t})}var N_={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",i=0;i<arguments.length;i++){var a=arguments[i];a&&(o=r(o,s(a)))}return o}function s(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var i="";for(var a in o)e.call(o,a)&&o[a]&&(i=r(i,a));return i}function r(o,i){return i?o?o+" "+i:o+i:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(N_);var Bq=N_.exports;const Te=dd(Bq);function Xe(){return Xe=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Xe.apply(null,arguments)}function Ck(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function hT(t){return"default"+t.charAt(0).toUpperCase()+t.substr(1)}function zq(t){var e=Uq(t,"string");return typeof e=="symbol"?e:String(e)}function Uq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Vq(t,e,n){var s=S.useRef(t!==void 0),r=S.useState(e),o=r[0],i=r[1],a=t!==void 0,l=s.current;return s.current=a,!a&&l&&o!==e&&i(e),[a?t:o,S.useCallback(function(c){for(var u=arguments.length,d=new Array(u>1?u-1:0),h=1;h<u;h++)d[h-1]=arguments[h];n&&n.apply(void 0,[c].concat(d)),i(c)},[n])]}function Jf(t,e){return Object.keys(e).reduce(function(n,s){var r,o=n,i=o[hT(s)],a=o[s],l=Ck(o,[hT(s),s].map(zq)),c=e[s],u=Vq(a,i,t[c]),d=u[0],h=u[1];return Xe({},l,(r={},r[s]=d,r[c]=h,r))},t)}function Sx(t,e){return Sx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Sx(t,e)}function Wq(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Sx(t,e)}const Hq=["xxl","xl","lg","md","sm","xs"],Gq="xs",Zf=S.createContext({prefixes:{},breakpoints:Hq,minBreakpoint:Gq}),{Consumer:OPe,Provider:FPe}=Zf;function Le(t,e){const{prefixes:n}=S.useContext(Zf);return t||n[e]||e}function E_(){const{breakpoints:t}=S.useContext(Zf);return t}function $_(){const{minBreakpoint:t}=S.useContext(Zf);return t}function I_(){const{dir:t}=S.useContext(Zf);return t==="rtl"}function Qf(t){return t&&t.ownerDocument||document}function qq(t){var e=Qf(t);return e&&e.defaultView||window}function Kq(t,e){return qq(t).getComputedStyle(t,e)}var Xq=/([A-Z])/g;function Yq(t){return t.replace(Xq,"-$1").toLowerCase()}var Jq=/^ms-/;function Gm(t){return Yq(t).replace(Jq,"-ms-")}var Zq=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Qq(t){return!!(t&&Zq.test(t))}function Ui(t,e){var n="",s="";if(typeof e=="string")return t.style.getPropertyValue(Gm(e))||Kq(t).getPropertyValue(Gm(e));Object.keys(e).forEach(function(r){var o=e[r];!o&&o!==0?t.style.removeProperty(Gm(r)):Qq(r)?s+=r+"("+o+") ":n+=Gm(r)+": "+o+";"}),s&&(n+="transform: "+s+";"),t.style.cssText+=";"+n}var T_={exports:{}},eK="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",tK=eK,nK=tK;function R_(){}function A_(){}A_.resetWarningCache=R_;var sK=function(){function t(s,r,o,i,a,l){if(l!==nK){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:A_,resetWarningCache:R_};return n.PropTypes=n,n};T_.exports=sK();var rK=T_.exports;const Vi=dd(rK),fT={disabled:!1},D_=tt.createContext(null);var oK=function(e){return e.scrollTop},xh="unmounted",wa="exited",Po="entering",Pi="entered",xf="exiting",aa=function(t){Wq(e,t);function e(s,r){var o;o=t.call(this,s,r)||this;var i=r,a=i&&!i.isMounting?s.enter:s.appear,l;return o.appearStatus=null,s.in?a?(l=wa,o.appearStatus=Po):l=Pi:s.unmountOnExit||s.mountOnEnter?l=xh:l=wa,o.state={status:l},o.nextCallback=null,o}e.getDerivedStateFromProps=function(r,o){var i=r.in;return i&&o.status===xh?{status:wa}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(r){var o=null;if(r!==this.props){var i=this.state.status;this.props.in?i!==Po&&i!==Pi&&(o=Po):(i===Po||i===Pi)&&(o=xf)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var r=this.props.timeout,o,i,a;return o=i=a=r,r!=null&&typeof r!="number"&&(o=r.exit,i=r.enter,a=r.appear!==void 0?r.appear:i),{exit:o,enter:i,appear:a}},n.updateStatus=function(r,o){if(r===void 0&&(r=!1),o!==null)if(this.cancelNextCallback(),o===Po){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:yu.findDOMNode(this);i&&oK(i)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===wa&&this.setState({status:xh})},n.performEnter=function(r){var o=this,i=this.props.enter,a=this.context?this.context.isMounting:r,l=this.props.nodeRef?[a]:[yu.findDOMNode(this),a],c=l[0],u=l[1],d=this.getTimeouts(),h=a?d.appear:d.enter;if(!r&&!i||fT.disabled){this.safeSetState({status:Pi},function(){o.props.onEntered(c)});return}this.props.onEnter(c,u),this.safeSetState({status:Po},function(){o.props.onEntering(c,u),o.onTransitionEnd(h,function(){o.safeSetState({status:Pi},function(){o.props.onEntered(c,u)})})})},n.performExit=function(){var r=this,o=this.props.exit,i=this.getTimeouts(),a=this.props.nodeRef?void 0:yu.findDOMNode(this);if(!o||fT.disabled){this.safeSetState({status:wa},function(){r.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:xf},function(){r.props.onExiting(a),r.onTransitionEnd(i.exit,function(){r.safeSetState({status:wa},function(){r.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(r,o){o=this.setNextCallback(o),this.setState(r,o)},n.setNextCallback=function(r){var o=this,i=!0;return this.nextCallback=function(a){i&&(i=!1,o.nextCallback=null,r(a))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},n.onTransitionEnd=function(r,o){this.setNextCallback(o);var i=this.props.nodeRef?this.props.nodeRef.current:yu.findDOMNode(this),a=r==null&&!this.props.addEndListener;if(!i||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],c=l[0],u=l[1];this.props.addEndListener(c,u)}r!=null&&setTimeout(this.nextCallback,r)},n.render=function(){var r=this.state.status;if(r===xh)return null;var o=this.props,i=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var a=Ck(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return tt.createElement(D_.Provider,{value:null},typeof i=="function"?i(r,a):tt.cloneElement(tt.Children.only(i),a))},e}(tt.Component);aa.contextType=D_;aa.propTypes={};function qc(){}aa.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:qc,onEntering:qc,onEntered:qc,onExit:qc,onExiting:qc,onExited:qc};aa.UNMOUNTED=xh;aa.EXITED=wa;aa.ENTERING=Po;aa.ENTERED=Pi;aa.EXITING=xf;function iK(t){return t.code==="Escape"||t.keyCode===27}function aK(){const t=S.version.split(".");return{major:+t[0],minor:+t[1],patch:+t[2]}}function wd(t){if(!t||typeof t=="function")return null;const{major:e}=aK();return e>=19?t.props.ref:t.ref}const Cd=!!(typeof window<"u"&&window.document&&window.document.createElement);var iC=!1,aC=!1;try{var _b={get passive(){return iC=!0},get once(){return aC=iC=!0}};Cd&&(window.addEventListener("test",_b,_b),window.removeEventListener("test",_b,!0))}catch{}function Sk(t,e,n,s){if(s&&typeof s!="boolean"&&!aC){var r=s.once,o=s.capture,i=n;!aC&&r&&(i=n.__once||function a(l){this.removeEventListener(e,a,o),n.call(this,l)},n.__once=i),t.addEventListener(e,i,iC?s:o)}t.addEventListener(e,n,s)}function lC(t,e,n,s){var r=s&&typeof s!="boolean"?s.capture:s;t.removeEventListener(e,n,r),n.__once&&t.removeEventListener(e,n.__once,r)}function Aa(t,e,n,s){return Sk(t,e,n,s),function(){lC(t,e,n,s)}}function lK(t,e,n,s){if(s===void 0&&(s=!0),t){var r=document.createEvent("HTMLEvents");r.initEvent(e,n,s),t.dispatchEvent(r)}}function cK(t){var e=Ui(t,"transitionDuration")||"",n=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*n}function uK(t,e,n){n===void 0&&(n=5);var s=!1,r=setTimeout(function(){s||lK(t,"transitionend",!0)},e+n),o=Aa(t,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),o()}}function O_(t,e,n,s){n==null&&(n=cK(t)||0);var r=uK(t,n,s),o=Aa(t,"transitionend",e);return function(){r(),o()}}function pT(t,e){const n=Ui(t,e)||"",s=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*s}function kk(t,e){const n=pT(t,"transitionDuration"),s=pT(t,"transitionDelay"),r=O_(t,o=>{o.target===t&&(r(),e(o))},n+s)}function eh(...t){return t.filter(e=>e!=null).reduce((e,n)=>{if(typeof n!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return e===null?n:function(...r){e.apply(this,r),n.apply(this,r)}},null)}function F_(t){t.offsetHeight}const mT=t=>!t||typeof t=="function"?t:e=>{t.current=e};function dK(t,e){const n=mT(t),s=mT(e);return r=>{n&&n(r),s&&s(r)}}function Ky(t,e){return S.useMemo(()=>dK(t,e),[t,e])}function hK(t){return t&&"setState"in t?yu.findDOMNode(t):t??null}const Nk=tt.forwardRef(({onEnter:t,onEntering:e,onEntered:n,onExit:s,onExiting:r,onExited:o,addEndListener:i,children:a,childRef:l,...c},u)=>{const d=S.useRef(null),h=Ky(d,l),f=k=>{h(hK(k))},m=k=>N=>{k&&d.current&&k(d.current,N)},g=S.useCallback(m(t),[t]),y=S.useCallback(m(e),[e]),x=S.useCallback(m(n),[n]),v=S.useCallback(m(s),[s]),b=S.useCallback(m(r),[r]),w=S.useCallback(m(o),[o]),C=S.useCallback(m(i),[i]);return p.jsx(aa,{ref:u,...c,onEnter:g,onEntered:x,onEntering:y,onExit:v,onExited:w,onExiting:b,addEndListener:C,nodeRef:d,children:typeof a=="function"?(k,N)=>a(k,{...N,ref:f}):tt.cloneElement(a,{ref:f})})}),fK={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function pK(t,e){const n=`offset${t[0].toUpperCase()}${t.slice(1)}`,s=e[n],r=fK[t];return s+parseInt(Ui(e,r[0]),10)+parseInt(Ui(e,r[1]),10)}const mK={[wa]:"collapse",[xf]:"collapsing",[Po]:"collapsing",[Pi]:"collapse show"},gK=tt.forwardRef(({onEnter:t,onEntering:e,onEntered:n,onExit:s,onExiting:r,className:o,children:i,dimension:a="height",in:l=!1,timeout:c=300,mountOnEnter:u=!1,unmountOnExit:d=!1,appear:h=!1,getDimensionValue:f=pK,...m},g)=>{const y=typeof a=="function"?a():a,x=S.useMemo(()=>eh(k=>{k.style[y]="0"},t),[y,t]),v=S.useMemo(()=>eh(k=>{const N=`scroll${y[0].toUpperCase()}${y.slice(1)}`;k.style[y]=`${k[N]}px`},e),[y,e]),b=S.useMemo(()=>eh(k=>{k.style[y]=null},n),[y,n]),w=S.useMemo(()=>eh(k=>{k.style[y]=`${f(y,k)}px`,F_(k)},s),[s,f,y]),C=S.useMemo(()=>eh(k=>{k.style[y]=null},r),[y,r]);return p.jsx(Nk,{ref:g,addEndListener:kk,...m,"aria-expanded":m.role?l:null,onEnter:x,onEntering:v,onEntered:b,onExit:w,onExiting:C,childRef:wd(i),in:l,timeout:c,mountOnEnter:u,unmountOnExit:d,appear:h,children:(k,N)=>tt.cloneElement(i,{...N,className:Te(o,i.props.className,mK[k],y==="width"&&"collapse-horizontal")})})});function xK(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t},[t]),e}function Ji(t){const e=xK(t);return S.useCallback(function(...n){return e.current&&e.current(...n)},[e])}const ep=t=>S.forwardRef((e,n)=>p.jsx("div",{...e,ref:n,className:Te(e.className,t)})),P_=ep("h4");P_.displayName="DivStyledAsH4";const __=S.forwardRef(({className:t,bsPrefix:e,as:n=P_,...s},r)=>(e=Le(e,"alert-heading"),p.jsx(n,{ref:r,className:Te(t,e),...s})));__.displayName="AlertHeading";function yK(){return S.useState(null)}function vK(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t},[t]),e}function js(t){const e=vK(t);return S.useCallback(function(...n){return e.current&&e.current(...n)},[e])}function bK(t,e,n,s=!1){const r=js(n);S.useEffect(()=>{const o=typeof t=="function"?t():t;return o.addEventListener(e,r,s),()=>o.removeEventListener(e,r,s)},[t])}function M_(){const t=S.useRef(!0),e=S.useRef(()=>t.current);return S.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),e.current}function L_(t){const e=S.useRef(null);return S.useEffect(()=>{e.current=t}),e.current}const wK=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",CK=typeof document<"u",gT=CK||wK?S.useLayoutEffect:S.useEffect,SK=["as","disabled"];function kK(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function NK(t){return!t||t.trim()==="#"}function Ek({tagName:t,disabled:e,href:n,target:s,rel:r,role:o,onClick:i,tabIndex:a=0,type:l}){t||(n!=null||s!=null||r!=null?t="a":t="button");const c={tagName:t};if(t==="button")return[{type:l||"button",disabled:e},c];const u=h=>{if((e||t==="a"&&NK(n))&&h.preventDefault(),e){h.stopPropagation();return}i==null||i(h)},d=h=>{h.key===" "&&(h.preventDefault(),u(h))};return t==="a"&&(n||(n="#"),e&&(n=void 0)),[{role:o??"button",disabled:void 0,tabIndex:e?void 0:a,href:n,target:t==="a"?s:void 0,"aria-disabled":e||void 0,rel:t==="a"?r:void 0,onClick:u,onKeyDown:d},c]}const $k=S.forwardRef((t,e)=>{let{as:n,disabled:s}=t,r=kK(t,SK);const[o,{tagName:i}]=Ek(Object.assign({tagName:n,disabled:s},r));return p.jsx(i,Object.assign({},r,o,{ref:e}))});$k.displayName="Button";const EK=["onKeyDown"];function $K(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function IK(t){return!t||t.trim()==="#"}const Xy=S.forwardRef((t,e)=>{let{onKeyDown:n}=t,s=$K(t,EK);const[r]=Ek(Object.assign({tagName:"a"},s)),o=js(i=>{r.onKeyDown(i),n==null||n(i)});return IK(s.href)||s.role==="button"?p.jsx("a",Object.assign({ref:e},s,r,{onKeyDown:o})):p.jsx("a",Object.assign({ref:e},s,{onKeyDown:n}))});Xy.displayName="Anchor";const j_=S.forwardRef(({className:t,bsPrefix:e,as:n=Xy,...s},r)=>(e=Le(e,"alert-link"),p.jsx(n,{ref:r,className:Te(t,e),...s})));j_.displayName="AlertLink";const TK={[Po]:"show",[Pi]:"show"},Uu=S.forwardRef(({className:t,children:e,transitionClasses:n={},onEnter:s,...r},o)=>{const i={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...r},a=S.useCallback((l,c)=>{F_(l),s==null||s(l,c)},[s]);return p.jsx(Nk,{ref:o,addEndListener:kk,...i,onEnter:a,childRef:wd(e),children:(l,c)=>S.cloneElement(e,{...c,className:Te("fade",t,e.props.className,TK[l],n[l])})})});Uu.displayName="Fade";const RK={"aria-label":Vi.string,onClick:Vi.func,variant:Vi.oneOf(["white"])},Yy=S.forwardRef(({className:t,variant:e,"aria-label":n="Close",...s},r)=>p.jsx("button",{ref:r,type:"button",className:Te("btn-close",e&&`btn-close-${e}`,t),"aria-label":n,...s}));Yy.displayName="CloseButton";Yy.propTypes=RK;const B_=S.forwardRef((t,e)=>{const{bsPrefix:n,show:s=!0,closeLabel:r="Close alert",closeVariant:o,className:i,children:a,variant:l="primary",onClose:c,dismissible:u,transition:d=Uu,...h}=Jf(t,{show:"onClose"}),f=Le(n,"alert"),m=Ji(x=>{c&&c(!1,x)}),g=d===!0?Uu:d,y=p.jsxs("div",{role:"alert",...g?void 0:h,ref:e,className:Te(i,f,l&&`${f}-${l}`,u&&`${f}-dismissible`),children:[u&&p.jsx(Yy,{onClick:m,"aria-label":r,variant:o}),a]});return g?p.jsx(g,{unmountOnExit:!0,...h,ref:void 0,in:s,children:y}):s?y:null});B_.displayName="Alert";const Wa=Object.assign(B_,{Link:j_,Heading:__}),Zs=S.forwardRef(({bsPrefix:t,bg:e="primary",pill:n=!1,text:s,className:r,as:o="span",...i},a)=>{const l=Le(t,"badge");return p.jsx(o,{ref:a,...i,className:Te(r,l,n&&"rounded-pill",s&&`text-${s}`,e&&`bg-${e}`)})});Zs.displayName="Badge";const Ve=S.forwardRef(({as:t,bsPrefix:e,variant:n="primary",size:s,active:r=!1,disabled:o=!1,className:i,...a},l)=>{const c=Le(e,"btn"),[u,{tagName:d}]=Ek({tagName:t,disabled:o,...a}),h=d;return p.jsx(h,{...u,...a,ref:l,disabled:o,className:Te(i,c,r&&"active",n&&`${c}-${n}`,s&&`${c}-${s}`,a.href&&o&&"disabled")})});Ve.displayName="Button";const Ik=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"card-body"),p.jsx(n,{ref:r,className:Te(t,e),...s})));Ik.displayName="CardBody";const z_=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"card-footer"),p.jsx(n,{ref:r,className:Te(t,e),...s})));z_.displayName="CardFooter";const Tk=S.createContext(null);Tk.displayName="CardHeaderContext";const U_=S.forwardRef(({bsPrefix:t,className:e,as:n="div",...s},r)=>{const o=Le(t,"card-header"),i=S.useMemo(()=>({cardHeaderBsPrefix:o}),[o]);return p.jsx(Tk.Provider,{value:i,children:p.jsx(n,{ref:r,...s,className:Te(e,o)})})});U_.displayName="CardHeader";const V_=S.forwardRef(({bsPrefix:t,className:e,variant:n,as:s="img",...r},o)=>{const i=Le(t,"card-img");return p.jsx(s,{ref:o,className:Te(n?`${i}-${n}`:i,e),...r})});V_.displayName="CardImg";const W_=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"card-img-overlay"),p.jsx(n,{ref:r,className:Te(t,e),...s})));W_.displayName="CardImgOverlay";const H_=S.forwardRef(({className:t,bsPrefix:e,as:n="a",...s},r)=>(e=Le(e,"card-link"),p.jsx(n,{ref:r,className:Te(t,e),...s})));H_.displayName="CardLink";const AK=ep("h6"),G_=S.forwardRef(({className:t,bsPrefix:e,as:n=AK,...s},r)=>(e=Le(e,"card-subtitle"),p.jsx(n,{ref:r,className:Te(t,e),...s})));G_.displayName="CardSubtitle";const q_=S.forwardRef(({className:t,bsPrefix:e,as:n="p",...s},r)=>(e=Le(e,"card-text"),p.jsx(n,{ref:r,className:Te(t,e),...s})));q_.displayName="CardText";const DK=ep("h5"),K_=S.forwardRef(({className:t,bsPrefix:e,as:n=DK,...s},r)=>(e=Le(e,"card-title"),p.jsx(n,{ref:r,className:Te(t,e),...s})));K_.displayName="CardTitle";const X_=S.forwardRef(({bsPrefix:t,className:e,bg:n,text:s,border:r,body:o=!1,children:i,as:a="div",...l},c)=>{const u=Le(t,"card");return p.jsx(a,{ref:c,...l,className:Te(e,u,n&&`bg-${n}`,s&&`text-${s}`,r&&`border-${r}`),children:o?p.jsx(Ik,{children:i}):i})});X_.displayName="Card";const be=Object.assign(X_,{Img:V_,Title:K_,Subtitle:G_,Body:Ik,Link:H_,Text:q_,Header:U_,Footer:z_,ImgOverlay:W_});function OK(t){const e=S.useRef(t);return e.current=t,e}function FK(t){const e=OK(t);S.useEffect(()=>()=>e.current(),[])}function PK(t,e){let n=0;return S.Children.map(t,s=>S.isValidElement(s)?e(s,n++):s)}function _K(t,e){return S.Children.toArray(t).some(n=>S.isValidElement(n)&&n.type===e)}function MK({as:t,bsPrefix:e,className:n,...s}){e=Le(e,"col");const r=E_(),o=$_(),i=[],a=[];return r.forEach(l=>{const c=s[l];delete s[l];let u,d,h;typeof c=="object"&&c!=null?{span:u,offset:d,order:h}=c:u=c;const f=l!==o?`-${l}`:"";u&&i.push(u===!0?`${e}${f}`:`${e}${f}-${u}`),h!=null&&a.push(`order${f}-${h}`),d!=null&&a.push(`offset${f}-${d}`)}),[{...s,className:Te(n,...i,...a)},{as:t,bsPrefix:e,spans:i}]}const ve=S.forwardRef((t,e)=>{const[{className:n,...s},{as:r="div",bsPrefix:o,spans:i}]=MK(t);return p.jsx(r,{...s,ref:e,className:Te(n,!i.length&&o)})});ve.displayName="Col";const Kt=S.forwardRef(({bsPrefix:t,fluid:e=!1,as:n="div",className:s,...r},o)=>{const i=Le(t,"container"),a=typeof e=="string"?`-${e}`:"-fluid";return p.jsx(n,{ref:o,...r,className:Te(s,e?`${i}${a}`:i)})});Kt.displayName="Container";var LK=Function.prototype.bind.call(Function.prototype.call,[].slice);function Oi(t,e){return LK(t.querySelectorAll(e))}function jK(t,e,n){const s=S.useRef(t!==void 0),[r,o]=S.useState(e),i=t!==void 0,a=s.current;return s.current=i,!i&&a&&r!==e&&o(e),[i?t:r,S.useCallback((...l)=>{const[c,...u]=l;let d=n==null?void 0:n(c,...u);return o(c),d},[n])]}function Y_(){const[,t]=S.useReducer(e=>e+1,0);return t}const Jy=S.createContext(null);var xT=Object.prototype.hasOwnProperty;function yT(t,e,n){for(n of t.keys())if(_h(n,e))return n}function _h(t,e){var n,s,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((s=t.length)===e.length)for(;s--&&_h(t[s],e[s]););return s===-1}if(n===Set){if(t.size!==e.size)return!1;for(s of t)if(r=s,r&&typeof r=="object"&&(r=yT(e,r),!r)||!e.has(r))return!1;return!0}if(n===Map){if(t.size!==e.size)return!1;for(s of t)if(r=s[0],r&&typeof r=="object"&&(r=yT(e,r),!r)||!_h(s[1],e.get(r)))return!1;return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((s=t.byteLength)===e.byteLength)for(;s--&&t.getInt8(s)===e.getInt8(s););return s===-1}if(ArrayBuffer.isView(t)){if((s=t.byteLength)===e.byteLength)for(;s--&&t[s]===e[s];);return s===-1}if(!n||typeof t=="object"){s=0;for(n in t)if(xT.call(t,n)&&++s&&!xT.call(e,n)||!(n in e)||!_h(t[n],e[n]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}function BK(t){const e=M_();return[t[0],S.useCallback(n=>{if(e())return t[1](n)},[e,t[1]])]}var Er="top",wo="bottom",Co="right",$r="left",Rk="auto",tp=[Er,wo,Co,$r],Vu="start",yf="end",zK="clippingParents",J_="viewport",th="popper",UK="reference",vT=tp.reduce(function(t,e){return t.concat([e+"-"+Vu,e+"-"+yf])},[]),Z_=[].concat(tp,[Rk]).reduce(function(t,e){return t.concat([e,e+"-"+Vu,e+"-"+yf])},[]),VK="beforeRead",WK="read",HK="afterRead",GK="beforeMain",qK="main",KK="afterMain",XK="beforeWrite",YK="write",JK="afterWrite",ZK=[VK,WK,HK,GK,qK,KK,XK,YK,JK];function pi(t){return t.split("-")[0]}function Kr(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function uc(t){var e=Kr(t).Element;return t instanceof e||t instanceof Element}function mi(t){var e=Kr(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Ak(t){if(typeof ShadowRoot>"u")return!1;var e=Kr(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var Jl=Math.max,kx=Math.min,Wu=Math.round;function cC(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Q_(){return!/^((?!chrome|android).)*safari/i.test(cC())}function Hu(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var s=t.getBoundingClientRect(),r=1,o=1;e&&mi(t)&&(r=t.offsetWidth>0&&Wu(s.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Wu(s.height)/t.offsetHeight||1);var i=uc(t)?Kr(t):window,a=i.visualViewport,l=!Q_()&&n,c=(s.left+(l&&a?a.offsetLeft:0))/r,u=(s.top+(l&&a?a.offsetTop:0))/o,d=s.width/r,h=s.height/o;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c,x:c,y:u}}function Dk(t){var e=Hu(t),n=t.offsetWidth,s=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-s)<=1&&(s=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:s}}function eM(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Ak(n)){var s=e;do{if(s&&t.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Za(t){return t?(t.nodeName||"").toLowerCase():null}function Zi(t){return Kr(t).getComputedStyle(t)}function QK(t){return["table","td","th"].indexOf(Za(t))>=0}function fl(t){return((uc(t)?t.ownerDocument:t.document)||window.document).documentElement}function Zy(t){return Za(t)==="html"?t:t.assignedSlot||t.parentNode||(Ak(t)?t.host:null)||fl(t)}function bT(t){return!mi(t)||Zi(t).position==="fixed"?null:t.offsetParent}function eX(t){var e=/firefox/i.test(cC()),n=/Trident/i.test(cC());if(n&&mi(t)){var s=Zi(t);if(s.position==="fixed")return null}var r=Zy(t);for(Ak(r)&&(r=r.host);mi(r)&&["html","body"].indexOf(Za(r))<0;){var o=Zi(r);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return r;r=r.parentNode}return null}function np(t){for(var e=Kr(t),n=bT(t);n&&QK(n)&&Zi(n).position==="static";)n=bT(n);return n&&(Za(n)==="html"||Za(n)==="body"&&Zi(n).position==="static")?e:n||eX(t)||e}function Ok(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Mh(t,e,n){return Jl(t,kx(e,n))}function tX(t,e,n){var s=Mh(t,e,n);return s>n?n:s}function tM(){return{top:0,right:0,bottom:0,left:0}}function nM(t){return Object.assign({},tM(),t)}function sM(t,e){return e.reduce(function(n,s){return n[s]=t,n},{})}var nX=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,nM(typeof e!="number"?e:sM(e,tp))};function sX(t){var e,n=t.state,s=t.name,r=t.options,o=n.elements.arrow,i=n.modifiersData.popperOffsets,a=pi(n.placement),l=Ok(a),c=[$r,Co].indexOf(a)>=0,u=c?"height":"width";if(!(!o||!i)){var d=nX(r.padding,n),h=Dk(o),f=l==="y"?Er:$r,m=l==="y"?wo:Co,g=n.rects.reference[u]+n.rects.reference[l]-i[l]-n.rects.popper[u],y=i[l]-n.rects.reference[l],x=np(o),v=x?l==="y"?x.clientHeight||0:x.clientWidth||0:0,b=g/2-y/2,w=d[f],C=v-h[u]-d[m],k=v/2-h[u]/2+b,N=Mh(w,k,C),E=l;n.modifiersData[s]=(e={},e[E]=N,e.centerOffset=N-k,e)}}function rX(t){var e=t.state,n=t.options,s=n.element,r=s===void 0?"[data-popper-arrow]":s;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||eM(e.elements.popper,r)&&(e.elements.arrow=r))}const oX={name:"arrow",enabled:!0,phase:"main",fn:sX,effect:rX,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Gu(t){return t.split("-")[1]}var iX={top:"auto",right:"auto",bottom:"auto",left:"auto"};function aX(t,e){var n=t.x,s=t.y,r=e.devicePixelRatio||1;return{x:Wu(n*r)/r||0,y:Wu(s*r)/r||0}}function wT(t){var e,n=t.popper,s=t.popperRect,r=t.placement,o=t.variation,i=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,h=i.x,f=h===void 0?0:h,m=i.y,g=m===void 0?0:m,y=typeof u=="function"?u({x:f,y:g}):{x:f,y:g};f=y.x,g=y.y;var x=i.hasOwnProperty("x"),v=i.hasOwnProperty("y"),b=$r,w=Er,C=window;if(c){var k=np(n),N="clientHeight",E="clientWidth";if(k===Kr(n)&&(k=fl(n),Zi(k).position!=="static"&&a==="absolute"&&(N="scrollHeight",E="scrollWidth")),k=k,r===Er||(r===$r||r===Co)&&o===yf){w=wo;var $=d&&k===C&&C.visualViewport?C.visualViewport.height:k[N];g-=$-s.height,g*=l?1:-1}if(r===$r||(r===Er||r===wo)&&o===yf){b=Co;var I=d&&k===C&&C.visualViewport?C.visualViewport.width:k[E];f-=I-s.width,f*=l?1:-1}}var A=Object.assign({position:a},c&&iX),P=u===!0?aX({x:f,y:g},Kr(n)):{x:f,y:g};if(f=P.x,g=P.y,l){var _;return Object.assign({},A,(_={},_[w]=v?"0":"",_[b]=x?"0":"",_.transform=(C.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",_))}return Object.assign({},A,(e={},e[w]=v?g+"px":"",e[b]=x?f+"px":"",e.transform="",e))}function lX(t){var e=t.state,n=t.options,s=n.gpuAcceleration,r=s===void 0?!0:s,o=n.adaptive,i=o===void 0?!0:o,a=n.roundOffsets,l=a===void 0?!0:a,c={placement:pi(e.placement),variation:Gu(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wT(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:i,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wT(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const cX={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lX,data:{}};var qm={passive:!0};function uX(t){var e=t.state,n=t.instance,s=t.options,r=s.scroll,o=r===void 0?!0:r,i=s.resize,a=i===void 0?!0:i,l=Kr(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(u){u.addEventListener("scroll",n.update,qm)}),a&&l.addEventListener("resize",n.update,qm),function(){o&&c.forEach(function(u){u.removeEventListener("scroll",n.update,qm)}),a&&l.removeEventListener("resize",n.update,qm)}}const dX={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:uX,data:{}};var hX={left:"right",right:"left",bottom:"top",top:"bottom"};function jg(t){return t.replace(/left|right|bottom|top/g,function(e){return hX[e]})}var fX={start:"end",end:"start"};function CT(t){return t.replace(/start|end/g,function(e){return fX[e]})}function Fk(t){var e=Kr(t),n=e.pageXOffset,s=e.pageYOffset;return{scrollLeft:n,scrollTop:s}}function Pk(t){return Hu(fl(t)).left+Fk(t).scrollLeft}function pX(t,e){var n=Kr(t),s=fl(t),r=n.visualViewport,o=s.clientWidth,i=s.clientHeight,a=0,l=0;if(r){o=r.width,i=r.height;var c=Q_();(c||!c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:o,height:i,x:a+Pk(t),y:l}}function mX(t){var e,n=fl(t),s=Fk(t),r=(e=t.ownerDocument)==null?void 0:e.body,o=Jl(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),i=Jl(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-s.scrollLeft+Pk(t),l=-s.scrollTop;return Zi(r||n).direction==="rtl"&&(a+=Jl(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:i,x:a,y:l}}function _k(t){var e=Zi(t),n=e.overflow,s=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+s)}function rM(t){return["html","body","#document"].indexOf(Za(t))>=0?t.ownerDocument.body:mi(t)&&_k(t)?t:rM(Zy(t))}function Lh(t,e){var n;e===void 0&&(e=[]);var s=rM(t),r=s===((n=t.ownerDocument)==null?void 0:n.body),o=Kr(s),i=r?[o].concat(o.visualViewport||[],_k(s)?s:[]):s,a=e.concat(i);return r?a:a.concat(Lh(Zy(i)))}function uC(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function gX(t,e){var n=Hu(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function ST(t,e,n){return e===J_?uC(pX(t,n)):uc(e)?gX(e,n):uC(mX(fl(t)))}function xX(t){var e=Lh(Zy(t)),n=["absolute","fixed"].indexOf(Zi(t).position)>=0,s=n&&mi(t)?np(t):t;return uc(s)?e.filter(function(r){return uc(r)&&eM(r,s)&&Za(r)!=="body"}):[]}function yX(t,e,n,s){var r=e==="clippingParents"?xX(t):[].concat(e),o=[].concat(r,[n]),i=o[0],a=o.reduce(function(l,c){var u=ST(t,c,s);return l.top=Jl(u.top,l.top),l.right=kx(u.right,l.right),l.bottom=kx(u.bottom,l.bottom),l.left=Jl(u.left,l.left),l},ST(t,i,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function oM(t){var e=t.reference,n=t.element,s=t.placement,r=s?pi(s):null,o=s?Gu(s):null,i=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(r){case Er:l={x:i,y:e.y-n.height};break;case wo:l={x:i,y:e.y+e.height};break;case Co:l={x:e.x+e.width,y:a};break;case $r:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var c=r?Ok(r):null;if(c!=null){var u=c==="y"?"height":"width";switch(o){case Vu:l[c]=l[c]-(e[u]/2-n[u]/2);break;case yf:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function vf(t,e){e===void 0&&(e={});var n=e,s=n.placement,r=s===void 0?t.placement:s,o=n.strategy,i=o===void 0?t.strategy:o,a=n.boundary,l=a===void 0?zK:a,c=n.rootBoundary,u=c===void 0?J_:c,d=n.elementContext,h=d===void 0?th:d,f=n.altBoundary,m=f===void 0?!1:f,g=n.padding,y=g===void 0?0:g,x=nM(typeof y!="number"?y:sM(y,tp)),v=h===th?UK:th,b=t.rects.popper,w=t.elements[m?v:h],C=yX(uc(w)?w:w.contextElement||fl(t.elements.popper),l,u,i),k=Hu(t.elements.reference),N=oM({reference:k,element:b,placement:r}),E=uC(Object.assign({},b,N)),$=h===th?E:k,I={top:C.top-$.top+x.top,bottom:$.bottom-C.bottom+x.bottom,left:C.left-$.left+x.left,right:$.right-C.right+x.right},A=t.modifiersData.offset;if(h===th&&A){var P=A[r];Object.keys(I).forEach(function(_){var U=[Co,wo].indexOf(_)>=0?1:-1,V=[Er,wo].indexOf(_)>=0?"y":"x";I[_]+=P[V]*U})}return I}function vX(t,e){e===void 0&&(e={});var n=e,s=n.placement,r=n.boundary,o=n.rootBoundary,i=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?Z_:l,u=Gu(s),d=u?a?vT:vT.filter(function(m){return Gu(m)===u}):tp,h=d.filter(function(m){return c.indexOf(m)>=0});h.length===0&&(h=d);var f=h.reduce(function(m,g){return m[g]=vf(t,{placement:g,boundary:r,rootBoundary:o,padding:i})[pi(g)],m},{});return Object.keys(f).sort(function(m,g){return f[m]-f[g]})}function bX(t){if(pi(t)===Rk)return[];var e=jg(t);return[CT(t),e,CT(e)]}function wX(t){var e=t.state,n=t.options,s=t.name;if(!e.modifiersData[s]._skip){for(var r=n.mainAxis,o=r===void 0?!0:r,i=n.altAxis,a=i===void 0?!0:i,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,f=n.flipVariations,m=f===void 0?!0:f,g=n.allowedAutoPlacements,y=e.options.placement,x=pi(y),v=x===y,b=l||(v||!m?[jg(y)]:bX(y)),w=[y].concat(b).reduce(function(K,J){return K.concat(pi(J)===Rk?vX(e,{placement:J,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:g}):J)},[]),C=e.rects.reference,k=e.rects.popper,N=new Map,E=!0,$=w[0],I=0;I<w.length;I++){var A=w[I],P=pi(A),_=Gu(A)===Vu,U=[Er,wo].indexOf(P)>=0,V=U?"width":"height",D=vf(e,{placement:A,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),W=U?_?Co:$r:_?wo:Er;C[V]>k[V]&&(W=jg(W));var R=jg(W),j=[];if(o&&j.push(D[P]<=0),a&&j.push(D[W]<=0,D[R]<=0),j.every(function(K){return K})){$=A,E=!1;break}N.set(A,j)}if(E)for(var G=m?3:1,O=function(J){var re=w.find(function(de){var pe=N.get(de);if(pe)return pe.slice(0,J).every(function(we){return we})});if(re)return $=re,"break"},B=G;B>0;B--){var z=O(B);if(z==="break")break}e.placement!==$&&(e.modifiersData[s]._skip=!0,e.placement=$,e.reset=!0)}}const CX={name:"flip",enabled:!0,phase:"main",fn:wX,requiresIfExists:["offset"],data:{_skip:!1}};function kT(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function NT(t){return[Er,Co,wo,$r].some(function(e){return t[e]>=0})}function SX(t){var e=t.state,n=t.name,s=e.rects.reference,r=e.rects.popper,o=e.modifiersData.preventOverflow,i=vf(e,{elementContext:"reference"}),a=vf(e,{altBoundary:!0}),l=kT(i,s),c=kT(a,r,o),u=NT(l),d=NT(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const kX={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:SX};function NX(t,e,n){var s=pi(t),r=[$r,Er].indexOf(s)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,i=o[0],a=o[1];return i=i||0,a=(a||0)*r,[$r,Co].indexOf(s)>=0?{x:a,y:i}:{x:i,y:a}}function EX(t){var e=t.state,n=t.options,s=t.name,r=n.offset,o=r===void 0?[0,0]:r,i=Z_.reduce(function(u,d){return u[d]=NX(d,e.rects,o),u},{}),a=i[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[s]=i}const $X={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:EX};function IX(t){var e=t.state,n=t.name;e.modifiersData[n]=oM({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const TX={name:"popperOffsets",enabled:!0,phase:"read",fn:IX,data:{}};function RX(t){return t==="x"?"y":"x"}function AX(t){var e=t.state,n=t.options,s=t.name,r=n.mainAxis,o=r===void 0?!0:r,i=n.altAxis,a=i===void 0?!1:i,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,f=h===void 0?!0:h,m=n.tetherOffset,g=m===void 0?0:m,y=vf(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),x=pi(e.placement),v=Gu(e.placement),b=!v,w=Ok(x),C=RX(w),k=e.modifiersData.popperOffsets,N=e.rects.reference,E=e.rects.popper,$=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,I=typeof $=="number"?{mainAxis:$,altAxis:$}:Object.assign({mainAxis:0,altAxis:0},$),A=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,P={x:0,y:0};if(k){if(o){var _,U=w==="y"?Er:$r,V=w==="y"?wo:Co,D=w==="y"?"height":"width",W=k[w],R=W+y[U],j=W-y[V],G=f?-E[D]/2:0,O=v===Vu?N[D]:E[D],B=v===Vu?-E[D]:-N[D],z=e.elements.arrow,K=f&&z?Dk(z):{width:0,height:0},J=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:tM(),re=J[U],de=J[V],pe=Mh(0,N[D],K[D]),we=b?N[D]/2-G-pe-re-I.mainAxis:O-pe-re-I.mainAxis,Ce=b?-N[D]/2+G+pe+de+I.mainAxis:B+pe+de+I.mainAxis,Ne=e.elements.arrow&&np(e.elements.arrow),ze=Ne?w==="y"?Ne.clientTop||0:Ne.clientLeft||0:0,_e=(_=A==null?void 0:A[w])!=null?_:0,st=W+we-_e-ze,je=W+Ce-_e,rt=Mh(f?kx(R,st):R,W,f?Jl(j,je):j);k[w]=rt,P[w]=rt-W}if(a){var ue,Ue=w==="x"?Er:$r,sn=w==="x"?wo:Co,gt=k[C],Jn=C==="y"?"height":"width",pn=gt+y[Ue],Zn=gt-y[sn],Vn=[Er,$r].indexOf(x)!==-1,hr=(ue=A==null?void 0:A[C])!=null?ue:0,it=Vn?pn:gt-N[Jn]-E[Jn]-hr+I.altAxis,Qn=Vn?gt+N[Jn]+E[Jn]-hr-I.altAxis:Zn,fr=f&&Vn?tX(it,gt,Qn):Mh(f?it:pn,gt,f?Qn:Zn);k[C]=fr,P[C]=fr-gt}e.modifiersData[s]=P}}const DX={name:"preventOverflow",enabled:!0,phase:"main",fn:AX,requiresIfExists:["offset"]};function OX(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function FX(t){return t===Kr(t)||!mi(t)?Fk(t):OX(t)}function PX(t){var e=t.getBoundingClientRect(),n=Wu(e.width)/t.offsetWidth||1,s=Wu(e.height)/t.offsetHeight||1;return n!==1||s!==1}function _X(t,e,n){n===void 0&&(n=!1);var s=mi(e),r=mi(e)&&PX(e),o=fl(e),i=Hu(t,r,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(s||!s&&!n)&&((Za(e)!=="body"||_k(o))&&(a=FX(e)),mi(e)?(l=Hu(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=Pk(o))),{x:i.left+a.scrollLeft-l.x,y:i.top+a.scrollTop-l.y,width:i.width,height:i.height}}function MX(t){var e=new Map,n=new Set,s=[];t.forEach(function(o){e.set(o.name,o)});function r(o){n.add(o.name);var i=[].concat(o.requires||[],o.requiresIfExists||[]);i.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&r(l)}}),s.push(o)}return t.forEach(function(o){n.has(o.name)||r(o)}),s}function LX(t){var e=MX(t);return ZK.reduce(function(n,s){return n.concat(e.filter(function(r){return r.phase===s}))},[])}function jX(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function BX(t){var e=t.reduce(function(n,s){var r=n[s.name];return n[s.name]=r?Object.assign({},r,s,{options:Object.assign({},r.options,s.options),data:Object.assign({},r.data,s.data)}):s,n},{});return Object.keys(e).map(function(n){return e[n]})}var ET={placement:"bottom",modifiers:[],strategy:"absolute"};function $T(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function zX(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,s=n===void 0?[]:n,r=e.defaultOptions,o=r===void 0?ET:r;return function(a,l,c){c===void 0&&(c=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},ET,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],h=!1,f={state:u,setOptions:function(x){var v=typeof x=="function"?x(u.options):x;g(),u.options=Object.assign({},o,u.options,v),u.scrollParents={reference:uc(a)?Lh(a):a.contextElement?Lh(a.contextElement):[],popper:Lh(l)};var b=LX(BX([].concat(s,u.options.modifiers)));return u.orderedModifiers=b.filter(function(w){return w.enabled}),m(),f.update()},forceUpdate:function(){if(!h){var x=u.elements,v=x.reference,b=x.popper;if($T(v,b)){u.rects={reference:_X(v,np(b),u.options.strategy==="fixed"),popper:Dk(b)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(I){return u.modifiersData[I.name]=Object.assign({},I.data)});for(var w=0;w<u.orderedModifiers.length;w++){if(u.reset===!0){u.reset=!1,w=-1;continue}var C=u.orderedModifiers[w],k=C.fn,N=C.options,E=N===void 0?{}:N,$=C.name;typeof k=="function"&&(u=k({state:u,options:E,name:$,instance:f})||u)}}}},update:jX(function(){return new Promise(function(y){f.forceUpdate(),y(u)})}),destroy:function(){g(),h=!0}};if(!$T(a,l))return f;f.setOptions(c).then(function(y){!h&&c.onFirstUpdate&&c.onFirstUpdate(y)});function m(){u.orderedModifiers.forEach(function(y){var x=y.name,v=y.options,b=v===void 0?{}:v,w=y.effect;if(typeof w=="function"){var C=w({state:u,name:x,instance:f,options:b}),k=function(){};d.push(C||k)}})}function g(){d.forEach(function(y){return y()}),d=[]}return f}}const UX=zX({defaultModifiers:[kX,TX,cX,dX,$X,CX,DX,oX]}),VX=["enabled","placement","strategy","modifiers"];function WX(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}const HX={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},GX={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:t})=>()=>{const{reference:e,popper:n}=t.elements;if("removeAttribute"in e){const s=(e.getAttribute("aria-describedby")||"").split(",").filter(r=>r.trim()!==n.id);s.length?e.setAttribute("aria-describedby",s.join(",")):e.removeAttribute("aria-describedby")}},fn:({state:t})=>{var e;const{popper:n,reference:s}=t.elements,r=(e=n.getAttribute("role"))==null?void 0:e.toLowerCase();if(n.id&&r==="tooltip"&&"setAttribute"in s){const o=s.getAttribute("aria-describedby");if(o&&o.split(",").indexOf(n.id)!==-1)return;s.setAttribute("aria-describedby",o?`${o},${n.id}`:n.id)}}},qX=[];function KX(t,e,n={}){let{enabled:s=!0,placement:r="bottom",strategy:o="absolute",modifiers:i=qX}=n,a=WX(n,VX);const l=S.useRef(i),c=S.useRef(),u=S.useCallback(()=>{var y;(y=c.current)==null||y.update()},[]),d=S.useCallback(()=>{var y;(y=c.current)==null||y.forceUpdate()},[]),[h,f]=BK(S.useState({placement:r,update:u,forceUpdate:d,attributes:{},styles:{popper:{},arrow:{}}})),m=S.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:y})=>{const x={},v={};Object.keys(y.elements).forEach(b=>{x[b]=y.styles[b],v[b]=y.attributes[b]}),f({state:y,styles:x,attributes:v,update:u,forceUpdate:d,placement:y.placement})}}),[u,d,f]),g=S.useMemo(()=>(_h(l.current,i)||(l.current=i),l.current),[i]);return S.useEffect(()=>{!c.current||!s||c.current.setOptions({placement:r,strategy:o,modifiers:[...g,m,HX]})},[o,r,m,s,g]),S.useEffect(()=>{if(!(!s||t==null||e==null))return c.current=UX(t,e,Object.assign({},a,{placement:r,strategy:o,modifiers:[...g,GX,m]})),()=>{c.current!=null&&(c.current.destroy(),c.current=void 0,f(y=>Object.assign({},y,{attributes:{},styles:{popper:{}}})))}},[s,t,e]),h}function Nx(t,e){if(t.contains)return t.contains(e);if(t.compareDocumentPosition)return t===e||!!(t.compareDocumentPosition(e)&16)}var XX=function(){},YX=XX;const JX=dd(YX),IT=()=>{};function ZX(t){return t.button===0}function QX(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}const Mb=t=>t&&("current"in t?t.current:t),TT={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function eY(t,e=IT,{disabled:n,clickTrigger:s="click"}={}){const r=S.useRef(!1),o=S.useRef(!1),i=S.useCallback(c=>{const u=Mb(t);JX(!!u,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),r.current=!u||QX(c)||!ZX(c)||!!Nx(u,c.target)||o.current,o.current=!1},[t]),a=js(c=>{const u=Mb(t);u&&Nx(u,c.target)?o.current=!0:o.current=!1}),l=js(c=>{r.current||e(c)});S.useEffect(()=>{var c,u;if(n||t==null)return;const d=Qf(Mb(t)),h=d.defaultView||window;let f=(c=h.event)!=null?c:(u=h.parent)==null?void 0:u.event,m=null;TT[s]&&(m=Aa(d,TT[s],a,!0));const g=Aa(d,s,i,!0),y=Aa(d,s,v=>{if(v===f){f=void 0;return}l(v)});let x=[];return"ontouchstart"in d.documentElement&&(x=[].slice.call(d.body.children).map(v=>Aa(v,"mousemove",IT))),()=>{m==null||m(),g(),y(),x.forEach(v=>v())}},[t,n,s,i,a,l])}function tY(t){const e={};return Array.isArray(t)?(t==null||t.forEach(n=>{e[n.name]=n}),e):t||e}function nY(t={}){return Array.isArray(t)?t:Object.keys(t).map(e=>(t[e].name=e,t[e]))}function sY({enabled:t,enableEvents:e,placement:n,flip:s,offset:r,fixed:o,containerPadding:i,arrowElement:a,popperConfig:l={}}){var c,u,d,h,f;const m=tY(l.modifiers);return Object.assign({},l,{placement:n,enabled:t,strategy:o?"fixed":l.strategy,modifiers:nY(Object.assign({},m,{eventListeners:{enabled:e,options:(c=m.eventListeners)==null?void 0:c.options},preventOverflow:Object.assign({},m.preventOverflow,{options:i?Object.assign({padding:i},(u=m.preventOverflow)==null?void 0:u.options):(d=m.preventOverflow)==null?void 0:d.options}),offset:{options:Object.assign({offset:r},(h=m.offset)==null?void 0:h.options)},arrow:Object.assign({},m.arrow,{enabled:!!a,options:Object.assign({},(f=m.arrow)==null?void 0:f.options,{element:a})}),flip:Object.assign({enabled:!!s},m.flip)}))})}const rY=["children","usePopper"];function oY(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}const iY=()=>{};function iM(t={}){const e=S.useContext(Jy),[n,s]=yK(),r=S.useRef(!1),{flip:o,offset:i,rootCloseEvent:a,fixed:l=!1,placement:c,popperConfig:u={},enableEventListeners:d=!0,usePopper:h=!!e}=t,f=(e==null?void 0:e.show)==null?!!t.show:e.show;f&&!r.current&&(r.current=!0);const m=k=>{e==null||e.toggle(!1,k)},{placement:g,setMenu:y,menuElement:x,toggleElement:v}=e||{},b=KX(v,x,sY({placement:c||g||"bottom-start",enabled:h,enableEvents:d??f,offset:i,flip:o,fixed:l,arrowElement:n,popperConfig:u})),w=Object.assign({ref:y||iY,"aria-labelledby":v==null?void 0:v.id},b.attributes.popper,{style:b.styles.popper}),C={show:f,placement:g,hasShown:r.current,toggle:e==null?void 0:e.toggle,popper:h?b:null,arrowProps:h?Object.assign({ref:s},b.attributes.arrow,{style:b.styles.arrow}):{}};return eY(x,m,{clickTrigger:a,disabled:!f}),[w,C]}function aM(t){let{children:e,usePopper:n=!0}=t,s=oY(t,rY);const[r,o]=iM(Object.assign({},s,{usePopper:n}));return p.jsx(p.Fragment,{children:e(r,o)})}aM.displayName="DropdownMenu";const Mk={prefix:String(Math.round(Math.random()*1e10)),current:0},lM=tt.createContext(Mk),aY=tt.createContext(!1);let lY=!!(typeof window<"u"&&window.document&&window.document.createElement),Lb=new WeakMap;function cY(t=!1){let e=S.useContext(lM),n=S.useRef(null);if(n.current===null&&!t){var s,r;let o=(r=tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||r===void 0||(s=r.ReactCurrentOwner)===null||s===void 0?void 0:s.current;if(o){let i=Lb.get(o);i==null?Lb.set(o,{id:e.current,state:o.memoizedState}):o.memoizedState!==i.state&&(e.current=i.id,Lb.delete(o))}n.current=++e.current}return n.current}function uY(t){let e=S.useContext(lM);e===Mk&&!lY&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let n=cY(!!t),s=`react-aria${e.prefix}`;return t||`${s}-${n}`}function dY(t){let e=tt.useId(),[n]=S.useState(gY()),s=n?"react-aria":`react-aria${Mk.prefix}`;return t||`${s}-${e}`}const hY=typeof tt.useId=="function"?dY:uY;function fY(){return!1}function pY(){return!0}function mY(t){return()=>{}}function gY(){return typeof tt.useSyncExternalStore=="function"?tt.useSyncExternalStore(mY,fY,pY):S.useContext(aY)}const cM=t=>{var e;return((e=t.getAttribute("role"))==null?void 0:e.toLowerCase())==="menu"},RT=()=>{};function uM(){const t=hY(),{show:e=!1,toggle:n=RT,setToggle:s,menuElement:r}=S.useContext(Jy)||{},o=S.useCallback(a=>{n(!e,a)},[e,n]),i={id:t,ref:s||RT,onClick:o,"aria-expanded":!!e};return r&&cM(r)&&(i["aria-haspopup"]=!0),[i,{show:e,toggle:n}]}function dM({children:t}){const[e,n]=uM();return p.jsx(p.Fragment,{children:t(e,n)})}dM.displayName="DropdownToggle";const dc=S.createContext(null),qu=(t,e=null)=>t!=null?String(t):e||null,Qy=S.createContext(null);Qy.displayName="NavContext";const xY="data-rr-ui-",yY="rrUi";function Sd(t){return`${xY}${t}`}function vY(t){return`${yY}${t}`}const bY=["eventKey","disabled","onClick","active","as"];function wY(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function hM({key:t,href:e,active:n,disabled:s,onClick:r}){const o=S.useContext(dc),i=S.useContext(Qy),{activeKey:a}=i||{},l=qu(t,e),c=n==null&&t!=null?qu(a)===l:n;return[{onClick:js(d=>{s||(r==null||r(d),o&&!d.isPropagationStopped()&&o(l,d))}),"aria-disabled":s||void 0,"aria-selected":c,[Sd("dropdown-item")]:""},{isActive:c}]}const fM=S.forwardRef((t,e)=>{let{eventKey:n,disabled:s,onClick:r,active:o,as:i=$k}=t,a=wY(t,bY);const[l]=hM({key:n,href:a.href,disabled:s,onClick:r,active:o});return p.jsx(i,Object.assign({},a,{ref:e},l))});fM.displayName="DropdownItem";const pM=S.createContext(Cd?window:void 0);pM.Provider;function e0(){return S.useContext(pM)}function AT(){const t=Y_(),e=S.useRef(null),n=S.useCallback(s=>{e.current=s,t()},[t]);return[e,n]}function sp({defaultShow:t,show:e,onSelect:n,onToggle:s,itemSelector:r=`* [${Sd("dropdown-item")}]`,focusFirstItemOnShow:o,placement:i="bottom-start",children:a}){const l=e0(),[c,u]=jK(e,t,s),[d,h]=AT(),f=d.current,[m,g]=AT(),y=m.current,x=L_(c),v=S.useRef(null),b=S.useRef(!1),w=S.useContext(dc),C=S.useCallback((A,P,_=P==null?void 0:P.type)=>{u(A,{originalEvent:P,source:_})},[u]),k=js((A,P)=>{n==null||n(A,P),C(!1,P,"select"),P.isPropagationStopped()||w==null||w(A,P)}),N=S.useMemo(()=>({toggle:C,placement:i,show:c,menuElement:f,toggleElement:y,setMenu:h,setToggle:g}),[C,i,c,f,y,h,g]);f&&x&&!c&&(b.current=f.contains(f.ownerDocument.activeElement));const E=js(()=>{y&&y.focus&&y.focus()}),$=js(()=>{const A=v.current;let P=o;if(P==null&&(P=d.current&&cM(d.current)?"keyboard":!1),P===!1||P==="keyboard"&&!/^key.+$/.test(A))return;const _=Oi(d.current,r)[0];_&&_.focus&&_.focus()});S.useEffect(()=>{c?$():b.current&&(b.current=!1,E())},[c,b,E,$]),S.useEffect(()=>{v.current=null});const I=(A,P)=>{if(!d.current)return null;const _=Oi(d.current,r);let U=_.indexOf(A)+P;return U=Math.max(0,Math.min(U,_.length)),_[U]};return bK(S.useCallback(()=>l.document,[l]),"keydown",A=>{var P,_;const{key:U}=A,V=A.target,D=(P=d.current)==null?void 0:P.contains(V),W=(_=m.current)==null?void 0:_.contains(V);if(/input|textarea/i.test(V.tagName)&&(U===" "||U!=="Escape"&&D||U==="Escape"&&V.type==="search")||!D&&!W||U==="Tab"&&(!d.current||!c))return;v.current=A.type;const j={originalEvent:A,source:A.type};switch(U){case"ArrowUp":{const G=I(V,-1);G&&G.focus&&G.focus(),A.preventDefault();return}case"ArrowDown":if(A.preventDefault(),!c)u(!0,j);else{const G=I(V,1);G&&G.focus&&G.focus()}return;case"Tab":Sk(V.ownerDocument,"keyup",G=>{var O;(G.key==="Tab"&&!G.target||!((O=d.current)!=null&&O.contains(G.target)))&&u(!1,j)},{once:!0});break;case"Escape":U==="Escape"&&(A.preventDefault(),A.stopPropagation()),u(!1,j);break}}),p.jsx(dc.Provider,{value:k,children:p.jsx(Jy.Provider,{value:N,children:a})})}sp.displayName="Dropdown";sp.Menu=aM;sp.Toggle=dM;sp.Item=fM;const Lk=S.createContext({});Lk.displayName="DropdownContext";const mM=S.forwardRef(({className:t,bsPrefix:e,as:n="hr",role:s="separator",...r},o)=>(e=Le(e,"dropdown-divider"),p.jsx(n,{ref:o,className:Te(t,e),role:s,...r})));mM.displayName="DropdownDivider";const gM=S.forwardRef(({className:t,bsPrefix:e,as:n="div",role:s="heading",...r},o)=>(e=Le(e,"dropdown-header"),p.jsx(n,{ref:o,className:Te(t,e),role:s,...r})));gM.displayName="DropdownHeader";const xM=S.forwardRef(({bsPrefix:t,className:e,eventKey:n,disabled:s=!1,onClick:r,active:o,as:i=Xy,...a},l)=>{const c=Le(t,"dropdown-item"),[u,d]=hM({key:n,href:a.href,disabled:s,onClick:r,active:o});return p.jsx(i,{...a,...u,ref:l,className:Te(e,c,d.isActive&&"active",s&&"disabled")})});xM.displayName="DropdownItem";const yM=S.forwardRef(({className:t,bsPrefix:e,as:n="span",...s},r)=>(e=Le(e,"dropdown-item-text"),p.jsx(n,{ref:r,className:Te(t,e),...s})));yM.displayName="DropdownItemText";const CY=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",SY=typeof document<"u",vM=SY||CY?S.useLayoutEffect:S.useEffect,t0=S.createContext(null);t0.displayName="InputGroupContext";const Dc=S.createContext(null);Dc.displayName="NavbarContext";function bM(t,e){return t}function wM(t,e,n){const s=n?"top-end":"top-start",r=n?"top-start":"top-end",o=n?"bottom-end":"bottom-start",i=n?"bottom-start":"bottom-end",a=n?"right-start":"left-start",l=n?"right-end":"left-end",c=n?"left-start":"right-start",u=n?"left-end":"right-end";let d=t?i:o;return e==="up"?d=t?r:s:e==="end"?d=t?u:c:e==="start"?d=t?l:a:e==="down-centered"?d="bottom":e==="up-centered"&&(d="top"),d}const CM=S.forwardRef(({bsPrefix:t,className:e,align:n,rootCloseEvent:s,flip:r=!0,show:o,renderOnMount:i,as:a="div",popperConfig:l,variant:c,...u},d)=>{let h=!1;const f=S.useContext(Dc),m=Le(t,"dropdown-menu"),{align:g,drop:y,isRTL:x}=S.useContext(Lk);n=n||g;const v=S.useContext(t0),b=[];if(n)if(typeof n=="object"){const A=Object.keys(n);if(A.length){const P=A[0],_=n[P];h=_==="start",b.push(`${m}-${P}-${_}`)}}else n==="end"&&(h=!0);const w=wM(h,y,x),[C,{hasShown:k,popper:N,show:E,toggle:$}]=iM({flip:r,rootCloseEvent:s,show:o,usePopper:!f&&b.length===0,offset:[0,2],popperConfig:l,placement:w});if(C.ref=Ky(bM(d),C.ref),vM(()=>{E&&(N==null||N.update())},[E]),!k&&!i&&!v)return null;typeof a!="string"&&(C.show=E,C.close=()=>$==null?void 0:$(!1),C.align=n);let I=u.style;return N!=null&&N.placement&&(I={...u.style,...C.style},u["x-placement"]=N.placement),p.jsx(a,{...u,...C,style:I,...(b.length||f)&&{"data-bs-popper":"static"},className:Te(e,m,E&&"show",h&&`${m}-end`,c&&`${m}-${c}`,...b)})});CM.displayName="DropdownMenu";const SM=S.forwardRef(({bsPrefix:t,split:e,className:n,childBsPrefix:s,as:r=Ve,...o},i)=>{const a=Le(t,"dropdown-toggle"),l=S.useContext(Jy);s!==void 0&&(o.bsPrefix=s);const[c]=uM();return c.ref=Ky(c.ref,bM(i)),p.jsx(r,{className:Te(n,a,e&&`${a}-split`,(l==null?void 0:l.show)&&"show"),...c,...o})});SM.displayName="DropdownToggle";const kM=S.forwardRef((t,e)=>{const{bsPrefix:n,drop:s="down",show:r,className:o,align:i="start",onSelect:a,onToggle:l,focusFirstItemOnShow:c,as:u="div",navbar:d,autoClose:h=!0,...f}=Jf(t,{show:"onToggle"}),m=S.useContext(t0),g=Le(n,"dropdown"),y=I_(),x=N=>h===!1?N==="click":h==="inside"?N!=="rootClose":h==="outside"?N!=="select":!0,v=Ji((N,E)=>{var $;!(($=E.originalEvent)==null||($=$.target)==null)&&$.classList.contains("dropdown-toggle")&&E.source==="mousedown"||(E.originalEvent.currentTarget===document&&(E.source!=="keydown"||E.originalEvent.key==="Escape")&&(E.source="rootClose"),x(E.source)&&(l==null||l(N,E)))}),w=wM(i==="end",s,y),C=S.useMemo(()=>({align:i,drop:s,isRTL:y}),[i,s,y]),k={down:g,"down-centered":`${g}-center`,up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return p.jsx(Lk.Provider,{value:C,children:p.jsx(sp,{placement:w,show:r,onSelect:a,onToggle:v,focusFirstItemOnShow:c,itemSelector:`.${g}-item:not(.disabled):not(:disabled)`,children:m?f.children:p.jsx(u,{...f,ref:e,className:Te(o,r&&"show",k[s])})})})});kM.displayName="Dropdown";const Nl=Object.assign(kM,{Toggle:SM,Menu:CM,Item:xM,ItemText:yM,Divider:mM,Header:gM}),kY={type:Vi.string,tooltip:Vi.bool,as:Vi.elementType},n0=S.forwardRef(({as:t="div",className:e,type:n="valid",tooltip:s=!1,...r},o)=>p.jsx(t,{...r,ref:o,className:Te(e,`${n}-${s?"tooltip":"feedback"}`)}));n0.displayName="Feedback";n0.propTypes=kY;const Qi=S.createContext({}),rp=S.forwardRef(({id:t,bsPrefix:e,className:n,type:s="checkbox",isValid:r=!1,isInvalid:o=!1,as:i="input",...a},l)=>{const{controlId:c}=S.useContext(Qi);return e=Le(e,"form-check-input"),p.jsx(i,{...a,ref:l,type:s,id:t||c,className:Te(n,e,r&&"is-valid",o&&"is-invalid")})});rp.displayName="FormCheckInput";const Ex=S.forwardRef(({bsPrefix:t,className:e,htmlFor:n,...s},r)=>{const{controlId:o}=S.useContext(Qi);return t=Le(t,"form-check-label"),p.jsx("label",{...s,ref:r,htmlFor:n||o,className:Te(e,t)})});Ex.displayName="FormCheckLabel";const NM=S.forwardRef(({id:t,bsPrefix:e,bsSwitchPrefix:n,inline:s=!1,reverse:r=!1,disabled:o=!1,isValid:i=!1,isInvalid:a=!1,feedbackTooltip:l=!1,feedback:c,feedbackType:u,className:d,style:h,title:f="",type:m="checkbox",label:g,children:y,as:x="input",...v},b)=>{e=Le(e,"form-check"),n=Le(n,"form-switch");const{controlId:w}=S.useContext(Qi),C=S.useMemo(()=>({controlId:t||w}),[w,t]),k=!y&&g!=null&&g!==!1||_K(y,Ex),N=p.jsx(rp,{...v,type:m==="switch"?"checkbox":m,ref:b,isValid:i,isInvalid:a,disabled:o,as:x});return p.jsx(Qi.Provider,{value:C,children:p.jsx("div",{style:h,className:Te(d,k&&e,s&&`${e}-inline`,r&&`${e}-reverse`,m==="switch"&&n),children:y||p.jsxs(p.Fragment,{children:[N,k&&p.jsx(Ex,{title:f,children:g}),c&&p.jsx(n0,{type:u,tooltip:l,children:c})]})})})});NM.displayName="FormCheck";const $x=Object.assign(NM,{Input:rp,Label:Ex}),EM=S.forwardRef(({bsPrefix:t,type:e,size:n,htmlSize:s,id:r,className:o,isValid:i=!1,isInvalid:a=!1,plaintext:l,readOnly:c,as:u="input",...d},h)=>{const{controlId:f}=S.useContext(Qi);return t=Le(t,"form-control"),p.jsx(u,{...d,type:e,size:s,ref:h,readOnly:c,id:r||f,className:Te(o,l?`${t}-plaintext`:t,n&&`${t}-${n}`,e==="color"&&`${t}-color`,i&&"is-valid",a&&"is-invalid")})});EM.displayName="FormControl";const NY=Object.assign(EM,{Feedback:n0}),$M=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"form-floating"),p.jsx(n,{ref:r,className:Te(t,e),...s})));$M.displayName="FormFloating";const jk=S.forwardRef(({controlId:t,as:e="div",...n},s)=>{const r=S.useMemo(()=>({controlId:t}),[t]);return p.jsx(Qi.Provider,{value:r,children:p.jsx(e,{...n,ref:s})})});jk.displayName="FormGroup";const IM=S.forwardRef(({as:t="label",bsPrefix:e,column:n=!1,visuallyHidden:s=!1,className:r,htmlFor:o,...i},a)=>{const{controlId:l}=S.useContext(Qi);e=Le(e,"form-label");let c="col-form-label";typeof n=="string"&&(c=`${c} ${c}-${n}`);const u=Te(r,e,s&&"visually-hidden",n&&c);return o=o||l,n?p.jsx(ve,{ref:a,as:"label",className:u,htmlFor:o,...i}):p.jsx(t,{ref:a,className:u,htmlFor:o,...i})});IM.displayName="FormLabel";const TM=S.forwardRef(({bsPrefix:t,className:e,id:n,...s},r)=>{const{controlId:o}=S.useContext(Qi);return t=Le(t,"form-range"),p.jsx("input",{...s,type:"range",ref:r,className:Te(e,t),id:n||o})});TM.displayName="FormRange";const RM=S.forwardRef(({bsPrefix:t,size:e,htmlSize:n,className:s,isValid:r=!1,isInvalid:o=!1,id:i,...a},l)=>{const{controlId:c}=S.useContext(Qi);return t=Le(t,"form-select"),p.jsx("select",{...a,size:n,ref:l,className:Te(s,t,e&&`${t}-${e}`,r&&"is-valid",o&&"is-invalid"),id:i||c})});RM.displayName="FormSelect";const AM=S.forwardRef(({bsPrefix:t,className:e,as:n="small",muted:s,...r},o)=>(t=Le(t,"form-text"),p.jsx(n,{...r,ref:o,className:Te(e,t,s&&"text-muted")})));AM.displayName="FormText";const DM=S.forwardRef((t,e)=>p.jsx($x,{...t,ref:e,type:"switch"}));DM.displayName="Switch";const EY=Object.assign(DM,{Input:$x.Input,Label:$x.Label}),OM=S.forwardRef(({bsPrefix:t,className:e,children:n,controlId:s,label:r,...o},i)=>(t=Le(t,"form-floating"),p.jsxs(jk,{ref:i,className:Te(e,t),controlId:s,...o,children:[n,p.jsx("label",{htmlFor:s,children:r})]})));OM.displayName="FloatingLabel";const $Y={_ref:Vi.any,validated:Vi.bool,as:Vi.elementType},Bk=S.forwardRef(({className:t,validated:e,as:n="form",...s},r)=>p.jsx(n,{...s,ref:r,className:Te(t,e&&"was-validated")}));Bk.displayName="Form";Bk.propTypes=$Y;const L=Object.assign(Bk,{Group:jk,Control:NY,Floating:$M,Check:$x,Switch:EY,Label:IM,Text:AM,Range:TM,Select:RM,FloatingLabel:OM}),s0=S.forwardRef(({className:t,bsPrefix:e,as:n="span",...s},r)=>(e=Le(e,"input-group-text"),p.jsx(n,{ref:r,className:Te(t,e),...s})));s0.displayName="InputGroupText";const IY=t=>p.jsx(s0,{children:p.jsx(rp,{type:"checkbox",...t})}),TY=t=>p.jsx(s0,{children:p.jsx(rp,{type:"radio",...t})}),FM=S.forwardRef(({bsPrefix:t,size:e,hasValidation:n,className:s,as:r="div",...o},i)=>{t=Le(t,"input-group");const a=S.useMemo(()=>({}),[]);return p.jsx(t0.Provider,{value:a,children:p.jsx(r,{ref:i,...o,className:Te(s,t,e&&`${t}-${e}`,n&&"has-validation")})})});FM.displayName="InputGroup";const DT=Object.assign(FM,{Text:s0,Radio:TY,Checkbox:IY}),OT=t=>!t||typeof t=="function"?t:e=>{t.current=e};function RY(t,e){const n=OT(t),s=OT(e);return r=>{n&&n(r),s&&s(r)}}function r0(t,e){return S.useMemo(()=>RY(t,e),[t,e])}const PM=S.createContext(null),AY=["as","active","eventKey"];function DY(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function zk({key:t,onClick:e,active:n,id:s,role:r,disabled:o}){const i=S.useContext(dc),a=S.useContext(Qy),l=S.useContext(PM);let c=n;const u={role:r};if(a){!r&&a.role==="tablist"&&(u.role="tab");const d=a.getControllerId(t??null),h=a.getControlledId(t??null);u[Sd("event-key")]=t,u.id=d||s,c=n==null&&t!=null?a.activeKey===t:n,(c||!(l!=null&&l.unmountOnExit)&&!(l!=null&&l.mountOnEnter))&&(u["aria-controls"]=h)}return u.role==="tab"&&(u["aria-selected"]=c,c||(u.tabIndex=-1),o&&(u.tabIndex=-1,u["aria-disabled"]=!0)),u.onClick=js(d=>{o||(e==null||e(d),t!=null&&i&&!d.isPropagationStopped()&&i(t,d))}),[u,{isActive:c}]}const _M=S.forwardRef((t,e)=>{let{as:n=$k,active:s,eventKey:r}=t,o=DY(t,AY);const[i,a]=zk(Object.assign({key:qu(r,o.href),active:s},o));return i[Sd("active")]=a.isActive,p.jsx(n,Object.assign({},o,i,{ref:e}))});_M.displayName="NavItem";const OY=["as","onSelect","activeKey","role","onKeyDown"];function FY(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}const FT=()=>{},PT=Sd("event-key"),MM=S.forwardRef((t,e)=>{let{as:n="div",onSelect:s,activeKey:r,role:o,onKeyDown:i}=t,a=FY(t,OY);const l=Y_(),c=S.useRef(!1),u=S.useContext(dc),d=S.useContext(PM);let h,f;d&&(o=o||"tablist",r=d.activeKey,h=d.getControlledId,f=d.getControllerId);const m=S.useRef(null),g=b=>{const w=m.current;if(!w)return null;const C=Oi(w,`[${PT}]:not([aria-disabled=true])`),k=w.querySelector("[aria-selected=true]");if(!k||k!==document.activeElement)return null;const N=C.indexOf(k);if(N===-1)return null;let E=N+b;return E>=C.length&&(E=0),E<0&&(E=C.length-1),C[E]},y=(b,w)=>{b!=null&&(s==null||s(b,w),u==null||u(b,w))},x=b=>{if(i==null||i(b),!d)return;let w;switch(b.key){case"ArrowLeft":case"ArrowUp":w=g(-1);break;case"ArrowRight":case"ArrowDown":w=g(1);break;default:return}w&&(b.preventDefault(),y(w.dataset[vY("EventKey")]||null,b),c.current=!0,l())};S.useEffect(()=>{if(m.current&&c.current){const b=m.current.querySelector(`[${PT}][aria-selected=true]`);b==null||b.focus()}c.current=!1});const v=r0(e,m);return p.jsx(dc.Provider,{value:y,children:p.jsx(Qy.Provider,{value:{role:o,activeKey:qu(r),getControlledId:h||FT,getControllerId:f||FT},children:p.jsx(n,Object.assign({},a,{onKeyDown:x,ref:v,role:o}))})})});MM.displayName="Nav";const LM=Object.assign(MM,{Item:_M}),jM=S.forwardRef(({bsPrefix:t,active:e,disabled:n,eventKey:s,className:r,variant:o,action:i,as:a,...l},c)=>{t=Le(t,"list-group-item");const[u,d]=zk({key:qu(s,l.href),active:e,...l}),h=Ji(m=>{if(n){m.preventDefault(),m.stopPropagation();return}u.onClick(m)});n&&l.tabIndex===void 0&&(l.tabIndex=-1,l["aria-disabled"]=!0);const f=a||(i?l.href?"a":"button":"div");return p.jsx(f,{ref:c,...l,...u,onClick:h,className:Te(r,t,d.isActive&&"active",n&&"disabled",o&&`${t}-${o}`,i&&`${t}-action`)})});jM.displayName="ListGroupItem";const BM=S.forwardRef((t,e)=>{const{className:n,bsPrefix:s,variant:r,horizontal:o,numbered:i,as:a="div",...l}=Jf(t,{activeKey:"onSelect"}),c=Le(s,"list-group");let u;return o&&(u=o===!0?"horizontal":`horizontal-${o}`),p.jsx(LM,{ref:e,...l,as:a,className:Te(n,c,r&&`${c}-${r}`,u&&`${c}-${u}`,i&&`${c}-numbered`)})});BM.displayName="ListGroup";const _T=Object.assign(BM,{Item:jM});var Km;function MT(t){if((!Km&&Km!==0||t)&&Cd){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),Km=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Km}function PY(){return S.useState(null)}function jb(t){t===void 0&&(t=Qf());try{var e=t.activeElement;return!e||!e.nodeName?null:e}catch{return t.body}}function _Y(t){const e=S.useRef(t);return e.current=t,e}function MY(t){const e=_Y(t);S.useEffect(()=>()=>e.current(),[])}function LY(t=document){const e=t.defaultView;return Math.abs(e.innerWidth-t.documentElement.clientWidth)}const LT=Sd("modal-open");class Uk{constructor({ownerDocument:e,handleContainerOverflow:n=!0,isRTL:s=!1}={}){this.handleContainerOverflow=n,this.isRTL=s,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return LY(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const n={overflow:"hidden"},s=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();e.style={overflow:r.style.overflow,[s]:r.style[s]},e.scrollBarWidth&&(n[s]=`${parseInt(Ui(r,s)||"0",10)+e.scrollBarWidth}px`),r.setAttribute(LT,""),Ui(r,n)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const n=this.getElement();n.removeAttribute(LT),Object.assign(n.style,e.style)}add(e){let n=this.modals.indexOf(e);return n!==-1||(n=this.modals.length,this.modals.push(e),this.setModalAttributes(e),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(e){const n=this.modals.indexOf(e);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const Bb=(t,e)=>Cd?t==null?(e||Qf()).body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),t&&("nodeType"in t||t.getBoundingClientRect)?t:null):null;function jY(t,e){const n=e0(),[s,r]=S.useState(()=>Bb(t,n==null?void 0:n.document));if(!s){const o=Bb(t);o&&r(o)}return S.useEffect(()=>{},[e,s]),S.useEffect(()=>{const o=Bb(t);o!==s&&r(o)},[t,s]),s}function BY({children:t,in:e,onExited:n,mountOnEnter:s,unmountOnExit:r}){const o=S.useRef(null),i=S.useRef(e),a=js(n);S.useEffect(()=>{e?i.current=!0:a(o.current)},[e,a]);const l=r0(o,wd(t)),c=S.cloneElement(t,{ref:l});return e?c:r||!i.current&&s?null:c}const zY=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function UY(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function VY(t){let{onEnter:e,onEntering:n,onEntered:s,onExit:r,onExiting:o,onExited:i,addEndListener:a,children:l}=t,c=UY(t,zY);const u=S.useRef(null),d=r0(u,wd(l)),h=w=>C=>{w&&u.current&&w(u.current,C)},f=S.useCallback(h(e),[e]),m=S.useCallback(h(n),[n]),g=S.useCallback(h(s),[s]),y=S.useCallback(h(r),[r]),x=S.useCallback(h(o),[o]),v=S.useCallback(h(i),[i]),b=S.useCallback(h(a),[a]);return Object.assign({},c,{nodeRef:u},e&&{onEnter:f},n&&{onEntering:m},s&&{onEntered:g},r&&{onExit:y},o&&{onExiting:x},i&&{onExited:v},a&&{addEndListener:b},{children:typeof l=="function"?(w,C)=>l(w,Object.assign({},C,{ref:d})):S.cloneElement(l,{ref:d})})}const WY=["component"];function HY(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}const GY=S.forwardRef((t,e)=>{let{component:n}=t,s=HY(t,WY);const r=VY(s);return p.jsx(n,Object.assign({ref:e},r))});function qY({in:t,onTransition:e}){const n=S.useRef(null),s=S.useRef(!0),r=js(e);return gT(()=>{if(!n.current)return;let o=!1;return r({in:t,element:n.current,initial:s.current,isStale:()=>o}),()=>{o=!0}},[t,r]),gT(()=>(s.current=!1,()=>{s.current=!0}),[]),n}function KY({children:t,in:e,onExited:n,onEntered:s,transition:r}){const[o,i]=S.useState(!e);e&&o&&i(!1);const a=qY({in:!!e,onTransition:c=>{const u=()=>{c.isStale()||(c.in?s==null||s(c.element,c.initial):(i(!0),n==null||n(c.element)))};Promise.resolve(r(c)).then(u,d=>{throw c.in||i(!0),d})}}),l=r0(a,wd(t));return o&&!e?null:S.cloneElement(t,{ref:l})}function jT(t,e,n){return t?p.jsx(GY,Object.assign({},n,{component:t})):e?p.jsx(KY,Object.assign({},n,{transition:e})):p.jsx(BY,Object.assign({},n))}const XY=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function YY(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}let zb;function JY(t){return zb||(zb=new Uk({ownerDocument:t==null?void 0:t.document})),zb}function ZY(t){const e=e0(),n=t||JY(e),s=S.useRef({dialog:null,backdrop:null});return Object.assign(s.current,{add:()=>n.add(s.current),remove:()=>n.remove(s.current),isTopModal:()=>n.isTopModal(s.current),setDialogRef:S.useCallback(r=>{s.current.dialog=r},[]),setBackdropRef:S.useCallback(r=>{s.current.backdrop=r},[])})}const zM=S.forwardRef((t,e)=>{let{show:n=!1,role:s="dialog",className:r,style:o,children:i,backdrop:a=!0,keyboard:l=!0,onBackdropClick:c,onEscapeKeyDown:u,transition:d,runTransition:h,backdropTransition:f,runBackdropTransition:m,autoFocus:g=!0,enforceFocus:y=!0,restoreFocus:x=!0,restoreFocusOptions:v,renderDialog:b,renderBackdrop:w=je=>p.jsx("div",Object.assign({},je)),manager:C,container:k,onShow:N,onHide:E=()=>{},onExit:$,onExited:I,onExiting:A,onEnter:P,onEntering:_,onEntered:U}=t,V=YY(t,XY);const D=e0(),W=jY(k),R=ZY(C),j=M_(),G=L_(n),[O,B]=S.useState(!n),z=S.useRef(null);S.useImperativeHandle(e,()=>R,[R]),Cd&&!G&&n&&(z.current=jb(D==null?void 0:D.document)),n&&O&&B(!1);const K=js(()=>{if(R.add(),Ce.current=Aa(document,"keydown",pe),we.current=Aa(document,"focus",()=>setTimeout(re),!0),N&&N(),g){var je,rt;const ue=jb((je=(rt=R.dialog)==null?void 0:rt.ownerDocument)!=null?je:D==null?void 0:D.document);R.dialog&&ue&&!Nx(R.dialog,ue)&&(z.current=ue,R.dialog.focus())}}),J=js(()=>{if(R.remove(),Ce.current==null||Ce.current(),we.current==null||we.current(),x){var je;(je=z.current)==null||je.focus==null||je.focus(v),z.current=null}});S.useEffect(()=>{!n||!W||K()},[n,W,K]),S.useEffect(()=>{O&&J()},[O,J]),MY(()=>{J()});const re=js(()=>{if(!y||!j()||!R.isTopModal())return;const je=jb(D==null?void 0:D.document);R.dialog&&je&&!Nx(R.dialog,je)&&R.dialog.focus()}),de=js(je=>{je.target===je.currentTarget&&(c==null||c(je),a===!0&&E())}),pe=js(je=>{l&&iK(je)&&R.isTopModal()&&(u==null||u(je),je.defaultPrevented||E())}),we=S.useRef(),Ce=S.useRef(),Ne=(...je)=>{B(!0),I==null||I(...je)};if(!W)return null;const ze=Object.assign({role:s,ref:R.setDialogRef,"aria-modal":s==="dialog"?!0:void 0},V,{style:o,className:r,tabIndex:-1});let _e=b?b(ze):p.jsx("div",Object.assign({},ze,{children:S.cloneElement(i,{role:"document"})}));_e=jT(d,h,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:$,onExiting:A,onExited:Ne,onEnter:P,onEntering:_,onEntered:U,children:_e});let st=null;return a&&(st=w({ref:R.setBackdropRef,onClick:de}),st=jT(f,m,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:st})),p.jsx(p.Fragment,{children:yu.createPortal(p.jsxs(p.Fragment,{children:[st,_e]}),W)})});zM.displayName="Modal";const UM=Object.assign(zM,{Manager:Uk});function QY(t,e){return t.classList?t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function eJ(t,e){t.classList?t.classList.add(e):QY(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function BT(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function tJ(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=BT(t.className,e):t.setAttribute("class",BT(t.className&&t.className.baseVal||"",e))}const Kc={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class VM extends Uk{adjustAndStore(e,n,s){const r=n.style[e];n.dataset[e]=r,Ui(n,{[e]:`${parseFloat(Ui(n,e))+s}px`})}restore(e,n){const s=n.dataset[e];s!==void 0&&(delete n.dataset[e],Ui(n,{[e]:s}))}setContainerStyle(e){super.setContainerStyle(e);const n=this.getElement();if(eJ(n,"modal-open"),!e.scrollBarWidth)return;const s=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";Oi(n,Kc.FIXED_CONTENT).forEach(o=>this.adjustAndStore(s,o,e.scrollBarWidth)),Oi(n,Kc.STICKY_CONTENT).forEach(o=>this.adjustAndStore(r,o,-e.scrollBarWidth)),Oi(n,Kc.NAVBAR_TOGGLER).forEach(o=>this.adjustAndStore(r,o,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const n=this.getElement();tJ(n,"modal-open");const s=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";Oi(n,Kc.FIXED_CONTENT).forEach(o=>this.restore(s,o)),Oi(n,Kc.STICKY_CONTENT).forEach(o=>this.restore(r,o)),Oi(n,Kc.NAVBAR_TOGGLER).forEach(o=>this.restore(r,o))}}let Ub;function WM(t){return Ub||(Ub=new VM(t)),Ub}const HM=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"modal-body"),p.jsx(n,{ref:r,className:Te(t,e),...s})));HM.displayName="ModalBody";const Vk=S.createContext({onHide(){}}),Wk=S.forwardRef(({bsPrefix:t,className:e,contentClassName:n,centered:s,size:r,fullscreen:o,children:i,scrollable:a,...l},c)=>{t=Le(t,"modal");const u=`${t}-dialog`,d=typeof o=="string"?`${t}-fullscreen-${o}`:`${t}-fullscreen`;return p.jsx("div",{...l,ref:c,className:Te(u,e,r&&`${t}-${r}`,s&&`${u}-centered`,a&&`${u}-scrollable`,o&&d),children:p.jsx("div",{className:Te(`${t}-content`,n),children:i})})});Wk.displayName="ModalDialog";const GM=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"modal-footer"),p.jsx(n,{ref:r,className:Te(t,e),...s})));GM.displayName="ModalFooter";const qM=S.forwardRef(({closeLabel:t="Close",closeVariant:e,closeButton:n=!1,onHide:s,children:r,...o},i)=>{const a=S.useContext(Vk),l=Ji(()=>{a==null||a.onHide(),s==null||s()});return p.jsxs("div",{ref:i,...o,children:[r,n&&p.jsx(Yy,{"aria-label":t,variant:e,onClick:l})]})}),KM=S.forwardRef(({bsPrefix:t,className:e,closeLabel:n="Close",closeButton:s=!1,...r},o)=>(t=Le(t,"modal-header"),p.jsx(qM,{ref:o,...r,className:Te(e,t),closeLabel:n,closeButton:s})));KM.displayName="ModalHeader";const nJ=ep("h4"),XM=S.forwardRef(({className:t,bsPrefix:e,as:n=nJ,...s},r)=>(e=Le(e,"modal-title"),p.jsx(n,{ref:r,className:Te(t,e),...s})));XM.displayName="ModalTitle";function sJ(t){return p.jsx(Uu,{...t,timeout:null})}function rJ(t){return p.jsx(Uu,{...t,timeout:null})}const YM=S.forwardRef(({bsPrefix:t,className:e,style:n,dialogClassName:s,contentClassName:r,children:o,dialogAs:i=Wk,"data-bs-theme":a,"aria-labelledby":l,"aria-describedby":c,"aria-label":u,show:d=!1,animation:h=!0,backdrop:f=!0,keyboard:m=!0,onEscapeKeyDown:g,onShow:y,onHide:x,container:v,autoFocus:b=!0,enforceFocus:w=!0,restoreFocus:C=!0,restoreFocusOptions:k,onEntered:N,onExit:E,onExiting:$,onEnter:I,onEntering:A,onExited:P,backdropClassName:_,manager:U,...V},D)=>{const[W,R]=S.useState({}),[j,G]=S.useState(!1),O=S.useRef(!1),B=S.useRef(!1),z=S.useRef(null),[K,J]=PY(),re=Ky(D,J),de=Ji(x),pe=I_();t=Le(t,"modal");const we=S.useMemo(()=>({onHide:de}),[de]);function Ce(){return U||WM({isRTL:pe})}function Ne(it){if(!Cd)return;const Qn=Ce().getScrollbarWidth()>0,fr=it.scrollHeight>Qf(it).documentElement.clientHeight;R({paddingRight:Qn&&!fr?MT():void 0,paddingLeft:!Qn&&fr?MT():void 0})}const ze=Ji(()=>{K&&Ne(K.dialog)});FK(()=>{lC(window,"resize",ze),z.current==null||z.current()});const _e=()=>{O.current=!0},st=it=>{O.current&&K&&it.target===K.dialog&&(B.current=!0),O.current=!1},je=()=>{G(!0),z.current=O_(K.dialog,()=>{G(!1)})},rt=it=>{it.target===it.currentTarget&&je()},ue=it=>{if(f==="static"){rt(it);return}if(B.current||it.target!==it.currentTarget){B.current=!1;return}x==null||x()},Ue=it=>{m?g==null||g(it):(it.preventDefault(),f==="static"&&je())},sn=(it,Qn)=>{it&&Ne(it),I==null||I(it,Qn)},gt=it=>{z.current==null||z.current(),E==null||E(it)},Jn=(it,Qn)=>{A==null||A(it,Qn),Sk(window,"resize",ze)},pn=it=>{it&&(it.style.display=""),P==null||P(it),lC(window,"resize",ze)},Zn=S.useCallback(it=>p.jsx("div",{...it,className:Te(`${t}-backdrop`,_,!h&&"show")}),[h,_,t]),Vn={...n,...W};Vn.display="block";const hr=it=>p.jsx("div",{role:"dialog",...it,style:Vn,className:Te(e,t,j&&`${t}-static`,!h&&"show"),onClick:f?ue:void 0,onMouseUp:st,"data-bs-theme":a,"aria-label":u,"aria-labelledby":l,"aria-describedby":c,children:p.jsx(i,{...V,onMouseDown:_e,className:s,contentClassName:r,children:o})});return p.jsx(Vk.Provider,{value:we,children:p.jsx(UM,{show:d,ref:re,backdrop:f,container:v,keyboard:!0,autoFocus:b,enforceFocus:w,restoreFocus:C,restoreFocusOptions:k,onEscapeKeyDown:Ue,onShow:y,onHide:x,onEnter:sn,onEntering:Jn,onEntered:N,onExit:gt,onExiting:$,onExited:pn,manager:Ce(),transition:h?sJ:void 0,backdropTransition:h?rJ:void 0,renderBackdrop:Zn,renderDialog:hr})})});YM.displayName="Modal";const Qt=Object.assign(YM,{Body:HM,Header:KM,Title:XM,Footer:GM,Dialog:Wk,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),JM=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"nav-item"),p.jsx(n,{ref:r,className:Te(t,e),...s})));JM.displayName="NavItem";const ZM=S.forwardRef(({bsPrefix:t,className:e,as:n=Xy,active:s,eventKey:r,disabled:o=!1,...i},a)=>{t=Le(t,"nav-link");const[l,c]=zk({key:qu(r,i.href),active:s,disabled:o,...i});return p.jsx(n,{...i,...l,ref:a,disabled:o,className:Te(e,t,o&&"disabled",c.isActive&&"active")})});ZM.displayName="NavLink";const QM=S.forwardRef((t,e)=>{const{as:n="div",bsPrefix:s,variant:r,fill:o=!1,justify:i=!1,navbar:a,navbarScroll:l,className:c,activeKey:u,...d}=Jf(t,{activeKey:"onSelect"}),h=Le(s,"nav");let f,m,g=!1;const y=S.useContext(Dc),x=S.useContext(Tk);return y?(f=y.bsPrefix,g=a??!0):x&&({cardHeaderBsPrefix:m}=x),p.jsx(LM,{as:n,ref:e,activeKey:u,className:Te(c,{[h]:!g,[`${f}-nav`]:g,[`${f}-nav-scroll`]:g&&l,[`${m}-${r}`]:!!m,[`${h}-${r}`]:!!r,[`${h}-fill`]:o,[`${h}-justified`]:i}),...d})});QM.displayName="Nav";const zt=Object.assign(QM,{Item:JM,Link:ZM}),eL=S.forwardRef(({bsPrefix:t,className:e,as:n,...s},r)=>{t=Le(t,"navbar-brand");const o=n||(s.href?"a":"span");return p.jsx(o,{...s,ref:r,className:Te(e,t)})});eL.displayName="NavbarBrand";const tL=S.forwardRef(({children:t,bsPrefix:e,...n},s)=>{e=Le(e,"navbar-collapse");const r=S.useContext(Dc);return p.jsx(gK,{in:!!(r&&r.expanded),...n,children:p.jsx("div",{ref:s,className:e,children:t})})});tL.displayName="NavbarCollapse";const nL=S.forwardRef(({bsPrefix:t,className:e,children:n,label:s="Toggle navigation",as:r="button",onClick:o,...i},a)=>{t=Le(t,"navbar-toggler");const{onToggle:l,expanded:c}=S.useContext(Dc)||{},u=Ji(d=>{o&&o(d),l&&l()});return r==="button"&&(i.type="button"),p.jsx(r,{...i,ref:a,onClick:u,"aria-label":s,className:Te(e,t,!c&&"collapsed"),children:n||p.jsx("span",{className:`${t}-icon`})})});nL.displayName="NavbarToggle";const dC=new WeakMap,zT=(t,e)=>{if(!t||!e)return;const n=dC.get(e)||new Map;dC.set(e,n);let s=n.get(t);return s||(s=e.matchMedia(t),s.refCount=0,n.set(s.media,s)),s};function oJ(t,e=typeof window>"u"?void 0:window){const n=zT(t,e),[s,r]=S.useState(()=>n?n.matches:!1);return vM(()=>{let o=zT(t,e);if(!o)return r(!1);let i=dC.get(e);const a=()=>{r(o.matches)};return o.refCount++,o.addListener(a),a(),()=>{o.removeListener(a),o.refCount--,o.refCount<=0&&(i==null||i.delete(o.media)),o=void 0}},[t]),s}function iJ(t){const e=Object.keys(t);function n(a,l){return a===l?l:a?`${a} and ${l}`:l}function s(a){return e[Math.min(e.indexOf(a)+1,e.length-1)]}function r(a){const l=s(a);let c=t[l];return typeof c=="number"?c=`${c-.2}px`:c=`calc(${c} - 0.2px)`,`(max-width: ${c})`}function o(a){let l=t[a];return typeof l=="number"&&(l=`${l}px`),`(min-width: ${l})`}function i(a,l,c){let u;typeof a=="object"?(u=a,c=l,l=!0):(l=l||!0,u={[a]:l});let d=S.useMemo(()=>Object.entries(u).reduce((h,[f,m])=>((m==="up"||m===!0)&&(h=n(h,o(f))),(m==="down"||m===!0)&&(h=n(h,r(f))),h),""),[JSON.stringify(u)]);return oJ(d,c)}return i}const aJ=iJ({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),sL=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=Le(e,"offcanvas-body"),p.jsx(n,{ref:r,className:Te(t,e),...s})));sL.displayName="OffcanvasBody";const lJ={[Po]:"show",[Pi]:"show"},rL=S.forwardRef(({bsPrefix:t,className:e,children:n,in:s=!1,mountOnEnter:r=!1,unmountOnExit:o=!1,appear:i=!1,...a},l)=>(t=Le(t,"offcanvas"),p.jsx(Nk,{ref:l,addEndListener:kk,in:s,mountOnEnter:r,unmountOnExit:o,appear:i,...a,childRef:wd(n),children:(c,u)=>S.cloneElement(n,{...u,className:Te(e,n.props.className,(c===Po||c===xf)&&`${t}-toggling`,lJ[c])})})));rL.displayName="OffcanvasToggling";const oL=S.forwardRef(({bsPrefix:t,className:e,closeLabel:n="Close",closeButton:s=!1,...r},o)=>(t=Le(t,"offcanvas-header"),p.jsx(qM,{ref:o,...r,className:Te(e,t),closeLabel:n,closeButton:s})));oL.displayName="OffcanvasHeader";const cJ=ep("h5"),iL=S.forwardRef(({className:t,bsPrefix:e,as:n=cJ,...s},r)=>(e=Le(e,"offcanvas-title"),p.jsx(n,{ref:r,className:Te(t,e),...s})));iL.displayName="OffcanvasTitle";function uJ(t){return p.jsx(rL,{...t})}function dJ(t){return p.jsx(Uu,{...t})}const aL=S.forwardRef(({bsPrefix:t,className:e,children:n,"aria-labelledby":s,placement:r="start",responsive:o,show:i=!1,backdrop:a=!0,keyboard:l=!0,scroll:c=!1,onEscapeKeyDown:u,onShow:d,onHide:h,container:f,autoFocus:m=!0,enforceFocus:g=!0,restoreFocus:y=!0,restoreFocusOptions:x,onEntered:v,onExit:b,onExiting:w,onEnter:C,onEntering:k,onExited:N,backdropClassName:E,manager:$,renderStaticNode:I=!1,...A},P)=>{const _=S.useRef();t=Le(t,"offcanvas");const[U,V]=S.useState(!1),D=Ji(h),W=aJ(o||"xs","up");S.useEffect(()=>{V(o?i&&!W:i)},[i,o,W]);const R=S.useMemo(()=>({onHide:D}),[D]);function j(){return $||(c?(_.current||(_.current=new VM({handleContainerOverflow:!1})),_.current):WM())}const G=(K,...J)=>{K&&(K.style.visibility="visible"),C==null||C(K,...J)},O=(K,...J)=>{K&&(K.style.visibility=""),N==null||N(...J)},B=S.useCallback(K=>p.jsx("div",{...K,className:Te(`${t}-backdrop`,E)}),[E,t]),z=K=>p.jsx("div",{...K,...A,className:Te(e,o?`${t}-${o}`:t,`${t}-${r}`),"aria-labelledby":s,children:n});return p.jsxs(p.Fragment,{children:[!U&&(o||I)&&z({}),p.jsx(Vk.Provider,{value:R,children:p.jsx(UM,{show:U,ref:P,backdrop:a,container:f,keyboard:l,autoFocus:m,enforceFocus:g&&!c,restoreFocus:y,restoreFocusOptions:x,onEscapeKeyDown:u,onShow:d,onHide:D,onEnter:G,onEntering:k,onEntered:v,onExit:b,onExiting:w,onExited:O,manager:j(),transition:uJ,backdropTransition:dJ,renderBackdrop:B,renderDialog:z})})]})});aL.displayName="Offcanvas";const hJ=Object.assign(aL,{Body:sL,Header:oL,Title:iL}),lL=S.forwardRef(({onHide:t,...e},n)=>{const s=S.useContext(Dc),r=Ji(()=>{s==null||s.onToggle==null||s.onToggle(),t==null||t()});return p.jsx(hJ,{ref:n,show:!!(s!=null&&s.expanded),...e,renderStaticNode:!0,onHide:r})});lL.displayName="NavbarOffcanvas";const cL=S.forwardRef(({className:t,bsPrefix:e,as:n="span",...s},r)=>(e=Le(e,"navbar-text"),p.jsx(n,{ref:r,className:Te(t,e),...s})));cL.displayName="NavbarText";const uL=S.forwardRef((t,e)=>{const{bsPrefix:n,expand:s=!0,variant:r="light",bg:o,fixed:i,sticky:a,className:l,as:c="nav",expanded:u,onToggle:d,onSelect:h,collapseOnSelect:f=!1,...m}=Jf(t,{expanded:"onToggle"}),g=Le(n,"navbar"),y=S.useCallback((...b)=>{h==null||h(...b),f&&u&&(d==null||d(!1))},[h,f,u,d]);m.role===void 0&&c!=="nav"&&(m.role="navigation");let x=`${g}-expand`;typeof s=="string"&&(x=`${x}-${s}`);const v=S.useMemo(()=>({onToggle:()=>d==null?void 0:d(!u),bsPrefix:g,expanded:!!u,expand:s}),[g,u,s,d]);return p.jsx(Dc.Provider,{value:v,children:p.jsx(dc.Provider,{value:y,children:p.jsx(c,{ref:e,...m,className:Te(l,g,s&&x,r&&`${g}-${r}`,o&&`bg-${o}`,a&&`sticky-${a}`,i&&`fixed-${i}`)})})})});uL.displayName="Navbar";const Xm=Object.assign(uL,{Brand:eL,Collapse:tL,Offcanvas:lL,Text:cL,Toggle:nL}),UT=1e3;function fJ(t,e,n){const s=(t-e)/(n-e)*100;return Math.round(s*UT)/UT}function VT({min:t,now:e,max:n,label:s,visuallyHidden:r,striped:o,animated:i,className:a,style:l,variant:c,bsPrefix:u,...d},h){return p.jsx("div",{ref:h,...d,role:"progressbar",className:Te(a,`${u}-bar`,{[`bg-${c}`]:c,[`${u}-bar-animated`]:i,[`${u}-bar-striped`]:i||o}),style:{width:`${fJ(e,t,n)}%`,...l},"aria-valuenow":e,"aria-valuemin":t,"aria-valuemax":n,children:r?p.jsx("span",{className:"visually-hidden",children:s}):s})}const Hk=S.forwardRef(({isChild:t=!1,...e},n)=>{const s={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...e};if(s.bsPrefix=Le(s.bsPrefix,"progress"),t)return VT(s,n);const{min:r,now:o,max:i,label:a,visuallyHidden:l,striped:c,animated:u,bsPrefix:d,variant:h,className:f,children:m,...g}=s;return p.jsx("div",{ref:n,...g,className:Te(f,d),children:m?PK(m,y=>S.cloneElement(y,{isChild:!0})):VT({min:r,now:o,max:i,label:a,visuallyHidden:l,striped:c,animated:u,bsPrefix:d,variant:h},n)})});Hk.displayName="ProgressBar";const ot=S.forwardRef(({bsPrefix:t,className:e,as:n="div",...s},r)=>{const o=Le(t,"row"),i=E_(),a=$_(),l=`${o}-cols`,c=[];return i.forEach(u=>{const d=s[u];delete s[u];let h;d!=null&&typeof d=="object"?{cols:h}=d:h=d;const f=u!==a?`-${u}`:"";h!=null&&c.push(`${l}${f}-${h}`)}),p.jsx(n,{ref:r,...s,className:Te(e,o,...c)})});ot.displayName="Row";const ir=S.forwardRef(({bsPrefix:t,variant:e,animation:n="border",size:s,as:r="div",className:o,...i},a)=>{t=Le(t,"spinner");const l=`${t}-${n}`;return p.jsx(r,{ref:a,...i,className:Te(o,l,s&&`${l}-${s}`,e&&`text-${e}`)})});ir.displayName="Spinner";const bf=S.forwardRef(({bsPrefix:t,className:e,striped:n,bordered:s,borderless:r,hover:o,size:i,variant:a,responsive:l,...c},u)=>{const d=Le(t,"table"),h=Te(e,d,a&&`${d}-${a}`,i&&`${d}-${i}`,n&&`${d}-${typeof n=="string"?`striped-${n}`:"striped"}`,s&&`${d}-bordered`,r&&`${d}-borderless`,o&&`${d}-hover`),f=p.jsx("table",{...c,className:h,ref:u});if(l){let m=`${d}-responsive`;return typeof l=="string"&&(m=`${m}-${l}`),p.jsx("div",{className:m,children:f})}return f});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pJ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mJ=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ze=(t,e)=>{const n=S.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:a="",children:l,...c},u)=>S.createElement("svg",{ref:u,...pJ,width:r,height:r,stroke:s,strokeWidth:i?Number(o)*24/Number(r):o,className:["lucide",`lucide-${mJ(t)}`,a].join(" "),...c},[...e.map(([d,h])=>S.createElement(d,h)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gJ=Ze("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dL=Ze("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xJ=Ze("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=Ze("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=Ze("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=Ze("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yJ=Ze("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vJ=Ze("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=Ze("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bJ=Ze("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cf=Ze("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hL=Ze("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=Ze("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fL=Ze("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wJ=Ze("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CJ=Ze("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SJ=Ze("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kJ=Ze("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pL=Ze("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NJ=Ze("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EJ=Ze("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $J=Ze("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mL=Ze("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gL=Ze("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=Ze("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=Ze("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IJ=Ze("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=Ze("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=Ze("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TJ=Ze("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RJ=Ze("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AJ=Ze("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DJ=Ze("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OJ=Ze("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=Ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FJ=Ze("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PJ=Ze("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _J=Ze("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=Ze("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MJ=Ze("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xL=Ze("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=Ze("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LJ=Ze("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jJ=Ze("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=Ze("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=Ze("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yL=Ze("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function BJ(){const{user:t,logout:e}=Hs(),n=(t==null?void 0:t.role)==="freelancer",s=()=>{e()};return p.jsx(Xm,{bg:"white",expand:"lg",className:"shadow-sm",children:p.jsxs(Kt,{children:[p.jsx(Xm.Brand,{as:ms,to:"/",className:"text-primary font-bold text-2xl",children:"GrowGig"}),p.jsx(Xm.Toggle,{"aria-controls":"basic-navbar-nav"}),p.jsxs(Xm.Collapse,{id:"basic-navbar-nav",children:[p.jsxs(zt,{className:"me-auto",children:[t&&p.jsxs(zt.Link,{as:ms,to:"/dashboard",className:"d-flex align-items-center",children:[p.jsx(mL,{size:18,className:"me-2"}),"Dashboard"]}),n?p.jsx(zt.Link,{as:ms,to:"/find-projects",children:"Find Projects"}):t&&p.jsx(zt.Link,{as:ms,to:"/find-candidates",children:"Find Candidates"})]}),p.jsxs(zt,{className:"d-flex align-items-center gap-3",children:[p.jsxs(zt.Link,{href:"tel:+1234567890",className:"d-flex align-items-center gap-1",children:[p.jsx(RJ,{size:18}),p.jsx("span",{children:"+1 (234) 567-890"})]}),p.jsxs(zt.Link,{href:"#",className:"d-flex align-items-center gap-1",children:[p.jsx(pL,{size:18}),p.jsx("span",{children:"EN"})]}),t?p.jsxs(Nl,{align:"end",children:[p.jsxs(Nl.Toggle,{variant:"light",className:"d-flex align-items-center gap-2",children:[p.jsx(qT,{size:18}),t.firstName]}),p.jsxs(Nl.Menu,{children:[p.jsx(Nl.Item,{as:ms,to:"/dashboard",children:"Dashboard"}),p.jsx(Nl.Item,{as:ms,to:"/dashboard/profile",children:"Profile"}),p.jsx(Nl.Divider,{}),p.jsxs(Nl.Item,{onClick:s,className:"text-danger",children:[p.jsx(IJ,{size:18,className:"me-2"}),"Sign Out"]})]})]}):p.jsxs(zt.Link,{as:ms,to:"/login",className:"btn btn-primary text-white",children:[p.jsx(qT,{size:18,className:"me-1"}),"Sign In"]})]})]})]})})}function zJ(){return p.jsx("footer",{className:"bg-gray-50 py-8 mt-auto",children:p.jsxs(Kt,{children:[p.jsxs(ot,{className:"mb-4",children:[p.jsxs(ve,{md:3,children:[p.jsx("h5",{className:"text-primary font-bold mb-3",children:"GrowGig"}),p.jsx("p",{className:"text-gray-600",children:"Connect with top freelancers and employers worldwide."})]}),p.jsxs(ve,{md:3,children:[p.jsx("h6",{className:"font-semibold mb-3",children:"For Freelancers"}),p.jsxs("ul",{className:"list-unstyled",children:[p.jsx("li",{children:p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:"Find Projects"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:"Create Profile"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:"Find Employers"})})]})]}),p.jsxs(ve,{md:3,children:[p.jsx("h6",{className:"font-semibold mb-3",children:"For Employers"}),p.jsxs("ul",{className:"list-unstyled",children:[p.jsx("li",{children:p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:"Post a Job"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:"Find Candidates"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:"Pricing"})})]})]}),p.jsxs(ve,{md:3,children:[p.jsx("h6",{className:"font-semibold mb-3",children:"Connect With Us"}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:p.jsx(CJ,{size:20})}),p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:p.jsx(LJ,{size:20})}),p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:p.jsx($J,{size:20})}),p.jsx("a",{href:"#",className:"text-gray-600 hover:text-primary",children:p.jsx(gL,{size:20})})]})]})]}),p.jsx("hr",{className:"my-4"}),p.jsxs("div",{className:"text-center text-gray-600",children:["© ",new Date().getFullYear()," GrowGig. All rights reserved."]})]})})}function UJ(){return p.jsxs(p.Fragment,{children:[p.jsx("section",{className:"bg-primary-50 py-16",children:p.jsx(Kt,{children:p.jsx(ot,{className:"align-items-center",children:p.jsxs(ve,{md:8,className:"mx-auto text-center",children:[p.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Find Your Next Opportunity"}),p.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Connect with top freelancers and employers worldwide"}),p.jsx(L,{className:"bg-white p-4 rounded-lg shadow-sm",children:p.jsxs(ot,{children:[p.jsx(ve,{md:5,children:p.jsx(L.Control,{type:"text",placeholder:"Job title or keyword",className:"mb-2 mb-md-0"})}),p.jsx(ve,{md:5,children:p.jsx(L.Control,{type:"text",placeholder:"Location",className:"mb-2 mb-md-0"})}),p.jsx(ve,{md:2,children:p.jsxs(Ve,{variant:"primary",className:"w-100",children:[p.jsx(i0,{size:20,className:"me-2"}),"Search"]})})]})})]})})})}),p.jsx("section",{className:"py-12",children:p.jsx(Kt,{children:p.jsxs(ot,{children:[p.jsxs(ve,{md:3,className:"text-center mb-4",children:[p.jsx("div",{className:"text-primary mb-2",children:p.jsx(op,{size:32,className:"mx-auto"})}),p.jsx("h3",{className:"text-2xl font-bold",children:"1,234"}),p.jsx("p",{className:"text-gray-600",children:"Live Jobs"})]}),p.jsxs(ve,{md:3,className:"text-center mb-4",children:[p.jsx("div",{className:"text-primary mb-2",children:p.jsx(a0,{size:32,className:"mx-auto"})}),p.jsx("h3",{className:"text-2xl font-bold",children:"5,678"}),p.jsx("p",{className:"text-gray-600",children:"Freelancers"})]}),p.jsxs(ve,{md:3,className:"text-center mb-4",children:[p.jsx("div",{className:"text-primary mb-2",children:p.jsx(qk,{size:32,className:"mx-auto"})}),p.jsx("h3",{className:"text-2xl font-bold",children:"890"}),p.jsx("p",{className:"text-gray-600",children:"Companies"})]}),p.jsxs(ve,{md:3,className:"text-center mb-4",children:[p.jsx("div",{className:"text-primary mb-2",children:p.jsx(NJ,{size:32,className:"mx-auto"})}),p.jsx("h3",{className:"text-2xl font-bold",children:"12"}),p.jsx("p",{className:"text-gray-600",children:"Categories"})]})]})})}),p.jsx("section",{className:"bg-gray-50 py-16",children:p.jsxs(Kt,{children:[p.jsx("h2",{className:"text-3xl font-bold text-center mb-12",children:"How It Works"}),p.jsx(ot,{children:[{title:"Create an Account",description:"Sign up as a freelancer or employer in minutes",icon:"1"},{title:"Post or Apply for Jobs",description:"Find the perfect opportunity or talent",icon:"2"},{title:"Collaborate & Work",description:"Work together seamlessly on projects",icon:"3"},{title:"Get Paid Securely",description:"Payments protected through escrow",icon:"4"}].map((t,e)=>p.jsx(ve,{md:3,className:"mb-4",children:p.jsx(be,{className:"border-0 h-100 shadow-sm",children:p.jsxs(be.Body,{className:"text-center",children:[p.jsx("div",{className:"bg-primary text-white rounded-circle w-12 h-12 flex items-center justify-center mx-auto mb-4",children:p.jsx("span",{className:"text-xl font-bold",children:t.icon})}),p.jsx(be.Title,{className:"font-bold mb-3",children:t.title}),p.jsx(be.Text,{className:"text-gray-600",children:t.description})]})})},e))})]})}),p.jsx("section",{className:"py-16",children:p.jsx(Kt,{children:p.jsxs(ot,{className:"g-4",children:[p.jsx(ve,{md:6,children:p.jsx(be,{className:"bg-primary text-white p-4",children:p.jsxs(be.Body,{className:"text-center",children:[p.jsx("h3",{className:"text-2xl font-bold mb-4",children:"For Employers"}),p.jsx("p",{className:"mb-4",children:"Find the perfect freelancer for your project"}),p.jsx(Ve,{variant:"light",size:"lg",children:"Post a Job"})]})})}),p.jsx(ve,{md:6,children:p.jsx(be,{className:"bg-primary-100 p-4",children:p.jsxs(be.Body,{className:"text-center",children:[p.jsx("h3",{className:"text-2xl font-bold mb-4",children:"For Freelancers"}),p.jsx("p",{className:"mb-4",children:"Find your next opportunity"}),p.jsx(Ve,{variant:"primary",size:"lg",children:"Find Projects"})]})})})]})})})]})}function VJ(){const[t,e]=S.useState(""),[n,s]=S.useState(""),[r,o]=S.useState(!1),i=Dr(),{login:a}=Hs(),l=async c=>{c.preventDefault(),o(!0);try{await a(t,n)&&i("/dashboard")}finally{o(!1)}};return p.jsx(Kt,{className:"py-16",children:p.jsx(ot,{className:"justify-content-center",children:p.jsx(ve,{md:6,children:p.jsx(be,{className:"shadow-sm",children:p.jsxs(be.Body,{className:"p-5",children:[p.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Welcome Back"}),p.jsxs(L,{onSubmit:l,children:[p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Email address"}),p.jsx(L.Control,{type:"email",value:t,onChange:c=>e(c.target.value),required:!0})]}),p.jsxs(L.Group,{className:"mb-4",children:[p.jsx(L.Label,{children:"Password"}),p.jsx(L.Control,{type:"password",value:n,onChange:c=>s(c.target.value),required:!0})]}),p.jsx(Ve,{variant:"primary",type:"submit",className:"w-100 mb-3",disabled:r,children:r?"Signing in...":"Sign In"}),p.jsxs("p",{className:"text-center mb-0",children:["Don't have an account?"," ",p.jsx(ms,{to:"/register",className:"text-primary",children:"Sign up"})]})]})]})})})})})}function WJ(){const[t,e]=S.useState({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",role:"freelancer"}),[n,s]=S.useState(!1),r=Dr(),{register:o}=Hs(),i=l=>{e({...t,[l.target.name]:l.target.value})},a=async l=>{if(l.preventDefault(),t.password!==t.confirmPassword){xe.error("Passwords do not match");return}s(!0);try{await o(t)?(xe.success("Account created successfully!"),r("/dashboard")):xe.error("Failed to create account. Please try again.")}catch(c){xe.error(c.message||"Failed to create account. Please try again.")}finally{s(!1)}};return p.jsx(Kt,{className:"py-16",children:p.jsx(ot,{className:"justify-content-center",children:p.jsx(ve,{md:8,children:p.jsx(be,{className:"shadow-sm",children:p.jsxs(be.Body,{className:"p-5",children:[p.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Create an Account"}),p.jsxs(L,{onSubmit:a,children:[p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"First Name"}),p.jsx(L.Control,{type:"text",name:"firstName",value:t.firstName,onChange:i,required:!0})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Last Name"}),p.jsx(L.Control,{type:"text",name:"lastName",value:t.lastName,onChange:i,required:!0})]})})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Email address"}),p.jsx(L.Control,{type:"email",name:"email",value:t.email,onChange:i,required:!0})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Password"}),p.jsx(L.Control,{type:"password",name:"password",value:t.password,onChange:i,required:!0})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Confirm Password"}),p.jsx(L.Control,{type:"password",name:"confirmPassword",value:t.confirmPassword,onChange:i,required:!0})]}),p.jsxs(L.Group,{className:"mb-4",children:[p.jsx(L.Label,{children:"I want to"}),p.jsxs(L.Select,{name:"role",value:t.role,onChange:i,required:!0,children:[p.jsx("option",{value:"freelancer",children:"Work as a Freelancer"}),p.jsx("option",{value:"employer",children:"Hire Freelancers"})]})]}),p.jsx(Ve,{variant:"primary",type:"submit",className:"w-100 mb-3",disabled:n,children:n?"Creating account...":"Create Account"}),p.jsxs("p",{className:"text-center mb-0",children:["Already have an account?"," ",p.jsx(ms,{to:"/login",className:"text-primary",children:"Sign in"})]})]})]})})})})})}const hC=(t,e="USD")=>t==null?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:e}).format(t),HJ=t=>{if(!t)return"";const e=new Date,n=new Date(t),s=Math.floor((e-n)/1e3);if(s<60)return"just now";const r=Math.floor(s/60);if(r<60)return`${r} minute${r===1?"":"s"} ago`;const o=Math.floor(r/60);if(o<24)return`${o} hour${o===1?"":"s"} ago`;const i=Math.floor(o/24);if(i<30)return`${i} day${i===1?"":"s"} ago`;const a=Math.floor(i/30);if(a<12)return`${a} month${a===1?"":"s"} ago`;const l=Math.floor(a/12);return`${l} year${l===1?"":"s"} ago`};function GJ(){const{user:t}=Hs(),e=(t==null?void 0:t.role)==="freelancer",[n,s]=S.useState(!0),[r,o]=S.useState({earnings:0,totalSpent:0,completedCount:0,activeCount:0,inProgressCount:0,pendingCount:0,profileViews:0,successRate:0,hireRate:0,invitationsCount:0,totalHires:0}),[i,a]=S.useState([]);return S.useEffect(()=>{(async()=>{try{const c=await We.get("/users/dashboard/stats");console.log("API Response Stats:",c.data.stats),o(u=>({...u,...c.data.stats})),a(c.data.recentActivity||[])}catch(c){console.error("Error fetching dashboard data:",c),bt.error("Failed to load dashboard data")}finally{s(!1)}})()},[]),n?p.jsx("div",{className:"text-center py-5",children:p.jsx(ir,{animation:"border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):p.jsxs(p.Fragment,{children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Dashboard Overview"}),console.log("Rendering Stats:",r),p.jsxs(ot,{className:"mb-4",children:[p.jsx(ve,{md:4,className:"mb-4",children:p.jsx(be,{children:p.jsx(be.Body,{children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"rounded-full bg-primary-100 p-3 mr-4",children:p.jsx(o0,{size:24,className:"text-primary"})}),p.jsxs("div",{children:[p.jsx("h6",{className:"text-gray-600 mb-1",children:e?"Earnings":"Total Spent"}),p.jsx("h4",{className:"font-bold mb-0",children:hC(e?r.earnings:r.totalSpent)})]})]})})})}),p.jsx(ve,{md:4,className:"mb-4",children:p.jsx(be,{children:p.jsx(be.Body,{children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"rounded-full bg-success-100 p-3 mr-4",children:p.jsx(wf,{size:24,className:"text-success"})}),p.jsxs("div",{children:[p.jsx("h6",{className:"text-gray-600 mb-1",children:e?"Completed Projects":"Active Jobs"}),p.jsx("h4",{className:"font-bold mb-0",children:e?r.completedCount:r.activeCount})]})]})})})}),p.jsx(ve,{md:4,className:"mb-4",children:p.jsx(be,{children:p.jsx(be.Body,{children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"rounded-full bg-warning-100 p-3 mr-4",children:p.jsx(Cf,{size:24,className:"text-warning"})}),p.jsxs("div",{children:[p.jsx("h6",{className:"text-gray-600 mb-1",children:e?"In Progress":"Pending Hires"}),p.jsx("h4",{className:"font-bold mb-0",children:e?r.inProgressCount:r.pendingCount})]})]})})})})]}),p.jsxs(ot,{children:[p.jsx(ve,{lg:8,className:"mb-4",children:p.jsxs(be,{children:[p.jsx(be.Header,{className:"bg-white",children:p.jsx("h5",{className:"mb-0",children:"Recent Activity"})}),p.jsx(be.Body,{children:p.jsx("div",{className:"timeline",children:i.length>0?i.map((l,c)=>p.jsx("div",{className:"mb-4 last:mb-0",children:p.jsxs("div",{className:"flex items-start",children:[p.jsx("div",{className:"rounded-full bg-gray-100 p-2 mr-3",children:p.jsx(gJ,{size:20,className:"text-gray-500"})}),p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold mb-1",children:l.title}),p.jsx("p",{className:"text-gray-600 text-sm mb-1",children:l.description}),p.jsx("small",{className:"text-gray-500",children:HJ(l.date)})]})]})},c)):p.jsx("p",{className:"text-center text-gray-500",children:"No recent activity"})})})]})}),p.jsx(ve,{lg:4,children:p.jsxs(be,{className:"mb-4",children:[p.jsx(be.Header,{className:"bg-white",children:p.jsx("h5",{className:"mb-0",children:"Quick Stats"})}),p.jsxs(be.Body,{children:[p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("span",{className:"text-gray-600",children:"Profile Views"}),p.jsxs("div",{className:"flex items-center text-success",children:[p.jsx(GT,{size:16,className:"mr-1"}),p.jsx("span",{children:r.profileViews})]})]}),p.jsx("h4",{className:"font-bold",children:r.profileViews})]}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("span",{className:"text-gray-600",children:e?"Success Rate":"Hire Rate"}),p.jsxs("div",{className:"flex items-center text-success",children:[p.jsx(GT,{size:16,className:"mr-1"}),p.jsxs("span",{children:[e?r.successRate:r.hireRate,"%"]})]})]}),p.jsxs("h4",{className:"font-bold",children:[e?r.successRate:r.hireRate,"%"]})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("span",{className:"text-gray-600",children:e?"Job Invitations":"Total Hires"}),p.jsxs("div",{className:"flex items-center text-success",children:[p.jsx(a0,{size:16,className:"mr-1"}),p.jsx("span",{children:e?r.invitationsCount:r.totalHires})]})]}),p.jsx("h4",{className:"font-bold",children:e?r.invitationsCount:r.totalHires})]})]})]})})]})]})}function qJ(){const{user:t}=Hs(),e=Dr(),[n,s]=S.useState([]),[r,o]=S.useState(!0),[i,a]=S.useState(null),l=(t==null?void 0:t.role)==="freelancer";S.useEffect(()=>{c()},[]);const c=async()=>{var g,y,x,v;try{o(!0),a(null),console.log("Current user:",{id:t==null?void 0:t._id,role:t==null?void 0:t.role,token:localStorage.getItem("token")}),console.log("Making API request to:",l?"/jobs/my-projects":"/jobs/my-jobs");const b=await We.get(l?"/jobs/my-projects":"/jobs/my-jobs").catch(w=>{var C,k;throw console.error("API call failed:",{status:(C=w.response)==null?void 0:C.status,data:(k=w.response)==null?void 0:k.data,message:w.message}),w});if(console.log("API response:",b.data),b.data&&b.data.length>0&&console.log("Project statuses:",b.data.map(w=>({id:w._id,title:w.title,status:w.status,progress:w.progress}))),!l)s(b.data);else{const w=b.data.filter(C=>C.employer);console.log("Filtered freelancer projects:",w),s(w)}}catch(b){console.error("Error fetching projects:",{message:b.message,response:(g=b.response)==null?void 0:g.data,status:(y=b.response)==null?void 0:y.status,stack:b.stack});const w=((v=(x=b.response)==null?void 0:x.data)==null?void 0:v.message)||b.message||"Failed to load projects";a(w),xe.error(w)}finally{o(!1)}},u=async g=>{var y,x;if(window.confirm("Are you sure you want to delete this project?"))try{if((await We.get(`/jobs/${g}`)).data.employer._id!==t._id){xe.error("You are not authorized to delete this project");return}await We.delete(`/jobs/${g}`),xe.success("Project deleted successfully"),c()}catch(v){console.error("Error deleting project:",v),xe.error(((x=(y=v.response)==null?void 0:y.data)==null?void 0:x.message)||"Failed to delete project")}},d=()=>{e("/dashboard/post-job")},h=g=>{const y={open:"primary","in-progress":"warning",completed:"success",closed:"secondary",cancelled:"danger"};return p.jsx(Zs,{bg:y[g]||"light",children:g})},f=g=>{console.log("Using simple view handler for project:",g),e(`/dashboard/projects/${g}`)},m=g=>{console.log("Using simple edit handler for project:",g),e(`/dashboard/projects/${g}/edit`)};return r?p.jsx("div",{className:"text-center py-5",children:p.jsx("div",{className:"spinner-border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[p.jsx("h2",{className:"text-2xl font-bold",children:l?"My Projects":"Posted Jobs"}),!l&&p.jsx(Ve,{variant:"primary",onClick:d,children:"Post New Job"})]}),i&&p.jsx(Wa,{variant:"danger",className:"mb-4",children:i}),p.jsx(be,{children:p.jsx(be.Body,{children:n.length===0?p.jsxs("div",{className:"text-center py-4",children:[p.jsx("p",{className:"text-muted mb-0",children:l?"You haven't been assigned to any projects yet":"You haven't posted any jobs yet"}),l&&p.jsx(Ve,{variant:"primary",className:"mt-3",onClick:()=>e("/find-projects"),children:"Browse Available Projects"})]}):p.jsxs(bf,{responsive:!0,hover:!0,children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Title"}),p.jsx("th",{children:"Status"}),p.jsx("th",{children:"Progress"}),p.jsx("th",{children:l?"Client":"Applications"}),p.jsx("th",{children:"Budget"}),p.jsx("th",{children:"Actions"})]})}),p.jsx("tbody",{children:n.map(g=>{var y,x,v;return p.jsxs("tr",{children:[p.jsxs("td",{children:[p.jsx("div",{className:"font-semibold",children:g.title}),p.jsx("small",{className:"text-gray-600",children:g.category})]}),p.jsx("td",{children:h(g.status)}),p.jsx("td",{style:{minWidth:"150px"},children:p.jsx(Hk,{now:g.progress||0,label:`${g.progress||0}%`,variant:g.progress===100?"success":"primary"})}),p.jsx("td",{children:l?`${(y=g.employer)==null?void 0:y.firstName} ${(x=g.employer)==null?void 0:x.lastName}`:p.jsxs(Ve,{variant:"link",className:"p-0",onClick:()=>e(`/dashboard/projects/${g._id}/applications`),children:[((v=g.applications)==null?void 0:v.length)||0," Applications"]})}),p.jsxs("td",{children:[g.salary.currency," ",g.salary.min.toLocaleString()," - ",g.salary.max.toLocaleString()]}),p.jsx("td",{children:p.jsxs("div",{className:"d-flex gap-2",children:[p.jsx(Ve,{variant:"light",size:"sm",onClick:()=>f(g._id),title:"View Details",children:p.jsx(wJ,{size:16})}),l?p.jsx(Ve,{variant:"light",size:"sm",onClick:()=>e(`/dashboard/projects/${g._id}/milestones`),title:"View Milestones",className:"text-primary",children:p.jsx(WT,{size:16})}):p.jsxs(p.Fragment,{children:[p.jsx(Ve,{variant:"light",size:"sm",onClick:()=>m(g._id),title:"Edit Job",children:p.jsx(_J,{size:16})}),p.jsx(Ve,{variant:"light",size:"sm",onClick:()=>u(g._id),title:"Delete Job",className:"text-danger",children:p.jsx(xL,{size:16})}),(g.status==="in-progress"||g.hasAcceptedApplication)&&p.jsx(Ve,{variant:"light",size:"sm",onClick:()=>e(`/dashboard/projects/${g._id}/milestones`),title:"Manage Milestones",className:"text-primary",children:p.jsx(WT,{size:16})})]})]})})]},g._id)})})]})})})]})}function vL({isDashboard:t=!1}){var G;const{user:e,token:n}=Hs(),[s]=r7(),[r,o]=S.useState([]),[i,a]=S.useState(null),[l,c]=S.useState(""),[u,d]=S.useState(!0),[h,f]=S.useState(!1),m=S.useRef(null),g=S.useRef(new Map),y=S.useRef(!0),x=S.useRef(!1),v=S.useRef(null),b=S.useRef(null),[w,C]=S.useState("");S.useEffect(()=>{(async()=>{if(e&&e._id){console.log("User ID from context:",e._id),C(e._id);return}if(n)try{const B=await We.get("/users/me");B.data&&B.data._id&&(console.log("User ID from API:",B.data._id),C(B.data._id))}catch(B){console.error("Failed to fetch current user details:",B)}})()},[e,n]),S.useEffect(()=>(y.current=!0,N(),()=>{y.current=!1,g.current.forEach(O=>{try{O.abort()}catch(B){console.log("Error aborting controller:",B)}}),g.current.clear()}),[]),S.useEffect(()=>{const O=s.get("chatId"),B=s.get("with");if(!w){console.log("Waiting for current user ID before initializing chat...");return}if(O&&r.length>0&&!x.current){x.current=!0,console.log("Opening chat from URL with chatId:",O);const z=r.find(K=>K._id===O);z?E(z):console.error("Could not find chat with ID:",O)}else if(B&&r.length>0&&!x.current){if(B===w){console.error("Cannot create chat with yourself"),x.current=!0;return}x.current=!0,console.log("Looking for chat with participant:",B);const z=r.find(K=>{const J=K.participants.map(de=>typeof de.user=="object"?String(de.user._id||""):String(de.user||"")),re=String(B||"");return console.log("Chat participants:",J,"Looking for:",re),J.includes(re)&&J.includes(w)});z?(console.log("Found existing chat:",z._id),E(z)):(console.log("Creating new chat with:",B),I(B))}},[s,r,w]),S.useEffect(()=>{var O;(O=i==null?void 0:i.messages)!=null&&O.length&&_()},[(G=i==null?void 0:i.messages)==null?void 0:G.length]),S.useEffect(()=>{i&&b.current&&b.current.focus()},[i==null?void 0:i._id]);const k=O=>{if(g.current.has(O))try{g.current.get(O).abort()}catch(z){console.log("Error aborting existing controller:",z)}const B=new AbortController;return g.current.set(O,B),B},N=async()=>{const O=k("fetchChats");try{const B=await We.get("/chat",{signal:O.signal});if(y.current){const z=B.data.sort((K,J)=>{const re=K.updatedAt||(K.messages&&K.messages.length>0?K.messages[K.messages.length-1].timestamp:0),de=J.updatedAt||(J.messages&&J.messages.length>0?J.messages[J.messages.length-1].timestamp:0);return new Date(de)-new Date(re)});o(z),d(!1)}}catch(B){if(B.name==="AbortError"||B.code==="ERR_CANCELED")return;console.error("Error fetching chats:",B),y.current&&d(!1)}finally{g.current.delete("fetchChats")}},E=async O=>{const B=k("selectChat");try{const z=await We.get(`/chat/${O._id}`,{signal:B.signal});y.current&&(console.log("Selected chat data:",{chatId:z.data._id,participants:z.data.participants,currentUser:e}),a(z.data),$(O._id),o(K=>K.map(J=>J._id===O._id?{...J,messages:z.data.messages,unread:0}:J)))}catch(z){if(z.name==="AbortError"||z.code==="ERR_CANCELED")return;console.error("Error selecting chat:",z)}finally{g.current.delete("selectChat")}},$=async O=>{const B=k("markRead");try{await We.put(`/chat/${O}/read`,{},{signal:B.signal})}catch(z){z.name!=="AbortError"&&z.code!=="ERR_CANCELED"&&console.error("Error marking messages as read:",z)}finally{g.current.delete("markRead")}},I=async O=>{const B=k("createChat");try{if(console.log("=== DEBUG: Chat Creation Started ==="),!O){console.error("Cannot create chat: Missing participantId");return}if(!w){console.error("Cannot create chat: Current user ID is not available");return}console.log("Participant ID received:",O),console.log("Participant ID type:",typeof O),console.log("Current user:",{_id:w,name:e?`${e.firstName} ${e.lastName}`:"Unknown"});const z=String(w),K=String(O||"");if(console.log(`ID comparison (string): ${K} === ${z} ? ${K===z}`),K===z){console.error("Error: Cannot create chat with yourself - IDs match");return}console.log(`Creating new chat between user ${z} and participant ${K}`);const J={participantId:O,message:"Hello! I would like to discuss a potential collaboration."};console.log("API request data:",J);const re=await We.post("/chat",J,{signal:B.signal});if(y.current){console.log("Chat creation successful!"),console.log("Response status:",re.status);const de=re.data;console.log("New chat ID:",de._id),console.log("New chat participants:"),de.participants.forEach((Ce,Ne)=>{const ze=typeof Ce.user=="object"?Ce.user._id:Ce.user,_e=typeof Ce.user=="object"?`${Ce.user.firstName} ${Ce.user.lastName}`:"Unknown";console.log(`Participant ${Ne+1}: ID=${ze}, Name=${_e}, Role=${Ce.role}`)});const pe=de.participants.some(Ce=>(typeof Ce.user=="object"?String(Ce.user._id||""):String(Ce.user||""))===z),we=de.participants.some(Ce=>(typeof Ce.user=="object"?String(Ce.user._id||""):String(Ce.user||""))===K);console.log(`Chat includes current user? ${pe}`),console.log(`Chat includes intended participant? ${we}`),(!pe||!we)&&console.error("Error: Chat was created with incorrect participants!"),o(Ce=>[de,...Ce]),a(de)}}catch(z){if(z.name==="AbortError"||z.code==="ERR_CANCELED")return;console.error("Error creating new chat:",z),z.response?(console.error("Error response status:",z.response.status),console.error("Error response data:",z.response.data)):z.request?console.error("Error: No response received",z.request):console.error("Error message:",z.message)}finally{g.current.delete("createChat")}},A=async O=>{if(O.preventDefault(),!l.trim()||!i||h)return;const B=l.trim();c(""),f(!0);const z=k("sendMessage");try{if(await We.post(`/chat/${i._id}/messages`,{message:B},{signal:z.signal}),y.current){const K={_id:`temp-${Date.now()}`,content:B,sender:e,timestamp:new Date().toISOString(),read:!1};a(J=>({...J,messages:[...J.messages,K],updatedAt:new Date().toISOString()})),o(J=>J.map(re=>re._id===i._id?{...re,messages:[...re.messages,K],updatedAt:new Date().toISOString()}:re)),P(i._id)}}catch(K){if(K.name==="AbortError"||K.code==="ERR_CANCELED")return;console.error("Error sending message:",K),c(B)}finally{f(!1),g.current.delete("sendMessage")}},P=async O=>{const B=k("refreshChat");try{const z=await We.get(`/chat/${O}`,{signal:B.signal});if(y.current){const K=z.data;a(K),o(J=>{const re=J.filter(de=>de._id!==O);return[K,...re]})}}catch(z){z.name!=="AbortError"&&z.code!=="ERR_CANCELED"&&console.error("Error refreshing chat:",z)}finally{g.current.delete("refreshChat")}},_=()=>{setTimeout(()=>{var O;(O=m.current)==null||O.scrollIntoView({behavior:"smooth"})},100)},U=O=>{if(!O)return"";try{return new Date(O).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch(B){return console.error("Error formatting time:",B),""}},V=O=>{if(!O)return"";const B=O.user||O;return!B||!B.firstName?"https://ui-avatars.com/api/?name=User&size=40&background=random":`https://ui-avatars.com/api/?name=${encodeURIComponent(B.firstName)}+${encodeURIComponent(B.lastName||"")}&size=40&background=random`},D=O=>{var ze;if(!O||!O.participants||!Array.isArray(O.participants))return console.error("Invalid chat data:",O),null;const B=String((e==null?void 0:e._id)||""),z=(e==null?void 0:e.role)||(e==null?void 0:e.userType)||"";let K;if(z==="employer"?K=O.participants.find(_e=>(_e==null?void 0:_e.user)&&_e.user.role==="freelancer"):z==="freelancer"?K=O.participants.find(_e=>(_e==null?void 0:_e.user)&&_e.user.role==="employer"):K=O.participants.find(_e=>(typeof _e.user=="object"?String(_e.user._id||""):String(_e.user||""))!==B),!K||!K.user)return console.error("Could not identify other participant in chat:",O._id),console.log("Chat participants:",O.participants),console.log("Current user ID:",B),null;const J=typeof K.user=="object"?K.user:{firstName:"User",lastName:""},re=typeof O.unread<"u"?O.unread:((ze=O.messages)==null?void 0:ze.filter(_e=>{const st=typeof _e.sender=="object"?String(_e.sender._id||""):String(_e.sender||"");return!_e.read&&st!==B}).length)||0,de=O.messages&&O.messages.length>0?O.messages[O.messages.length-1]:null,pe=(de==null?void 0:de.content)||"No messages yet",we=de&&(typeof de.sender=="object"?String(de.sender._id||"")===B:String(de.sender||"")===B);let Ce="",Ne="";return J.role==="freelancer"?(Ce="Freelancer",Ne="bg-info text-white"):J.role==="employer"?(Ce="Employer",Ne="bg-primary text-white"):J.userType&&(Ce=J.userType.charAt(0).toUpperCase()+J.userType.slice(1),Ne="bg-secondary text-white"),p.jsx("div",{className:`p-3 border-bottom cursor-pointer hover:bg-gray-50 ${(i==null?void 0:i._id)===O._id?"bg-gray-100":""}`,onClick:()=>E(O),children:p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx("img",{src:V(J),alt:`${J.firstName||"User"} ${J.lastName||""}`,className:"rounded-circle me-3",style:{width:"40px",height:"40px"}}),p.jsxs("div",{className:"flex-grow-1",children:[p.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[p.jsxs("h6",{className:"mb-0",children:[J.firstName||"User"," ",J.lastName||"",Ce&&p.jsx("span",{className:`ms-2 badge ${Ne}`,children:Ce})]}),re>0&&p.jsx("span",{className:"badge bg-primary rounded-pill",children:re})]}),p.jsxs("div",{className:"d-flex align-items-center",children:[we&&p.jsx("small",{className:"text-muted me-1",children:"You: "}),p.jsx("p",{className:"text-muted mb-0 small text-truncate",children:pe})]})]})]})},`chat-${O._id}`)},W=(O,B,z)=>{var ue,Ue,sn,gt,Jn;if(!O||!O.sender)return console.error("Invalid message data:",O),null;const K=typeof O.sender=="object"&&O.sender?String(O.sender._id||""):String(O.sender||""),J=w;console.log(`Message: "${(ue=O.content)==null?void 0:ue.substring(0,15)}..." - Sender ID: ${K}, Current User ID: ${J}`);const re=K===J,de=`msg-${O._id||B}-${re?"me":"other"}`;let pe,we="";if(re)pe=e,e.role==="freelancer"?we="bg-info text-white":e.role==="employer"&&(we="bg-primary text-white");else{const pn=i.participants.find(Zn=>!Zn||!Zn.user?!1:(typeof Zn.user=="object"?String(Zn.user._id||""):String(Zn.user||""))===K);pe=(pn==null?void 0:pn.user)||(typeof O.sender=="object"?O.sender:{firstName:"User",lastName:""}),pe.role==="freelancer"?we="bg-info text-white":pe.role==="employer"?we="bg-primary text-white":pe.userType&&(we="bg-secondary text-white")}if(!pe)return console.error("Could not identify message sender:",K),null;const Ce=pe.role==="freelancer"?"Freelancer":pe.role==="employer"?"Employer":pe.userType?pe.userType.charAt(0).toUpperCase()+pe.userType.slice(1):"",Ne=B===0||String(((Ue=z[B-1].sender)==null?void 0:Ue._id)||z[B-1].sender||"")!==String(((sn=O.sender)==null?void 0:sn._id)||O.sender||""),ze=B===z.length-1||String(((gt=z[B+1].sender)==null?void 0:gt._id)||z[B+1].sender||"")!==String(((Jn=O.sender)==null?void 0:Jn._id)||O.sender||""),_e=U(O.timestamp),st=O.read,je=O.readAt?new Date(O.readAt).toLocaleString():"",rt=re?{backgroundColor:"#28a745",color:"white",borderTopLeftRadius:"1rem",borderTopRightRadius:Ne?"1rem":"0.5rem",borderBottomLeftRadius:"1rem",borderBottomRightRadius:ze?"1rem":"0.5rem",marginLeft:"auto",marginRight:"0.5rem"}:{backgroundColor:"#f0f2f5",color:"black",borderTopLeftRadius:Ne?"1rem":"0.5rem",borderTopRightRadius:"1rem",borderBottomLeftRadius:ze?"1rem":"0.5rem",borderBottomRightRadius:"1rem",marginRight:"auto",marginLeft:"0.5rem"};return p.jsxs("div",{className:`d-flex mb-1 ${re?"justify-content-end":"justify-content-start"}`,children:[!re&&ze&&p.jsx("img",{src:V(pe),alt:`${pe.firstName||"User"} ${pe.lastName||""}`,className:"rounded-circle me-2 align-self-end",style:{width:"32px",height:"32px"}}),!re&&!ze&&p.jsx("div",{style:{width:"32px"},className:"me-2"}),p.jsxs("div",{className:"d-flex flex-column",style:{maxWidth:"70%"},children:[Ne&&p.jsxs("div",{className:`mb-1 ${re?"text-end":"text-start"}`,children:[p.jsx("small",{className:"text-muted",children:re?"You":`${pe.firstName||"User"} ${pe.lastName||""}`}),!re&&we&&p.jsx("span",{className:`ms-1 badge ${we}`,style:{fontSize:"0.7rem"},children:Ce})]}),p.jsxs("div",{className:"p-2 mb-1 rounded-3",style:rt,children:[p.jsx("p",{className:"mb-1",children:O.content}),p.jsxs("div",{className:"d-flex align-items-center justify-content-end",style:{fontSize:"0.7rem"},children:[p.jsx("small",{className:re?"text-white-50":"text-muted",children:_e}),re&&p.jsx("span",{className:"ms-1",title:st?`Read at ${je}`:"Delivered",children:st?p.jsx(vJ,{size:12,className:"text-white-50"}):p.jsx(bJ,{size:12,className:"text-white-50"})})]})]})]}),re&&ze&&p.jsx("img",{src:V(pe),alt:`${pe.firstName||"User"} ${pe.lastName||""}`,className:"rounded-circle ms-2 align-self-end",style:{width:"32px",height:"32px"}}),re&&!ze&&p.jsx("div",{style:{width:"32px"},className:"ms-2"})]},de)},R=()=>{if(!i||!i.participants||!Array.isArray(i.participants))return console.error("Invalid chat or missing participants"),null;const O=String((e==null?void 0:e._id)||""),B=(e==null?void 0:e.role)||(e==null?void 0:e.userType)||"";if(console.log("Current user role:",B),console.log("Chat participants:",i.participants.map(K=>typeof K.user=="object"?`${K.user._id} (${K.user.firstName}, ${K.user.role})`:K.user)),B==="employer"){const K=i.participants.find(J=>(J==null?void 0:J.user)&&J.user.role==="freelancer");return console.log("Found freelancer participant:",K),K}if(B==="freelancer"){const K=i.participants.find(J=>(J==null?void 0:J.user)&&J.user.role==="employer");return console.log("Found employer participant:",K),K}const z=i.participants.find(K=>(typeof K.user=="object"?String(K.user._id||""):String(K.user||""))!==O);return console.log("Fallback participant found:",z),z},j=()=>{if(!i||!i.participants||!Array.isArray(i.participants))return console.error("Invalid selected chat or missing participants:",i),null;const O=R();if(!O||!O.user)return console.error("Could not identify other participant in chat header:",i._id),console.log("Current user:",e),console.log("All participants:",i.participants),null;O.user.firstName||console.warn("Other participant missing name information:",O);let B="User",z="";O.user.role==="freelancer"?(B="Freelancer",z="bg-info text-white"):O.user.role==="employer"?(B="Employer",z="bg-primary text-white"):O.user.userType&&(B=O.user.userType.charAt(0).toUpperCase()+O.user.userType.slice(1));const K=O.role==="initiator"?"Started the conversation":"Recipient";return p.jsx(be.Header,{className:"bg-white border-bottom",children:p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx("img",{src:V(O.user),alt:`${O.user.firstName||"User"} ${O.user.lastName||""}`,className:"rounded-circle me-3",style:{width:"40px",height:"40px"}}),p.jsxs("div",{children:[p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsxs("h5",{className:"mb-0",children:[O.user.firstName||"User"," ",O.user.lastName||""]}),p.jsx("span",{className:`ms-2 badge ${z}`,children:B})]}),p.jsx("small",{className:"text-muted",children:K})]})]})})};return p.jsx(Kt,{fluid:!0,className:t?"p-0 h-100":"py-4",children:p.jsxs(ot,{className:t?"h-100 m-0":"h-[calc(100vh-8rem)]",children:[p.jsx(ve,{md:4,className:"h-100 p-0",children:p.jsxs(be,{className:"h-100 border-0",children:[p.jsxs(be.Header,{className:"bg-white border-bottom",children:[p.jsx("h4",{className:"mb-0",children:"Messages"}),p.jsx("small",{className:"text-muted d-block",children:"Your conversations"})]}),p.jsx("div",{className:"overflow-y-auto",style:{height:"calc(100% - 56px)"},ref:v,children:u?p.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:p.jsx(ir,{animation:"border",variant:"primary"})}):r.length===0?p.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:p.jsx("p",{className:"text-muted",children:"No conversations yet"})}):r.map(O=>D(O))})]})}),p.jsx(ve,{md:8,className:"h-100 p-0",children:i?p.jsxs(be,{className:"h-100 border-0",children:[j(),p.jsxs("div",{className:"overflow-y-auto p-3",style:{height:"calc(100% - 120px)"},children:[i.messages&&i.messages.length>0?i.messages.map((O,B)=>W(O,B,i.messages)):p.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:p.jsx("p",{className:"text-muted",children:"No messages yet. Start the conversation!"})}),p.jsx("div",{ref:m})]}),p.jsx(be.Footer,{className:"bg-white border-top",children:p.jsx(L,{onSubmit:A,className:"d-flex",children:p.jsxs("div",{className:"d-flex align-items-center w-100",children:[p.jsx(L.Control,{type:"text",value:l,onChange:O=>c(O.target.value),placeholder:"Type a message...",className:"flex-grow-1 me-2",disabled:h,ref:b}),p.jsx(Ve,{type:"submit",variant:"primary",disabled:!l.trim()||h,children:h?p.jsx(ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):p.jsx(FJ,{size:20})})]})})})]}):p.jsx("div",{className:"d-flex align-items-center justify-content-center h-100",children:p.jsxs("div",{className:"text-center",children:[p.jsx("h4",{children:"Select a chat to start messaging"}),p.jsx("p",{className:"text-muted",children:"Or start a new conversation"})]})})})]})})}function KJ(){return p.jsxs("div",{className:"h-100",children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Messages"}),p.jsx("div",{className:"h-[calc(100vh-12rem)]",children:p.jsx(vL,{isDashboard:!0})})]})}function hc(t){"@babel/helpers - typeof";return hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hc(t)}function XJ(t,e){if(hc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(hc(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bL(t){var e=XJ(t,"string");return hc(e)=="symbol"?e:e+""}function yh(t,e,n){return(e=bL(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Ke(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KT(Object(n),!0).forEach(function(s){yh(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KT(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function YJ(t){if(Array.isArray(t))return t}function JJ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var s,r,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(s=o.call(n)).done)&&(a.push(s.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw r}}return a}}function fC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,s=Array(e);n<e;n++)s[n]=t[n];return s}function wL(t,e){if(t){if(typeof t=="string")return fC(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fC(t,e):void 0}}function ZJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wi(t,e){return YJ(t)||JJ(t,e)||wL(t,e)||ZJ()}function la(t,e){if(t==null)return{};var n,s,r=Ck(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)n=o[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var QJ=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function eZ(t){var e=t.defaultInputValue,n=e===void 0?"":e,s=t.defaultMenuIsOpen,r=s===void 0?!1:s,o=t.defaultValue,i=o===void 0?null:o,a=t.inputValue,l=t.menuIsOpen,c=t.onChange,u=t.onInputChange,d=t.onMenuClose,h=t.onMenuOpen,f=t.value,m=la(t,QJ),g=S.useState(a!==void 0?a:n),y=Wi(g,2),x=y[0],v=y[1],b=S.useState(l!==void 0?l:r),w=Wi(b,2),C=w[0],k=w[1],N=S.useState(f!==void 0?f:i),E=Wi(N,2),$=E[0],I=E[1],A=S.useCallback(function(R,j){typeof c=="function"&&c(R,j),I(R)},[c]),P=S.useCallback(function(R,j){var G;typeof u=="function"&&(G=u(R,j)),v(G!==void 0?G:R)},[u]),_=S.useCallback(function(){typeof h=="function"&&h(),k(!0)},[h]),U=S.useCallback(function(){typeof d=="function"&&d(),k(!1)},[d]),V=a!==void 0?a:x,D=l!==void 0?l:C,W=f!==void 0?f:$;return Ke(Ke({},m),{},{inputValue:V,menuIsOpen:D,onChange:A,onInputChange:P,onMenuClose:U,onMenuOpen:_,value:W})}function tZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XT(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,bL(s.key),s)}}function nZ(t,e,n){return e&&XT(t.prototype,e),n&&XT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sZ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sx(t,e)}function Ix(t){return Ix=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ix(t)}function CL(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CL=function(){return!!t})()}function rZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oZ(t,e){if(e&&(hc(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rZ(t)}function iZ(t){var e=CL();return function(){var n,s=Ix(t);if(e){var r=Ix(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return oZ(this,n)}}function aZ(t){if(Array.isArray(t))return fC(t)}function lZ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kk(t){return aZ(t)||lZ(t)||wL(t)||cZ()}function uZ(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function dZ(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var hZ=function(){function t(n){var s=this;this._insertTag=function(r){var o;s.tags.length===0?s.insertionPoint?o=s.insertionPoint.nextSibling:s.prepend?o=s.container.firstChild:o=s.before:o=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(r,o),s.tags.push(r)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(s){s.forEach(this._insertTag)},e.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(dZ(this));var r=this.tags[this.tags.length-1];if(this.isSpeedy){var o=uZ(r);try{o.insertRule(s,o.cssRules.length)}catch{}}else r.appendChild(document.createTextNode(s));this.ctr++},e.flush=function(){this.tags.forEach(function(s){var r;return(r=s.parentNode)==null?void 0:r.removeChild(s)}),this.tags=[],this.ctr=0},t}(),Os="-ms-",Tx="-moz-",At="-webkit-",SL="comm",Xk="rule",Yk="decl",fZ="@import",kL="@keyframes",pZ="@layer",mZ=Math.abs,l0=String.fromCharCode,gZ=Object.assign;function xZ(t,e){return gs(t,0)^45?(((e<<2^gs(t,0))<<2^gs(t,1))<<2^gs(t,2))<<2^gs(t,3):0}function NL(t){return t.trim()}function yZ(t,e){return(t=e.exec(t))?t[0]:t}function Dt(t,e,n){return t.replace(e,n)}function pC(t,e){return t.indexOf(e)}function gs(t,e){return t.charCodeAt(e)|0}function Sf(t,e,n){return t.slice(e,n)}function oi(t){return t.length}function Jk(t){return t.length}function Ym(t,e){return e.push(t),t}function vZ(t,e){return t.map(e).join("")}var c0=1,Ku=1,EL=0,Ir=0,On=0,kd="";function u0(t,e,n,s,r,o,i){return{value:t,root:e,parent:n,type:s,props:r,children:o,line:c0,column:Ku,length:i,return:""}}function nh(t,e){return gZ(u0("",null,null,"",null,null,0),t,{length:-t.length},e)}function bZ(){return On}function wZ(){return On=Ir>0?gs(kd,--Ir):0,Ku--,On===10&&(Ku=1,c0--),On}function Hr(){return On=Ir<EL?gs(kd,Ir++):0,Ku++,On===10&&(Ku=1,c0++),On}function gi(){return gs(kd,Ir)}function Bg(){return Ir}function ip(t,e){return Sf(kd,t,e)}function kf(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function $L(t){return c0=Ku=1,EL=oi(kd=t),Ir=0,[]}function IL(t){return kd="",t}function zg(t){return NL(ip(Ir-1,mC(t===91?t+2:t===40?t+1:t)))}function CZ(t){for(;(On=gi())&&On<33;)Hr();return kf(t)>2||kf(On)>3?"":" "}function SZ(t,e){for(;--e&&Hr()&&!(On<48||On>102||On>57&&On<65||On>70&&On<97););return ip(t,Bg()+(e<6&&gi()==32&&Hr()==32))}function mC(t){for(;Hr();)switch(On){case t:return Ir;case 34:case 39:t!==34&&t!==39&&mC(On);break;case 40:t===41&&mC(t);break;case 92:Hr();break}return Ir}function kZ(t,e){for(;Hr()&&t+On!==57;)if(t+On===84&&gi()===47)break;return"/*"+ip(e,Ir-1)+"*"+l0(t===47?t:Hr())}function NZ(t){for(;!kf(gi());)Hr();return ip(t,Ir)}function EZ(t){return IL(Ug("",null,null,null,[""],t=$L(t),0,[0],t))}function Ug(t,e,n,s,r,o,i,a,l){for(var c=0,u=0,d=i,h=0,f=0,m=0,g=1,y=1,x=1,v=0,b="",w=r,C=o,k=s,N=b;y;)switch(m=v,v=Hr()){case 40:if(m!=108&&gs(N,d-1)==58){pC(N+=Dt(zg(v),"&","&\f"),"&\f")!=-1&&(x=-1);break}case 34:case 39:case 91:N+=zg(v);break;case 9:case 10:case 13:case 32:N+=CZ(m);break;case 92:N+=SZ(Bg()-1,7);continue;case 47:switch(gi()){case 42:case 47:Ym($Z(kZ(Hr(),Bg()),e,n),l);break;default:N+="/"}break;case 123*g:a[c++]=oi(N)*x;case 125*g:case 59:case 0:switch(v){case 0:case 125:y=0;case 59+u:x==-1&&(N=Dt(N,/\f/g,"")),f>0&&oi(N)-d&&Ym(f>32?JT(N+";",s,n,d-1):JT(Dt(N," ","")+";",s,n,d-2),l);break;case 59:N+=";";default:if(Ym(k=YT(N,e,n,c,u,r,a,b,w=[],C=[],d),o),v===123)if(u===0)Ug(N,e,k,k,w,o,d,a,C);else switch(h===99&&gs(N,3)===110?100:h){case 100:case 108:case 109:case 115:Ug(t,k,k,s&&Ym(YT(t,k,k,0,0,r,a,b,r,w=[],d),C),r,C,d,a,s?w:C);break;default:Ug(N,k,k,k,[""],C,0,a,C)}}c=u=f=0,g=x=1,b=N="",d=i;break;case 58:d=1+oi(N),f=m;default:if(g<1){if(v==123)--g;else if(v==125&&g++==0&&wZ()==125)continue}switch(N+=l0(v),v*g){case 38:x=u>0?1:(N+="\f",-1);break;case 44:a[c++]=(oi(N)-1)*x,x=1;break;case 64:gi()===45&&(N+=zg(Hr())),h=gi(),u=d=oi(b=N+=NZ(Bg())),v++;break;case 45:m===45&&oi(N)==2&&(g=0)}}return o}function YT(t,e,n,s,r,o,i,a,l,c,u){for(var d=r-1,h=r===0?o:[""],f=Jk(h),m=0,g=0,y=0;m<s;++m)for(var x=0,v=Sf(t,d+1,d=mZ(g=i[m])),b=t;x<f;++x)(b=NL(g>0?h[x]+" "+v:Dt(v,/&\f/g,h[x])))&&(l[y++]=b);return u0(t,e,n,r===0?Xk:a,l,c,u)}function $Z(t,e,n){return u0(t,e,n,SL,l0(bZ()),Sf(t,2,-2),0)}function JT(t,e,n,s){return u0(t,e,n,Yk,Sf(t,0,s),Sf(t,s+1,-1),s)}function Iu(t,e){for(var n="",s=Jk(t),r=0;r<s;r++)n+=e(t[r],r,t,e)||"";return n}function IZ(t,e,n,s){switch(t.type){case pZ:if(t.children.length)break;case fZ:case Yk:return t.return=t.return||t.value;case SL:return"";case kL:return t.return=t.value+"{"+Iu(t.children,s)+"}";case Xk:t.value=t.props.join(",")}return oi(n=Iu(t.children,s))?t.return=t.value+"{"+n+"}":""}function TZ(t){var e=Jk(t);return function(n,s,r,o){for(var i="",a=0;a<e;a++)i+=t[a](n,s,r,o)||"";return i}}function RZ(t){return function(e){e.root||(e=e.return)&&t(e)}}function AZ(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var DZ=function(e,n,s){for(var r=0,o=0;r=o,o=gi(),r===38&&o===12&&(n[s]=1),!kf(o);)Hr();return ip(e,Ir)},OZ=function(e,n){var s=-1,r=44;do switch(kf(r)){case 0:r===38&&gi()===12&&(n[s]=1),e[s]+=DZ(Ir-1,n,s);break;case 2:e[s]+=zg(r);break;case 4:if(r===44){e[++s]=gi()===58?"&\f":"",n[s]=e[s].length;break}default:e[s]+=l0(r)}while(r=Hr());return e},FZ=function(e,n){return IL(OZ($L(e),n))},ZT=new WeakMap,PZ=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,s=e.parent,r=e.column===s.column&&e.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!ZT.get(s))&&!r){ZT.set(e,!0);for(var o=[],i=FZ(n,o),a=s.props,l=0,c=0;l<i.length;l++)for(var u=0;u<a.length;u++,c++)e.props[c]=o[l]?i[l].replace(/&\f/g,a[u]):a[u]+" "+i[l]}}},_Z=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function TL(t,e){switch(xZ(t,e)){case 5103:return At+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return At+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return At+t+Tx+t+Os+t+t;case 6828:case 4268:return At+t+Os+t+t;case 6165:return At+t+Os+"flex-"+t+t;case 5187:return At+t+Dt(t,/(\w+).+(:[^]+)/,At+"box-$1$2"+Os+"flex-$1$2")+t;case 5443:return At+t+Os+"flex-item-"+Dt(t,/flex-|-self/,"")+t;case 4675:return At+t+Os+"flex-line-pack"+Dt(t,/align-content|flex-|-self/,"")+t;case 5548:return At+t+Os+Dt(t,"shrink","negative")+t;case 5292:return At+t+Os+Dt(t,"basis","preferred-size")+t;case 6060:return At+"box-"+Dt(t,"-grow","")+At+t+Os+Dt(t,"grow","positive")+t;case 4554:return At+Dt(t,/([^-])(transform)/g,"$1"+At+"$2")+t;case 6187:return Dt(Dt(Dt(t,/(zoom-|grab)/,At+"$1"),/(image-set)/,At+"$1"),t,"")+t;case 5495:case 3959:return Dt(t,/(image-set\([^]*)/,At+"$1$`$1");case 4968:return Dt(Dt(t,/(.+:)(flex-)?(.*)/,At+"box-pack:$3"+Os+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+At+t+t;case 4095:case 3583:case 4068:case 2532:return Dt(t,/(.+)-inline(.+)/,At+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(oi(t)-1-e>6)switch(gs(t,e+1)){case 109:if(gs(t,e+4)!==45)break;case 102:return Dt(t,/(.+:)(.+)-([^]+)/,"$1"+At+"$2-$3$1"+Tx+(gs(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~pC(t,"stretch")?TL(Dt(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(gs(t,e+1)!==115)break;case 6444:switch(gs(t,oi(t)-3-(~pC(t,"!important")&&10))){case 107:return Dt(t,":",":"+At)+t;case 101:return Dt(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+At+(gs(t,14)===45?"inline-":"")+"box$3$1"+At+"$2$3$1"+Os+"$2box$3")+t}break;case 5936:switch(gs(t,e+11)){case 114:return At+t+Os+Dt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return At+t+Os+Dt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return At+t+Os+Dt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return At+t+Os+t+t}return t}var MZ=function(e,n,s,r){if(e.length>-1&&!e.return)switch(e.type){case Yk:e.return=TL(e.value,e.length);break;case kL:return Iu([nh(e,{value:Dt(e.value,"@","@"+At)})],r);case Xk:if(e.length)return vZ(e.props,function(o){switch(yZ(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Iu([nh(e,{props:[Dt(o,/:(read-\w+)/,":"+Tx+"$1")]})],r);case"::placeholder":return Iu([nh(e,{props:[Dt(o,/:(plac\w+)/,":"+At+"input-$1")]}),nh(e,{props:[Dt(o,/:(plac\w+)/,":"+Tx+"$1")]}),nh(e,{props:[Dt(o,/:(plac\w+)/,Os+"input-$1")]})],r)}return""})}},LZ=[MZ],jZ=function(e){var n=e.key;if(n==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(g){var y=g.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var r=e.stylisPlugins||LZ,o={},i,a=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var y=g.getAttribute("data-emotion").split(" "),x=1;x<y.length;x++)o[y[x]]=!0;a.push(g)});var l,c=[PZ,_Z];{var u,d=[IZ,RZ(function(g){u.insert(g)})],h=TZ(c.concat(r,d)),f=function(y){return Iu(EZ(y),h)};l=function(y,x,v,b){u=v,f(y?y+"{"+x.styles+"}":x.styles),b&&(m.inserted[x.name]=!0)}}var m={key:n,sheet:new hZ({key:n,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:l};return m.sheet.hydrate(a),m},RL={exports:{}},Mt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cs=typeof Symbol=="function"&&Symbol.for,Zk=cs?Symbol.for("react.element"):60103,Qk=cs?Symbol.for("react.portal"):60106,d0=cs?Symbol.for("react.fragment"):60107,h0=cs?Symbol.for("react.strict_mode"):60108,f0=cs?Symbol.for("react.profiler"):60114,p0=cs?Symbol.for("react.provider"):60109,m0=cs?Symbol.for("react.context"):60110,e2=cs?Symbol.for("react.async_mode"):60111,g0=cs?Symbol.for("react.concurrent_mode"):60111,x0=cs?Symbol.for("react.forward_ref"):60112,y0=cs?Symbol.for("react.suspense"):60113,BZ=cs?Symbol.for("react.suspense_list"):60120,v0=cs?Symbol.for("react.memo"):60115,b0=cs?Symbol.for("react.lazy"):60116,zZ=cs?Symbol.for("react.block"):60121,UZ=cs?Symbol.for("react.fundamental"):60117,VZ=cs?Symbol.for("react.responder"):60118,WZ=cs?Symbol.for("react.scope"):60119;function Qr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Zk:switch(t=t.type,t){case e2:case g0:case d0:case f0:case h0:case y0:return t;default:switch(t=t&&t.$$typeof,t){case m0:case x0:case b0:case v0:case p0:return t;default:return e}}case Qk:return e}}}function AL(t){return Qr(t)===g0}Mt.AsyncMode=e2;Mt.ConcurrentMode=g0;Mt.ContextConsumer=m0;Mt.ContextProvider=p0;Mt.Element=Zk;Mt.ForwardRef=x0;Mt.Fragment=d0;Mt.Lazy=b0;Mt.Memo=v0;Mt.Portal=Qk;Mt.Profiler=f0;Mt.StrictMode=h0;Mt.Suspense=y0;Mt.isAsyncMode=function(t){return AL(t)||Qr(t)===e2};Mt.isConcurrentMode=AL;Mt.isContextConsumer=function(t){return Qr(t)===m0};Mt.isContextProvider=function(t){return Qr(t)===p0};Mt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zk};Mt.isForwardRef=function(t){return Qr(t)===x0};Mt.isFragment=function(t){return Qr(t)===d0};Mt.isLazy=function(t){return Qr(t)===b0};Mt.isMemo=function(t){return Qr(t)===v0};Mt.isPortal=function(t){return Qr(t)===Qk};Mt.isProfiler=function(t){return Qr(t)===f0};Mt.isStrictMode=function(t){return Qr(t)===h0};Mt.isSuspense=function(t){return Qr(t)===y0};Mt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===d0||t===g0||t===f0||t===h0||t===y0||t===BZ||typeof t=="object"&&t!==null&&(t.$$typeof===b0||t.$$typeof===v0||t.$$typeof===p0||t.$$typeof===m0||t.$$typeof===x0||t.$$typeof===UZ||t.$$typeof===VZ||t.$$typeof===WZ||t.$$typeof===zZ)};Mt.typeOf=Qr;RL.exports=Mt;var HZ=RL.exports,DL=HZ,GZ={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},qZ={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},OL={};OL[DL.ForwardRef]=GZ;OL[DL.Memo]=qZ;var KZ=!0;function XZ(t,e,n){var s="";return n.split(" ").forEach(function(r){t[r]!==void 0?e.push(t[r]+";"):r&&(s+=r+" ")}),s}var FL=function(e,n,s){var r=e.key+"-"+n.name;(s===!1||KZ===!1)&&e.registered[r]===void 0&&(e.registered[r]=n.styles)},YZ=function(e,n,s){FL(e,n,s);var r=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var o=n;do e.insert(n===o?"."+r:"",o,e.sheet,!0),o=o.next;while(o!==void 0)}};function JZ(t){for(var e=0,n,s=0,r=t.length;r>=4;++s,r-=4)n=t.charCodeAt(s)&255|(t.charCodeAt(++s)&255)<<8|(t.charCodeAt(++s)&255)<<16|(t.charCodeAt(++s)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(r){case 3:e^=(t.charCodeAt(s+2)&255)<<16;case 2:e^=(t.charCodeAt(s+1)&255)<<8;case 1:e^=t.charCodeAt(s)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var ZZ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},QZ=/[A-Z]|^ms/g,eQ=/_EMO_([^_]+?)_([^]*?)_EMO_/g,PL=function(e){return e.charCodeAt(1)===45},QT=function(e){return e!=null&&typeof e!="boolean"},Vb=AZ(function(t){return PL(t)?t:t.replace(QZ,"-$&").toLowerCase()}),eR=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(eQ,function(s,r,o){return ii={name:r,styles:o,next:ii},r})}return ZZ[e]!==1&&!PL(e)&&typeof n=="number"&&n!==0?n+"px":n};function Nf(t,e,n){if(n==null)return"";var s=n;if(s.__emotion_styles!==void 0)return s;switch(typeof n){case"boolean":return"";case"object":{var r=n;if(r.anim===1)return ii={name:r.name,styles:r.styles,next:ii},r.name;var o=n;if(o.styles!==void 0){var i=o.next;if(i!==void 0)for(;i!==void 0;)ii={name:i.name,styles:i.styles,next:ii},i=i.next;var a=o.styles+";";return a}return tQ(t,e,n)}case"function":{if(t!==void 0){var l=ii,c=n(t);return ii=l,Nf(t,e,c)}break}}var u=n;return u}function tQ(t,e,n){var s="";if(Array.isArray(n))for(var r=0;r<n.length;r++)s+=Nf(t,e,n[r])+";";else for(var o in n){var i=n[o];if(typeof i!="object"){var a=i;QT(a)&&(s+=Vb(o)+":"+eR(o,a)+";")}else if(Array.isArray(i)&&typeof i[0]=="string"&&e==null)for(var l=0;l<i.length;l++)QT(i[l])&&(s+=Vb(o)+":"+eR(o,i[l])+";");else{var c=Nf(t,e,i);switch(o){case"animation":case"animationName":{s+=Vb(o)+":"+c+";";break}default:s+=o+"{"+c+"}"}}}return s}var tR=/label:\s*([^\s;{]+)\s*(;|$)/g,ii;function _L(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var s=!0,r="";ii=void 0;var o=t[0];if(o==null||o.raw===void 0)s=!1,r+=Nf(n,e,o);else{var i=o;r+=i[0]}for(var a=1;a<t.length;a++)if(r+=Nf(n,e,t[a]),s){var l=o;r+=l[a]}tR.lastIndex=0;for(var c="",u;(u=tR.exec(r))!==null;)c+="-"+u[1];var d=JZ(r)+c;return{name:d,styles:r,next:ii}}var nQ=function(e){return e()},sQ=Q1.useInsertionEffect?Q1.useInsertionEffect:!1,rQ=sQ||nQ,ML=S.createContext(typeof HTMLElement<"u"?jZ({key:"css"}):null);ML.Provider;var oQ=function(e){return S.forwardRef(function(n,s){var r=S.useContext(ML);return e(n,r,s)})},iQ=S.createContext({}),t2={}.hasOwnProperty,gC="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",aQ=function(e,n){var s={};for(var r in n)t2.call(n,r)&&(s[r]=n[r]);return s[gC]=e,s},lQ=function(e){var n=e.cache,s=e.serialized,r=e.isStringTag;return FL(n,s,r),rQ(function(){return YZ(n,s,r)}),null},cQ=oQ(function(t,e,n){var s=t.css;typeof s=="string"&&e.registered[s]!==void 0&&(s=e.registered[s]);var r=t[gC],o=[s],i="";typeof t.className=="string"?i=XZ(e.registered,o,t.className):t.className!=null&&(i=t.className+" ");var a=_L(o,void 0,S.useContext(iQ));i+=e.key+"-"+a.name;var l={};for(var c in t)t2.call(t,c)&&c!=="css"&&c!==gC&&(l[c]=t[c]);return l.className=i,n&&(l.ref=n),S.createElement(S.Fragment,null,S.createElement(lQ,{cache:e,serialized:a,isStringTag:typeof r=="string"}),S.createElement(r,l))}),uQ=cQ,Ge=function(e,n){var s=arguments;if(n==null||!t2.call(n,"css"))return S.createElement.apply(void 0,s);var r=s.length,o=new Array(r);o[0]=uQ,o[1]=aQ(e,n);for(var i=2;i<r;i++)o[i]=s[i];return S.createElement.apply(null,o)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Ge||(Ge={}));function n2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return _L(e)}function dQ(){var t=n2.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function hQ(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const fQ=Math.min,pQ=Math.max,Rx=Math.round,Jm=Math.floor,Ax=t=>({x:t,y:t});function mQ(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function w0(){return typeof window<"u"}function LL(t){return BL(t)?(t.nodeName||"").toLowerCase():"#document"}function ea(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function jL(t){var e;return(e=(BL(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function BL(t){return w0()?t instanceof Node||t instanceof ea(t).Node:!1}function gQ(t){return w0()?t instanceof Element||t instanceof ea(t).Element:!1}function s2(t){return w0()?t instanceof HTMLElement||t instanceof ea(t).HTMLElement:!1}function nR(t){return!w0()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof ea(t).ShadowRoot}function zL(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=r2(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!["inline","contents"].includes(r)}function xQ(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function yQ(t){return["html","body","#document"].includes(LL(t))}function r2(t){return ea(t).getComputedStyle(t)}function vQ(t){if(LL(t)==="html")return t;const e=t.assignedSlot||t.parentNode||nR(t)&&t.host||jL(t);return nR(e)?e.host:e}function UL(t){const e=vQ(t);return yQ(e)?t.ownerDocument?t.ownerDocument.body:t.body:s2(e)&&zL(e)?e:UL(e)}function Dx(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=UL(t),o=r===((s=t.ownerDocument)==null?void 0:s.body),i=ea(r);if(o){const a=xC(i);return e.concat(i,i.visualViewport||[],zL(r)?r:[],a&&n?Dx(a):[])}return e.concat(r,Dx(r,[],n))}function xC(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function bQ(t){const e=r2(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=s2(t),o=r?t.offsetWidth:n,i=r?t.offsetHeight:s,a=Rx(n)!==o||Rx(s)!==i;return a&&(n=o,s=i),{width:n,height:s,$:a}}function o2(t){return gQ(t)?t:t.contextElement}function sR(t){const e=o2(t);if(!s2(e))return Ax(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:o}=bQ(e);let i=(o?Rx(n.width):n.width)/s,a=(o?Rx(n.height):n.height)/r;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const wQ=Ax(0);function CQ(t){const e=ea(t);return!xQ()||!e.visualViewport?wQ:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function SQ(t,e,n){return!1}function rR(t,e,n,s){e===void 0&&(e=!1);const r=t.getBoundingClientRect(),o=o2(t);let i=Ax(1);e&&(i=sR(t));const a=SQ()?CQ(o):Ax(0);let l=(r.left+a.x)/i.x,c=(r.top+a.y)/i.y,u=r.width/i.x,d=r.height/i.y;if(o){const h=ea(o),f=s;let m=h,g=xC(m);for(;g&&s&&f!==m;){const y=sR(g),x=g.getBoundingClientRect(),v=r2(g),b=x.left+(g.clientLeft+parseFloat(v.paddingLeft))*y.x,w=x.top+(g.clientTop+parseFloat(v.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,d*=y.y,l+=b,c+=w,m=ea(g),g=xC(m)}}return mQ({width:u,height:d,x:l,y:c})}function VL(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function kQ(t,e){let n=null,s;const r=jL(t);function o(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(a||e(),!h||!f)return;const m=Jm(d),g=Jm(r.clientWidth-(u+h)),y=Jm(r.clientHeight-(d+f)),x=Jm(u),b={rootMargin:-m+"px "+-g+"px "+-y+"px "+-x+"px",threshold:pQ(0,fQ(1,l))||1};let w=!0;function C(k){const N=k[0].intersectionRatio;if(N!==l){if(!w)return i();N?i(!1,N):s=setTimeout(()=>{i(!1,1e-7)},1e3)}N===1&&!VL(c,t.getBoundingClientRect())&&i(),w=!1}try{n=new IntersectionObserver(C,{...b,root:r.ownerDocument})}catch{n=new IntersectionObserver(C,b)}n.observe(t)}return i(!0),o}function NQ(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=o2(t),u=r||o?[...c?Dx(c):[],...Dx(e)]:[];u.forEach(x=>{r&&x.addEventListener("scroll",n,{passive:!0}),o&&x.addEventListener("resize",n)});const d=c&&a?kQ(c,n):null;let h=-1,f=null;i&&(f=new ResizeObserver(x=>{let[v]=x;v&&v.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),n()}),c&&!l&&f.observe(c),f.observe(e));let m,g=l?rR(t):null;l&&y();function y(){const x=rR(t);g&&!VL(g,x)&&n(),g=x,m=requestAnimationFrame(y)}return n(),()=>{var x;u.forEach(v=>{r&&v.removeEventListener("scroll",n),o&&v.removeEventListener("resize",n)}),d==null||d(),(x=f)==null||x.disconnect(),f=null,l&&cancelAnimationFrame(m)}}var yC=S.useLayoutEffect,EQ=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Ox=function(){};function $Q(t,e){return e?e[0]==="-"?t+e:t+"__"+e:t}function IQ(t,e){for(var n=arguments.length,s=new Array(n>2?n-2:0),r=2;r<n;r++)s[r-2]=arguments[r];var o=[].concat(s);if(e&&t)for(var i in e)e.hasOwnProperty(i)&&e[i]&&o.push("".concat($Q(t,i)));return o.filter(function(a){return a}).map(function(a){return String(a).trim()}).join(" ")}var oR=function(e){return MQ(e)?e.filter(Boolean):hc(e)==="object"&&e!==null?[e]:[]},WL=function(e){e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme;var n=la(e,EQ);return Ke({},n)},xn=function(e,n,s){var r=e.cx,o=e.getStyles,i=e.getClassNames,a=e.className;return{css:o(n,e),className:r(s??{},i(n,e),a)}};function C0(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function TQ(t){return C0(t)?window.innerHeight:t.clientHeight}function HL(t){return C0(t)?window.pageYOffset:t.scrollTop}function Fx(t,e){if(C0(t)){window.scrollTo(0,e);return}t.scrollTop=e}function RQ(t){var e=getComputedStyle(t),n=e.position==="absolute",s=/(auto|scroll)/;if(e.position==="fixed")return document.documentElement;for(var r=t;r=r.parentElement;)if(e=getComputedStyle(r),!(n&&e.position==="static")&&s.test(e.overflow+e.overflowY+e.overflowX))return r;return document.documentElement}function AQ(t,e,n,s){return n*((t=t/s-1)*t*t+1)+e}function Zm(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ox,r=HL(t),o=e-r,i=10,a=0;function l(){a+=i;var c=AQ(a,r,o,n);Fx(t,c),a<n?window.requestAnimationFrame(l):s(t)}l()}function iR(t,e){var n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),r=e.offsetHeight/3;s.bottom+r>n.bottom?Fx(t,Math.min(e.offsetTop+e.clientHeight-t.offsetHeight+r,t.scrollHeight)):s.top-r<n.top&&Fx(t,Math.max(e.offsetTop-r,0))}function DQ(t){var e=t.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}function aR(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function OQ(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var GL=!1,FQ={get passive(){return GL=!0}},Qm=typeof window<"u"?window:{};Qm.addEventListener&&Qm.removeEventListener&&(Qm.addEventListener("p",Ox,FQ),Qm.removeEventListener("p",Ox,!1));var PQ=GL;function _Q(t){return t!=null}function MQ(t){return Array.isArray(t)}function eg(t,e,n){return t?e:n}var LQ=function(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];var o=Object.entries(e).filter(function(i){var a=Wi(i,1),l=a[0];return!s.includes(l)});return o.reduce(function(i,a){var l=Wi(a,2),c=l[0],u=l[1];return i[c]=u,i},{})},jQ=["children","innerProps"],BQ=["children","innerProps"];function zQ(t){var e=t.maxHeight,n=t.menuEl,s=t.minHeight,r=t.placement,o=t.shouldScroll,i=t.isFixedPosition,a=t.controlHeight,l=RQ(n),c={placement:"bottom",maxHeight:e};if(!n||!n.offsetParent)return c;var u=l.getBoundingClientRect(),d=u.height,h=n.getBoundingClientRect(),f=h.bottom,m=h.height,g=h.top,y=n.offsetParent.getBoundingClientRect(),x=y.top,v=i?window.innerHeight:TQ(l),b=HL(l),w=parseInt(getComputedStyle(n).marginBottom,10),C=parseInt(getComputedStyle(n).marginTop,10),k=x-C,N=v-g,E=k+b,$=d-b-g,I=f-v+b+w,A=b+g-C,P=160;switch(r){case"auto":case"bottom":if(N>=m)return{placement:"bottom",maxHeight:e};if($>=m&&!i)return o&&Zm(l,I,P),{placement:"bottom",maxHeight:e};if(!i&&$>=s||i&&N>=s){o&&Zm(l,I,P);var _=i?N-w:$-w;return{placement:"bottom",maxHeight:_}}if(r==="auto"||i){var U=e,V=i?k:E;return V>=s&&(U=Math.min(V-w-a,e)),{placement:"top",maxHeight:U}}if(r==="bottom")return o&&Fx(l,I),{placement:"bottom",maxHeight:e};break;case"top":if(k>=m)return{placement:"top",maxHeight:e};if(E>=m&&!i)return o&&Zm(l,A,P),{placement:"top",maxHeight:e};if(!i&&E>=s||i&&k>=s){var D=e;return(!i&&E>=s||i&&k>=s)&&(D=i?k-C:E-C),o&&Zm(l,A,P),{placement:"top",maxHeight:D}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(r,'".'))}return c}function UQ(t){var e={bottom:"top",top:"bottom"};return t?e[t]:"bottom"}var qL=function(e){return e==="auto"?"bottom":e},VQ=function(e,n){var s,r=e.placement,o=e.theme,i=o.borderRadius,a=o.spacing,l=o.colors;return Ke((s={label:"menu"},yh(s,UQ(r),"100%"),yh(s,"position","absolute"),yh(s,"width","100%"),yh(s,"zIndex",1),s),n?{}:{backgroundColor:l.neutral0,borderRadius:i,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:a.menuGutter,marginTop:a.menuGutter})},KL=S.createContext(null),WQ=function(e){var n=e.children,s=e.minMenuHeight,r=e.maxMenuHeight,o=e.menuPlacement,i=e.menuPosition,a=e.menuShouldScrollIntoView,l=e.theme,c=S.useContext(KL)||{},u=c.setPortalPlacement,d=S.useRef(null),h=S.useState(r),f=Wi(h,2),m=f[0],g=f[1],y=S.useState(null),x=Wi(y,2),v=x[0],b=x[1],w=l.spacing.controlHeight;return yC(function(){var C=d.current;if(C){var k=i==="fixed",N=a&&!k,E=zQ({maxHeight:r,menuEl:C,minHeight:s,placement:o,shouldScroll:N,isFixedPosition:k,controlHeight:w});g(E.maxHeight),b(E.placement),u==null||u(E.placement)}},[r,o,i,a,s,u,w]),n({ref:d,placerProps:Ke(Ke({},e),{},{placement:v||qL(o),maxHeight:m})})},HQ=function(e){var n=e.children,s=e.innerRef,r=e.innerProps;return Ge("div",Xe({},xn(e,"menu",{menu:!0}),{ref:s},r),n)},GQ=HQ,qQ=function(e,n){var s=e.maxHeight,r=e.theme.spacing.baseUnit;return Ke({maxHeight:s,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},n?{}:{paddingBottom:r,paddingTop:r})},KQ=function(e){var n=e.children,s=e.innerProps,r=e.innerRef,o=e.isMulti;return Ge("div",Xe({},xn(e,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:r},s),n)},XL=function(e,n){var s=e.theme,r=s.spacing.baseUnit,o=s.colors;return Ke({textAlign:"center"},n?{}:{color:o.neutral40,padding:"".concat(r*2,"px ").concat(r*3,"px")})},XQ=XL,YQ=XL,JQ=function(e){var n=e.children,s=n===void 0?"No options":n,r=e.innerProps,o=la(e,jQ);return Ge("div",Xe({},xn(Ke(Ke({},o),{},{children:s,innerProps:r}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),r),s)},ZQ=function(e){var n=e.children,s=n===void 0?"Loading...":n,r=e.innerProps,o=la(e,BQ);return Ge("div",Xe({},xn(Ke(Ke({},o),{},{children:s,innerProps:r}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),r),s)},QQ=function(e){var n=e.rect,s=e.offset,r=e.position;return{left:n.left,position:r,top:s,width:n.width,zIndex:1}},eee=function(e){var n=e.appendTo,s=e.children,r=e.controlElement,o=e.innerProps,i=e.menuPlacement,a=e.menuPosition,l=S.useRef(null),c=S.useRef(null),u=S.useState(qL(i)),d=Wi(u,2),h=d[0],f=d[1],m=S.useMemo(function(){return{setPortalPlacement:f}},[]),g=S.useState(null),y=Wi(g,2),x=y[0],v=y[1],b=S.useCallback(function(){if(r){var N=DQ(r),E=a==="fixed"?0:window.pageYOffset,$=N[h]+E;($!==(x==null?void 0:x.offset)||N.left!==(x==null?void 0:x.rect.left)||N.width!==(x==null?void 0:x.rect.width))&&v({offset:$,rect:N})}},[r,a,h,x==null?void 0:x.offset,x==null?void 0:x.rect.left,x==null?void 0:x.rect.width]);yC(function(){b()},[b]);var w=S.useCallback(function(){typeof c.current=="function"&&(c.current(),c.current=null),r&&l.current&&(c.current=NQ(r,l.current,b,{elementResize:"ResizeObserver"in window}))},[r,b]);yC(function(){w()},[w]);var C=S.useCallback(function(N){l.current=N,w()},[w]);if(!n&&a!=="fixed"||!x)return null;var k=Ge("div",Xe({ref:C},xn(Ke(Ke({},e),{},{offset:x.offset,position:a,rect:x.rect}),"menuPortal",{"menu-portal":!0}),o),s);return Ge(KL.Provider,{value:m},n?pk.createPortal(k,n):k)},tee=function(e){var n=e.isDisabled,s=e.isRtl;return{label:"container",direction:s?"rtl":void 0,pointerEvents:n?"none":void 0,position:"relative"}},nee=function(e){var n=e.children,s=e.innerProps,r=e.isDisabled,o=e.isRtl;return Ge("div",Xe({},xn(e,"container",{"--is-disabled":r,"--is-rtl":o}),s),n)},see=function(e,n){var s=e.theme.spacing,r=e.isMulti,o=e.hasValue,i=e.selectProps.controlShouldRenderValue;return Ke({alignItems:"center",display:r&&o&&i?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},n?{}:{padding:"".concat(s.baseUnit/2,"px ").concat(s.baseUnit*2,"px")})},ree=function(e){var n=e.children,s=e.innerProps,r=e.isMulti,o=e.hasValue;return Ge("div",Xe({},xn(e,"valueContainer",{"value-container":!0,"value-container--is-multi":r,"value-container--has-value":o}),s),n)},oee=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},iee=function(e){var n=e.children,s=e.innerProps;return Ge("div",Xe({},xn(e,"indicatorsContainer",{indicators:!0}),s),n)},lR,aee=["size"],lee=["innerProps","isRtl","size"],cee={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},YL=function(e){var n=e.size,s=la(e,aee);return Ge("svg",Xe({height:n,width:n,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:cee},s))},i2=function(e){return Ge(YL,Xe({size:20},e),Ge("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},JL=function(e){return Ge(YL,Xe({size:20},e),Ge("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},ZL=function(e,n){var s=e.isFocused,r=e.theme,o=r.spacing.baseUnit,i=r.colors;return Ke({label:"indicatorContainer",display:"flex",transition:"color 150ms"},n?{}:{color:s?i.neutral60:i.neutral20,padding:o*2,":hover":{color:s?i.neutral80:i.neutral40}})},uee=ZL,dee=function(e){var n=e.children,s=e.innerProps;return Ge("div",Xe({},xn(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),s),n||Ge(JL,null))},hee=ZL,fee=function(e){var n=e.children,s=e.innerProps;return Ge("div",Xe({},xn(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),s),n||Ge(i2,null))},pee=function(e,n){var s=e.isDisabled,r=e.theme,o=r.spacing.baseUnit,i=r.colors;return Ke({label:"indicatorSeparator",alignSelf:"stretch",width:1},n?{}:{backgroundColor:s?i.neutral10:i.neutral20,marginBottom:o*2,marginTop:o*2})},mee=function(e){var n=e.innerProps;return Ge("span",Xe({},n,xn(e,"indicatorSeparator",{"indicator-separator":!0})))},gee=dQ(lR||(lR=hQ([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),xee=function(e,n){var s=e.isFocused,r=e.size,o=e.theme,i=o.colors,a=o.spacing.baseUnit;return Ke({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:r,lineHeight:1,marginRight:r,textAlign:"center",verticalAlign:"middle"},n?{}:{color:s?i.neutral60:i.neutral20,padding:a*2})},Wb=function(e){var n=e.delay,s=e.offset;return Ge("span",{css:n2({animation:"".concat(gee," 1s ease-in-out ").concat(n,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:s?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},yee=function(e){var n=e.innerProps,s=e.isRtl,r=e.size,o=r===void 0?4:r,i=la(e,lee);return Ge("div",Xe({},xn(Ke(Ke({},i),{},{innerProps:n,isRtl:s,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),n),Ge(Wb,{delay:0,offset:s}),Ge(Wb,{delay:160,offset:!0}),Ge(Wb,{delay:320,offset:!s}))},vee=function(e,n){var s=e.isDisabled,r=e.isFocused,o=e.theme,i=o.colors,a=o.borderRadius,l=o.spacing;return Ke({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:l.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},n?{}:{backgroundColor:s?i.neutral5:i.neutral0,borderColor:s?i.neutral10:r?i.primary:i.neutral20,borderRadius:a,borderStyle:"solid",borderWidth:1,boxShadow:r?"0 0 0 1px ".concat(i.primary):void 0,"&:hover":{borderColor:r?i.primary:i.neutral30}})},bee=function(e){var n=e.children,s=e.isDisabled,r=e.isFocused,o=e.innerRef,i=e.innerProps,a=e.menuIsOpen;return Ge("div",Xe({ref:o},xn(e,"control",{control:!0,"control--is-disabled":s,"control--is-focused":r,"control--menu-is-open":a}),i,{"aria-disabled":s||void 0}),n)},wee=bee,Cee=["data"],See=function(e,n){var s=e.theme.spacing;return n?{}:{paddingBottom:s.baseUnit*2,paddingTop:s.baseUnit*2}},kee=function(e){var n=e.children,s=e.cx,r=e.getStyles,o=e.getClassNames,i=e.Heading,a=e.headingProps,l=e.innerProps,c=e.label,u=e.theme,d=e.selectProps;return Ge("div",Xe({},xn(e,"group",{group:!0}),l),Ge(i,Xe({},a,{selectProps:d,theme:u,getStyles:r,getClassNames:o,cx:s}),c),Ge("div",null,n))},Nee=function(e,n){var s=e.theme,r=s.colors,o=s.spacing;return Ke({label:"group",cursor:"default",display:"block"},n?{}:{color:r.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},Eee=function(e){var n=WL(e);n.data;var s=la(n,Cee);return Ge("div",Xe({},xn(e,"groupHeading",{"group-heading":!0}),s))},$ee=kee,Iee=["innerRef","isDisabled","isHidden","inputClassName"],Tee=function(e,n){var s=e.isDisabled,r=e.value,o=e.theme,i=o.spacing,a=o.colors;return Ke(Ke({visibility:s?"hidden":"visible",transform:r?"translateZ(0)":""},Ree),n?{}:{margin:i.baseUnit/2,paddingBottom:i.baseUnit/2,paddingTop:i.baseUnit/2,color:a.neutral80})},QL={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},Ree={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ke({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},QL)},Aee=function(e){return Ke({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},QL)},Dee=function(e){var n=e.cx,s=e.value,r=WL(e),o=r.innerRef,i=r.isDisabled,a=r.isHidden,l=r.inputClassName,c=la(r,Iee);return Ge("div",Xe({},xn(e,"input",{"input-container":!0}),{"data-value":s||""}),Ge("input",Xe({className:n({input:!0},l),ref:o,style:Aee(a),disabled:i},c)))},Oee=Dee,Fee=function(e,n){var s=e.theme,r=s.spacing,o=s.borderRadius,i=s.colors;return Ke({label:"multiValue",display:"flex",minWidth:0},n?{}:{backgroundColor:i.neutral10,borderRadius:o/2,margin:r.baseUnit/2})},Pee=function(e,n){var s=e.theme,r=s.borderRadius,o=s.colors,i=e.cropWithEllipsis;return Ke({overflow:"hidden",textOverflow:i||i===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},n?{}:{borderRadius:r/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},_ee=function(e,n){var s=e.theme,r=s.spacing,o=s.borderRadius,i=s.colors,a=e.isFocused;return Ke({alignItems:"center",display:"flex"},n?{}:{borderRadius:o/2,backgroundColor:a?i.dangerLight:void 0,paddingLeft:r.baseUnit,paddingRight:r.baseUnit,":hover":{backgroundColor:i.dangerLight,color:i.danger}})},e4=function(e){var n=e.children,s=e.innerProps;return Ge("div",s,n)},Mee=e4,Lee=e4;function jee(t){var e=t.children,n=t.innerProps;return Ge("div",Xe({role:"button"},n),e||Ge(i2,{size:14}))}var Bee=function(e){var n=e.children,s=e.components,r=e.data,o=e.innerProps,i=e.isDisabled,a=e.removeProps,l=e.selectProps,c=s.Container,u=s.Label,d=s.Remove;return Ge(c,{data:r,innerProps:Ke(Ke({},xn(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":i})),o),selectProps:l},Ge(u,{data:r,innerProps:Ke({},xn(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:l},n),Ge(d,{data:r,innerProps:Ke(Ke({},xn(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(n||"option")},a),selectProps:l}))},zee=Bee,Uee=function(e,n){var s=e.isDisabled,r=e.isFocused,o=e.isSelected,i=e.theme,a=i.spacing,l=i.colors;return Ke({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},n?{}:{backgroundColor:o?l.primary:r?l.primary25:"transparent",color:s?l.neutral20:o?l.neutral0:"inherit",padding:"".concat(a.baseUnit*2,"px ").concat(a.baseUnit*3,"px"),":active":{backgroundColor:s?void 0:o?l.primary:l.primary50}})},Vee=function(e){var n=e.children,s=e.isDisabled,r=e.isFocused,o=e.isSelected,i=e.innerRef,a=e.innerProps;return Ge("div",Xe({},xn(e,"option",{option:!0,"option--is-disabled":s,"option--is-focused":r,"option--is-selected":o}),{ref:i,"aria-disabled":s},a),n)},Wee=Vee,Hee=function(e,n){var s=e.theme,r=s.spacing,o=s.colors;return Ke({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},n?{}:{color:o.neutral50,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2})},Gee=function(e){var n=e.children,s=e.innerProps;return Ge("div",Xe({},xn(e,"placeholder",{placeholder:!0}),s),n)},qee=Gee,Kee=function(e,n){var s=e.isDisabled,r=e.theme,o=r.spacing,i=r.colors;return Ke({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n?{}:{color:s?i.neutral40:i.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},Xee=function(e){var n=e.children,s=e.isDisabled,r=e.innerProps;return Ge("div",Xe({},xn(e,"singleValue",{"single-value":!0,"single-value--is-disabled":s}),r),n)},Yee=Xee,Jee={ClearIndicator:fee,Control:wee,DropdownIndicator:dee,DownChevron:JL,CrossIcon:i2,Group:$ee,GroupHeading:Eee,IndicatorsContainer:iee,IndicatorSeparator:mee,Input:Oee,LoadingIndicator:yee,Menu:GQ,MenuList:KQ,MenuPortal:eee,LoadingMessage:ZQ,NoOptionsMessage:JQ,MultiValue:zee,MultiValueContainer:Mee,MultiValueLabel:Lee,MultiValueRemove:jee,Option:Wee,Placeholder:qee,SelectContainer:nee,SingleValue:Yee,ValueContainer:ree},Zee=function(e){return Ke(Ke({},Jee),e.components)},cR=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function Qee(t,e){return!!(t===e||cR(t)&&cR(e))}function ete(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!Qee(t[n],e[n]))return!1;return!0}function tte(t,e){e===void 0&&(e=ete);var n=null;function s(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(n&&n.lastThis===this&&e(r,n.lastArgs))return n.lastResult;var i=t.apply(this,r);return n={lastResult:i,lastArgs:r,lastThis:this},i}return s.clear=function(){n=null},s}var nte={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},ste=function(e){return Ge("span",Xe({css:nte},e))},uR=ste,rte={guidance:function(e){var n=e.isSearchable,s=e.isMulti,r=e.tabSelectsValue,o=e.context,i=e.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(r?", press Tab to select the option and exit the menu":"",".");case"input":return i?"".concat(e["aria-label"]||"Select"," is focused ").concat(n?",type to refine list":"",", press Down to open the menu, ").concat(s?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var n=e.action,s=e.label,r=s===void 0?"":s,o=e.labels,i=e.isDisabled;switch(n){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(r,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return i?"option ".concat(r," is disabled. Select another option."):"option ".concat(r,", selected.");default:return""}},onFocus:function(e){var n=e.context,s=e.focused,r=e.options,o=e.label,i=o===void 0?"":o,a=e.selectValue,l=e.isDisabled,c=e.isSelected,u=e.isAppleDevice,d=function(g,y){return g&&g.length?"".concat(g.indexOf(y)+1," of ").concat(g.length):""};if(n==="value"&&a)return"value ".concat(i," focused, ").concat(d(a,s),".");if(n==="menu"&&u){var h=l?" disabled":"",f="".concat(c?" selected":"").concat(h);return"".concat(i).concat(f,", ").concat(d(r,s),".")}return""},onFilter:function(e){var n=e.inputValue,s=e.resultsMessage;return"".concat(s).concat(n?" for search term "+n:"",".")}},ote=function(e){var n=e.ariaSelection,s=e.focusedOption,r=e.focusedValue,o=e.focusableOptions,i=e.isFocused,a=e.selectValue,l=e.selectProps,c=e.id,u=e.isAppleDevice,d=l.ariaLiveMessages,h=l.getOptionLabel,f=l.inputValue,m=l.isMulti,g=l.isOptionDisabled,y=l.isSearchable,x=l.menuIsOpen,v=l.options,b=l.screenReaderStatus,w=l.tabSelectsValue,C=l.isLoading,k=l["aria-label"],N=l["aria-live"],E=S.useMemo(function(){return Ke(Ke({},rte),d||{})},[d]),$=S.useMemo(function(){var V="";if(n&&E.onChange){var D=n.option,W=n.options,R=n.removedValue,j=n.removedValues,G=n.value,O=function(pe){return Array.isArray(pe)?null:pe},B=R||D||O(G),z=B?h(B):"",K=W||j||void 0,J=K?K.map(h):[],re=Ke({isDisabled:B&&g(B,a),label:z,labels:J},n);V=E.onChange(re)}return V},[n,E,g,a,h]),I=S.useMemo(function(){var V="",D=s||r,W=!!(s&&a&&a.includes(s));if(D&&E.onFocus){var R={focused:D,label:h(D),isDisabled:g(D,a),isSelected:W,options:o,context:D===s?"menu":"value",selectValue:a,isAppleDevice:u};V=E.onFocus(R)}return V},[s,r,h,g,E,o,a,u]),A=S.useMemo(function(){var V="";if(x&&v.length&&!C&&E.onFilter){var D=b({count:o.length});V=E.onFilter({inputValue:f,resultsMessage:D})}return V},[o,f,x,E,v,b,C]),P=(n==null?void 0:n.action)==="initial-input-focus",_=S.useMemo(function(){var V="";if(E.guidance){var D=r?"value":x?"menu":"input";V=E.guidance({"aria-label":k,context:D,isDisabled:s&&g(s,a),isMulti:m,isSearchable:y,tabSelectsValue:w,isInitialFocus:P})}return V},[k,s,r,m,g,y,x,E,a,w,P]),U=Ge(S.Fragment,null,Ge("span",{id:"aria-selection"},$),Ge("span",{id:"aria-focused"},I),Ge("span",{id:"aria-results"},A),Ge("span",{id:"aria-guidance"},_));return Ge(S.Fragment,null,Ge(uR,{id:c},P&&U),Ge(uR,{"aria-live":N,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},i&&!P&&U))},ite=ote,vC=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],ate=new RegExp("["+vC.map(function(t){return t.letters}).join("")+"]","g"),t4={};for(var Hb=0;Hb<vC.length;Hb++)for(var Gb=vC[Hb],qb=0;qb<Gb.letters.length;qb++)t4[Gb.letters[qb]]=Gb.base;var n4=function(e){return e.replace(ate,function(n){return t4[n]})},lte=tte(n4),dR=function(e){return e.replace(/^\s+|\s+$/g,"")},cte=function(e){return"".concat(e.label," ").concat(e.value)},ute=function(e){return function(n,s){if(n.data.__isNew__)return!0;var r=Ke({ignoreCase:!0,ignoreAccents:!0,stringify:cte,trim:!0,matchFrom:"any"},e),o=r.ignoreCase,i=r.ignoreAccents,a=r.stringify,l=r.trim,c=r.matchFrom,u=l?dR(s):s,d=l?dR(a(n)):a(n);return o&&(u=u.toLowerCase(),d=d.toLowerCase()),i&&(u=lte(u),d=n4(d)),c==="start"?d.substr(0,u.length)===u:d.indexOf(u)>-1}},dte=["innerRef"];function hte(t){var e=t.innerRef,n=la(t,dte),s=LQ(n,"onExited","in","enter","exit","appear");return Ge("input",Xe({ref:e},s,{css:n2({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var fte=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};function pte(t){var e=t.isEnabled,n=t.onBottomArrive,s=t.onBottomLeave,r=t.onTopArrive,o=t.onTopLeave,i=S.useRef(!1),a=S.useRef(!1),l=S.useRef(0),c=S.useRef(null),u=S.useCallback(function(y,x){if(c.current!==null){var v=c.current,b=v.scrollTop,w=v.scrollHeight,C=v.clientHeight,k=c.current,N=x>0,E=w-C-b,$=!1;E>x&&i.current&&(s&&s(y),i.current=!1),N&&a.current&&(o&&o(y),a.current=!1),N&&x>E?(n&&!i.current&&n(y),k.scrollTop=w,$=!0,i.current=!0):!N&&-x>b&&(r&&!a.current&&r(y),k.scrollTop=0,$=!0,a.current=!0),$&&fte(y)}},[n,s,r,o]),d=S.useCallback(function(y){u(y,y.deltaY)},[u]),h=S.useCallback(function(y){l.current=y.changedTouches[0].clientY},[]),f=S.useCallback(function(y){var x=l.current-y.changedTouches[0].clientY;u(y,x)},[u]),m=S.useCallback(function(y){if(y){var x=PQ?{passive:!1}:!1;y.addEventListener("wheel",d,x),y.addEventListener("touchstart",h,x),y.addEventListener("touchmove",f,x)}},[f,h,d]),g=S.useCallback(function(y){y&&(y.removeEventListener("wheel",d,!1),y.removeEventListener("touchstart",h,!1),y.removeEventListener("touchmove",f,!1))},[f,h,d]);return S.useEffect(function(){if(e){var y=c.current;return m(y),function(){g(y)}}},[e,m,g]),function(y){c.current=y}}var hR=["boxSizing","height","overflow","paddingRight","position"],fR={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function pR(t){t.cancelable&&t.preventDefault()}function mR(t){t.stopPropagation()}function gR(){var t=this.scrollTop,e=this.scrollHeight,n=t+this.offsetHeight;t===0?this.scrollTop=1:n===e&&(this.scrollTop=t-1)}function xR(){return"ontouchstart"in window||navigator.maxTouchPoints}var yR=!!(typeof window<"u"&&window.document&&window.document.createElement),sh=0,Xc={capture:!1,passive:!1};function mte(t){var e=t.isEnabled,n=t.accountForScrollbars,s=n===void 0?!0:n,r=S.useRef({}),o=S.useRef(null),i=S.useCallback(function(l){if(yR){var c=document.body,u=c&&c.style;if(s&&hR.forEach(function(m){var g=u&&u[m];r.current[m]=g}),s&&sh<1){var d=parseInt(r.current.paddingRight,10)||0,h=document.body?document.body.clientWidth:0,f=window.innerWidth-h+d||0;Object.keys(fR).forEach(function(m){var g=fR[m];u&&(u[m]=g)}),u&&(u.paddingRight="".concat(f,"px"))}c&&xR()&&(c.addEventListener("touchmove",pR,Xc),l&&(l.addEventListener("touchstart",gR,Xc),l.addEventListener("touchmove",mR,Xc))),sh+=1}},[s]),a=S.useCallback(function(l){if(yR){var c=document.body,u=c&&c.style;sh=Math.max(sh-1,0),s&&sh<1&&hR.forEach(function(d){var h=r.current[d];u&&(u[d]=h)}),c&&xR()&&(c.removeEventListener("touchmove",pR,Xc),l&&(l.removeEventListener("touchstart",gR,Xc),l.removeEventListener("touchmove",mR,Xc)))}},[s]);return S.useEffect(function(){if(e){var l=o.current;return i(l),function(){a(l)}}},[e,i,a]),function(l){o.current=l}}var gte=function(e){var n=e.target;return n.ownerDocument.activeElement&&n.ownerDocument.activeElement.blur()},xte={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function yte(t){var e=t.children,n=t.lockEnabled,s=t.captureEnabled,r=s===void 0?!0:s,o=t.onBottomArrive,i=t.onBottomLeave,a=t.onTopArrive,l=t.onTopLeave,c=pte({isEnabled:r,onBottomArrive:o,onBottomLeave:i,onTopArrive:a,onTopLeave:l}),u=mte({isEnabled:n}),d=function(f){c(f),u(f)};return Ge(S.Fragment,null,n&&Ge("div",{onClick:gte,css:xte}),e(d))}var vte={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},bte=function(e){var n=e.name,s=e.onFocus;return Ge("input",{required:!0,name:n,tabIndex:-1,"aria-hidden":"true",onFocus:s,css:vte,value:"",onChange:function(){}})},wte=bte;function a2(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Cte(){return a2(/^iPhone/i)}function s4(){return a2(/^Mac/i)}function Ste(){return a2(/^iPad/i)||s4()&&navigator.maxTouchPoints>1}function kte(){return Cte()||Ste()}function Nte(){return s4()||kte()}var Ete=function(e){return e.label},$te=function(e){return e.label},Ite=function(e){return e.value},Tte=function(e){return!!e.isDisabled},Rte={clearIndicator:hee,container:tee,control:vee,dropdownIndicator:uee,group:See,groupHeading:Nee,indicatorsContainer:oee,indicatorSeparator:pee,input:Tee,loadingIndicator:xee,loadingMessage:YQ,menu:VQ,menuList:qQ,menuPortal:QQ,multiValue:Fee,multiValueLabel:Pee,multiValueRemove:_ee,noOptionsMessage:XQ,option:Uee,placeholder:Hee,singleValue:Kee,valueContainer:see},Ate={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},Dte=4,r4=4,Ote=38,Fte=r4*2,Pte={baseUnit:r4,controlHeight:Ote,menuGutter:Fte},Kb={borderRadius:Dte,colors:Ate,spacing:Pte},_te={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:aR(),captureMenuScroll:!aR(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:ute(),formatGroupLabel:Ete,getOptionLabel:$te,getOptionValue:Ite,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:Tte,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!OQ(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var n=e.count;return"".concat(n," result").concat(n!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function vR(t,e,n,s){var r=a4(t,e,n),o=l4(t,e,n),i=i4(t,e),a=Px(t,e);return{type:"option",data:e,isDisabled:r,isSelected:o,label:i,value:a,index:s}}function Vg(t,e){return t.options.map(function(n,s){if("options"in n){var r=n.options.map(function(i,a){return vR(t,i,e,a)}).filter(function(i){return wR(t,i)});return r.length>0?{type:"group",data:n,options:r,index:s}:void 0}var o=vR(t,n,e,s);return wR(t,o)?o:void 0}).filter(_Q)}function o4(t){return t.reduce(function(e,n){return n.type==="group"?e.push.apply(e,Kk(n.options.map(function(s){return s.data}))):e.push(n.data),e},[])}function bR(t,e){return t.reduce(function(n,s){return s.type==="group"?n.push.apply(n,Kk(s.options.map(function(r){return{data:r.data,id:"".concat(e,"-").concat(s.index,"-").concat(r.index)}}))):n.push({data:s.data,id:"".concat(e,"-").concat(s.index)}),n},[])}function Mte(t,e){return o4(Vg(t,e))}function wR(t,e){var n=t.inputValue,s=n===void 0?"":n,r=e.data,o=e.isSelected,i=e.label,a=e.value;return(!u4(t)||!o)&&c4(t,{label:i,value:a,data:r},s)}function Lte(t,e){var n=t.focusedValue,s=t.selectValue,r=s.indexOf(n);if(r>-1){var o=e.indexOf(n);if(o>-1)return n;if(r<e.length)return e[r]}return null}function jte(t,e){var n=t.focusedOption;return n&&e.indexOf(n)>-1?n:e[0]}var Xb=function(e,n){var s,r=(s=e.find(function(o){return o.data===n}))===null||s===void 0?void 0:s.id;return r||null},i4=function(e,n){return e.getOptionLabel(n)},Px=function(e,n){return e.getOptionValue(n)};function a4(t,e,n){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(e,n):!1}function l4(t,e,n){if(n.indexOf(e)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(e,n);var s=Px(t,e);return n.some(function(r){return Px(t,r)===s})}function c4(t,e,n){return t.filterOption?t.filterOption(e,n):!0}var u4=function(e){var n=e.hideSelectedOptions,s=e.isMulti;return n===void 0?s:n},Bte=1,d4=function(t){sZ(n,t);var e=iZ(n);function n(s){var r;if(tZ(this,n),r=e.call(this,s),r.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},r.blockOptionHover=!1,r.isComposing=!1,r.commonProps=void 0,r.initialTouchX=0,r.initialTouchY=0,r.openAfterFocus=!1,r.scrollToFocusedOptionOnUpdate=!1,r.userIsDragging=void 0,r.isAppleDevice=Nte(),r.controlRef=null,r.getControlRef=function(l){r.controlRef=l},r.focusedOptionRef=null,r.getFocusedOptionRef=function(l){r.focusedOptionRef=l},r.menuListRef=null,r.getMenuListRef=function(l){r.menuListRef=l},r.inputRef=null,r.getInputRef=function(l){r.inputRef=l},r.focus=r.focusInput,r.blur=r.blurInput,r.onChange=function(l,c){var u=r.props,d=u.onChange,h=u.name;c.name=h,r.ariaOnChange(l,c),d(l,c)},r.setValue=function(l,c,u){var d=r.props,h=d.closeMenuOnSelect,f=d.isMulti,m=d.inputValue;r.onInputChange("",{action:"set-value",prevInputValue:m}),h&&(r.setState({inputIsHiddenAfterUpdate:!f}),r.onMenuClose()),r.setState({clearFocusValueOnUpdate:!0}),r.onChange(l,{action:c,option:u})},r.selectOption=function(l){var c=r.props,u=c.blurInputOnSelect,d=c.isMulti,h=c.name,f=r.state.selectValue,m=d&&r.isOptionSelected(l,f),g=r.isOptionDisabled(l,f);if(m){var y=r.getOptionValue(l);r.setValue(f.filter(function(x){return r.getOptionValue(x)!==y}),"deselect-option",l)}else if(!g)d?r.setValue([].concat(Kk(f),[l]),"select-option",l):r.setValue(l,"select-option");else{r.ariaOnChange(l,{action:"select-option",option:l,name:h});return}u&&r.blurInput()},r.removeValue=function(l){var c=r.props.isMulti,u=r.state.selectValue,d=r.getOptionValue(l),h=u.filter(function(m){return r.getOptionValue(m)!==d}),f=eg(c,h,h[0]||null);r.onChange(f,{action:"remove-value",removedValue:l}),r.focusInput()},r.clearValue=function(){var l=r.state.selectValue;r.onChange(eg(r.props.isMulti,[],null),{action:"clear",removedValues:l})},r.popValue=function(){var l=r.props.isMulti,c=r.state.selectValue,u=c[c.length-1],d=c.slice(0,c.length-1),h=eg(l,d,d[0]||null);u&&r.onChange(h,{action:"pop-value",removedValue:u})},r.getFocusedOptionId=function(l){return Xb(r.state.focusableOptionsWithIds,l)},r.getFocusableOptionsWithIds=function(){return bR(Vg(r.props,r.state.selectValue),r.getElementId("option"))},r.getValue=function(){return r.state.selectValue},r.cx=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return IQ.apply(void 0,[r.props.classNamePrefix].concat(c))},r.getOptionLabel=function(l){return i4(r.props,l)},r.getOptionValue=function(l){return Px(r.props,l)},r.getStyles=function(l,c){var u=r.props.unstyled,d=Rte[l](c,u);d.boxSizing="border-box";var h=r.props.styles[l];return h?h(d,c):d},r.getClassNames=function(l,c){var u,d;return(u=(d=r.props.classNames)[l])===null||u===void 0?void 0:u.call(d,c)},r.getElementId=function(l){return"".concat(r.state.instancePrefix,"-").concat(l)},r.getComponents=function(){return Zee(r.props)},r.buildCategorizedOptions=function(){return Vg(r.props,r.state.selectValue)},r.getCategorizedOptions=function(){return r.props.menuIsOpen?r.buildCategorizedOptions():[]},r.buildFocusableOptions=function(){return o4(r.buildCategorizedOptions())},r.getFocusableOptions=function(){return r.props.menuIsOpen?r.buildFocusableOptions():[]},r.ariaOnChange=function(l,c){r.setState({ariaSelection:Ke({value:l},c)})},r.onMenuMouseDown=function(l){l.button===0&&(l.stopPropagation(),l.preventDefault(),r.focusInput())},r.onMenuMouseMove=function(l){r.blockOptionHover=!1},r.onControlMouseDown=function(l){if(!l.defaultPrevented){var c=r.props.openMenuOnClick;r.state.isFocused?r.props.menuIsOpen?l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&r.onMenuClose():c&&r.openMenu("first"):(c&&(r.openAfterFocus=!0),r.focusInput()),l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&l.preventDefault()}},r.onDropdownIndicatorMouseDown=function(l){if(!(l&&l.type==="mousedown"&&l.button!==0)&&!r.props.isDisabled){var c=r.props,u=c.isMulti,d=c.menuIsOpen;r.focusInput(),d?(r.setState({inputIsHiddenAfterUpdate:!u}),r.onMenuClose()):r.openMenu("first"),l.preventDefault()}},r.onClearIndicatorMouseDown=function(l){l&&l.type==="mousedown"&&l.button!==0||(r.clearValue(),l.preventDefault(),r.openAfterFocus=!1,l.type==="touchend"?r.focusInput():setTimeout(function(){return r.focusInput()}))},r.onScroll=function(l){typeof r.props.closeMenuOnScroll=="boolean"?l.target instanceof HTMLElement&&C0(l.target)&&r.props.onMenuClose():typeof r.props.closeMenuOnScroll=="function"&&r.props.closeMenuOnScroll(l)&&r.props.onMenuClose()},r.onCompositionStart=function(){r.isComposing=!0},r.onCompositionEnd=function(){r.isComposing=!1},r.onTouchStart=function(l){var c=l.touches,u=c&&c.item(0);u&&(r.initialTouchX=u.clientX,r.initialTouchY=u.clientY,r.userIsDragging=!1)},r.onTouchMove=function(l){var c=l.touches,u=c&&c.item(0);if(u){var d=Math.abs(u.clientX-r.initialTouchX),h=Math.abs(u.clientY-r.initialTouchY),f=5;r.userIsDragging=d>f||h>f}},r.onTouchEnd=function(l){r.userIsDragging||(r.controlRef&&!r.controlRef.contains(l.target)&&r.menuListRef&&!r.menuListRef.contains(l.target)&&r.blurInput(),r.initialTouchX=0,r.initialTouchY=0)},r.onControlTouchEnd=function(l){r.userIsDragging||r.onControlMouseDown(l)},r.onClearIndicatorTouchEnd=function(l){r.userIsDragging||r.onClearIndicatorMouseDown(l)},r.onDropdownIndicatorTouchEnd=function(l){r.userIsDragging||r.onDropdownIndicatorMouseDown(l)},r.handleInputChange=function(l){var c=r.props.inputValue,u=l.currentTarget.value;r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange(u,{action:"input-change",prevInputValue:c}),r.props.menuIsOpen||r.onMenuOpen()},r.onInputFocus=function(l){r.props.onFocus&&r.props.onFocus(l),r.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(r.openAfterFocus||r.props.openMenuOnFocus)&&r.openMenu("first"),r.openAfterFocus=!1},r.onInputBlur=function(l){var c=r.props.inputValue;if(r.menuListRef&&r.menuListRef.contains(document.activeElement)){r.inputRef.focus();return}r.props.onBlur&&r.props.onBlur(l),r.onInputChange("",{action:"input-blur",prevInputValue:c}),r.onMenuClose(),r.setState({focusedValue:null,isFocused:!1})},r.onOptionHover=function(l){if(!(r.blockOptionHover||r.state.focusedOption===l)){var c=r.getFocusableOptions(),u=c.indexOf(l);r.setState({focusedOption:l,focusedOptionId:u>-1?r.getFocusedOptionId(l):null})}},r.shouldHideSelectedOptions=function(){return u4(r.props)},r.onValueInputFocus=function(l){l.preventDefault(),l.stopPropagation(),r.focus()},r.onKeyDown=function(l){var c=r.props,u=c.isMulti,d=c.backspaceRemovesValue,h=c.escapeClearsValue,f=c.inputValue,m=c.isClearable,g=c.isDisabled,y=c.menuIsOpen,x=c.onKeyDown,v=c.tabSelectsValue,b=c.openMenuOnFocus,w=r.state,C=w.focusedOption,k=w.focusedValue,N=w.selectValue;if(!g&&!(typeof x=="function"&&(x(l),l.defaultPrevented))){switch(r.blockOptionHover=!0,l.key){case"ArrowLeft":if(!u||f)return;r.focusValue("previous");break;case"ArrowRight":if(!u||f)return;r.focusValue("next");break;case"Delete":case"Backspace":if(f)return;if(k)r.removeValue(k);else{if(!d)return;u?r.popValue():m&&r.clearValue()}break;case"Tab":if(r.isComposing||l.shiftKey||!y||!v||!C||b&&r.isOptionSelected(C,N))return;r.selectOption(C);break;case"Enter":if(l.keyCode===229)break;if(y){if(!C||r.isComposing)return;r.selectOption(C);break}return;case"Escape":y?(r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange("",{action:"menu-close",prevInputValue:f}),r.onMenuClose()):m&&h&&r.clearValue();break;case" ":if(f)return;if(!y){r.openMenu("first");break}if(!C)return;r.selectOption(C);break;case"ArrowUp":y?r.focusOption("up"):r.openMenu("last");break;case"ArrowDown":y?r.focusOption("down"):r.openMenu("first");break;case"PageUp":if(!y)return;r.focusOption("pageup");break;case"PageDown":if(!y)return;r.focusOption("pagedown");break;case"Home":if(!y)return;r.focusOption("first");break;case"End":if(!y)return;r.focusOption("last");break;default:return}l.preventDefault()}},r.state.instancePrefix="react-select-"+(r.props.instanceId||++Bte),r.state.selectValue=oR(s.value),s.menuIsOpen&&r.state.selectValue.length){var o=r.getFocusableOptionsWithIds(),i=r.buildFocusableOptions(),a=i.indexOf(r.state.selectValue[0]);r.state.focusableOptionsWithIds=o,r.state.focusedOption=i[a],r.state.focusedOptionId=Xb(o,i[a])}return r}return nZ(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&iR(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(r){var o=this.props,i=o.isDisabled,a=o.menuIsOpen,l=this.state.isFocused;(l&&!i&&r.isDisabled||l&&a&&!r.menuIsOpen)&&this.focusInput(),l&&i&&!r.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!l&&!i&&r.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(iR(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(r,o){this.props.onInputChange(r,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(r){var o=this,i=this.state,a=i.selectValue,l=i.isFocused,c=this.buildFocusableOptions(),u=r==="first"?0:c.length-1;if(!this.props.isMulti){var d=c.indexOf(a[0]);d>-1&&(u=d)}this.scrollToFocusedOptionOnUpdate=!(l&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:c[u],focusedOptionId:this.getFocusedOptionId(c[u])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(r){var o=this.state,i=o.selectValue,a=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var l=i.indexOf(a);a||(l=-1);var c=i.length-1,u=-1;if(i.length){switch(r){case"previous":l===0?u=0:l===-1?u=c:u=l-1;break;case"next":l>-1&&l<c&&(u=l+1);break}this.setState({inputIsHidden:u!==-1,focusedValue:i[u]})}}}},{key:"focusOption",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,i=this.state.focusedOption,a=this.getFocusableOptions();if(a.length){var l=0,c=a.indexOf(i);i||(c=-1),r==="up"?l=c>0?c-1:a.length-1:r==="down"?l=(c+1)%a.length:r==="pageup"?(l=c-o,l<0&&(l=0)):r==="pagedown"?(l=c+o,l>a.length-1&&(l=a.length-1)):r==="last"&&(l=a.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:a[l],focusedValue:null,focusedOptionId:this.getFocusedOptionId(a[l])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Kb):Ke(Ke({},Kb),this.props.theme):Kb}},{key:"getCommonProps",value:function(){var r=this.clearValue,o=this.cx,i=this.getStyles,a=this.getClassNames,l=this.getValue,c=this.selectOption,u=this.setValue,d=this.props,h=d.isMulti,f=d.isRtl,m=d.options,g=this.hasValue();return{clearValue:r,cx:o,getStyles:i,getClassNames:a,getValue:l,hasValue:g,isMulti:h,isRtl:f,options:m,selectOption:c,selectProps:d,setValue:u,theme:this.getTheme()}}},{key:"hasValue",value:function(){var r=this.state.selectValue;return r.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var r=this.props,o=r.isClearable,i=r.isMulti;return o===void 0?i:o}},{key:"isOptionDisabled",value:function(r,o){return a4(this.props,r,o)}},{key:"isOptionSelected",value:function(r,o){return l4(this.props,r,o)}},{key:"filterOption",value:function(r,o){return c4(this.props,r,o)}},{key:"formatOptionLabel",value:function(r,o){if(typeof this.props.formatOptionLabel=="function"){var i=this.props.inputValue,a=this.state.selectValue;return this.props.formatOptionLabel(r,{context:o,inputValue:i,selectValue:a})}else return this.getOptionLabel(r)}},{key:"formatGroupLabel",value:function(r){return this.props.formatGroupLabel(r)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var r=this.props,o=r.isDisabled,i=r.isSearchable,a=r.inputId,l=r.inputValue,c=r.tabIndex,u=r.form,d=r.menuIsOpen,h=r.required,f=this.getComponents(),m=f.Input,g=this.state,y=g.inputIsHidden,x=g.ariaSelection,v=this.commonProps,b=a||this.getElementId("input"),w=Ke(Ke(Ke({"aria-autocomplete":"list","aria-expanded":d,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":h,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},d&&{"aria-controls":this.getElementId("listbox")}),!i&&{"aria-readonly":!0}),this.hasValue()?(x==null?void 0:x.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return i?S.createElement(m,Xe({},v,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:b,innerRef:this.getInputRef,isDisabled:o,isHidden:y,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:c,form:u,type:"text",value:l},w)):S.createElement(hte,Xe({id:b,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Ox,onFocus:this.onInputFocus,disabled:o,tabIndex:c,inputMode:"none",form:u,value:""},w))}},{key:"renderPlaceholderOrValue",value:function(){var r=this,o=this.getComponents(),i=o.MultiValue,a=o.MultiValueContainer,l=o.MultiValueLabel,c=o.MultiValueRemove,u=o.SingleValue,d=o.Placeholder,h=this.commonProps,f=this.props,m=f.controlShouldRenderValue,g=f.isDisabled,y=f.isMulti,x=f.inputValue,v=f.placeholder,b=this.state,w=b.selectValue,C=b.focusedValue,k=b.isFocused;if(!this.hasValue()||!m)return x?null:S.createElement(d,Xe({},h,{key:"placeholder",isDisabled:g,isFocused:k,innerProps:{id:this.getElementId("placeholder")}}),v);if(y)return w.map(function(E,$){var I=E===C,A="".concat(r.getOptionLabel(E),"-").concat(r.getOptionValue(E));return S.createElement(i,Xe({},h,{components:{Container:a,Label:l,Remove:c},isFocused:I,isDisabled:g,key:A,index:$,removeProps:{onClick:function(){return r.removeValue(E)},onTouchEnd:function(){return r.removeValue(E)},onMouseDown:function(_){_.preventDefault()}},data:E}),r.formatOptionLabel(E,"value"))});if(x)return null;var N=w[0];return S.createElement(u,Xe({},h,{data:N,isDisabled:g}),this.formatOptionLabel(N,"value"))}},{key:"renderClearIndicator",value:function(){var r=this.getComponents(),o=r.ClearIndicator,i=this.commonProps,a=this.props,l=a.isDisabled,c=a.isLoading,u=this.state.isFocused;if(!this.isClearable()||!o||l||!this.hasValue()||c)return null;var d={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return S.createElement(o,Xe({},i,{innerProps:d,isFocused:u}))}},{key:"renderLoadingIndicator",value:function(){var r=this.getComponents(),o=r.LoadingIndicator,i=this.commonProps,a=this.props,l=a.isDisabled,c=a.isLoading,u=this.state.isFocused;if(!o||!c)return null;var d={"aria-hidden":"true"};return S.createElement(o,Xe({},i,{innerProps:d,isDisabled:l,isFocused:u}))}},{key:"renderIndicatorSeparator",value:function(){var r=this.getComponents(),o=r.DropdownIndicator,i=r.IndicatorSeparator;if(!o||!i)return null;var a=this.commonProps,l=this.props.isDisabled,c=this.state.isFocused;return S.createElement(i,Xe({},a,{isDisabled:l,isFocused:c}))}},{key:"renderDropdownIndicator",value:function(){var r=this.getComponents(),o=r.DropdownIndicator;if(!o)return null;var i=this.commonProps,a=this.props.isDisabled,l=this.state.isFocused,c={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return S.createElement(o,Xe({},i,{innerProps:c,isDisabled:a,isFocused:l}))}},{key:"renderMenu",value:function(){var r=this,o=this.getComponents(),i=o.Group,a=o.GroupHeading,l=o.Menu,c=o.MenuList,u=o.MenuPortal,d=o.LoadingMessage,h=o.NoOptionsMessage,f=o.Option,m=this.commonProps,g=this.state.focusedOption,y=this.props,x=y.captureMenuScroll,v=y.inputValue,b=y.isLoading,w=y.loadingMessage,C=y.minMenuHeight,k=y.maxMenuHeight,N=y.menuIsOpen,E=y.menuPlacement,$=y.menuPosition,I=y.menuPortalTarget,A=y.menuShouldBlockScroll,P=y.menuShouldScrollIntoView,_=y.noOptionsMessage,U=y.onMenuScrollToTop,V=y.onMenuScrollToBottom;if(!N)return null;var D=function(z,K){var J=z.type,re=z.data,de=z.isDisabled,pe=z.isSelected,we=z.label,Ce=z.value,Ne=g===re,ze=de?void 0:function(){return r.onOptionHover(re)},_e=de?void 0:function(){return r.selectOption(re)},st="".concat(r.getElementId("option"),"-").concat(K),je={id:st,onClick:_e,onMouseMove:ze,onMouseOver:ze,tabIndex:-1,role:"option","aria-selected":r.isAppleDevice?void 0:pe};return S.createElement(f,Xe({},m,{innerProps:je,data:re,isDisabled:de,isSelected:pe,key:st,label:we,type:J,value:Ce,isFocused:Ne,innerRef:Ne?r.getFocusedOptionRef:void 0}),r.formatOptionLabel(z.data,"menu"))},W;if(this.hasOptions())W=this.getCategorizedOptions().map(function(B){if(B.type==="group"){var z=B.data,K=B.options,J=B.index,re="".concat(r.getElementId("group"),"-").concat(J),de="".concat(re,"-heading");return S.createElement(i,Xe({},m,{key:re,data:z,options:K,Heading:a,headingProps:{id:de,data:B.data},label:r.formatGroupLabel(B.data)}),B.options.map(function(pe){return D(pe,"".concat(J,"-").concat(pe.index))}))}else if(B.type==="option")return D(B,"".concat(B.index))});else if(b){var R=w({inputValue:v});if(R===null)return null;W=S.createElement(d,m,R)}else{var j=_({inputValue:v});if(j===null)return null;W=S.createElement(h,m,j)}var G={minMenuHeight:C,maxMenuHeight:k,menuPlacement:E,menuPosition:$,menuShouldScrollIntoView:P},O=S.createElement(WQ,Xe({},m,G),function(B){var z=B.ref,K=B.placerProps,J=K.placement,re=K.maxHeight;return S.createElement(l,Xe({},m,G,{innerRef:z,innerProps:{onMouseDown:r.onMenuMouseDown,onMouseMove:r.onMenuMouseMove},isLoading:b,placement:J}),S.createElement(yte,{captureEnabled:x,onTopArrive:U,onBottomArrive:V,lockEnabled:A},function(de){return S.createElement(c,Xe({},m,{innerRef:function(we){r.getMenuListRef(we),de(we)},innerProps:{role:"listbox","aria-multiselectable":m.isMulti,id:r.getElementId("listbox")},isLoading:b,maxHeight:re,focusedOption:g}),W)}))});return I||$==="fixed"?S.createElement(u,Xe({},m,{appendTo:I,controlElement:this.controlRef,menuPlacement:E,menuPosition:$}),O):O}},{key:"renderFormField",value:function(){var r=this,o=this.props,i=o.delimiter,a=o.isDisabled,l=o.isMulti,c=o.name,u=o.required,d=this.state.selectValue;if(u&&!this.hasValue()&&!a)return S.createElement(wte,{name:c,onFocus:this.onValueInputFocus});if(!(!c||a))if(l)if(i){var h=d.map(function(g){return r.getOptionValue(g)}).join(i);return S.createElement("input",{name:c,type:"hidden",value:h})}else{var f=d.length>0?d.map(function(g,y){return S.createElement("input",{key:"i-".concat(y),name:c,type:"hidden",value:r.getOptionValue(g)})}):S.createElement("input",{name:c,type:"hidden",value:""});return S.createElement("div",null,f)}else{var m=d[0]?this.getOptionValue(d[0]):"";return S.createElement("input",{name:c,type:"hidden",value:m})}}},{key:"renderLiveRegion",value:function(){var r=this.commonProps,o=this.state,i=o.ariaSelection,a=o.focusedOption,l=o.focusedValue,c=o.isFocused,u=o.selectValue,d=this.getFocusableOptions();return S.createElement(ite,Xe({},r,{id:this.getElementId("live-region"),ariaSelection:i,focusedOption:a,focusedValue:l,isFocused:c,selectValue:u,focusableOptions:d,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var r=this.getComponents(),o=r.Control,i=r.IndicatorsContainer,a=r.SelectContainer,l=r.ValueContainer,c=this.props,u=c.className,d=c.id,h=c.isDisabled,f=c.menuIsOpen,m=this.state.isFocused,g=this.commonProps=this.getCommonProps();return S.createElement(a,Xe({},g,{className:u,innerProps:{id:d,onKeyDown:this.onKeyDown},isDisabled:h,isFocused:m}),this.renderLiveRegion(),S.createElement(o,Xe({},g,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:h,isFocused:m,menuIsOpen:f}),S.createElement(l,Xe({},g,{isDisabled:h}),this.renderPlaceholderOrValue(),this.renderInput()),S.createElement(i,Xe({},g,{isDisabled:h}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(r,o){var i=o.prevProps,a=o.clearFocusValueOnUpdate,l=o.inputIsHiddenAfterUpdate,c=o.ariaSelection,u=o.isFocused,d=o.prevWasFocused,h=o.instancePrefix,f=r.options,m=r.value,g=r.menuIsOpen,y=r.inputValue,x=r.isMulti,v=oR(m),b={};if(i&&(m!==i.value||f!==i.options||g!==i.menuIsOpen||y!==i.inputValue)){var w=g?Mte(r,v):[],C=g?bR(Vg(r,v),"".concat(h,"-option")):[],k=a?Lte(o,v):null,N=jte(o,w),E=Xb(C,N);b={selectValue:v,focusedOption:N,focusedOptionId:E,focusableOptionsWithIds:C,focusedValue:k,clearFocusValueOnUpdate:!1}}var $=l!=null&&r!==i?{inputIsHidden:l,inputIsHiddenAfterUpdate:void 0}:{},I=c,A=u&&d;return u&&!A&&(I={value:eg(x,v,v[0]||null),options:v,action:"initial-input-focus"},A=!d),(c==null?void 0:c.action)==="initial-input-focus"&&(I=null),Ke(Ke(Ke({},b),$),{},{prevProps:r,ariaSelection:I,prevWasFocused:A})}}]),n}(S.Component);d4.defaultProps=_te;var zte=S.forwardRef(function(t,e){var n=eZ(t);return S.createElement(d4,Xe({ref:e},n))}),Ute=zte;function Vte(){const{user:t}=Hs(),e=(t==null?void 0:t.role)==="freelancer",[n,s]=S.useState(!0),[r,o]=S.useState(!1),[i,a]=S.useState(""),[l,c]=S.useState({firstName:"",lastName:"",email:"",phone:"",company:"",position:"",location:""}),[u,d]=S.useState({title:"",bio:"",skills:[],hourlyRate:{amount:0,currency:"USD"},experience:[],education:[],socialLinks:{linkedin:"",github:"",website:""},availability:"immediately"}),h=[{value:"data-engineer",label:"Data Engineer"},{value:"web-developer",label:"Web Developer"},{value:"frontend-developer",label:"Frontend Developer"},{value:"backend-developer",label:"Backend Developer"},{value:"full-stack-developer",label:"Full Stack Developer"},{value:"mobile-developer",label:"Mobile Developer"},{value:"devops-engineer",label:"DevOps Engineer"},{value:"cloud-architect",label:"Cloud Architect"},{value:"data-scientist",label:"Data Scientist"},{value:"machine-learning-engineer",label:"Machine Learning Engineer"},{value:"ui-ux-designer",label:"UI/UX Designer"},{value:"graphic-designer",label:"Graphic Designer"},{value:"project-manager",label:"Project Manager"},{value:"business-analyst",label:"Business Analyst"},{value:"carpenter",label:"Carpentry"},{value:"plumber",label:"Plumbing"},{value:"electrician",label:"Electrician"},{value:"writer",label:"Writer/Editor"},{value:"photographer",label:"Photographer"},{value:"virtual-assistant",label:"Virtual Assistant"},{value:"other",label:"Other (Please specify)"}];S.useEffect(()=>{f()},[t]),S.useEffect(()=>{const g=u.skills||[],y=h.map(v=>v.value),x=g.find(v=>!y.includes(v)&&v!=="other");x?(o(!0),a(x)):o(g.includes("other"))},[u.skills]);const f=async()=>{var g,y;try{if(e)try{const x=await We.get("/freelancers/profile");console.log("Fetched freelancer profile:",x.data),x.data&&x.data._id?d({title:x.data.title||"",bio:x.data.bio||"",skills:x.data.skills||[],hourlyRate:x.data.hourlyRate||{amount:0,currency:"USD"},experience:x.data.experience||[],education:x.data.education||[],socialLinks:x.data.socialLinks||{},availability:x.data.availability||"immediately"}):console.log("No existing profile found, will create new one")}catch(x){if(((g=x.response)==null?void 0:g.status)===404)console.log("No profile exists yet, will create new one");else throw x}else try{const x=await We.get("/employers/profile");console.log("Fetched employer profile:",x.data),x.data&&x.data._id&&c({firstName:x.data.firstName||"",lastName:x.data.lastName||"",email:x.data.email||"",phone:x.data.phone||"",company:x.data.company||"",position:x.data.position||"",location:x.data.location||""})}catch(x){if(((y=x.response)==null?void 0:y.status)===404)console.log("No employer profile exists yet, will create new one");else throw x}}catch(x){console.error("Error fetching profile:",x),xe.error("Failed to fetch profile")}finally{s(!1)}},m=async g=>{var y,x;g.preventDefault();try{if(s(!0),e){console.log("Updating freelancer profile with data:",u);let v=Array.isArray(u.skills)?[...u.skills]:[];v=v.filter(w=>w!=="other"),r&&i.trim()&&v.push(i.trim()),v=[...new Set(v)];const b={...u,skills:v,hourlyRate:{amount:Number(u.hourlyRate.amount)||0,currency:u.hourlyRate.currency||"USD"}};await We.put("/freelancers/profile",b)}else console.log("Updating employer profile with data:",l),await We.put("/employers/profile",l);xe.success("Profile updated successfully"),await f()}catch(v){console.error("Error updating profile:",v),xe.error(`Failed to update profile: ${((x=(y=v.response)==null?void 0:y.data)==null?void 0:x.message)||v.message}`)}finally{s(!1)}};return n?p.jsx("div",{children:"Loading..."}):p.jsxs(p.Fragment,{children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Profile Settings"}),p.jsxs(L,{onSubmit:m,children:[e?p.jsxs(p.Fragment,{children:[p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Professional Info"}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Professional Title"}),p.jsx(L.Control,{type:"text",value:u.title,onChange:g=>d({...u,title:g.target.value}),placeholder:"e.g., Senior Frontend Developer"})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Hourly Rate ($)"}),p.jsx(L.Control,{type:"number",value:u.hourlyRate.amount,onChange:g=>d({...u,hourlyRate:{...u.hourlyRate,amount:Number(g.target.value)}})})]})})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Bio"}),p.jsx(L.Control,{as:"textarea",rows:4,value:u.bio,onChange:g=>d({...u,bio:g.target.value}),placeholder:"Tell us about yourself..."})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Skills"}),p.jsx(Ute,{isMulti:!0,options:h,value:h.filter(g=>{var y,x;return((y=u.skills)==null?void 0:y.includes(g.value))||g.value==="other"&&r||r&&i&&!h.map(v=>v.value).includes(i)&&((x=u.skills)==null?void 0:x.includes(i))}),onChange:g=>{const y=g?g.map(w=>w.value):[],x=y.includes("other");o(x);let b=[...y.filter(w=>w!=="other")];x&&i.trim()?b.push(i.trim()):x||(b=b.filter(w=>w!==i.trim()),a("")),d({...u,skills:b})},placeholder:"Select skills...",classNamePrefix:"react-select"})]}),r&&p.jsxs(L.Group,{className:"mb-3 ms-2",children:[p.jsx(L.Label,{children:'Specify "Other" Skill'}),p.jsx(L.Control,{type:"text",value:i,onChange:g=>{const y=g.target.value;a(y),d(x=>{x.skills.filter(b=>!h.map(w=>w.value).includes(b)||b==="other"),x.skills.filter(b=>{const w=h.find(C=>C.value===b);return w&&w.value!=="other"});let v=h.filter(b=>x.skills.includes(b.value)&&b.value!=="other").map(b=>b.value);return{...x,skills:[...v,y.trim()].filter(Boolean)}})},placeholder:"Enter your skill"})]})]})}),p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Social Links"}),p.jsxs(ot,{children:[p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"LinkedIn"}),p.jsx(L.Control,{type:"url",value:u.socialLinks.linkedin,onChange:g=>d({...u,socialLinks:{...u.socialLinks,linkedin:g.target.value}})})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"GitHub"}),p.jsx(L.Control,{type:"url",value:u.socialLinks.github,onChange:g=>d({...u,socialLinks:{...u.socialLinks,github:g.target.value}})})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Website"}),p.jsx(L.Control,{type:"url",value:u.socialLinks.website,onChange:g=>d({...u,socialLinks:{...u.socialLinks,website:g.target.value}})})]})})]})]})})]}):p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Basic Information"}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"First Name"}),p.jsx(L.Control,{type:"text",value:l.firstName,onChange:g=>c({...l,firstName:g.target.value})})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Last Name"}),p.jsx(L.Control,{type:"text",value:l.lastName,onChange:g=>c({...l,lastName:g.target.value})})]})})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Email"}),p.jsx(L.Control,{type:"email",value:l.email,onChange:g=>c({...l,email:g.target.value})})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Phone"}),p.jsx(L.Control,{type:"tel",value:l.phone,onChange:g=>c({...l,phone:g.target.value})})]})})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Company (Optional)"}),p.jsx(L.Control,{type:"text",value:l.company,onChange:g=>c({...l,company:g.target.value}),placeholder:"Enter company name if applicable"})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Position (Optional)"}),p.jsx(L.Control,{type:"text",value:l.position,onChange:g=>c({...l,position:g.target.value}),placeholder:"Enter your position if applicable"})]})})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Location"}),p.jsx(L.Control,{type:"text",value:l.location,onChange:g=>c({...l,location:g.target.value}),placeholder:"City, Country"})]})]})}),p.jsx("div",{className:"d-flex justify-content-end",children:p.jsxs(Ve,{type:"submit",variant:"primary",size:"lg",children:[p.jsx(OJ,{size:20,className:"mr-2"}),"Save Changes"]})})]})]})}function Wte(){const{user:t}=Hs(),[e,n]=S.useState([]),[s,r]=S.useState([]),[o,i]=S.useState(!0),[a,l]=S.useState(!1),[c,u]=S.useState("history");S.useEffect(()=>{d()},[]),S.useEffect(()=>{c==="milestones"&&h()},[c]);const d=async()=>{try{i(!0);const x=await We.get("/payments/history");console.log("Fetched payments:",x.data),n(x.data)}catch(x){console.error("Error fetching payments:",x),xe.error("Failed to fetch payments")}finally{i(!1)}},h=async()=>{try{l(!0);let x=[];if((t==null?void 0:t.role)==="freelancer")try{const v=await We.get("/jobs/my-projects");if(console.log("Freelancer jobs:",v.data),v.data&&v.data.length>0)for(const b of v.data)try{const C=(await We.get(`/milestones/job/${b._id}`)).data.map(k=>({...k,jobTitle:b.title}));x=[...x,...C]}catch(w){console.error(`Error fetching milestones for job ${b._id}:`,w)}else console.log("No projects found for freelancer")}catch(v){console.error("Error fetching freelancer projects:",v),xe.error("Unable to fetch your projects")}else if((t==null?void 0:t.role)==="employer")try{const v=await We.get("/jobs/my-jobs");if(console.log("Employer jobs:",v.data),v.data&&v.data.length>0)for(const b of v.data)try{const k=(await We.get(`/milestones/job/${b._id}`)).data.map(N=>({...N,jobTitle:b.title})).filter(N=>N.payment&&N.payment.status!=="released");x=[...x,...k]}catch(w){console.error(`Error fetching milestones for job ${b._id}:`,w)}else console.log("No projects found for employer")}catch(v){console.error("Error fetching employer projects:",v),xe.error("Unable to fetch your projects")}console.log("All milestones loaded:",x.length),r(x)}catch(x){console.error("Error in fetchUserMilestones:",x),xe.error("Failed to fetch milestone data")}finally{l(!1)}},f=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),m=x=>new Date(x).toLocaleDateString(),g=x=>{const v={pending:"warning","in-progress":"info",completed:"success",overdue:"danger"};return p.jsx(Zs,{bg:v[x]||"secondary",children:x})},y=x=>{if(!x.payment)return p.jsx(Zs,{bg:"danger",children:"Unfunded"});const v={held:"info",released:"success",refunded:"warning",pending:"warning"};return p.jsx(Zs,{bg:v[x.payment.status]||"secondary",children:x.payment.status==="held"?"In Escrow":x.payment.status})};return o&&c==="history"?p.jsxs(Kt,{className:"py-4",children:[p.jsx("h2",{className:"mb-4",children:"Payments & Transactions"}),p.jsxs("div",{className:"text-center py-5",children:[p.jsx("div",{className:"spinner-border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})}),p.jsx("p",{className:"mt-3",children:"Loading payment history..."})]})]}):p.jsxs(Kt,{className:"py-4",children:[p.jsx("h2",{className:"mb-4",children:"Payments & Transactions"}),p.jsxs(zt,{variant:"tabs",className:"mb-4",children:[p.jsx(zt.Item,{children:p.jsxs(zt.Link,{active:c==="history",onClick:()=>u("history"),children:[p.jsx(HT,{size:18,className:"me-2"}),"Payment History"]})}),((t==null?void 0:t.role)==="freelancer"||(t==null?void 0:t.role)==="employer")&&p.jsx(zt.Item,{children:p.jsxs(zt.Link,{active:c==="milestones",onClick:()=>u("milestones"),children:[p.jsx(Cf,{size:18,className:"me-2"}),"Milestone Payments"]})})]}),c==="history"&&p.jsx(ot,{children:p.jsx(ve,{children:p.jsxs(be,{className:"mb-4",children:[p.jsx(be.Header,{className:"bg-white",children:p.jsxs("h4",{className:"mb-0",children:[p.jsx(HT,{size:18,className:"me-2"}),"Payment History"]})}),p.jsx(be.Body,{children:e.length===0?p.jsx("div",{className:"text-center py-4",children:p.jsx("p",{className:"text-muted mb-0",children:"No payment records found"})}):p.jsxs(bf,{responsive:!0,children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Date"}),p.jsx("th",{children:"Description"}),p.jsx("th",{children:"Amount"}),p.jsx("th",{children:"Status"})]})}),p.jsx("tbody",{children:e.map(x=>p.jsxs("tr",{children:[p.jsx("td",{children:m(x.date)}),p.jsx("td",{children:x.description}),p.jsx("td",{children:f(x.amount)}),p.jsx("td",{children:p.jsx("span",{className:`badge bg-${x.status==="completed"||x.status==="released"?"success":"warning"}`,children:x.status})})]},x._id))})]})})]})})}),c==="milestones"&&p.jsx(ot,{children:p.jsx(ve,{children:p.jsxs(be,{className:"mb-4",children:[p.jsx(be.Header,{className:"bg-white",children:p.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[p.jsxs("h4",{className:"mb-0",children:[p.jsx(Cf,{size:18,className:"me-2"}),(t==null?void 0:t.role)==="employer"?"Pending Milestone Payments":"Milestone Payments"]}),p.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:h,disabled:a,children:a?p.jsxs(p.Fragment,{children:[p.jsx(ir,{animation:"border",size:"sm",className:"me-1"}),"Refreshing..."]}):p.jsxs(p.Fragment,{children:[p.jsx(xJ,{size:16,className:"me-1"}),"Refresh"]})})]})}),p.jsx(be.Body,{children:a?p.jsxs("div",{className:"text-center py-4",children:[p.jsx(ir,{animation:"border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading milestones..."})}),p.jsx("p",{className:"mt-3",children:"Loading milestone data..."})]}):s.length===0?p.jsx("div",{className:"text-center py-4",children:p.jsx("p",{className:"text-muted mb-0",children:(t==null?void 0:t.role)==="employer"?"No pending milestone payments found":"No milestone payments found for your projects"})}):p.jsxs(bf,{responsive:!0,hover:!0,children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Project"}),p.jsx("th",{children:"Milestone"}),p.jsx("th",{children:"Amount"}),p.jsx("th",{children:"Due Date"}),p.jsx("th",{children:"Milestone Status"}),p.jsx("th",{children:"Payment Status"})]})}),p.jsx("tbody",{children:s.map(x=>p.jsxs("tr",{children:[p.jsx("td",{children:x.jobTitle}),p.jsx("td",{children:x.title}),p.jsx("td",{children:f(x.amount)}),p.jsx("td",{children:m(x.dueDate)}),p.jsx("td",{children:g(x.status)}),p.jsx("td",{children:y(x)})]},x._id))})]})})]})})})]})}function CR(){const t=Dr(),{id:e}=yd(),[n,s]=S.useState(!1),[r,o]=S.useState({title:"",description:"",category:"",type:"full-time",location:"",isRemote:!1,salary:{min:0,max:0,currency:"USD"},skills:[]});S.useEffect(()=>{(async()=>{if(e)try{s(!0);const l=await We.get(`/jobs/${e}`);o(l.data)}catch(l){console.error("Error fetching job:",l),xe.error("Failed to load job details"),t("/dashboard/projects")}finally{s(!1)}})()},[e,t]);const i=async a=>{var l,c;a.preventDefault();try{s(!0),e?(await We.put(`/jobs/${e}`,r),xe.success("Job updated successfully!")):(await We.post("/jobs",r),xe.success("Job posted successfully!")),t("/dashboard/projects")}catch(u){console.error("Error saving job:",u),xe.error(((c=(l=u.response)==null?void 0:l.data)==null?void 0:c.message)||`Failed to ${e?"update":"post"} job`)}finally{s(!1)}};return n?p.jsx("div",{className:"text-center py-5",children:p.jsx("div",{className:"spinner-border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):p.jsxs(p.Fragment,{children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:e?"Edit Job":"Post a New Job"}),p.jsxs(L,{onSubmit:i,children:[p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Job Details"}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Job Title"}),p.jsx(L.Control,{type:"text",value:r.title,onChange:a=>o({...r,title:a.target.value}),placeholder:"e.g., Senior Frontend Developer",required:!0})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Description"}),p.jsx(L.Control,{as:"textarea",rows:6,value:r.description,onChange:a=>o({...r,description:a.target.value}),placeholder:"Describe the job requirements, responsibilities, and qualifications...",required:!0})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Category"}),p.jsxs(L.Control,{as:"select",value:r.category,onChange:a=>o({...r,category:a.target.value}),required:!0,children:[p.jsx("option",{value:"",children:"Select a category"}),p.jsx("option",{value:"web-development",children:"Web Development"}),p.jsx("option",{value:"mobile-development",children:"Mobile Development"}),p.jsx("option",{value:"ui-ux-design",children:"UI/UX Design"}),p.jsx("option",{value:"data-science",children:"Data Science"}),p.jsx("option",{value:"devops",children:"DevOps"}),p.jsx("option",{value:"other",children:"Other"})]})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Job Type"}),p.jsxs(L.Control,{as:"select",value:r.type,onChange:a=>o({...r,type:a.target.value}),required:!0,children:[p.jsx("option",{value:"full-time",children:"Full Time"}),p.jsx("option",{value:"part-time",children:"Part Time"}),p.jsx("option",{value:"contract",children:"Contract"}),p.jsx("option",{value:"freelance",children:"Freelance"})]})]})})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Location"}),p.jsx(L.Control,{type:"text",value:r.location,onChange:a=>o({...r,location:a.target.value}),placeholder:"e.g., New York, NY",required:!0})]})}),p.jsx(ve,{md:6,children:p.jsx(L.Group,{className:"mb-3",children:p.jsx(L.Check,{type:"checkbox",label:"Remote Work Available",checked:r.isRemote,onChange:a=>o({...r,isRemote:a.target.checked}),className:"mt-4"})})})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Minimum Salary"}),p.jsx(L.Control,{type:"number",value:r.salary.min,onChange:a=>o({...r,salary:{...r.salary,min:Number(a.target.value)}}),min:"0"})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Maximum Salary"}),p.jsx(L.Control,{type:"number",value:r.salary.max,onChange:a=>o({...r,salary:{...r.salary,max:Number(a.target.value)}}),min:"0"})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Currency"}),p.jsxs(L.Control,{as:"select",value:r.salary.currency,onChange:a=>o({...r,salary:{...r.salary,currency:a.target.value}}),children:[p.jsx("option",{value:"USD",children:"USD"}),p.jsx("option",{value:"EUR",children:"EUR"}),p.jsx("option",{value:"GBP",children:"GBP"}),p.jsx("option",{value:"INR",children:"INR"})]})]})})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Required Skills"}),p.jsx(L.Control,{type:"text",value:r.skills.join(", "),onChange:a=>o({...r,skills:a.target.value.split(",").map(l=>l.trim())}),placeholder:"Add skills separated by commas (e.g., React, Node.js, MongoDB)"})]})]})}),p.jsxs("div",{className:"d-flex justify-content-end",children:[p.jsx(Ve,{variant:"secondary",className:"me-2",onClick:()=>t("/dashboard/projects"),children:"Cancel"}),p.jsx(Ve,{type:"submit",variant:"primary",disabled:n,children:e?"Update Job":"Post Job"})]})]})]})}function Hte({milestone:t,onPaymentComplete:e}){const[n,s]=S.useState(!1),[r,o]=S.useState({cardNumber:"",cardHolder:"",expiryMonth:"",expiryYear:"",cvv:"",cardBrand:"visa"}),i=l=>{const{name:c,value:u}=l.target;o(d=>({...d,[c]:u}))},a=async l=>{var c,u;if(l.preventDefault(),!r.cardNumber||!r.cardHolder||!r.expiryMonth||!r.expiryYear||!r.cvv){xe.error("Please fill in all payment details");return}try{s(!0);const d=await We.post("/payments/fund-escrow",{milestoneData:t,paymentMethod:"card",paymentDetails:{cardNumber:r.cardNumber,cardHolder:r.cardHolder,expiryMonth:r.expiryMonth,expiryYear:r.expiryYear,cardBrand:r.cardBrand}});xe.success("Payment processed successfully"),e&&e(d.data)}catch(d){console.error("Payment error:",d),xe.error(((u=(c=d.response)==null?void 0:c.data)==null?void 0:u.message)||"Failed to process payment")}finally{s(!1)}};return p.jsx(be,{children:p.jsxs(be.Body,{children:[p.jsxs("div",{className:"d-flex align-items-center mb-4",children:[p.jsx(hL,{size:24,className:"text-primary me-2"}),p.jsx("h4",{className:"mb-0",children:"Payment Details"})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("h5",{className:"mb-3",children:"Amount to Fund"}),p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx(o0,{size:20,className:"text-success me-2"}),p.jsxs("span",{className:"h3 mb-0",children:[t.amount," ",t.currency]})]})]}),p.jsxs(L,{onSubmit:a,children:[p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Card Number"}),p.jsx(L.Control,{type:"text",name:"cardNumber",value:r.cardNumber,onChange:i,placeholder:"1234 5678 9012 3456",maxLength:"16",required:!0})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Card Holder Name"}),p.jsx(L.Control,{type:"text",name:"cardHolder",value:r.cardHolder,onChange:i,placeholder:"John Doe",required:!0})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Expiry Month"}),p.jsxs(L.Select,{name:"expiryMonth",value:r.expiryMonth,onChange:i,required:!0,children:[p.jsx("option",{value:"",children:"Month"}),Array.from({length:12},(l,c)=>{const u=(c+1).toString().padStart(2,"0");return p.jsx("option",{value:u,children:u},u)})]})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Expiry Year"}),p.jsxs(L.Select,{name:"expiryYear",value:r.expiryYear,onChange:i,required:!0,children:[p.jsx("option",{value:"",children:"Year"}),Array.from({length:10},(l,c)=>{const u=(new Date().getFullYear()+c).toString();return p.jsx("option",{value:u,children:u},u)})]})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"CVV"}),p.jsx(L.Control,{type:"text",name:"cvv",value:r.cvv,onChange:i,placeholder:"123",maxLength:"4",required:!0})]})})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Card Type"}),p.jsxs(L.Select,{name:"cardBrand",value:r.cardBrand,onChange:i,required:!0,children:[p.jsx("option",{value:"visa",children:"Visa"}),p.jsx("option",{value:"mastercard",children:"Mastercard"}),p.jsx("option",{value:"amex",children:"American Express"})]})]}),p.jsx(Ve,{type:"submit",variant:"primary",className:"w-100",disabled:n,children:n?p.jsxs(p.Fragment,{children:[p.jsx(ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Processing..."]}):"Fund Escrow"})]})]})})}const Gte=t=>{if(t!=null&&t.startsWith("http"))return t;if(t){const e="";return e.endsWith("/")&&t.startsWith("/")?`${e}${t.substring(1)}`:`${e}${t}`}return""},qte=({milestone:t,onSubmissionComplete:e,onClose:n})=>{var x,v;const[s,r]=S.useState(((x=t.submission)==null?void 0:x.description)||""),[o,i]=S.useState([]),[a,l]=S.useState(!1),[c,u]=S.useState(null),[d,h]=S.useState(!1),f=b=>b!=null&&b.includes("image")?p.jsx(EJ,{size:18}):p.jsx(SJ,{size:18}),m=b=>b<1024?b+" B":b<1024*1024?(b/1024).toFixed(1)+" KB":(b/(1024*1024)).toFixed(1)+" MB",g=async b=>{var w,C,k,N,E;if(b.preventDefault(),!s.trim()){u("Description is required");return}l(!0),u(null),h(!1);try{console.log("Starting milestone submission...",{milestoneId:t._id,description:s,filesCount:o.length});const $=new FormData;$.append("description",s.trim()),o.length>0&&o.forEach(_=>{$.append("files",_)}),console.log("FormData contents:");for(let[_,U]of $.entries())console.log("FormData field:",_,typeof U=="object"?U.name:U);let I=0;const A=2;let P;for(;I<A;)try{I++,console.log(`Attempt ${I} to submit milestone work`),P=await We.post(`/milestones/${t._id}/submit`,$,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4});break}catch(_){if(console.error(`Attempt ${I} failed:`,_.message),I>=A)throw _;await new Promise(U=>setTimeout(U,1e3))}console.log("Submission response:",P.data),h(!0),xe.success("Work submitted successfully"),e&&(console.log("Calling onSubmissionComplete with:",P.data),e(P.data)),setTimeout(()=>{console.log("Closing submission modal..."),n&&n()},1500)}catch($){console.error("Error submitting milestone:",{error:$,message:$.message,response:(w=$.response)==null?void 0:w.data,status:(C=$.response)==null?void 0:C.status});let I="Error submitting work. Please try again.";(N=(k=$.response)==null?void 0:k.data)!=null&&N.message?I=$.response.data.message:$.message&&$.message.includes("timeout")?I="The request timed out. Your files may be too large or the connection is slow.":$.message&&$.message.includes("Network Error")?I="Network error. Please check your internet connection and try again.":$.message&&(I=$.message),u(I),xe.error(I),((E=$.response)==null?void 0:E.status)===401&&(console.log("Unauthorized error - redirecting to login..."),localStorage.removeItem("token"),window.location.href="/login")}finally{l(!1)}},y=b=>{const w=Array.from(b.target.files);if(console.log("Selected files:",w.map(I=>({name:I.name,size:I.size,type:I.type}))),w.length>5){u("You can only upload up to 5 files");return}const C=10*1024*1024,k=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","application/zip","application/x-rar-compressed","application/vnd.rar","image/jpeg","image/png"],N=[".pdf",".doc",".docx",".txt",".zip",".rar",".jpg",".jpeg",".png"],E=[],$=[];if(w.forEach(I=>{I.size>C&&E.push(I.name);const A="."+I.name.split(".").pop().toLowerCase();!k.includes(I.type)&&!N.includes(A)&&$.push(`${I.name} (${I.type||"unknown type"})`)}),E.length>0){u(`These files exceed the 10MB limit: ${E.join(", ")}`);return}if($.length>0){u(`Unsupported file types: ${$.join(", ")}. 
        Allowed types: PDF, DOC, DOCX, TXT, ZIP, RAR, JPG, JPEG, PNG.`);return}i(w),u(null)};return p.jsxs("div",{className:"p-4 border rounded",children:[p.jsx("h5",{className:"mb-3",children:t.submission?"Edit Submission":"Submit Work"}),c&&p.jsx(Wa,{variant:"danger",className:"mb-3",dismissible:!0,onClose:()=>u(null),children:c}),d&&p.jsx(Wa,{variant:"success",className:"mb-3",children:"Work submitted successfully!"}),((v=t.submission)==null?void 0:v.files)&&t.submission.files.length>0&&p.jsxs("div",{className:"mb-3",children:[p.jsx("h6",{className:"mb-2",children:"Previously Uploaded Files:"}),p.jsx(_T,{variant:"flush",className:"border rounded mb-3",children:t.submission.files.map((b,w)=>p.jsxs(_T.Item,{className:"d-flex align-items-center justify-content-between",children:[p.jsxs("div",{className:"d-flex align-items-center",children:[f(b.mimetype),p.jsx("span",{className:"ms-2",children:b.originalname}),p.jsxs("small",{className:"text-muted ms-2",children:["(",m(b.size),")"]})]}),p.jsx("a",{href:Gte(b.path),target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",download:b.originalname,children:p.jsx(fL,{size:16})})]},w))})]}),p.jsxs(L,{onSubmit:g,children:[p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Description of Work Completed"}),p.jsx(L.Control,{as:"textarea",rows:4,value:s,onChange:b=>r(b.target.value),placeholder:"Describe the work you've completed...",required:!0,disabled:a||d})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Attachments (Optional)"}),p.jsx(L.Control,{type:"file",multiple:!0,onChange:y,accept:".pdf,.doc,.docx,.txt,.zip,.rar,.jpg,.jpeg,.png",disabled:a||d}),p.jsx(L.Text,{className:"text-muted",children:"You can upload up to 5 files (10MB each)"})]}),p.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[p.jsx(Ve,{type:"submit",variant:"primary",disabled:a||d||!s.trim(),children:a?p.jsxs(p.Fragment,{children:[p.jsx(ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Submitting..."]}):t.submission?"Update Submission":"Submit Work"}),t.submission&&p.jsxs("span",{className:"text-muted",children:["Last submitted: ",new Date(t.submission.submittedAt).toLocaleString()]})]})]})]})},Kte=t=>({setHttpHandler(e){t.httpHandler=e},httpHandler(){return t.httpHandler},updateHttpClientConfig(e,n){var s;(s=t.httpHandler)==null||s.updateHttpClientConfig(e,n)},httpHandlerConfigs(){return t.httpHandler.httpHandlerConfigs()}}),Xte=t=>({httpHandler:t.httpHandler()});var SR;(function(t){t.HEADER="header",t.QUERY="query"})(SR||(SR={}));var kR;(function(t){t.HEADER="header",t.QUERY="query"})(kR||(kR={}));var Ef;(function(t){t.HTTP="http",t.HTTPS="https"})(Ef||(Ef={}));var _x;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(_x||(_x={}));var NR;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(NR||(NR={}));const bC="__smithy_context";var ER;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(ER||(ER={}));var $R;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})($R||($R={}));class vs{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const n=new vs({...e,headers:{...e.headers}});return n.query&&(n.query=Yte(n.query)),n}static isInstance(e){if(!e)return!1;const n=e;return"method"in n&&"protocol"in n&&"hostname"in n&&"path"in n&&typeof n.query=="object"&&typeof n.headers=="object"}clone(){return vs.clone(this)}}function Yte(t){return Object.keys(t).reduce((e,n)=>{const s=t[n];return{...e,[n]:Array.isArray(s)?[...s]:s}},{})}class $f{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const n=e;return typeof n.statusCode=="number"&&typeof n.headers=="object"}}function Jte(t){return e=>async n=>{var r,o;const{request:s}=n;return vs.isInstance(s)&&s.body&&t.runtime==="node"&&((o=(r=t.requestHandler)==null?void 0:r.constructor)==null?void 0:o.name)!=="FetchHttpHandler"&&(s.headers={...s.headers,Expect:"100-continue"}),e({...n,request:s})}}const Zte={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},Qte=t=>({applyToStack:e=>{e.add(Jte(t),Zte)}}),h4={WHEN_SUPPORTED:"WHEN_SUPPORTED"},ene=h4.WHEN_SUPPORTED,tne=h4.WHEN_SUPPORTED;var Mr;(function(t){t.MD5="MD5",t.CRC32="CRC32",t.CRC32C="CRC32C",t.CRC64NVME="CRC64NVME",t.SHA1="SHA1",t.SHA256="SHA256"})(Mr||(Mr={}));var IR;(function(t){t.HEADER="header",t.TRAILER="trailer"})(IR||(IR={}));Mr.CRC32;var TR;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(TR||(TR={}));function nne(t,e,n){return t.$source||(t.$source={}),t.$source[e]=n,t}function Ro(t,e,n){t.__aws_sdk_context?t.__aws_sdk_context.features||(t.__aws_sdk_context.features={}):t.__aws_sdk_context={features:{}},t.__aws_sdk_context.features[e]=n}const RR=t=>{var e,n;return $f.isInstance(t)?((e=t.headers)==null?void 0:e.date)??((n=t.headers)==null?void 0:n.Date):void 0},l2=t=>new Date(Date.now()+t),sne=(t,e)=>Math.abs(l2(e).getTime()-t)>=3e5,AR=(t,e)=>{const n=Date.parse(t);return sne(n,e)?n-Date.now():e},jh=(t,e)=>{if(!e)throw new Error(`Property \`${t}\` is not resolved for AWS SDK SigV4Auth`);return e},f4=async t=>{var c,u,d;const e=jh("context",t.context),n=jh("config",t.config),s=(d=(u=(c=e.endpointV2)==null?void 0:c.properties)==null?void 0:u.authSchemes)==null?void 0:d[0],o=await jh("signer",n.signer)(s),i=t==null?void 0:t.signingRegion,a=t==null?void 0:t.signingRegionSet,l=t==null?void 0:t.signingName;return{config:n,signer:o,signingRegion:i,signingRegionSet:a,signingName:l}};class p4{async sign(e,n,s){var d;if(!vs.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const r=await f4(s),{config:o,signer:i}=r;let{signingRegion:a,signingName:l}=r;const c=s.context;if(((d=c==null?void 0:c.authSchemes)==null?void 0:d.length)??!1){const[h,f]=c.authSchemes;(h==null?void 0:h.name)==="sigv4a"&&(f==null?void 0:f.name)==="sigv4"&&(a=(f==null?void 0:f.signingRegion)??a,l=(f==null?void 0:f.signingName)??l)}return await i.sign(e,{signingDate:l2(o.systemClockOffset),signingRegion:a,signingService:l})}errorHandler(e){return n=>{const s=n.ServerTime??RR(n.$response);if(s){const r=jh("config",e.config),o=r.systemClockOffset;r.systemClockOffset=AR(s,r.systemClockOffset),r.systemClockOffset!==o&&n.$metadata&&(n.$metadata.clockSkewCorrected=!0)}throw n}}successHandler(e,n){const s=RR(e);if(s){const r=jh("config",n.config);r.systemClockOffset=AR(s,r.systemClockOffset)}}}class rne extends p4{async sign(e,n,s){var h;if(!vs.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const{config:r,signer:o,signingRegion:i,signingRegionSet:a,signingName:l}=await f4(s),u=(await((h=r.sigv4aSigningRegionSet)==null?void 0:h.call(r))??a??[i]).join(",");return await o.sign(e,{signingDate:l2(r.systemClockOffset),signingRegion:u,signingService:l})}}const Nd=t=>t[bC]||(t[bC]={}),xi=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e};function one(t){const e=new Map;for(const n of t)e.set(n.schemeId,n);return e}const ine=(t,e)=>(n,s)=>async r=>{var c;const o=t.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(t,s,r.input)),i=one(t.httpAuthSchemes),a=Nd(s),l=[];for(const u of o){const d=i.get(u.schemeId);if(!d){l.push(`HttpAuthScheme \`${u.schemeId}\` was not enabled for this service.`);continue}const h=d.identityProvider(await e.identityProviderConfigProvider(t));if(!h){l.push(`HttpAuthScheme \`${u.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:f={},signingProperties:m={}}=((c=u.propertiesExtractor)==null?void 0:c.call(u,t,s))||{};u.identityProperties=Object.assign(u.identityProperties||{},f),u.signingProperties=Object.assign(u.signingProperties||{},m),a.selectedHttpAuthScheme={httpAuthOption:u,identity:await h(u.identityProperties),signer:d.signer};break}if(!a.selectedHttpAuthScheme)throw new Error(l.join(`
`));return n(r)},ane={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},lne=(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:n})=>({applyToStack:s=>{s.addRelativeTo(ine(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:n}),ane)}}),cne=(t,e)=>(n,s)=>async r=>{var i,a,l,c;const{response:o}=await n(r);try{const u=await e(o,t);return{response:o,output:u}}catch(u){if(Object.defineProperty(u,"$response",{value:o}),!("$metadata"in u)){const d="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{u.message+=`
  `+d}catch{!s.logger||((a=(i=s.logger)==null?void 0:i.constructor)==null?void 0:a.name)==="NoOpLogger"?console.warn(d):(c=(l=s.logger)==null?void 0:l.warn)==null||c.call(l,d)}typeof u.$responseBodyText<"u"&&u.$response&&(u.$response.body=u.$responseBodyText)}throw u}},une=(t,e)=>(n,s)=>async r=>{var a;const o=(a=s.endpointV2)!=null&&a.url&&t.urlParser?async()=>t.urlParser(s.endpointV2.url):t.endpoint;if(!o)throw new Error("No valid endpoint provider available.");const i=await e(r.input,{...t,endpoint:o});return n({...r,request:i})},dne={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},c2={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function hne(t,e,n){return{applyToStack:s=>{s.add(cne(t,n),dne),s.add(une(t,e),c2)}}}c2.name;const fne=t=>e=>{throw e},pne=(t,e)=>{},mne=t=>(e,n)=>async s=>{if(!vs.isInstance(s.request))return e(s);const o=Nd(n).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:i={}},identity:a,signer:l}=o,c=await e({...s,request:await l.sign(s.request,a,i)}).catch((l.errorHandler||fne)(i));return(l.successHandler||pne)(c.response,i),c},m4={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},gne=t=>({applyToStack:e=>{e.addRelativeTo(mne(),m4)}}),Tu=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},el={},Ed=new Array(64);for(let t=0,e=65,n=90;t+e<=n;t++){const s=String.fromCharCode(t+e);el[s]=t,Ed[t]=s}for(let t=0,e=97,n=122;t+e<=n;t++){const s=String.fromCharCode(t+e),r=t+26;el[s]=r,Ed[r]=s}for(let t=0;t<10;t++){el[t.toString(10)]=t+52;const e=t.toString(10),n=t+52;el[e]=n,Ed[n]=e}el["+"]=62;Ed[62]="+";el["/"]=63;Ed[63]="/";const Ru=6,Bh=8,xne=63,u2=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const n=new ArrayBuffer(e),s=new DataView(n);for(let r=0;r<t.length;r+=4){let o=0,i=0;for(let c=r,u=r+3;c<=u;c++)if(t[c]!=="="){if(!(t[c]in el))throw new TypeError(`Invalid character ${t[c]} in base64 string.`);o|=el[t[c]]<<(u-c)*Ru,i+=Ru}else o>>=Ru;const a=r/4*3;o>>=i%Bh;const l=Math.floor(i/Bh);for(let c=0;c<l;c++){const u=(l-c-1)*Bh;s.setUint8(a+c,(o&255<<u)>>u)}}return new Uint8Array(n)},fc=t=>new TextEncoder().encode(t),zh=t=>typeof t=="string"?fc(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),d2=t=>{if(typeof t=="string")return t;if(typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(t)};function h2(t){let e;typeof t=="string"?e=fc(t):e=t;const n=typeof e=="object"&&typeof e.length=="number",s=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!n&&!s)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let r="";for(let o=0;o<e.length;o+=3){let i=0,a=0;for(let c=o,u=Math.min(o+3,e.length);c<u;c++)i|=e[c]<<(u-c-1)*Bh,a+=Bh;const l=Math.ceil(a/Ru);i<<=l*Ru-a;for(let c=1;c<=l;c++){const u=(l-c)*Ru;r+=Ed[(i&xne<<u)>>u]}r+="==".slice(0,4-l)}return r}function yne(t,e="utf-8"){return e==="base64"?h2(t):d2(t)}function vne(t,e){return e==="base64"?Zl.mutate(u2(t)):Zl.mutate(fc(t))}class Zl extends Uint8Array{static fromString(e,n="utf-8"){switch(typeof e){case"string":return vne(e,n);default:throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}}static mutate(e){return Object.setPrototypeOf(e,Zl.prototype),e}transformToString(e="utf-8"){return yne(this,e)}}const DR=t=>{var e;return typeof ReadableStream=="function"&&(((e=t==null?void 0:t.constructor)==null?void 0:e.name)===ReadableStream.name||t instanceof ReadableStream)},bne=(t,e)=>{const{base64Encoder:n,bodyLengthChecker:s,checksumAlgorithmFn:r,checksumLocationName:o,streamHasher:i}=e,a=n!==void 0&&s!==void 0&&r!==void 0&&o!==void 0&&i!==void 0,l=a?i(r,t):void 0,c=t.getReader();return new ReadableStream({async pull(u){const{value:d,done:h}=await c.read();if(h){if(u.enqueue(`0\r
`),a){const f=n(await l);u.enqueue(`${o}:${f}\r
`),u.enqueue(`\r
`)}u.close()}else u.enqueue(`${(s(d)||0).toString(16)}\r
${d}\r
`)}})};async function wne(t,e){let n=0;const s=[],r=t.getReader();let o=!1;for(;!o;){const{done:l,value:c}=await r.read();if(c&&(s.push(c),n+=(c==null?void 0:c.byteLength)??0),n>=e)break;o=l}r.releaseLock();const i=new Uint8Array(Math.min(e,n));let a=0;for(const l of s){if(l.byteLength>i.byteLength-a){i.set(l.subarray(0,i.byteLength-a),a);break}else i.set(l,a);a+=l.length}return i}const Ql=t=>encodeURIComponent(t).replace(/[!'()*]/g,Cne),Cne=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function Sne(t){const e=[];for(let n of Object.keys(t).sort()){const s=t[n];if(n=Ql(n),Array.isArray(s))for(let r=0,o=s.length;r<o;r++)e.push(`${n}=${Ql(s[r])}`);else{let r=n;(s||typeof s=="string")&&(r+=`=${Ql(s)}`),e.push(r)}}return e.join("&")}function OR(t,e){return new Request(t,e)}function kne(t=0){return new Promise((e,n)=>{t&&setTimeout(()=>{const s=new Error(`Request did not complete within ${t} ms`);s.name="TimeoutError",n(s)},t)})}const Yb={supported:void 0};class f2{static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new f2(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(n=>n||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),Yb.supported===void 0&&(Yb.supported=typeof Request<"u"&&"keepalive"in OR("https://[::1]"))}destroy(){}async handle(e,{abortSignal:n}={}){var x;this.config||(this.config=await this.configProvider);const s=this.config.requestTimeout,r=this.config.keepAlive===!0,o=this.config.credentials;if(n!=null&&n.aborted){const v=new Error("Request aborted");return v.name="AbortError",Promise.reject(v)}let i=e.path;const a=Sne(e.query||{});a&&(i+=`?${a}`),e.fragment&&(i+=`#${e.fragment}`);let l="";if(e.username!=null||e.password!=null){const v=e.username??"",b=e.password??"";l=`${v}:${b}@`}const{port:c,method:u}=e,d=`${e.protocol}//${l}${e.hostname}${c?`:${c}`:""}${i}`,h=u==="GET"||u==="HEAD"?void 0:e.body,f={body:h,headers:new Headers(e.headers),method:u,credentials:o};(x=this.config)!=null&&x.cache&&(f.cache=this.config.cache),h&&(f.duplex="half"),typeof AbortController<"u"&&(f.signal=n),Yb.supported&&(f.keepalive=r),typeof this.config.requestInit=="function"&&Object.assign(f,this.config.requestInit(e));let m=()=>{};const g=OR(d,f),y=[fetch(g).then(v=>{const b=v.headers,w={};for(const k of b.entries())w[k[0]]=k[1];return v.body!=null?{response:new $f({headers:w,reason:v.statusText,statusCode:v.status,body:v.body})}:v.blob().then(k=>({response:new $f({headers:w,reason:v.statusText,statusCode:v.status,body:k})}))}),kne(s)];return n&&y.push(new Promise((v,b)=>{const w=()=>{const C=new Error("Request aborted");C.name="AbortError",b(C)};if(typeof n.addEventListener=="function"){const C=n;C.addEventListener("abort",w,{once:!0}),m=()=>C.removeEventListener("abort",w)}else n.onabort=w})),Promise.race(y).finally(m)}updateHttpClientConfig(e,n){this.config=void 0,this.configProvider=this.configProvider.then(s=>(s[e]=n,s))}httpHandlerConfigs(){return this.config??{}}}const g4=async t=>{var e;return typeof Blob=="function"&&t instanceof Blob||((e=t.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await t.arrayBuffer()):Nne(t):Ene(t)};async function Nne(t){const e=await $ne(t),n=u2(e);return new Uint8Array(n)}async function Ene(t){const e=[],n=t.getReader();let s=!1,r=0;for(;!s;){const{done:a,value:l}=await n.read();l&&(e.push(l),r+=l.length),s=a}const o=new Uint8Array(r);let i=0;for(const a of e)o.set(a,i),i+=a.length;return o}function $ne(t){return new Promise((e,n)=>{const s=new FileReader;s.onloadend=()=>{if(s.readyState!==2)return n(new Error("Reader aborted too early"));const r=s.result??"",o=r.indexOf(","),i=o>-1?o+1:r.length;e(r.substring(i))},s.onabort=()=>n(new Error("Read aborted")),s.onerror=()=>n(s.error),s.readAsDataURL(t)})}const x4={},wC={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),x4[t]=e,wC[e]=t}function y4(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2){const s=t.slice(n,n+2).toLowerCase();if(s in wC)e[n/2]=wC[s];else throw new Error(`Cannot decode unrecognized sequence ${s} as hexadecimal`)}return e}function gr(t){let e="";for(let n=0;n<t.byteLength;n++)e+=x4[t[n]];return e}const FR="The stream has already been transformed.",Ine=t=>{var r,o;if(!PR(t)&&!DR(t)){const i=((o=(r=t==null?void 0:t.__proto__)==null?void 0:r.constructor)==null?void 0:o.name)||t;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${i}`)}let e=!1;const n=async()=>{if(e)throw new Error(FR);return e=!0,await g4(t)},s=i=>{if(typeof i.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return i.stream()};return Object.assign(t,{transformToByteArray:n,transformToString:async i=>{const a=await n();if(i==="base64")return h2(a);if(i==="hex")return gr(a);if(i===void 0||i==="utf8"||i==="utf-8")return d2(a);if(typeof TextDecoder=="function")return new TextDecoder(i).decode(a);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(e)throw new Error(FR);if(e=!0,PR(t))return s(t);if(DR(t))return t;throw new Error(`Cannot transform payload to web stream, got ${t}`)}})},PR=t=>typeof Blob=="function"&&t instanceof Blob;async function Tne(t){return typeof t.stream=="function"&&(t=t.stream()),t.tee()}const Rne=async(t=new Uint8Array,e)=>{if(t instanceof Uint8Array)return Zl.mutate(t);if(!t)return Zl.mutate(new Uint8Array);const n=e.streamCollector(t);return Zl.mutate(await n)};function _R(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}const Ane=(t,e,n,s,r,o)=>{if(e!=null&&e[n]!==void 0){const i=s();if(i.length<=0)throw new Error("Empty value provided for input HTTP label: "+n+".");t=t.replace(r,o?i.split("/").map(a=>_R(a)).join("/"):_R(i))}else throw new Error("No value provided for input HTTP label: "+n+".");return t};function Dne(t,e){return new One(t,e)}class One{constructor(e,n){this.input=e,this.context=n,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:n="https",port:s,path:r}=await this.context.endpoint();this.path=r;for(const o of this.resolvePathStack)o(this.path);return new vs({protocol:n,hostname:this.hostname||e,port:s,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push(n=>{this.path=`${n!=null&&n.endsWith("/")?n.slice(0,-1):n||""}`+e}),this}p(e,n,s,r){return this.resolvePathStack.push(o=>{this.path=Ane(o,this.input,e,n,s,r)}),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}function Fne(t,e,n){t.__smithy_context?t.__smithy_context.features||(t.__smithy_context.features={}):t.__smithy_context={features:{}},t.__smithy_context.features[e]=n}class Pne{constructor(e){this.authSchemes=new Map;for(const[n,s]of Object.entries(e))s!==void 0&&this.authSchemes.set(n,s)}getIdentityProvider(e){return this.authSchemes.get(e)}}const _ne=t=>e=>v4(e)&&e.expiration.getTime()-Date.now()<t,Mne=3e5,Lne=_ne(Mne),v4=t=>t.expiration!==void 0,jne=(t,e,n)=>{if(t===void 0)return;const s=typeof t!="function"?async()=>Promise.resolve(t):t;let r,o,i,a=!1;const l=async c=>{o||(o=s(c));try{r=await o,i=!0,a=!1}finally{o=void 0}return r};return e===void 0?async c=>((!i||c!=null&&c.forceRefresh)&&(r=await l(c)),r):async c=>((!i||c!=null&&c.forceRefresh)&&(r=await l(c)),a?r:n(r)?(e(r)&&await l(c),r):(a=!0,r))},Bne=(t,e,n)=>{let s,r,o,i=!1;const a=async()=>{r||(r=t());try{s=await r,o=!0,i=!1}finally{r=void 0}return s};return async l=>((!o||l!=null&&l.forceRefresh)&&(s=await a()),s)},zne=t=>(t.sigv4aSigningRegionSet=Tu(t.sigv4aSigningRegionSet),t),Une="X-Amz-Algorithm",Vne="X-Amz-Credential",b4="X-Amz-Date",Wne="X-Amz-SignedHeaders",Hne="X-Amz-Expires",w4="X-Amz-Signature",C4="X-Amz-Security-Token",S4="authorization",k4=b4.toLowerCase(),Gne="date",qne=[S4,k4,Gne],Kne=w4.toLowerCase(),CC="x-amz-content-sha256",Xne=C4.toLowerCase(),Yne={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},Jne=/^proxy-/,Zne=/^sec-/,Jb="AWS4-HMAC-SHA256",Qne="AWS4-HMAC-SHA256-PAYLOAD",ese="UNSIGNED-PAYLOAD",tse=50,N4="aws4_request",nse=60*60*24*7,tg={},Zb=[],Qb=(t,e,n)=>`${t}/${e}/${n}/${N4}`,sse=async(t,e,n,s,r)=>{const o=await MR(t,e.secretAccessKey,e.accessKeyId),i=`${n}:${s}:${r}:${gr(o)}:${e.sessionToken}`;if(i in tg)return tg[i];for(Zb.push(i);Zb.length>tse;)delete tg[Zb.shift()];let a=`AWS4${e.secretAccessKey}`;for(const l of[n,s,r,N4])a=await MR(t,a,l);return tg[i]=a},MR=(t,e,n)=>{const s=new t(e);return s.update(zh(n)),s.digest()},LR=({headers:t},e,n)=>{const s={};for(const r of Object.keys(t).sort()){if(t[r]==null)continue;const o=r.toLowerCase();(o in Yne||e!=null&&e.has(o)||Jne.test(o)||Zne.test(o))&&(!n||n&&!n.has(o))||(s[o]=t[r].trim().replace(/\s+/g," "))}return s},rse=({query:t={}})=>{const e=[],n={};for(const s of Object.keys(t)){if(s.toLowerCase()===Kne)continue;const r=Ql(s);e.push(r);const o=t[s];typeof o=="string"?n[r]=`${r}=${Ql(o)}`:Array.isArray(o)&&(n[r]=o.slice(0).reduce((i,a)=>i.concat([`${r}=${Ql(a)}`]),[]).sort().join("&"))}return e.sort().map(s=>n[s]).filter(s=>s).join("&")},ose=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",e1=async({headers:t,body:e},n)=>{for(const s of Object.keys(t))if(s.toLowerCase()===CC)return t[s];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||ose(e)){const s=new n;return s.update(zh(e)),gr(await s.digest())}return ese};class ise{format(e){const n=[];for(const o of Object.keys(e)){const i=fc(o);n.push(Uint8Array.from([i.byteLength]),i,this.formatHeaderValue(e[o]))}const s=new Uint8Array(n.reduce((o,i)=>o+i.byteLength,0));let r=0;for(const o of n)s.set(o,r),r+=o.byteLength;return s}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,e.value,!1),new Uint8Array(n.buffer);case"integer":const s=new DataView(new ArrayBuffer(5));return s.setUint8(0,4),s.setInt32(1,e.value,!1),new Uint8Array(s.buffer);case"long":const r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":const o=new DataView(new ArrayBuffer(3+e.value.byteLength));o.setUint8(0,6),o.setUint16(1,e.value.byteLength,!1);const i=new Uint8Array(o.buffer);return i.set(e.value,3),i;case"string":const a=fc(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set(lse.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!ase.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const d=new Uint8Array(17);return d[0]=9,d.set(y4(e.value.replace(/\-/g,"")),1),d}}}var jR;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(jR||(jR={}));const ase=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;let lse=class E4{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const n=new Uint8Array(8);for(let s=7,r=Math.abs(Math.round(e));s>-1&&r>0;s--,r/=256)n[s]=r;return e<0&&BR(n),new E4(n)}valueOf(){const e=this.bytes.slice(0),n=e[0]&128;return n&&BR(e),parseInt(gr(e),16)*(n?-1:1)}toString(){return String(this.valueOf())}};function BR(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}const cse=(t,e)=>{t=t.toLowerCase();for(const n of Object.keys(e))if(t===n.toLowerCase())return!0;return!1},use=(t,e={})=>{var r,o;const{headers:n,query:s={}}=vs.clone(t);for(const i of Object.keys(n)){const a=i.toLowerCase();(a.slice(0,6)==="x-amz-"&&!((r=e.unhoistableHeaders)!=null&&r.has(a))||(o=e.hoistableHeaders)!=null&&o.has(a))&&(s[i]=n[i],delete n[i])}return{...t,headers:n,query:s}},zR=t=>{t=vs.clone(t);for(const e of Object.keys(t.headers))qne.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},dse=t=>hse(t).toISOString().replace(/\.\d{3}Z$/,"Z"),hse=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class SC{constructor({applyChecksum:e,credentials:n,region:s,service:r,sha256:o,uriEscapePath:i=!0}){this.headerFormatter=new ise,this.service=r,this.sha256=o,this.uriEscapePath=i,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=xi(s),this.credentialProvider=xi(n)}async presign(e,n={}){const{signingDate:s=new Date,expiresIn:r=3600,unsignableHeaders:o,unhoistableHeaders:i,signableHeaders:a,hoistableHeaders:l,signingRegion:c,signingService:u}=n,d=await this.credentialProvider();this.validateResolvedCredentials(d);const h=c??await this.regionProvider(),{longDate:f,shortDate:m}=ng(s);if(r>nse)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const g=Qb(m,h,u??this.service),y=use(zR(e),{unhoistableHeaders:i,hoistableHeaders:l});d.sessionToken&&(y.query[C4]=d.sessionToken),y.query[Une]=Jb,y.query[Vne]=`${d.accessKeyId}/${g}`,y.query[b4]=f,y.query[Hne]=r.toString(10);const x=LR(y,o,a);return y.query[Wne]=UR(x),y.query[w4]=await this.getSignature(f,g,this.getSigningKey(d,h,m,u),this.createCanonicalRequest(y,x,await e1(e,this.sha256))),y}async sign(e,n){return typeof e=="string"?this.signString(e,n):e.headers&&e.payload?this.signEvent(e,n):e.message?this.signMessage(e,n):this.signRequest(e,n)}async signEvent({headers:e,payload:n},{signingDate:s=new Date,priorSignature:r,signingRegion:o,signingService:i}){const a=o??await this.regionProvider(),{shortDate:l,longDate:c}=ng(s),u=Qb(l,a,i??this.service),d=await e1({headers:{},body:n},this.sha256),h=new this.sha256;h.update(e);const f=gr(await h.digest()),m=[Qne,c,u,r,f,d].join(`
`);return this.signString(m,{signingDate:s,signingRegion:a,signingService:i})}async signMessage(e,{signingDate:n=new Date,signingRegion:s,signingService:r}){return this.signEvent({headers:this.headerFormatter.format(e.message.headers),payload:e.message.body},{signingDate:n,signingRegion:s,signingService:r,priorSignature:e.priorSignature}).then(i=>({message:e.message,signature:i}))}async signString(e,{signingDate:n=new Date,signingRegion:s,signingService:r}={}){const o=await this.credentialProvider();this.validateResolvedCredentials(o);const i=s??await this.regionProvider(),{shortDate:a}=ng(n),l=new this.sha256(await this.getSigningKey(o,i,a,r));return l.update(zh(e)),gr(await l.digest())}async signRequest(e,{signingDate:n=new Date,signableHeaders:s,unsignableHeaders:r,signingRegion:o,signingService:i}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const l=o??await this.regionProvider(),c=zR(e),{longDate:u,shortDate:d}=ng(n),h=Qb(d,l,i??this.service);c.headers[k4]=u,a.sessionToken&&(c.headers[Xne]=a.sessionToken);const f=await e1(c,this.sha256);!cse(CC,c.headers)&&this.applyChecksum&&(c.headers[CC]=f);const m=LR(c,r,s),g=await this.getSignature(u,h,this.getSigningKey(a,l,d,i),this.createCanonicalRequest(c,m,f));return c.headers[S4]=`${Jb} Credential=${a.accessKeyId}/${h}, SignedHeaders=${UR(m)}, Signature=${g}`,c}createCanonicalRequest(e,n,s){const r=Object.keys(n).sort();return`${e.method}
${this.getCanonicalPath(e)}
${rse(e)}
${r.map(o=>`${o}:${n[o]}`).join(`
`)}

${r.join(";")}
${s}`}async createStringToSign(e,n,s){const r=new this.sha256;r.update(zh(s));const o=await r.digest();return`${Jb}
${e}
${n}
${gr(o)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const n=[];for(const o of e.split("/"))(o==null?void 0:o.length)!==0&&o!=="."&&(o===".."?n.pop():n.push(o));const s=`${e!=null&&e.startsWith("/")?"/":""}${n.join("/")}${n.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return Ql(s).replace(/%2F/g,"/")}return e}async getSignature(e,n,s,r){const o=await this.createStringToSign(e,n,r),i=new this.sha256(await s);return i.update(zh(o)),gr(await i.digest())}getSigningKey(e,n,s,r){return sse(this.sha256,e,s,n,r||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const ng=t=>{const e=dse(t).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},UR=t=>Object.keys(t).sort().join(";"),fse=t=>{let e=t.credentials,n=!!t.credentials,s;Object.defineProperty(t,"credentials",{set(c){c&&c!==e&&c!==s&&(n=!0),e=c;const u=pse(t,{credentials:e,credentialDefaultProvider:t.credentialDefaultProvider}),d=mse(t,u);n&&!d.attributed?(s=async h=>d(h).then(f=>nne(f,"CREDENTIALS_CODE","e")),s.memoized=d.memoized,s.configBound=d.configBound,s.attributed=!0):s=d},get(){return s},enumerable:!0,configurable:!0}),t.credentials=e;const{signingEscapePath:r=!0,systemClockOffset:o=t.systemClockOffset||0,sha256:i}=t;let a;return t.signer?a=Tu(t.signer):t.regionInfoProvider?a=()=>Tu(t.region)().then(async c=>[await t.regionInfoProvider(c,{useFipsEndpoint:await t.useFipsEndpoint(),useDualstackEndpoint:await t.useDualstackEndpoint()})||{},c]).then(([c,u])=>{const{signingRegion:d,signingService:h}=c;t.signingRegion=t.signingRegion||d||u,t.signingName=t.signingName||h||t.serviceId;const f={...t,credentials:t.credentials,region:t.signingRegion,service:t.signingName,sha256:i,uriEscapePath:r},m=t.signerConstructor||SC;return new m(f)}):a=async c=>{c=Object.assign({},{name:"sigv4",signingName:t.signingName||t.defaultSigningName,signingRegion:await Tu(t.region)(),properties:{}},c);const u=c.signingRegion,d=c.signingName;t.signingRegion=t.signingRegion||u,t.signingName=t.signingName||d||t.serviceId;const h={...t,credentials:t.credentials,region:t.signingRegion,service:t.signingName,sha256:i,uriEscapePath:r},f=t.signerConstructor||SC;return new f(h)},Object.assign(t,{systemClockOffset:o,signingEscapePath:r,signer:a})};function pse(t,{credentials:e,credentialDefaultProvider:n}){let s;return e?e!=null&&e.memoized?s=e:s=jne(e,Lne,v4):n?s=Tu(n(Object.assign({},t,{parentClientConfig:t}))):s=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},s.memoized=!0,s}function mse(t,e){if(e.configBound)return e;const n=async s=>e({...s,callerClientConfig:t});return n.memoized=e.memoized,n.configBound=!0,n}const El=(t,e)=>{const n=[];if(t&&n.push(t),e)for(const s of e)n.push(s);return n},pa=(t,e)=>`${t||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,Mx=()=>{let t=[],e=[],n=!1;const s=new Set,r=d=>d.sort((h,f)=>VR[f.step]-VR[h.step]||WR[f.priority||"normal"]-WR[h.priority||"normal"]),o=d=>{let h=!1;const f=m=>{const g=El(m.name,m.aliases);if(g.includes(d)){h=!0;for(const y of g)s.delete(y);return!1}return!0};return t=t.filter(f),e=e.filter(f),h},i=d=>{let h=!1;const f=m=>{if(m.middleware===d){h=!0;for(const g of El(m.name,m.aliases))s.delete(g);return!1}return!0};return t=t.filter(f),e=e.filter(f),h},a=d=>{var h;return t.forEach(f=>{d.add(f.middleware,{...f})}),e.forEach(f=>{d.addRelativeTo(f.middleware,{...f})}),(h=d.identifyOnResolve)==null||h.call(d,u.identifyOnResolve()),d},l=d=>{const h=[];return d.before.forEach(f=>{f.before.length===0&&f.after.length===0?h.push(f):h.push(...l(f))}),h.push(d),d.after.reverse().forEach(f=>{f.before.length===0&&f.after.length===0?h.push(f):h.push(...l(f))}),h},c=(d=!1)=>{const h=[],f=[],m={};return t.forEach(y=>{const x={...y,before:[],after:[]};for(const v of El(x.name,x.aliases))m[v]=x;h.push(x)}),e.forEach(y=>{const x={...y,before:[],after:[]};for(const v of El(x.name,x.aliases))m[v]=x;f.push(x)}),f.forEach(y=>{if(y.toMiddleware){const x=m[y.toMiddleware];if(x===void 0){if(d)return;throw new Error(`${y.toMiddleware} is not found when adding ${pa(y.name,y.aliases)} middleware ${y.relation} ${y.toMiddleware}`)}y.relation==="after"&&x.after.push(y),y.relation==="before"&&x.before.push(y)}}),r(h).map(l).reduce((y,x)=>(y.push(...x),y),[])},u={add:(d,h={})=>{const{name:f,override:m,aliases:g}=h,y={step:"initialize",priority:"normal",middleware:d,...h},x=El(f,g);if(x.length>0){if(x.some(v=>s.has(v))){if(!m)throw new Error(`Duplicate middleware name '${pa(f,g)}'`);for(const v of x){const b=t.findIndex(C=>{var k;return C.name===v||((k=C.aliases)==null?void 0:k.some(N=>N===v))});if(b===-1)continue;const w=t[b];if(w.step!==y.step||y.priority!==w.priority)throw new Error(`"${pa(w.name,w.aliases)}" middleware with ${w.priority} priority in ${w.step} step cannot be overridden by "${pa(f,g)}" middleware with ${y.priority} priority in ${y.step} step.`);t.splice(b,1)}}for(const v of x)s.add(v)}t.push(y)},addRelativeTo:(d,h)=>{const{name:f,override:m,aliases:g}=h,y={middleware:d,...h},x=El(f,g);if(x.length>0){if(x.some(v=>s.has(v))){if(!m)throw new Error(`Duplicate middleware name '${pa(f,g)}'`);for(const v of x){const b=e.findIndex(C=>{var k;return C.name===v||((k=C.aliases)==null?void 0:k.some(N=>N===v))});if(b===-1)continue;const w=e[b];if(w.toMiddleware!==y.toMiddleware||w.relation!==y.relation)throw new Error(`"${pa(w.name,w.aliases)}" middleware ${w.relation} "${w.toMiddleware}" middleware cannot be overridden by "${pa(f,g)}" middleware ${y.relation} "${y.toMiddleware}" middleware.`);e.splice(b,1)}}for(const v of x)s.add(v)}e.push(y)},clone:()=>a(Mx()),use:d=>{d.applyToStack(u)},remove:d=>typeof d=="string"?o(d):i(d),removeByTag:d=>{let h=!1;const f=m=>{const{tags:g,name:y,aliases:x}=m;if(g&&g.includes(d)){const v=El(y,x);for(const b of v)s.delete(b);return h=!0,!1}return!0};return t=t.filter(f),e=e.filter(f),h},concat:d=>{var f;const h=a(Mx());return h.use(d),h.identifyOnResolve(n||h.identifyOnResolve()||(((f=d.identifyOnResolve)==null?void 0:f.call(d))??!1)),h},applyToStack:a,identify:()=>c(!0).map(d=>{const h=d.step??d.relation+" "+d.toMiddleware;return pa(d.name,d.aliases)+" - "+h}),identifyOnResolve(d){return typeof d=="boolean"&&(n=d),n},resolve:(d,h)=>{for(const f of c().map(m=>m.middleware).reverse())d=f(d,h);return n&&console.log(u.identify()),d}};return u},VR={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},WR={high:3,normal:2,low:1};class gse{constructor(e){this.config=e,this.middlewareStack=Mx()}send(e,n,s){const r=typeof n!="function"?n:void 0,o=typeof n=="function"?n:s,i=r===void 0&&this.config.cacheMiddleware===!0;let a;if(i){this.handlers||(this.handlers=new WeakMap);const l=this.handlers;l.has(e.constructor)?a=l.get(e.constructor):(a=e.resolveMiddleware(this.middlewareStack,this.config,r),l.set(e.constructor,a))}else delete this.handlers,a=e.resolveMiddleware(this.middlewareStack,this.config,r);if(o)a(e).then(l=>o(null,l.output),l=>o(l)).catch(()=>{});else return a(e).then(l=>l.output)}destroy(){var e,n,s;(s=(n=(e=this.config)==null?void 0:e.requestHandler)==null?void 0:n.destroy)==null||s.call(n),delete this.handlers}}class $4{constructor(){this.middlewareStack=Mx()}static classBuilder(){return new xse}resolveMiddlewareWithContext(e,n,s,{middlewareFn:r,clientName:o,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,smithyContext:c,additionalContext:u,CommandCtor:d}){for(const y of r.bind(this)(d,e,n,s))this.middlewareStack.use(y);const h=e.concat(this.middlewareStack),{logger:f}=n,m={logger:f,clientName:o,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,[bC]:{commandInstance:this,...c},...u},{requestHandler:g}=n;return h.resolve(y=>g.handle(y.request,s||{}),m)}}class xse{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,n,s={}){return this._smithyContext={service:e,operation:n,...s},this}c(e={}){return this._additionalContext=e,this}n(e,n){return this._clientName=e,this._commandName=n,this}f(e=s=>s,n=s=>s){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=n,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}build(){const e=this;let n;return n=class extends $4{static getEndpointParameterInstructions(){return e._ep}constructor(...[s]){super(),this.serialize=e._serializer,this.deserialize=e._deserializer,this.input=s??{},e._init(this)}resolveMiddleware(s,r,o){return this.resolveMiddlewareWithContext(s,r,o,{CommandCtor:n,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const Xu="***SensitiveInformation***",yse=t=>{switch(t){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${t}"`)}},vse=t=>{if(t!=null){if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return String(e)!==String(t)&&A4.warn(R4(`Expected number but observed string: ${t}`)),e}if(typeof t=="number")return t;throw new TypeError(`Expected number, got ${typeof t}: ${t}`)}},bse=Math.ceil(2**127*(2-2**-23)),HR=t=>{const e=vse(t);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>bse)throw new TypeError(`Expected 32-bit float, got ${t}`);return e},wse=t=>{if(t!=null){if(Number.isInteger(t)&&!Number.isNaN(t))return t;throw new TypeError(`Expected integer, got ${typeof t}: ${t}`)}},GR=t=>I4(t,16),qR=t=>I4(t,8),I4=(t,e)=>{const n=wse(t);if(n!==void 0&&Cse(n,e)!==n)throw new TypeError(`Expected ${e}-bit integer, got ${t}`);return n},Cse=(t,e)=>{switch(e){case 32:return Int32Array.of(t)[0];case 16:return Int16Array.of(t)[0];case 8:return Int8Array.of(t)[0]}},T4=(t,e)=>{if(t==null)throw e?new TypeError(`Expected a non-null value for ${e}`):new TypeError("Expected a non-null value");return t},Sse=t=>{if(t==null)return;if(typeof t=="object"&&!Array.isArray(t))return t;const e=Array.isArray(t)?"array":typeof t;throw new TypeError(`Expected object, got ${e}: ${t}`)},Uh=t=>{if(t!=null){if(typeof t=="string")return t;if(["boolean","number","bigint"].includes(typeof t))return A4.warn(R4(`Expected string, got ${typeof t}: ${t}`)),String(t);throw new TypeError(`Expected string, got ${typeof t}: ${t}`)}},kse=t=>HR(typeof t=="string"?p2(t):t),Nse=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,p2=t=>{const e=t.match(Nse);if(e===null||e[0].length!==t.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(t)},Ese=t=>GR(typeof t=="string"?p2(t):t),$se=t=>qR(typeof t=="string"?p2(t):t),R4=t=>String(new TypeError(t).stack||t).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),A4={warn:console.warn},Ise=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Tse=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),Rse=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=Tse.exec(t);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[n,s,r,o,i,a,l,c,u]=e,d=Ese(D4(s)),h=Vh(r,"month",1,12),f=Vh(o,"day",1,31),m=Ase(d,h,f,{hours:i,minutes:a,seconds:l,fractionalMilliseconds:c});return u.toUpperCase()!="Z"&&m.setTime(m.getTime()-_se(u)),m},Ase=(t,e,n,s)=>{const r=e-1;return Ose(t,r,n),new Date(Date.UTC(t,r,n,Vh(s.hours,"hour",0,23),Vh(s.minutes,"minute",0,59),Vh(s.seconds,"seconds",0,60),Pse(s.fractionalMilliseconds)))},Dse=[31,28,31,30,31,30,31,31,30,31,30,31],Ose=(t,e,n)=>{let s=Dse[e];if(e===1&&Fse(t)&&(s=29),n>s)throw new TypeError(`Invalid day for ${Ise[e]} in ${t}: ${n}`)},Fse=t=>t%4===0&&(t%100!==0||t%400===0),Vh=(t,e,n,s)=>{const r=$se(D4(t));if(r<n||r>s)throw new TypeError(`${e} must be between ${n} and ${s}, inclusive`);return r},Pse=t=>t==null?0:kse("0."+t)*1e3,_se=t=>{const e=t[0];let n=1;if(e=="+")n=1;else if(e=="-")n=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const s=Number(t.substring(1,3)),r=Number(t.substring(4,6));return n*(s*60+r)*60*1e3},D4=t=>{let e=0;for(;e<t.length-1&&t.charAt(e)==="0";)e++;return e===0?t:t.slice(e)};class vu extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;const n=e;return vu.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](e){if(!e)return!1;const n=e;return this===vu?vu.isInstance(e):vu.isInstance(e)?n.name&&this.name?this.prototype.isPrototypeOf(e)||n.name===this.name:this.prototype.isPrototypeOf(e):!1}}const Or=(t,e={})=>{Object.entries(e).filter(([,s])=>s!==void 0).forEach(([s,r])=>{(t[s]==null||t[s]==="")&&(t[s]=r)});const n=t.message||t.Message||"UnknownError";return t.message=n,delete t.Message,t},Mse=({output:t,parsedBody:e,exceptionCtor:n,errorCode:s})=>{const r=jse(t),o=r.httpStatusCode?r.httpStatusCode+"":void 0,i=new n({name:(e==null?void 0:e.code)||(e==null?void 0:e.Code)||s||o||"UnknownError",$fault:"client",$metadata:r});throw Or(i,e)},Lse=t=>({output:e,parsedBody:n,errorCode:s})=>{Mse({output:e,parsedBody:n,exceptionCtor:t,errorCode:s})},jse=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),Bse=t=>{switch(t){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},zse=t=>{const e=[];for(const n in _x){const s=_x[n];t[s]!==void 0&&e.push({algorithmId:()=>s,checksumConstructor:()=>t[s]})}return{addChecksumAlgorithm(n){e.push(n)},checksumAlgorithms(){return e}}},Use=t=>{const e={};return t.checksumAlgorithms().forEach(n=>{e[n.algorithmId()]=n.checksumConstructor()}),e},Vse=t=>({setRetryStrategy(e){t.retryStrategy=e},retryStrategy(){return t.retryStrategy}}),Wse=t=>{const e={};return e.retryStrategy=t.retryStrategy(),e},Hse=t=>Object.assign(zse(t),Vse(t)),Gse=t=>Object.assign(Use(t),Wse(t)),O4=t=>{const e="#text";for(const n in t)t.hasOwnProperty(n)&&t[n][e]!==void 0?t[n]=t[n][e]:typeof t[n]=="object"&&t[n]!==null&&(t[n]=O4(t[n]));return t},KR=t=>t!=null;class F4{trace(){}debug(){}info(){}warn(){}error(){}}function bs(t,e,n){let s,r,o;if(typeof e>"u"&&typeof n>"u")s={},o=t;else{if(s=t,typeof e=="function")return r=e,o=n,qse(s,r,o);o=e}for(const i of Object.keys(o)){if(!Array.isArray(o[i])){s[i]=o[i];continue}Kse(s,null,o,i)}return s}const qse=(t,e,n)=>bs(t,Object.entries(n).reduce((s,[r,o])=>(Array.isArray(o)?s[r]=o:typeof o=="function"?s[r]=[e,o()]:s[r]=[e,o],s),{})),Kse=(t,e,n,s)=>{let[r,o]=n[s];if(typeof o=="function"){let i;const a=r===void 0&&(i=o())!=null,l=typeof r=="function"&&!!r(void 0)||typeof r!="function"&&!!r;a?t[s]=i:l&&(t[s]=o())}else{const i=r===void 0&&o!=null,a=typeof r=="function"&&!!r(o)||typeof r!="function"&&!!r;(i||a)&&(t[s]=o)}},Xse=(t,e)=>Rne(t,e).then(n=>e.utf8Encoder(n));var m2={},S0={};(function(t){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",n=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+e+"]["+n+"]*",r=new RegExp("^"+s+"$"),o=function(a,l){const c=[];let u=l.exec(a);for(;u;){const d=[];d.startIndex=l.lastIndex-u[0].length;const h=u.length;for(let f=0;f<h;f++)d.push(u[f]);c.push(d),u=l.exec(a)}return c},i=function(a){const l=r.exec(a);return!(l===null||typeof l>"u")};t.isExist=function(a){return typeof a<"u"},t.isEmptyObject=function(a){return Object.keys(a).length===0},t.merge=function(a,l,c){if(l){const u=Object.keys(l),d=u.length;for(let h=0;h<d;h++)c==="strict"?a[u[h]]=[l[u[h]]]:a[u[h]]=l[u[h]]}},t.getValue=function(a){return t.isExist(a)?a:""},t.isName=i,t.getAllMatches=o,t.nameRegexp=s})(S0);const g2=S0,Yse={allowBooleanAttributes:!1,unpairedTags:[]};m2.validate=function(t,e){e=Object.assign({},Yse,e);const n=[];let s=!1,r=!1;t[0]==="\uFEFF"&&(t=t.substr(1));for(let o=0;o<t.length;o++)if(t[o]==="<"&&t[o+1]==="?"){if(o+=2,o=YR(t,o),o.err)return o}else if(t[o]==="<"){let i=o;if(o++,t[o]==="!"){o=JR(t,o);continue}else{let a=!1;t[o]==="/"&&(a=!0,o++);let l="";for(;o<t.length&&t[o]!==">"&&t[o]!==" "&&t[o]!=="	"&&t[o]!==`
`&&t[o]!=="\r";o++)l+=t[o];if(l=l.trim(),l[l.length-1]==="/"&&(l=l.substring(0,l.length-1),o--),!rre(l)){let d;return l.trim().length===0?d="Invalid space after '<'.":d="Tag '"+l+"' is an invalid name.",Nn("InvalidTag",d,Ks(t,o))}const c=Qse(t,o);if(c===!1)return Nn("InvalidAttr","Attributes for '"+l+"' have open quote.",Ks(t,o));let u=c.value;if(o=c.index,u[u.length-1]==="/"){const d=o-u.length;u=u.substring(0,u.length-1);const h=ZR(u,e);if(h===!0)s=!0;else return Nn(h.err.code,h.err.msg,Ks(t,d+h.err.line))}else if(a)if(c.tagClosed){if(u.trim().length>0)return Nn("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",Ks(t,i));if(n.length===0)return Nn("InvalidTag","Closing tag '"+l+"' has not been opened.",Ks(t,i));{const d=n.pop();if(l!==d.tagName){let h=Ks(t,d.tagStartPos);return Nn("InvalidTag","Expected closing tag '"+d.tagName+"' (opened in line "+h.line+", col "+h.col+") instead of closing tag '"+l+"'.",Ks(t,i))}n.length==0&&(r=!0)}}else return Nn("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",Ks(t,o));else{const d=ZR(u,e);if(d!==!0)return Nn(d.err.code,d.err.msg,Ks(t,o-u.length+d.err.line));if(r===!0)return Nn("InvalidXml","Multiple possible root nodes found.",Ks(t,o));e.unpairedTags.indexOf(l)!==-1||n.push({tagName:l,tagStartPos:i}),s=!0}for(o++;o<t.length;o++)if(t[o]==="<")if(t[o+1]==="!"){o++,o=JR(t,o);continue}else if(t[o+1]==="?"){if(o=YR(t,++o),o.err)return o}else break;else if(t[o]==="&"){const d=nre(t,o);if(d==-1)return Nn("InvalidChar","char '&' is not expected.",Ks(t,o));o=d}else if(r===!0&&!XR(t[o]))return Nn("InvalidXml","Extra text at the end",Ks(t,o));t[o]==="<"&&o--}}else{if(XR(t[o]))continue;return Nn("InvalidChar","char '"+t[o]+"' is not expected.",Ks(t,o))}if(s){if(n.length==1)return Nn("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",Ks(t,n[0].tagStartPos));if(n.length>0)return Nn("InvalidXml","Invalid '"+JSON.stringify(n.map(o=>o.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Nn("InvalidXml","Start tag expected.",1);return!0};function XR(t){return t===" "||t==="	"||t===`
`||t==="\r"}function YR(t,e){const n=e;for(;e<t.length;e++)if(t[e]=="?"||t[e]==" "){const s=t.substr(n,e-n);if(e>5&&s==="xml")return Nn("InvalidXml","XML declaration allowed only at the start of the document.",Ks(t,e));if(t[e]=="?"&&t[e+1]==">"){e++;break}else continue}return e}function JR(t,e){if(t.length>e+5&&t[e+1]==="-"&&t[e+2]==="-"){for(e+=3;e<t.length;e++)if(t[e]==="-"&&t[e+1]==="-"&&t[e+2]===">"){e+=2;break}}else if(t.length>e+8&&t[e+1]==="D"&&t[e+2]==="O"&&t[e+3]==="C"&&t[e+4]==="T"&&t[e+5]==="Y"&&t[e+6]==="P"&&t[e+7]==="E"){let n=1;for(e+=8;e<t.length;e++)if(t[e]==="<")n++;else if(t[e]===">"&&(n--,n===0))break}else if(t.length>e+9&&t[e+1]==="["&&t[e+2]==="C"&&t[e+3]==="D"&&t[e+4]==="A"&&t[e+5]==="T"&&t[e+6]==="A"&&t[e+7]==="["){for(e+=8;e<t.length;e++)if(t[e]==="]"&&t[e+1]==="]"&&t[e+2]===">"){e+=2;break}}return e}const Jse='"',Zse="'";function Qse(t,e){let n="",s="",r=!1;for(;e<t.length;e++){if(t[e]===Jse||t[e]===Zse)s===""?s=t[e]:s!==t[e]||(s="");else if(t[e]===">"&&s===""){r=!0;break}n+=t[e]}return s!==""?!1:{value:n,index:e,tagClosed:r}}const ere=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function ZR(t,e){const n=g2.getAllMatches(t,ere),s={};for(let r=0;r<n.length;r++){if(n[r][1].length===0)return Nn("InvalidAttr","Attribute '"+n[r][2]+"' has no space in starting.",rh(n[r]));if(n[r][3]!==void 0&&n[r][4]===void 0)return Nn("InvalidAttr","Attribute '"+n[r][2]+"' is without value.",rh(n[r]));if(n[r][3]===void 0&&!e.allowBooleanAttributes)return Nn("InvalidAttr","boolean attribute '"+n[r][2]+"' is not allowed.",rh(n[r]));const o=n[r][2];if(!sre(o))return Nn("InvalidAttr","Attribute '"+o+"' is an invalid name.",rh(n[r]));if(!s.hasOwnProperty(o))s[o]=1;else return Nn("InvalidAttr","Attribute '"+o+"' is repeated.",rh(n[r]))}return!0}function tre(t,e){let n=/\d/;for(t[e]==="x"&&(e++,n=/[\da-fA-F]/);e<t.length;e++){if(t[e]===";")return e;if(!t[e].match(n))break}return-1}function nre(t,e){if(e++,t[e]===";")return-1;if(t[e]==="#")return e++,tre(t,e);let n=0;for(;e<t.length;e++,n++)if(!(t[e].match(/\w/)&&n<20)){if(t[e]===";")break;return-1}return e}function Nn(t,e,n){return{err:{code:t,msg:e,line:n.line||n,col:n.col}}}function sre(t){return g2.isName(t)}function rre(t){return g2.isName(t)}function Ks(t,e){const n=t.substring(0,e).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function rh(t){return t.startIndex+t[1].length}var x2={};const P4={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,n){return t}},ore=function(t){return Object.assign({},P4,t)};x2.buildOptions=ore;x2.defaultOptions=P4;class ire{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,n){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:n})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}var are=ire;const lre=S0;function cre(t,e){const n={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let s=1,r=!1,o=!1,i="";for(;e<t.length;e++)if(t[e]==="<"&&!o){if(r&&hre(t,e))e+=7,[entityName,val,e]=ure(t,e+1),val.indexOf("&")===-1&&(n[gre(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(r&&fre(t,e))e+=8;else if(r&&pre(t,e))e+=8;else if(r&&mre(t,e))e+=9;else if(dre)o=!0;else throw new Error("Invalid DOCTYPE");s++,i=""}else if(t[e]===">"){if(o?t[e-1]==="-"&&t[e-2]==="-"&&(o=!1,s--):s--,s===0)break}else t[e]==="["?r=!0:i+=t[e];if(s!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:n,i:e}}function ure(t,e){let n="";for(;e<t.length&&t[e]!=="'"&&t[e]!=='"';e++)n+=t[e];if(n=n.trim(),n.indexOf(" ")!==-1)throw new Error("External entites are not supported");const s=t[e++];let r="";for(;e<t.length&&t[e]!==s;e++)r+=t[e];return[n,r,e]}function dre(t,e){return t[e+1]==="!"&&t[e+2]==="-"&&t[e+3]==="-"}function hre(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="N"&&t[e+4]==="T"&&t[e+5]==="I"&&t[e+6]==="T"&&t[e+7]==="Y"}function fre(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="L"&&t[e+4]==="E"&&t[e+5]==="M"&&t[e+6]==="E"&&t[e+7]==="N"&&t[e+8]==="T"}function pre(t,e){return t[e+1]==="!"&&t[e+2]==="A"&&t[e+3]==="T"&&t[e+4]==="T"&&t[e+5]==="L"&&t[e+6]==="I"&&t[e+7]==="S"&&t[e+8]==="T"}function mre(t,e){return t[e+1]==="!"&&t[e+2]==="N"&&t[e+3]==="O"&&t[e+4]==="T"&&t[e+5]==="A"&&t[e+6]==="T"&&t[e+7]==="I"&&t[e+8]==="O"&&t[e+9]==="N"}function gre(t){if(lre.isName(t))return t;throw new Error(`Invalid entity name ${t}`)}var xre=cre;const yre=/^[-+]?0x[a-fA-F0-9]+$/,vre=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,bre={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function wre(t,e={}){if(e=Object.assign({},bre,e),!t||typeof t!="string")return t;let n=t.trim();if(e.skipLike!==void 0&&e.skipLike.test(n))return t;if(t==="0")return 0;if(e.hex&&yre.test(n))return Sre(n,16);if(n.search(/[eE]/)!==-1){const s=n.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(s){if(e.leadingZeros)n=(s[1]||"")+s[3];else if(!(s[2]==="0"&&s[3][0]==="."))return t;return e.eNotation?Number(n):t}else return t}else{const s=vre.exec(n);if(s){const r=s[1],o=s[2];let i=Cre(s[3]);if(!e.leadingZeros&&o.length>0&&r&&n[2]!==".")return t;if(!e.leadingZeros&&o.length>0&&!r&&n[1]!==".")return t;if(e.leadingZeros&&o===t)return 0;{const a=Number(n),l=""+a;return l.search(/[eE]/)!==-1?e.eNotation?a:t:n.indexOf(".")!==-1?l==="0"&&i===""||l===i||r&&l==="-"+i?a:t:o?i===l||r+i===l?a:t:n===l||n===r+l?a:t}}else return t}}function Cre(t){return t&&t.indexOf(".")!==-1&&(t=t.replace(/0+$/,""),t==="."?t="0":t[0]==="."?t="0"+t:t[t.length-1]==="."&&(t=t.substr(0,t.length-1))),t}function Sre(t,e){if(parseInt)return parseInt(t,e);if(Number.parseInt)return Number.parseInt(t,e);if(window&&window.parseInt)return window.parseInt(t,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}var kre=wre;const _4=S0,oh=are,Nre=xre,Ere=kre;let $re=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(n,s)=>String.fromCharCode(Number.parseInt(s,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(n,s)=>String.fromCharCode(Number.parseInt(s,16))}},this.addExternalEntities=Ire,this.parseXml=Ore,this.parseTextData=Tre,this.resolveNameSpace=Rre,this.buildAttributesMap=Dre,this.isItStopNode=Mre,this.replaceEntitiesValue=Pre,this.readStopNodeData=jre,this.saveTextToParentTag=_re,this.addChild=Fre}};function Ire(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const s=e[n];this.lastEntities[s]={regex:new RegExp("&"+s+";","g"),val:t[s]}}}function Tre(t,e,n,s,r,o,i){if(t!==void 0&&(this.options.trimValues&&!s&&(t=t.trim()),t.length>0)){i||(t=this.replaceEntitiesValue(t));const a=this.options.tagValueProcessor(e,t,n,r,o);return a==null?t:typeof a!=typeof t||a!==t?a:this.options.trimValues?NC(t,this.options.parseTagValue,this.options.numberParseOptions):t.trim()===t?NC(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function Rre(t){if(this.options.removeNSPrefix){const e=t.split(":"),n=t.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(t=n+e[1])}return t}const Are=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Dre(t,e,n){if(!this.options.ignoreAttributes&&typeof t=="string"){const s=_4.getAllMatches(t,Are),r=s.length,o={};for(let i=0;i<r;i++){const a=this.resolveNameSpace(s[i][1]);let l=s[i][4],c=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(c=this.options.transformAttributeName(c)),c==="__proto__"&&(c="#__proto__"),l!==void 0){this.options.trimValues&&(l=l.trim()),l=this.replaceEntitiesValue(l);const u=this.options.attributeValueProcessor(a,l,e);u==null?o[c]=l:typeof u!=typeof l||u!==l?o[c]=u:o[c]=NC(l,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[c]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){const i={};return i[this.options.attributesGroupName]=o,i}return o}}const Ore=function(t){t=t.replace(/\r\n?/g,`
`);const e=new oh("!xml");let n=e,s="",r="";for(let o=0;o<t.length;o++)if(t[o]==="<")if(t[o+1]==="/"){const a=Ul(t,">",o,"Closing Tag is not closed.");let l=t.substring(o+2,a).trim();if(this.options.removeNSPrefix){const d=l.indexOf(":");d!==-1&&(l=l.substr(d+1))}this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&(s=this.saveTextToParentTag(s,n,r));const c=r.substring(r.lastIndexOf(".")+1);if(l&&this.options.unpairedTags.indexOf(l)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${l}>`);let u=0;c&&this.options.unpairedTags.indexOf(c)!==-1?(u=r.lastIndexOf(".",r.lastIndexOf(".")-1),this.tagsNodeStack.pop()):u=r.lastIndexOf("."),r=r.substring(0,u),n=this.tagsNodeStack.pop(),s="",o=a}else if(t[o+1]==="?"){let a=kC(t,o,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(s=this.saveTextToParentTag(s,n,r),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){const l=new oh(a.tagName);l.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(l[":@"]=this.buildAttributesMap(a.tagExp,r,a.tagName)),this.addChild(n,l,r)}o=a.closeIndex+1}else if(t.substr(o+1,3)==="!--"){const a=Ul(t,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){const l=t.substring(o+4,a-2);s=this.saveTextToParentTag(s,n,r),n.add(this.options.commentPropName,[{[this.options.textNodeName]:l}])}o=a}else if(t.substr(o+1,2)==="!D"){const a=Nre(t,o);this.docTypeEntities=a.entities,o=a.i}else if(t.substr(o+1,2)==="!["){const a=Ul(t,"]]>",o,"CDATA is not closed.")-2,l=t.substring(o+9,a);s=this.saveTextToParentTag(s,n,r);let c=this.parseTextData(l,n.tagname,r,!0,!1,!0,!0);c==null&&(c=""),this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:l}]):n.add(this.options.textNodeName,c),o=a+2}else{let a=kC(t,o,this.options.removeNSPrefix),l=a.tagName;const c=a.rawTagName;let u=a.tagExp,d=a.attrExpPresent,h=a.closeIndex;this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&s&&n.tagname!=="!xml"&&(s=this.saveTextToParentTag(s,n,r,!1));const f=n;if(f&&this.options.unpairedTags.indexOf(f.tagname)!==-1&&(n=this.tagsNodeStack.pop(),r=r.substring(0,r.lastIndexOf("."))),l!==e.tagname&&(r+=r?"."+l:l),this.isItStopNode(this.options.stopNodes,r,l)){let m="";if(u.length>0&&u.lastIndexOf("/")===u.length-1)l[l.length-1]==="/"?(l=l.substr(0,l.length-1),r=r.substr(0,r.length-1),u=l):u=u.substr(0,u.length-1),o=a.closeIndex;else if(this.options.unpairedTags.indexOf(l)!==-1)o=a.closeIndex;else{const y=this.readStopNodeData(t,c,h+1);if(!y)throw new Error(`Unexpected end of ${c}`);o=y.i,m=y.tagContent}const g=new oh(l);l!==u&&d&&(g[":@"]=this.buildAttributesMap(u,r,l)),m&&(m=this.parseTextData(m,l,r,!0,d,!0,!0)),r=r.substr(0,r.lastIndexOf(".")),g.add(this.options.textNodeName,m),this.addChild(n,g,r)}else{if(u.length>0&&u.lastIndexOf("/")===u.length-1){l[l.length-1]==="/"?(l=l.substr(0,l.length-1),r=r.substr(0,r.length-1),u=l):u=u.substr(0,u.length-1),this.options.transformTagName&&(l=this.options.transformTagName(l));const m=new oh(l);l!==u&&d&&(m[":@"]=this.buildAttributesMap(u,r,l)),this.addChild(n,m,r),r=r.substr(0,r.lastIndexOf("."))}else{const m=new oh(l);this.tagsNodeStack.push(n),l!==u&&d&&(m[":@"]=this.buildAttributesMap(u,r,l)),this.addChild(n,m,r),n=m}s="",o=h}}else s+=t[o];return e.child};function Fre(t,e,n){const s=this.options.updateTag(e.tagname,n,e[":@"]);s===!1||(typeof s=="string"&&(e.tagname=s),t.addChild(e))}const Pre=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){const n=this.docTypeEntities[e];t=t.replace(n.regx,n.val)}for(let e in this.lastEntities){const n=this.lastEntities[e];t=t.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const n=this.htmlEntities[e];t=t.replace(n.regex,n.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function _re(t,e,n,s){return t&&(s===void 0&&(s=Object.keys(e.child).length===0),t=this.parseTextData(t,e.tagname,n,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,s),t!==void 0&&t!==""&&e.add(this.options.textNodeName,t),t=""),t}function Mre(t,e,n){const s="*."+n;for(const r in t){const o=t[r];if(s===o||e===o)return!0}return!1}function Lre(t,e,n=">"){let s,r="";for(let o=e;o<t.length;o++){let i=t[o];if(s)i===s&&(s="");else if(i==='"'||i==="'")s=i;else if(i===n[0])if(n[1]){if(t[o+1]===n[1])return{data:r,index:o}}else return{data:r,index:o};else i==="	"&&(i=" ");r+=i}}function Ul(t,e,n,s){const r=t.indexOf(e,n);if(r===-1)throw new Error(s);return r+e.length-1}function kC(t,e,n,s=">"){const r=Lre(t,e+1,s);if(!r)return;let o=r.data;const i=r.index,a=o.search(/\s/);let l=o,c=!0;a!==-1&&(l=o.substring(0,a),o=o.substring(a+1).trimStart());const u=l;if(n){const d=l.indexOf(":");d!==-1&&(l=l.substr(d+1),c=l!==r.data.substr(d+1))}return{tagName:l,tagExp:o,closeIndex:i,attrExpPresent:c,rawTagName:u}}function jre(t,e,n){const s=n;let r=1;for(;n<t.length;n++)if(t[n]==="<")if(t[n+1]==="/"){const o=Ul(t,">",n,`${e} is not closed`);if(t.substring(n+2,o).trim()===e&&(r--,r===0))return{tagContent:t.substring(s,n),i:o};n=o}else if(t[n+1]==="?")n=Ul(t,"?>",n+1,"StopNode is not closed.");else if(t.substr(n+1,3)==="!--")n=Ul(t,"-->",n+3,"StopNode is not closed.");else if(t.substr(n+1,2)==="![")n=Ul(t,"]]>",n,"StopNode is not closed.")-2;else{const o=kC(t,n,">");o&&((o&&o.tagName)===e&&o.tagExp[o.tagExp.length-1]!=="/"&&r++,n=o.closeIndex)}}function NC(t,e,n){if(e&&typeof t=="string"){const s=t.trim();return s==="true"?!0:s==="false"?!1:Ere(t,n)}else return _4.isExist(t)?t:""}var Bre=$re,M4={};function zre(t,e){return L4(t,e)}function L4(t,e,n){let s;const r={};for(let o=0;o<t.length;o++){const i=t[o],a=Ure(i);let l="";if(n===void 0?l=a:l=n+"."+a,a===e.textNodeName)s===void 0?s=i[a]:s+=""+i[a];else{if(a===void 0)continue;if(i[a]){let c=L4(i[a],e,l);const u=Wre(c,e);i[":@"]?Vre(c,i[":@"],l,e):Object.keys(c).length===1&&c[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?c=c[e.textNodeName]:Object.keys(c).length===0&&(e.alwaysCreateTextNode?c[e.textNodeName]="":c=""),r[a]!==void 0&&r.hasOwnProperty(a)?(Array.isArray(r[a])||(r[a]=[r[a]]),r[a].push(c)):e.isArray(a,l,u)?r[a]=[c]:r[a]=c}}}return typeof s=="string"?s.length>0&&(r[e.textNodeName]=s):s!==void 0&&(r[e.textNodeName]=s),r}function Ure(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const s=e[n];if(s!==":@")return s}}function Vre(t,e,n,s){if(e){const r=Object.keys(e),o=r.length;for(let i=0;i<o;i++){const a=r[i];s.isArray(a,n+"."+a,!0,!0)?t[a]=[e[a]]:t[a]=e[a]}}}function Wre(t,e){const{textNodeName:n}=e,s=Object.keys(t).length;return!!(s===0||s===1&&(t[n]||typeof t[n]=="boolean"||t[n]===0))}M4.prettify=zre;const{buildOptions:Hre}=x2,Gre=Bre,{prettify:qre}=M4,Kre=m2;let Xre=class{constructor(e){this.externalEntities={},this.options=Hre(e)}parse(e,n){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(n){n===!0&&(n={});const o=Kre.validate(e,n);if(o!==!0)throw Error(`${o.err.msg}:${o.err.line}:${o.err.col}`)}const s=new Gre(this.options);s.addExternalEntities(this.externalEntities);const r=s.parseXml(e);return this.options.preserveOrder||r===void 0?r:qre(r,this.options)}addEntity(e,n){if(n.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(n==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=n}};var Yre=Xre;const Jre=`
`;function Zre(t,e){let n="";return e.format&&e.indentBy.length>0&&(n=Jre),j4(t,e,"",n)}function j4(t,e,n,s){let r="",o=!1;for(let i=0;i<t.length;i++){const a=t[i],l=Qre(a);if(l===void 0)continue;let c="";if(n.length===0?c=l:c=`${n}.${l}`,l===e.textNodeName){let m=a[l];eoe(c,e)||(m=e.tagValueProcessor(l,m),m=B4(m,e)),o&&(r+=s),r+=m,o=!1;continue}else if(l===e.cdataPropName){o&&(r+=s),r+=`<![CDATA[${a[l][0][e.textNodeName]}]]>`,o=!1;continue}else if(l===e.commentPropName){r+=s+`<!--${a[l][0][e.textNodeName]}-->`,o=!0;continue}else if(l[0]==="?"){const m=QR(a[":@"],e),g=l==="?xml"?"":s;let y=a[l][0][e.textNodeName];y=y.length!==0?" "+y:"",r+=g+`<${l}${y}${m}?>`,o=!0;continue}let u=s;u!==""&&(u+=e.indentBy);const d=QR(a[":@"],e),h=s+`<${l}${d}`,f=j4(a[l],e,c,u);e.unpairedTags.indexOf(l)!==-1?e.suppressUnpairedNode?r+=h+">":r+=h+"/>":(!f||f.length===0)&&e.suppressEmptyNode?r+=h+"/>":f&&f.endsWith(">")?r+=h+`>${f}${s}</${l}>`:(r+=h+">",f&&s!==""&&(f.includes("/>")||f.includes("</"))?r+=s+e.indentBy+f+s:r+=f,r+=`</${l}>`),o=!0}return r}function Qre(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const s=e[n];if(t.hasOwnProperty(s)&&s!==":@")return s}}function QR(t,e){let n="";if(t&&!e.ignoreAttributes)for(let s in t){if(!t.hasOwnProperty(s))continue;let r=e.attributeValueProcessor(s,t[s]);r=B4(r,e),r===!0&&e.suppressBooleanAttributes?n+=` ${s.substr(e.attributeNamePrefix.length)}`:n+=` ${s.substr(e.attributeNamePrefix.length)}="${r}"`}return n}function eoe(t,e){t=t.substr(0,t.length-e.textNodeName.length-1);let n=t.substr(t.lastIndexOf(".")+1);for(let s in e.stopNodes)if(e.stopNodes[s]===t||e.stopNodes[s]==="*."+n)return!0;return!1}function B4(t,e){if(t&&t.length>0&&e.processEntities)for(let n=0;n<e.entities.length;n++){const s=e.entities[n];t=t.replace(s.regex,s.val)}return t}var toe=Zre;const noe=toe,soe={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function pl(t){this.options=Object.assign({},soe,t),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=ioe),this.processTextOrObjNode=roe,this.options.format?(this.indentate=ooe,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}pl.prototype.build=function(t){return this.options.preserveOrder?noe(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0).val)};pl.prototype.j2x=function(t,e){let n="",s="";for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r))if(typeof t[r]>"u")this.isAttribute(r)&&(s+="");else if(t[r]===null)this.isAttribute(r)?s+="":r[0]==="?"?s+=this.indentate(e)+"<"+r+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+r+"/"+this.tagEndChar;else if(t[r]instanceof Date)s+=this.buildTextValNode(t[r],r,"",e);else if(typeof t[r]!="object"){const o=this.isAttribute(r);if(o)n+=this.buildAttrPairStr(o,""+t[r]);else if(r===this.options.textNodeName){let i=this.options.tagValueProcessor(r,""+t[r]);s+=this.replaceEntitiesValue(i)}else s+=this.buildTextValNode(t[r],r,"",e)}else if(Array.isArray(t[r])){const o=t[r].length;let i="",a="";for(let l=0;l<o;l++){const c=t[r][l];if(!(typeof c>"u"))if(c===null)r[0]==="?"?s+=this.indentate(e)+"<"+r+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+r+"/"+this.tagEndChar;else if(typeof c=="object")if(this.options.oneListGroup){const u=this.j2x(c,e+1);i+=u.val,this.options.attributesGroupName&&c.hasOwnProperty(this.options.attributesGroupName)&&(a+=u.attrStr)}else i+=this.processTextOrObjNode(c,r,e);else if(this.options.oneListGroup){let u=this.options.tagValueProcessor(r,c);u=this.replaceEntitiesValue(u),i+=u}else i+=this.buildTextValNode(c,r,"",e)}this.options.oneListGroup&&(i=this.buildObjectNode(i,r,a,e)),s+=i}else if(this.options.attributesGroupName&&r===this.options.attributesGroupName){const o=Object.keys(t[r]),i=o.length;for(let a=0;a<i;a++)n+=this.buildAttrPairStr(o[a],""+t[r][o[a]])}else s+=this.processTextOrObjNode(t[r],r,e);return{attrStr:n,val:s}};pl.prototype.buildAttrPairStr=function(t,e){return e=this.options.attributeValueProcessor(t,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+t:" "+t+'="'+e+'"'};function roe(t,e,n){const s=this.j2x(t,n+1);return t[this.options.textNodeName]!==void 0&&Object.keys(t).length===1?this.buildTextValNode(t[this.options.textNodeName],e,s.attrStr,n):this.buildObjectNode(s.val,e,s.attrStr,n)}pl.prototype.buildObjectNode=function(t,e,n,s){if(t==="")return e[0]==="?"?this.indentate(s)+"<"+e+n+"?"+this.tagEndChar:this.indentate(s)+"<"+e+n+this.closeTag(e)+this.tagEndChar;{let r="</"+e+this.tagEndChar,o="";return e[0]==="?"&&(o="?",r=""),(n||n==="")&&t.indexOf("<")===-1?this.indentate(s)+"<"+e+n+o+">"+t+r:this.options.commentPropName!==!1&&e===this.options.commentPropName&&o.length===0?this.indentate(s)+`<!--${t}-->`+this.newLine:this.indentate(s)+"<"+e+n+o+this.tagEndChar+t+this.indentate(s)+r}};pl.prototype.closeTag=function(t){let e="";return this.options.unpairedTags.indexOf(t)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${t}`,e};pl.prototype.buildTextValNode=function(t,e,n,s){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(s)+`<![CDATA[${t}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(s)+`<!--${t}-->`+this.newLine;if(e[0]==="?")return this.indentate(s)+"<"+e+n+"?"+this.tagEndChar;{let r=this.options.tagValueProcessor(e,t);return r=this.replaceEntitiesValue(r),r===""?this.indentate(s)+"<"+e+n+this.closeTag(e)+this.tagEndChar:this.indentate(s)+"<"+e+n+">"+r+"</"+e+this.tagEndChar}};pl.prototype.replaceEntitiesValue=function(t){if(t&&t.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const n=this.options.entities[e];t=t.replace(n.regex,n.val)}return t};function ooe(t){return this.options.indentBy.repeat(t)}function ioe(t){return t.startsWith(this.options.attributeNamePrefix)&&t!==this.options.textNodeName?t.substr(this.attrPrefixLen):!1}var aoe=pl;const loe=m2,coe=Yre,uoe=aoe;var doe={XMLParser:coe,XMLValidator:loe,XMLBuilder:uoe};const z4=(t,e)=>Xse(t,e).then(n=>{if(n.length){const s=new doe.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(l,c)=>c.trim()===""&&c.includes(`
`)?"":void 0});s.addEntity("#xD","\r"),s.addEntity("#10",`
`);let r;try{r=s.parse(n,!0)}catch(l){throw l&&typeof l=="object"&&Object.defineProperty(l,"$responseBodyText",{value:n}),l}const o="#text",i=Object.keys(r)[0],a=r[i];return a[o]&&(a[i]=a[o],delete a[o]),O4(a)}return{}}),hoe=async(t,e)=>{const n=await z4(t,e);return n.Error&&(n.Error.message=n.Error.message??n.Error.Message),n},foe=(t,e)=>{var n;if(((n=e==null?void 0:e.Error)==null?void 0:n.Code)!==void 0)return e.Error.Code;if((e==null?void 0:e.Code)!==void 0)return e.Code;if(t.statusCode==404)return"NotFound"};Mr.CRC32,Mr.CRC32C,Mr.CRC64NVME,Mr.SHA1,Mr.SHA256;Mr.SHA256,Mr.SHA1,Mr.CRC32,Mr.CRC32C,Mr.CRC64NVME;function poe(t,e,n,s){function r(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function a(u){try{c(s.next(u))}catch(d){i(d)}}function l(u){try{c(s.throw(u))}catch(d){i(d)}}function c(u){u.done?o(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})}function moe(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,r,o,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(c){return function(u){return l([c,u])}}function l(c){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(n=0)),n;)try{if(s=1,r&&(o=c[0]&2?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],r=0}finally{s=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function goe(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}const xoe=t=>new TextEncoder().encode(t);var yoe=typeof Buffer<"u"&&Buffer.from?function(t){return Buffer.from(t,"utf8")}:xoe;function Yu(t){return t instanceof Uint8Array?t:typeof t=="string"?yoe(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}function EC(t){return typeof t=="string"?t.length===0:t.byteLength===0}function U4(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),n=0;n<t.length;)e[n]=t[n],n+=1;return e}return Uint32Array.from(t)}var voe=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697];U4(voe);var V4=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var n,s;try{for(var r=goe(e),o=r.next();!o.done;o=r.next()){var i=o.value;this.checksum=this.checksum>>>8^woe[(this.checksum^i)&255]}}catch(a){n={error:a}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(n)throw n.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),boe=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],woe=U4(boe);const Coe=t=>{const{requestChecksumCalculation:e,responseChecksumValidation:n,requestStreamBufferSize:s}=t;return Object.assign(t,{requestChecksumCalculation:xi(e??ene),responseChecksumValidation:xi(n??tne),requestStreamBufferSize:Number(s??0)})};const Soe=t=>e=>async n=>{if(!vs.isInstance(n.request))return e(n);const{request:s}=n,{handlerProtocol:r=""}=t.requestHandler.metadata||{};if(r.indexOf("h2")>=0&&!s.headers[":authority"])delete s.headers.host,s.headers[":authority"]=s.hostname+(s.port?":"+s.port:"");else if(!s.headers.host){let o=s.hostname;s.port!=null&&(o+=`:${s.port}`),s.headers.host=o}return e(n)},koe={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},Noe=t=>({applyToStack:e=>{e.add(Soe(t),koe)}}),Eoe=()=>(t,e)=>async n=>{var s,r;try{const o=await t(n),{clientName:i,commandName:a,logger:l,dynamoDbDocumentClientOptions:c={}}=e,{overrideInputFilterSensitiveLog:u,overrideOutputFilterSensitiveLog:d}=c,h=u??e.inputFilterSensitiveLog,f=d??e.outputFilterSensitiveLog,{$metadata:m,...g}=o.output;return(s=l==null?void 0:l.info)==null||s.call(l,{clientName:i,commandName:a,input:h(n.input),output:f(g),metadata:m}),o}catch(o){const{clientName:i,commandName:a,logger:l,dynamoDbDocumentClientOptions:c={}}=e,{overrideInputFilterSensitiveLog:u}=c,d=u??e.inputFilterSensitiveLog;throw(r=l==null?void 0:l.error)==null||r.call(l,{clientName:i,commandName:a,input:d(n.input),error:o,metadata:o.$metadata}),o}},$oe={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},Ioe=t=>({applyToStack:e=>{e.add(Eoe(),$oe)}});var eA={};const t1="X-Amzn-Trace-Id",Toe="AWS_LAMBDA_FUNCTION_NAME",Roe="_X_AMZN_TRACE_ID",Aoe=t=>e=>async n=>{const{request:s}=n;if(!vs.isInstance(s)||t.runtime!=="node")return e(n);const r=Object.keys(s.headers??{}).find(l=>l.toLowerCase()===t1.toLowerCase())??t1;if(s.headers.hasOwnProperty(r))return e(n);const o=eA[Toe],i=eA[Roe],a=l=>typeof l=="string"&&l.length>0;return a(o)&&a(i)&&(s.headers[t1]=i),e({...n,request:s})},Doe={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},Ooe=t=>({applyToStack:e=>{e.add(Aoe(t),Doe)}}),Foe=t=>(e,n)=>async s=>{const r=await t.region(),o=t.region;let i=()=>{};n.__s3RegionRedirect&&(Object.defineProperty(t,"region",{writable:!1,value:async()=>n.__s3RegionRedirect}),i=()=>Object.defineProperty(t,"region",{writable:!0,value:o}));try{const a=await e(s);if(n.__s3RegionRedirect){i();const l=await t.region();if(r!==l)throw new Error("Region was not restored following S3 region redirect.")}return a}catch(a){throw i(),a}},Poe={tags:["REGION_REDIRECT","S3"],name:"regionRedirectEndpointMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};function _oe(t){return(e,n)=>async s=>{var r,o,i;try{return await e(s)}catch(a){if(t.followRegionRedirects&&(((r=a==null?void 0:a.$metadata)==null?void 0:r.httpStatusCode)===301||((o=a==null?void 0:a.$metadata)==null?void 0:o.httpStatusCode)===400&&(a==null?void 0:a.name)==="IllegalLocationConstraintException")){try{const l=a.$response.headers["x-amz-bucket-region"];(i=n.logger)==null||i.debug(`Redirecting from ${await t.region()} to ${l}`),n.__s3RegionRedirect=l}catch(l){throw new Error("Region redirect failed: "+l)}return e(s)}throw a}}}const Moe={step:"initialize",tags:["REGION_REDIRECT","S3"],name:"regionRedirectMiddleware",override:!0},Loe=t=>({applyToStack:e=>{e.add(_oe(t),Moe),e.addRelativeTo(Foe(t),Poe)}}),by=class by{constructor(e={}){at(this,"data");at(this,"lastPurgeTime",Date.now());this.data=e}get(e){const n=this.data[e];if(n)return n}set(e,n){return this.data[e]=n,n}delete(e){delete this.data[e]}async purgeExpired(){const e=Date.now();if(!(this.lastPurgeTime+by.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS>e))for(const n in this.data){const s=this.data[n];if(!s.isRefreshing){const r=await s.identity;r.expiration&&r.expiration.getTime()<e&&delete this.data[n]}}}};at(by,"EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS",3e4);let $C=by;class n1{constructor(e,n=!1,s=Date.now()){at(this,"_identity");at(this,"isRefreshing");at(this,"accessed");this._identity=e,this.isRefreshing=n,this.accessed=s}get identity(){return this.accessed=Date.now(),this._identity}}const wy=class wy{constructor(e,n=new $C){at(this,"createSessionFn");at(this,"cache");this.createSessionFn=e,this.cache=n}async getS3ExpressIdentity(e,n){const s=n.Bucket,{cache:r}=this,o=r.get(s);return o?o.identity.then(i=>{var c,u;return(((c=i.expiration)==null?void 0:c.getTime())??0)<Date.now()?r.set(s,new n1(this.getIdentity(s))).identity:((((u=i.expiration)==null?void 0:u.getTime())??0)<Date.now()+wy.REFRESH_WINDOW_MS&&!o.isRefreshing&&(o.isRefreshing=!0,this.getIdentity(s).then(d=>{r.set(s,new n1(Promise.resolve(d)))})),i)}):r.set(s,new n1(this.getIdentity(s))).identity}async getIdentity(e){var r,o;await this.cache.purgeExpired().catch(i=>{console.warn(`Error while clearing expired entries in S3ExpressIdentityCache: 
`+i)});const n=await this.createSessionFn(e);if(!((r=n.Credentials)!=null&&r.AccessKeyId)||!((o=n.Credentials)!=null&&o.SecretAccessKey))throw new Error("s3#createSession response credential missing AccessKeyId or SecretAccessKey.");return{accessKeyId:n.Credentials.AccessKeyId,secretAccessKey:n.Credentials.SecretAccessKey,sessionToken:n.Credentials.SessionToken,expiration:n.Credentials.Expiration?new Date(n.Credentials.Expiration):void 0}}};at(wy,"REFRESH_WINDOW_MS",6e4);let IC=wy;var tA;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(tA||(tA={}));const joe="Directory",Boe="S3Express",zoe="sigv4-s3express",TC="X-Amz-S3session-Token",RC=TC.toLowerCase();class Uoe extends SC{async signWithCredentials(e,n,s){const r=nA(n);e.headers[RC]=n.sessionToken;const o=this;return sA(o,r),o.signRequest(e,s??{})}async presignWithCredentials(e,n,s){const r=nA(n);return delete e.headers[RC],e.headers[TC]=n.sessionToken,e.query=e.query??{},e.query[TC]=n.sessionToken,sA(this,r),this.presign(e,s)}}function nA(t){return{accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,expiration:t.expiration}}function sA(t,e){const n=setTimeout(()=>{throw new Error("SignatureV4S3Express credential override was created but not called.")},10),s=t.credentialProvider,r=()=>(clearTimeout(n),t.credentialProvider=s,Promise.resolve(e));t.credentialProvider=r}const Voe=t=>(e,n)=>async s=>{var r,o,i,a,l;if(n.endpointV2){const c=n.endpointV2,u=((i=(o=(r=c.properties)==null?void 0:r.authSchemes)==null?void 0:o[0])==null?void 0:i.name)===zoe;if((((a=c.properties)==null?void 0:a.backend)===Boe||((l=c.properties)==null?void 0:l.bucketType)===joe)&&(Ro(n,"S3_EXPRESS_BUCKET","J"),n.isS3ExpressBucket=!0),u){const h=s.input.Bucket;if(h){const f=await t.s3ExpressIdentityProvider.getS3ExpressIdentity(await t.credentials(),{Bucket:h});n.s3ExpressIdentity=f,vs.isInstance(s.request)&&f.sessionToken&&(s.request.headers[RC]=f.sessionToken)}}}return e(s)},Woe={name:"s3ExpressMiddleware",step:"build",tags:["S3","S3_EXPRESS"],override:!0},Hoe=t=>({applyToStack:e=>{e.add(Voe(t),Woe)}}),Goe=async(t,e,n,s)=>{const r=await s.signWithCredentials(n,t,{});if(r.headers["X-Amz-Security-Token"]||r.headers["x-amz-security-token"])throw new Error("X-Amz-Security-Token must not be set for s3-express requests.");return r},qoe=t=>e=>{throw e},Koe=(t,e)=>{},Xoe=t=>(e,n)=>async s=>{if(!vs.isInstance(s.request))return e(s);const o=Nd(n).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:i={}},identity:a,signer:l}=o;let c;n.s3ExpressIdentity?c=await Goe(n.s3ExpressIdentity,i,s.request,await t.signer()):c=await l.sign(s.request,a,i);const u=await e({...s,request:c}).catch((l.errorHandler||qoe)(i));return(l.successHandler||Koe)(u.response,i),u},Yoe=t=>({applyToStack:e=>{e.addRelativeTo(Xoe(t),m4)}}),Joe=(t,{session:e})=>{const[n,s]=e,{forcePathStyle:r,useAccelerateEndpoint:o,disableMultiregionAccessPoints:i,followRegionRedirects:a,s3ExpressIdentityProvider:l,bucketEndpoint:c}=t;return Object.assign(t,{forcePathStyle:r??!1,useAccelerateEndpoint:o??!1,disableMultiregionAccessPoints:i??!1,followRegionRedirects:a??!1,s3ExpressIdentityProvider:l??new IC(async u=>n().send(new s({Bucket:u}))),bucketEndpoint:c??!1})},Zoe={CopyObjectCommand:!0,UploadPartCopyCommand:!0,CompleteMultipartUploadCommand:!0},Qoe=3e3,eie=t=>(e,n)=>async s=>{const r=await e(s),{response:o}=r;if(!$f.isInstance(o))return r;const{statusCode:i,body:a}=o;if(i<200||i>=300||!(typeof(a==null?void 0:a.stream)=="function"||typeof(a==null?void 0:a.pipe)=="function"||typeof(a==null?void 0:a.tee)=="function"))return r;let c=a,u=a;a&&typeof a=="object"&&!(a instanceof Uint8Array)&&([c,u]=await Tne(a)),o.body=u;const d=await tie(c,{streamCollector:async f=>wne(f,Qoe)});typeof(c==null?void 0:c.destroy)=="function"&&c.destroy();const h=t.utf8Encoder(d.subarray(d.length-16));if(d.length===0&&Zoe[n.commandName]){const f=new Error("S3 aborted request");throw f.name="InternalError",f}return h&&h.endsWith("</Error>")&&(o.statusCode=400),r},tie=(t=new Uint8Array,e)=>t instanceof Uint8Array?Promise.resolve(t):e.streamCollector(t)||Promise.resolve(new Uint8Array),nie={relation:"after",toMiddleware:"deserializerMiddleware",tags:["THROW_200_EXCEPTIONS","S3"],name:"throw200ExceptionsMiddleware",override:!0},sie=t=>({applyToStack:e=>{e.addRelativeTo(eie(t),nie)}}),rie=t=>typeof t=="string"&&t.indexOf("arn:")===0&&t.split(":").length>=6;function oie(t){return(e,n)=>async s=>{var r,o,i,a;if(t.bucketEndpoint){const l=n.endpointV2;if(l){const c=s.input.Bucket;if(typeof c=="string")try{const u=new URL(c);n.endpointV2={...l,url:u}}catch(u){const d=`@aws-sdk/middleware-sdk-s3: bucketEndpoint=true was set but Bucket=${c} could not be parsed as URL.`;throw((o=(r=n.logger)==null?void 0:r.constructor)==null?void 0:o.name)==="NoOpLogger"?console.warn(d):(a=(i=n.logger)==null?void 0:i.warn)==null||a.call(i,d),u}}}return e(s)}}const iie={name:"bucketEndpointMiddleware",override:!0,relation:"after",toMiddleware:"endpointV2Middleware"};function aie({bucketEndpoint:t}){return e=>async n=>{const{input:{Bucket:s}}=n;if(!t&&typeof s=="string"&&!rie(s)&&s.indexOf("/")>=0){const r=new Error(`Bucket name shouldn't contain '/', received '${s}'`);throw r.name="InvalidBucketName",r}return e({...n})}}const lie={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},cie=t=>({applyToStack:e=>{e.add(aie(t),lie),e.addRelativeTo(oie(t),iie)}}),uie=void 0;function die(t){return t===void 0?!0:typeof t=="string"&&t.length<=50}function hie(t){const e=Tu(t.userAgentAppId??uie),{customUserAgent:n}=t;return Object.assign(t,{customUserAgent:typeof n=="string"?[[n]]:n,userAgentAppId:async()=>{var r,o;const s=await e();if(!die(s)){const i=((o=(r=t.logger)==null?void 0:r.constructor)==null?void 0:o.name)==="NoOpLogger"||!t.logger?console:t.logger;typeof s!="string"?i==null||i.warn("userAgentAppId must be a string or undefined."):s.length>50&&(i==null||i.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return s}})}class fie{constructor({size:e,params:n}){this.data=new Map,this.parameters=[],this.capacity=e??50,n&&(this.parameters=n)}get(e,n){const s=this.hash(e);if(s===!1)return n();if(!this.data.has(s)){if(this.data.size>this.capacity+10){const r=this.data.keys();let o=0;for(;;){const{value:i,done:a}=r.next();if(this.data.delete(i),a||++o>10)break}}this.data.set(s,n())}return this.data.get(s)}size(){return this.data.size}hash(e){let n="";const{parameters:s}=this;if(s.length===0)return!1;for(const r of s){const o=String(e[r]??"");if(o.includes("|;"))return!1;n+=o+"|;"}return n}}const pie=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),W4=t=>pie.test(t)||t.startsWith("[")&&t.endsWith("]"),mie=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),y2=(t,e=!1)=>{if(!e)return mie.test(t);const n=t.split(".");for(const s of n)if(!y2(s))return!1;return!0},Lx={},If="endpoints";function tl(t){return typeof t!="object"||t==null?t:"ref"in t?`$${tl(t.ref)}`:"fn"in t?`${t.fn}(${(t.argv||[]).map(tl).join(", ")})`:JSON.stringify(t,null,2)}class Xr extends Error{constructor(e){super(e),this.name="EndpointError"}}const gie=(t,e)=>t===e,xie=t=>{const e=t.split("."),n=[];for(const s of e){const r=s.indexOf("[");if(r!==-1){if(s.indexOf("]")!==s.length-1)throw new Xr(`Path: '${t}' does not end with ']'`);const o=s.slice(r+1,-1);if(Number.isNaN(parseInt(o)))throw new Xr(`Invalid array index: '${o}' in path: '${t}'`);r!==0&&n.push(s.slice(0,r)),n.push(o)}else n.push(s)}return n},H4=(t,e)=>xie(e).reduce((n,s)=>{if(typeof n!="object")throw new Xr(`Index '${s}' in '${e}' not found in '${JSON.stringify(t)}'`);return Array.isArray(n)?n[parseInt(s)]:n[s]},t),yie=t=>t!=null,vie=t=>!t,s1={[Ef.HTTP]:80,[Ef.HTTPS]:443},bie=t=>{const e=(()=>{try{if(t instanceof URL)return t;if(typeof t=="object"&&"hostname"in t){const{hostname:h,port:f,protocol:m="",path:g="",query:y={}}=t,x=new URL(`${m}//${h}${f?`:${f}`:""}${g}`);return x.search=Object.entries(y).map(([v,b])=>`${v}=${b}`).join("&"),x}return new URL(t)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(t)} as a whatwg URL.`),null;const n=e.href,{host:s,hostname:r,pathname:o,protocol:i,search:a}=e;if(a)return null;const l=i.slice(0,-1);if(!Object.values(Ef).includes(l))return null;const c=W4(r),u=n.includes(`${s}:${s1[l]}`)||typeof t=="string"&&t.includes(`${s}:${s1[l]}`),d=`${s}${u?`:${s1[l]}`:""}`;return{scheme:l,authority:d,path:o,normalizedPath:o.endsWith("/")?o:`${o}/`,isIp:c}},wie=(t,e)=>t===e,Cie=(t,e,n,s)=>e>=n||t.length<n?null:s?t.substring(t.length-n,t.length-e):t.substring(e,n),Sie=t=>encodeURIComponent(t).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),kie={booleanEquals:gie,getAttr:H4,isSet:yie,isValidHostLabel:y2,not:vie,parseURL:bie,stringEquals:wie,substring:Cie,uriEncode:Sie},G4=(t,e)=>{const n=[],s={...e.endpointParams,...e.referenceRecord};let r=0;for(;r<t.length;){const o=t.indexOf("{",r);if(o===-1){n.push(t.slice(r));break}n.push(t.slice(r,o));const i=t.indexOf("}",o);if(i===-1){n.push(t.slice(o));break}t[o+1]==="{"&&t[i+1]==="}"&&(n.push(t.slice(o+1,i)),r=i+2);const a=t.substring(o+1,i);if(a.includes("#")){const[l,c]=a.split("#");n.push(H4(s[l],c))}else n.push(s[a]);r=i+1}return n.join("")},Nie=({ref:t},e)=>({...e.endpointParams,...e.referenceRecord})[t],k0=(t,e,n)=>{if(typeof t=="string")return G4(t,n);if(t.fn)return q4(t,n);if(t.ref)return Nie(t,n);throw new Xr(`'${e}': ${String(t)} is not a string, function or reference.`)},q4=({fn:t,argv:e},n)=>{const s=e.map(o=>["boolean","number"].includes(typeof o)?o:k0(o,"arg",n)),r=t.split(".");return r[0]in Lx&&r[1]!=null?Lx[r[0]][r[1]](...s):kie[t](...s)},Eie=({assign:t,...e},n)=>{var r,o;if(t&&t in n.referenceRecord)throw new Xr(`'${t}' is already defined in Reference Record.`);const s=q4(e,n);return(o=(r=n.logger)==null?void 0:r.debug)==null||o.call(r,`${If} evaluateCondition: ${tl(e)} = ${tl(s)}`),{result:s===""?!0:!!s,...t!=null&&{toAssign:{name:t,value:s}}}},v2=(t=[],e)=>{var s,r;const n={};for(const o of t){const{result:i,toAssign:a}=Eie(o,{...e,referenceRecord:{...e.referenceRecord,...n}});if(!i)return{result:i};a&&(n[a.name]=a.value,(r=(s=e.logger)==null?void 0:s.debug)==null||r.call(s,`${If} assign: ${a.name} := ${tl(a.value)}`))}return{result:!0,referenceRecord:n}},$ie=(t,e)=>Object.entries(t).reduce((n,[s,r])=>({...n,[s]:r.map(o=>{const i=k0(o,"Header value entry",e);if(typeof i!="string")throw new Xr(`Header '${s}' value '${i}' is not a string`);return i})}),{}),K4=(t,e)=>{if(Array.isArray(t))return t.map(n=>K4(n,e));switch(typeof t){case"string":return G4(t,e);case"object":if(t===null)throw new Xr(`Unexpected endpoint property: ${t}`);return X4(t,e);case"boolean":return t;default:throw new Xr(`Unexpected endpoint property type: ${typeof t}`)}},X4=(t,e)=>Object.entries(t).reduce((n,[s,r])=>({...n,[s]:K4(r,e)}),{}),Iie=(t,e)=>{const n=k0(t,"Endpoint URL",e);if(typeof n=="string")try{return new URL(n)}catch(s){throw console.error(`Failed to construct URL with ${n}`,s),s}throw new Xr(`Endpoint URL must be a string, got ${typeof n}`)},Tie=(t,e)=>{var u,d;const{conditions:n,endpoint:s}=t,{result:r,referenceRecord:o}=v2(n,e);if(!r)return;const i={...e,referenceRecord:{...e.referenceRecord,...o}},{url:a,properties:l,headers:c}=s;return(d=(u=e.logger)==null?void 0:u.debug)==null||d.call(u,`${If} Resolving endpoint from template: ${tl(s)}`),{...c!=null&&{headers:$ie(c,i)},...l!=null&&{properties:X4(l,i)},url:Iie(a,i)}},Rie=(t,e)=>{const{conditions:n,error:s}=t,{result:r,referenceRecord:o}=v2(n,e);if(r)throw new Xr(k0(s,"Error",{...e,referenceRecord:{...e.referenceRecord,...o}}))},Aie=(t,e)=>{const{conditions:n,rules:s}=t,{result:r,referenceRecord:o}=v2(n,e);if(r)return Y4(s,{...e,referenceRecord:{...e.referenceRecord,...o}})},Y4=(t,e)=>{for(const n of t)if(n.type==="endpoint"){const s=Tie(n,e);if(s)return s}else if(n.type==="error")Rie(n,e);else if(n.type==="tree"){const s=Aie(n,e);if(s)return s}else throw new Xr(`Unknown endpoint rule: ${n}`);throw new Xr("Rules evaluation failed")},Die=(t,e)=>{var c,u,d,h;const{endpointParams:n,logger:s}=e,{parameters:r,rules:o}=t;(u=(c=e.logger)==null?void 0:c.debug)==null||u.call(c,`${If} Initial EndpointParams: ${tl(n)}`);const i=Object.entries(r).filter(([,f])=>f.default!=null).map(([f,m])=>[f,m.default]);if(i.length>0)for(const[f,m]of i)n[f]=n[f]??m;const a=Object.entries(r).filter(([,f])=>f.required).map(([f])=>f);for(const f of a)if(n[f]==null)throw new Xr(`Missing required parameter: '${f}'`);const l=Y4(o,{endpointParams:n,logger:s,referenceRecord:{}});return(h=(d=e.logger)==null?void 0:d.debug)==null||h.call(d,`${If} Resolved endpoint: ${tl(l)}`),l},J4=(t,e=!1)=>{if(e){for(const n of t.split("."))if(!J4(n))return!1;return!0}return!(!y2(t)||t.length<3||t.length>63||t!==t.toLowerCase()||W4(t))},rA=":",Oie="/",Fie=t=>{const e=t.split(rA);if(e.length<6)return null;const[n,s,r,o,i,...a]=e;if(n!=="arn"||s===""||r===""||a.join(rA)==="")return null;const l=a.map(c=>c.split(Oie)).flat();return{partition:s,service:r,region:o,accountId:i,resourceId:l}},Pie=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"AWS ISOE (Europe) global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"AWS ISOF global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"amazonaws.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"EU (Germany)"}}}],_ie={partitions:Pie};let Mie=_ie;const Lie=t=>{const{partitions:e}=Mie;for(const s of e){const{regions:r,outputs:o}=s;for(const[i,a]of Object.entries(r))if(i===t)return{...o,...a}}for(const s of e){const{regionRegex:r,outputs:o}=s;if(new RegExp(r).test(t))return{...o}}const n=e.find(s=>s.id==="aws");if(!n)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...n.outputs}},Z4={isVirtualHostableS3Bucket:J4,parseArn:Fie,partition:Lie};Lx.aws=Z4;const jie=/\d{12}\.ddb/;async function Bie(t,e,n){var o,i,a,l,c,u,d;const s=n.request;if(((o=s==null?void 0:s.headers)==null?void 0:o["smithy-protocol"])==="rpc-v2-cbor"&&Ro(t,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const h=await e.retryStrategy();typeof h.acquireInitialRetryToken=="function"?(a=(i=h.constructor)==null?void 0:i.name)!=null&&a.includes("Adaptive")?Ro(t,"RETRY_MODE_ADAPTIVE","F"):Ro(t,"RETRY_MODE_STANDARD","E"):Ro(t,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const h=t.endpointV2;switch(String((l=h==null?void 0:h.url)==null?void 0:l.hostname).match(jie)&&Ro(t,"ACCOUNT_ID_ENDPOINT","O"),await((c=e.accountIdEndpointMode)==null?void 0:c.call(e))){case"disabled":Ro(t,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Ro(t,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Ro(t,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const r=(d=(u=t.__smithy_context)==null?void 0:u.selectedHttpAuthScheme)==null?void 0:d.identity;if(r!=null&&r.$source){const h=r;h.accountId&&Ro(t,"RESOLVED_ACCOUNT_ID","T");for(const[f,m]of Object.entries(h.$source??{}))Ro(t,f,m)}}const oA="user-agent",r1="x-amz-user-agent",iA=" ",o1="/",zie=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,Uie=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,aA="-",Vie=1024;function Wie(t){let e="";for(const n in t){const s=t[n];if(e.length+s.length+1<=Vie){e.length?e+=","+s:e+=s;continue}break}return e}const Hie=t=>(e,n)=>async s=>{var f,m,g,y;const{request:r}=s;if(!vs.isInstance(r))return e(s);const{headers:o}=r,i=((f=n==null?void 0:n.userAgent)==null?void 0:f.map(sg))||[],a=(await t.defaultUserAgentProvider()).map(sg);await Bie(n,t,s);const l=n;a.push(`m/${Wie(Object.assign({},(m=n.__smithy_context)==null?void 0:m.features,(g=l.__aws_sdk_context)==null?void 0:g.features))}`);const c=((y=t==null?void 0:t.customUserAgent)==null?void 0:y.map(sg))||[],u=await t.userAgentAppId();u&&a.push(sg([`app/${u}`]));const d=[].concat([...a,...i,...c]).join(iA),h=[...a.filter(x=>x.startsWith("aws-sdk-")),...c].join(iA);return t.runtime!=="browser"?(h&&(o[r1]=o[r1]?`${o[oA]} ${h}`:h),o[oA]=d):o[r1]=d,e({...s,request:r})},sg=t=>{var i;const e=t[0].split(o1).map(a=>a.replace(zie,aA)).join(o1),n=(i=t[1])==null?void 0:i.replace(Uie,aA),s=e.indexOf(o1),r=e.substring(0,s);let o=e.substring(s+1);return r==="api"&&(o=o.toLowerCase()),[r,o,n].filter(a=>a&&a.length>0).reduce((a,l,c)=>{switch(c){case 0:return l;case 1:return`${a}/${l}`;default:return`${a}#${l}`}},"")},Gie={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},qie=t=>({applyToStack:e=>{e.add(Hie(t),Gie)}}),Kie=!1,Xie=!1,Q4=t=>typeof t=="string"&&(t.startsWith("fips-")||t.endsWith("-fips")),lA=t=>Q4(t)?["fips-aws-global","aws-fips"].includes(t)?"us-east-1":t.replace(/fips-(dkr-|prod-)?|-fips/,""):t,Yie=t=>{const{region:e,useFipsEndpoint:n}=t;if(!e)throw new Error("Region is missing");return Object.assign(t,{region:async()=>{if(typeof e=="string")return lA(e);const s=await e();return lA(s)},useFipsEndpoint:async()=>{const s=typeof e=="string"?e:await e();return Q4(s)?!0:typeof n!="function"?Promise.resolve(!!n):n()}})},Jie=t=>Object.assign(t,{eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),cA="content-length";function Zie(t){return e=>async n=>{const s=n.request;if(vs.isInstance(s)){const{body:r,headers:o}=s;if(r&&Object.keys(o).map(i=>i.toLowerCase()).indexOf(cA)===-1)try{const i=t(r);s.headers={...s.headers,[cA]:String(i)}}catch{}}return e({...n,request:s})}}const Qie={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},eae=t=>({applyToStack:e=>{e.add(Zie(t.bodyLengthChecker),Qie)}}),tae=async t=>{const e=(t==null?void 0:t.Bucket)||"";if(typeof t.Bucket=="string"&&(t.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),iae(e)){if(t.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!oae(e)||e.indexOf(".")!==-1&&!String(t.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(t.ForcePathStyle=!0);return t.DisableMultiRegionAccessPoints&&(t.disableMultiRegionAccessPoints=!0,t.DisableMRAP=!0),t},nae=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,sae=/(\d+\.){3}\d+/,rae=/\.\./,oae=t=>nae.test(t)&&!sae.test(t)&&!rae.test(t),iae=t=>{const[e,n,s,,,r]=t.split(":"),o=e==="arn"&&t.split(":").length>=6,i=!!(o&&n&&s&&r);if(o&&!i)throw new Error(`Invalid ARN: ${t} was an invalid ARN.`);return i},aae=(t,e,n)=>{const s=async()=>{const r=n[t]??n[e];return typeof r=="function"?r():r};return t==="credentialScope"||e==="CredentialScope"?async()=>{const r=typeof n.credentials=="function"?await n.credentials():n.credentials;return(r==null?void 0:r.credentialScope)??(r==null?void 0:r.CredentialScope)}:t==="accountId"||e==="AccountId"?async()=>{const r=typeof n.credentials=="function"?await n.credentials():n.credentials;return(r==null?void 0:r.accountId)??(r==null?void 0:r.AccountId)}:t==="endpoint"||e==="endpoint"?async()=>{const r=await s();if(r&&typeof r=="object"){if("url"in r)return r.url.href;if("hostname"in r){const{protocol:o,hostname:i,port:a,path:l}=r;return`${o}//${i}${a?":"+a:""}${l}`}}return r}:s},ej=async t=>{};function lae(t){const e={};if(t=t.replace(/^\?/,""),t)for(const n of t.split("&")){let[s,r=null]=n.split("=");s=decodeURIComponent(s),r&&(r=decodeURIComponent(r)),s in e?Array.isArray(e[s])?e[s].push(r):e[s]=[e[s],r]:e[s]=r}return e}const jx=t=>{if(typeof t=="string")return jx(new URL(t));const{hostname:e,pathname:n,port:s,protocol:r,search:o}=t;let i;return o&&(i=lae(o)),{hostname:e,port:s?parseInt(s):void 0,protocol:r,path:n,query:i}},tj=t=>typeof t=="object"?"url"in t?jx(t.url):t:jx(t),cae=async(t,e,n,s)=>{if(!n.endpoint){let i;n.serviceConfiguredEndpoint?i=await n.serviceConfiguredEndpoint():i=await ej(n.serviceId),i&&(n.endpoint=()=>Promise.resolve(tj(i)))}const r=await nj(t,e,n);if(typeof n.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return n.endpointProvider(r,s)},nj=async(t,e,n)=>{var o;const s={},r=((o=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:o.call(e))||{};for(const[i,a]of Object.entries(r))switch(a.type){case"staticContextParams":s[i]=a.value;break;case"contextParams":s[i]=t[a.name];break;case"clientContextParams":case"builtInParams":s[i]=await aae(a.name,i,n)();break;case"operationContextParams":s[i]=a.get(t);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(a))}return Object.keys(r).length===0&&Object.assign(s,n),String(n.serviceId).toLowerCase()==="s3"&&await tae(s),s},uae=({config:t,instructions:e})=>(n,s)=>async r=>{var a,l,c;t.endpoint&&Fne(s,"ENDPOINT_OVERRIDE","N");const o=await cae(r.input,{getEndpointParameterInstructions(){return e}},{...t},s);s.endpointV2=o,s.authSchemes=(a=o.properties)==null?void 0:a.authSchemes;const i=(l=s.authSchemes)==null?void 0:l[0];if(i){s.signing_region=i.signingRegion,s.signing_service=i.signingName;const u=Nd(s),d=(c=u==null?void 0:u.selectedHttpAuthScheme)==null?void 0:c.httpAuthOption;d&&(d.signingProperties=Object.assign(d.signingProperties||{},{signing_region:i.signingRegion,signingRegion:i.signingRegion,signing_service:i.signingName,signingName:i.signingName,signingRegionSet:i.signingRegionSet},i.properties))}return n({...r})},dae={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:c2.name},hae=(t,e)=>({applyToStack:n=>{n.addRelativeTo(uae({config:t,instructions:e}),dae)}}),fae=t=>{const e=t.tls??!0,{endpoint:n,useDualstackEndpoint:s,useFipsEndpoint:r}=t,o=n!=null?async()=>tj(await xi(n)()):void 0,a=Object.assign(t,{endpoint:o,tls:e,isCustomEndpoint:!!n,useDualstackEndpoint:xi(s??!1),useFipsEndpoint:xi(r??!1)});let l;return a.serviceConfiguredEndpoint=async()=>(t.serviceId&&!l&&(l=ej(t.serviceId)),l),a};var Ju;(function(t){t.STANDARD="standard",t.ADAPTIVE="adaptive"})(Ju||(Ju={}));const Bx=3,pae=Ju.STANDARD,mae=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],gae=["TimeoutError","RequestTimeout","RequestTimeoutException"],xae=[500,502,503,504],yae=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],vae=t=>{var e;return(e=t.$metadata)==null?void 0:e.clockSkewCorrected},sj=t=>{var e,n;return((e=t.$metadata)==null?void 0:e.httpStatusCode)===429||mae.includes(t.name)||((n=t.$retryable)==null?void 0:n.throttling)==!0},b2=(t,e=0)=>{var n;return vae(t)||gae.includes(t.name)||yae.includes((t==null?void 0:t.code)||"")||xae.includes(((n=t.$metadata)==null?void 0:n.httpStatusCode)||0)||t.cause!==void 0&&e<=10&&b2(t.cause,e+1)},bae=t=>{var e;if(((e=t.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const n=t.$metadata.httpStatusCode;return 500<=n&&n<=599&&!b2(t)}return!1};class N0{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const n=this.getCurrentTimeInSeconds();this.lastThrottleTime=n,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const n=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(s=>N0.setTimeoutFn(s,n))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const n=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+n),this.lastTimestamp=e}updateClientSendingRate(e){let n;if(this.updateMeasuredRate(),sj(e)){const r=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=r,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),n=this.cubicThrottle(r),this.enableTokenBucket()}else this.calculateTimeWindow(),n=this.cubicSuccess(this.getCurrentTimeInSeconds());const s=Math.min(n,2*this.measuredTxRate);this.updateTokenBucketRate(s)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),n=Math.floor(e*2)/2;if(this.requestCount++,n>this.lastTxRateBucket){const s=this.requestCount/(n-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(s*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=n}}getPrecise(e){return parseFloat(e.toFixed(8))}}N0.setTimeoutFn=setTimeout;const AC=100,rj=20*1e3,wae=500,uA=500,Cae=5,Sae=10,kae=1,Nae="amz-sdk-invocation-id",Eae="amz-sdk-request",$ae=()=>{let t=AC;return{computeNextBackoffDelay:s=>Math.floor(Math.min(rj,Math.random()*2**s*t)),setDelayBase:s=>{t=s}}},dA=({retryDelay:t,retryCount:e,retryCost:n})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(rj,t),getRetryCost:()=>n});class oj{constructor(e){this.maxAttempts=e,this.mode=Ju.STANDARD,this.capacity=uA,this.retryBackoffStrategy=$ae(),this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return dA({retryDelay:AC,retryCount:0})}async refreshRetryTokenForRetry(e,n){const s=await this.getMaxAttempts();if(this.shouldRetry(e,n,s)){const r=n.errorType;this.retryBackoffStrategy.setDelayBase(r==="THROTTLING"?wae:AC);const o=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),i=n.retryAfterHint?Math.max(n.retryAfterHint.getTime()-Date.now()||0,o):o,a=this.getCapacityCost(r);return this.capacity-=a,dA({retryDelay:i,retryCount:e.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(uA,this.capacity+(e.getRetryCost()??kae))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Bx}`),Bx}}shouldRetry(e,n,s){return e.getRetryCount()+1<s&&this.capacity>=this.getCapacityCost(n.errorType)&&this.isRetryableError(n.errorType)}getCapacityCost(e){return e==="TRANSIENT"?Sae:Cae}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class Iae{constructor(e,n){this.maxAttemptsProvider=e,this.mode=Ju.ADAPTIVE;const{rateLimiter:s}=n??{};this.rateLimiter=s??new N0,this.standardRetryStrategy=new oj(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,n){return this.rateLimiter.updateClientSendingRate(n),this.standardRetryStrategy.refreshRetryTokenForRetry(e,n)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}let rg;const Tae=new Uint8Array(16);function Rae(){if(!rg&&(rg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!rg))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rg(Tae)}const fs=[];for(let t=0;t<256;++t)fs.push((t+256).toString(16).slice(1));function Aae(t,e=0){return fs[t[e+0]]+fs[t[e+1]]+fs[t[e+2]]+fs[t[e+3]]+"-"+fs[t[e+4]]+fs[t[e+5]]+"-"+fs[t[e+6]]+fs[t[e+7]]+"-"+fs[t[e+8]]+fs[t[e+9]]+"-"+fs[t[e+10]]+fs[t[e+11]]+fs[t[e+12]]+fs[t[e+13]]+fs[t[e+14]]+fs[t[e+15]]}const Dae=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),hA={randomUUID:Dae};function Oae(t,e,n){if(hA.randomUUID&&!t)return hA.randomUUID();t=t||{};const s=t.random||(t.rng||Rae)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Aae(s)}const Fae=t=>t instanceof Error?t:t instanceof Object?Object.assign(new Error,t):typeof t=="string"?new Error(t):new Error(`AWS SDK error wrapper for ${t}`),Pae=t=>{const{retryStrategy:e,retryMode:n,maxAttempts:s}=t,r=xi(s??Bx);return Object.assign(t,{maxAttempts:r,retryStrategy:async()=>e||(await xi(n)()===Ju.ADAPTIVE?new Iae(r):new oj(r))})},_ae=t=>(t==null?void 0:t.body)instanceof ReadableStream,Mae=t=>(e,n)=>async s=>{var i;let r=await t.retryStrategy();const o=await t.maxAttempts();if(Lae(r)){r=r;let a=await r.acquireInitialRetryToken(n.partition_id),l=new Error,c=0,u=0;const{request:d}=s,h=vs.isInstance(d);for(h&&(d.headers[Nae]=Oae());;)try{h&&(d.headers[Eae]=`attempt=${c+1}; max=${o}`);const{response:f,output:m}=await e(s);return r.recordSuccess(a),m.$metadata.attempts=c+1,m.$metadata.totalRetryDelay=u,{response:f,output:m}}catch(f){const m=jae(f);if(l=Fae(f),h&&_ae(d))throw(i=n.logger instanceof F4?console:n.logger)==null||i.warn("An error was encountered in a non-retryable streaming request."),l;try{a=await r.refreshRetryTokenForRetry(a,m)}catch{throw l.$metadata||(l.$metadata={}),l.$metadata.attempts=c+1,l.$metadata.totalRetryDelay=u,l}c=a.getRetryCount();const g=a.getRetryDelay();u+=g,await new Promise(y=>setTimeout(y,g))}}else return r=r,r!=null&&r.mode&&(n.userAgent=[...n.userAgent||[],["cfg/retry-mode",r.mode]]),r.retry(e,s)},Lae=t=>typeof t.acquireInitialRetryToken<"u"&&typeof t.refreshRetryTokenForRetry<"u"&&typeof t.recordSuccess<"u",jae=t=>{const e={error:t,errorType:Bae(t)},n=Vae(t.$response);return n&&(e.retryAfterHint=n),e},Bae=t=>sj(t)?"THROTTLING":b2(t)?"TRANSIENT":bae(t)?"SERVER_ERROR":"CLIENT_ERROR",zae={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},Uae=t=>({applyToStack:e=>{e.add(Mae(t),zae)}}),Vae=t=>{if(!$f.isInstance(t))return;const e=Object.keys(t.headers).find(o=>o.toLowerCase()==="retry-after");if(!e)return;const n=t.headers[e],s=Number(n);return Number.isNaN(s)?new Date(n):new Date(s*1e3)},Wae={CrtSignerV4:null};class Hae{constructor(e){at(this,"sigv4aSigner");at(this,"sigv4Signer");at(this,"signerOptions");this.sigv4Signer=new Uoe(e),this.signerOptions=e}async sign(e,n={}){if(n.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().sign(e,n)}return this.sigv4Signer.sign(e,n)}async signWithCredentials(e,n,s={}){if(s.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().signWithCredentials(e,n,s)}return this.sigv4Signer.signWithCredentials(e,n,s)}async presign(e,n={}){if(n.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().presign(e,n)}return this.sigv4Signer.presign(e,n)}async presignWithCredentials(e,n,s={}){if(s.signingRegion==="*")throw new Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(e,n,s)}getSigv4aSigner(){if(!this.sigv4aSigner){let e=null;try{if(e=Wae.CrtSignerV4,typeof e!="function")throw new Error}catch(n){throw n.message=`${n.message}
Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. 
You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. 
For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`,n}this.sigv4aSigner=new e({...this.signerOptions,signingAlgorithm:1})}return this.sigv4aSigner}}const w2="required",F="type",le="rules",H="conditions",te="fn",ne="argv",Me="ref",lt="assign",Re="url",Ae="properties",Vl="backend",zs="authSchemes",os="disableDoubleEncoding",is="signingName",sr="signingRegion",De="headers",C2="signingRegionSet",Gae=6,qae=!1,Qo=!0,Lr="isSet",Rn="booleanEquals",Ie="error",zx="aws.partition",Nt="stringEquals",un="getAttr",In="name",Wt="substring",fA="bucketSuffix",S2="parseURL",me="endpoint",ce="tree",Ux="aws.isVirtualHostableS3Bucket",Vx="{url#scheme}://{Bucket}.{url#authority}{url#path}",yi="not",pA="accessPointSuffix",Wg="{url#scheme}://{url#authority}{url#path}",ij="hardwareType",aj="regionPrefix",mA="bucketAliasSuffix",DC="outpostId",Oc="isValidHostLabel",k2="sigv4a",Tf="s3-outposts",Zu="s3",lj="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",cj="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",gA="https://{Bucket}.s3.{partitionResult#dnsSuffix}",uj="aws.parseArn",dj="bucketArn",hj="arnType",Wx="",N2="s3-object-lambda",fj="accesspoint",E2="accessPointName",xA="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",yA="mrapPartition",vA="outpostType",bA="arnPrefix",pj="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",wA="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",CA="https://s3.{partitionResult#dnsSuffix}",Yc={[w2]:!1,[F]:"String"},Jc={[w2]:!0,default:!1,[F]:"Boolean"},ih={[w2]:!1,[F]:"Boolean"},oo={[te]:Rn,[ne]:[{[Me]:"Accelerate"},!0]},Gt={[te]:Rn,[ne]:[{[Me]:"UseFIPS"},!0]},Bt={[te]:Rn,[ne]:[{[Me]:"UseDualStack"},!0]},kn={[te]:Lr,[ne]:[{[Me]:"Endpoint"}]},mj={[te]:zx,[ne]:[{[Me]:"Region"}],[lt]:"partitionResult"},SA={[te]:Nt,[ne]:[{[te]:un,[ne]:[{[Me]:"partitionResult"},In]},"aws-cn"]},Wh={[te]:Lr,[ne]:[{[Me]:"Bucket"}]},wt={[Me]:"Bucket"},kA={[H]:[Bt],[Ie]:"S3Express does not support Dual-stack.",[F]:Ie},NA={[H]:[oo],[Ie]:"S3Express does not support S3 Accelerate.",[F]:Ie},EA={[H]:[kn,{[te]:S2,[ne]:[{[Me]:"Endpoint"}],[lt]:"url"}],[le]:[{[H]:[{[te]:Lr,[ne]:[{[Me]:"DisableS3ExpressSessionAuth"}]},{[te]:Rn,[ne]:[{[Me]:"DisableS3ExpressSessionAuth"},!0]}],[le]:[{[H]:[{[te]:Rn,[ne]:[{[te]:un,[ne]:[{[Me]:"url"},"isIp"]},!0]}],[le]:[{[H]:[{[te]:"uriEncode",[ne]:[wt],[lt]:"uri_encoded_bucket"}],[le]:[{[me]:{[Re]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[Ae]:{[Vl]:"S3Express",[zs]:[{[os]:!0,[In]:"sigv4",[is]:"s3express",[sr]:"{Region}"}]},[De]:{}},[F]:me}],[F]:ce}],[F]:ce},{[H]:[{[te]:Ux,[ne]:[wt,!1]}],[le]:[{[me]:{[Re]:Vx,[Ae]:{[Vl]:"S3Express",[zs]:[{[os]:!0,[In]:"sigv4",[is]:"s3express",[sr]:"{Region}"}]},[De]:{}},[F]:me}],[F]:ce},{[Ie]:"S3Express bucket name is not a valid virtual hostable name.",[F]:Ie}],[F]:ce},{[H]:[{[te]:Rn,[ne]:[{[te]:un,[ne]:[{[Me]:"url"},"isIp"]},!0]}],[le]:[{[H]:[{[te]:"uriEncode",[ne]:[wt],[lt]:"uri_encoded_bucket"}],[le]:[{[me]:{[Re]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[Ae]:{[Vl]:"S3Express",[zs]:[{[os]:!0,[In]:"sigv4-s3express",[is]:"s3express",[sr]:"{Region}"}]},[De]:{}},[F]:me}],[F]:ce}],[F]:ce},{[H]:[{[te]:Ux,[ne]:[wt,!1]}],[le]:[{[me]:{[Re]:Vx,[Ae]:{[Vl]:"S3Express",[zs]:[{[os]:!0,[In]:"sigv4-s3express",[is]:"s3express",[sr]:"{Region}"}]},[De]:{}},[F]:me}],[F]:ce},{[Ie]:"S3Express bucket name is not a valid virtual hostable name.",[F]:Ie}],[F]:ce},Xs={[te]:S2,[ne]:[{[Me]:"Endpoint"}],[lt]:"url"},i1={[te]:Rn,[ne]:[{[te]:un,[ne]:[{[Me]:"url"},"isIp"]},!0]},gj={[Me]:"url"},xj={[te]:"uriEncode",[ne]:[wt],[lt]:"uri_encoded_bucket"},Ol={[Vl]:"S3Express",[zs]:[{[os]:!0,[In]:"sigv4",[is]:"s3express",[sr]:"{Region}"}]},Qe={},yj={[te]:Ux,[ne]:[wt,!1]},$A={[Ie]:"S3Express bucket name is not a valid virtual hostable name.",[F]:Ie},IA={[te]:Lr,[ne]:[{[Me]:"UseS3ExpressControlEndpoint"}]},TA={[te]:Rn,[ne]:[{[Me]:"UseS3ExpressControlEndpoint"},!0]},et={[te]:yi,[ne]:[kn]},og={[Ie]:"Unrecognized S3Express bucket name format.",[F]:Ie},RA={[te]:yi,[ne]:[Wh]},AA={[Me]:ij},DA={[H]:[et],[Ie]:"Expected a endpoint to be specified but no endpoint was found",[F]:Ie},ig={[zs]:[{[os]:!0,[In]:k2,[is]:Tf,[C2]:["*"]},{[os]:!0,[In]:"sigv4",[is]:Tf,[sr]:"{Region}"}]},a1={[te]:Rn,[ne]:[{[Me]:"ForcePathStyle"},!1]},Kae={[Me]:"ForcePathStyle"},Dn={[te]:Rn,[ne]:[{[Me]:"Accelerate"},!1]},Wn={[te]:Nt,[ne]:[{[Me]:"Region"},"aws-global"]},es={[zs]:[{[os]:!0,[In]:"sigv4",[is]:Zu,[sr]:"us-east-1"}]},vt={[te]:yi,[ne]:[Wn]},ts={[te]:Rn,[ne]:[{[Me]:"UseGlobalEndpoint"},!0]},OA={[Re]:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[Ae]:{[zs]:[{[os]:!0,[In]:"sigv4",[is]:Zu,[sr]:"{Region}"}]},[De]:{}},Ln={[zs]:[{[os]:!0,[In]:"sigv4",[is]:Zu,[sr]:"{Region}"}]},ns={[te]:Rn,[ne]:[{[Me]:"UseGlobalEndpoint"},!1]},xt={[te]:Rn,[ne]:[{[Me]:"UseDualStack"},!1]},FA={[Re]:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},dt={[te]:Rn,[ne]:[{[Me]:"UseFIPS"},!1]},PA={[Re]:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},_A={[Re]:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},l1={[te]:Rn,[ne]:[{[te]:un,[ne]:[gj,"isIp"]},!1]},c1={[Re]:lj,[Ae]:Ln,[De]:{}},OC={[Re]:Vx,[Ae]:Ln,[De]:{}},MA={[me]:OC,[F]:me},u1={[Re]:cj,[Ae]:Ln,[De]:{}},LA={[Re]:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},ag={[Ie]:"Invalid region: region was not a valid DNS name.",[F]:Ie},vr={[Me]:dj},vj={[Me]:hj},d1={[te]:un,[ne]:[vr,"service"]},$2={[Me]:E2},jA={[H]:[Bt],[Ie]:"S3 Object Lambda does not support Dual-stack",[F]:Ie},BA={[H]:[oo],[Ie]:"S3 Object Lambda does not support S3 Accelerate",[F]:Ie},zA={[H]:[{[te]:Lr,[ne]:[{[Me]:"DisableAccessPoints"}]},{[te]:Rn,[ne]:[{[Me]:"DisableAccessPoints"},!0]}],[Ie]:"Access points are not supported for this operation",[F]:Ie},h1={[H]:[{[te]:Lr,[ne]:[{[Me]:"UseArnRegion"}]},{[te]:Rn,[ne]:[{[Me]:"UseArnRegion"},!1]},{[te]:yi,[ne]:[{[te]:Nt,[ne]:[{[te]:un,[ne]:[vr,"region"]},"{Region}"]}]}],[Ie]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[F]:Ie},bj={[te]:un,[ne]:[{[Me]:"bucketPartition"},In]},wj={[te]:un,[ne]:[vr,"accountId"]},f1={[zs]:[{[os]:!0,[In]:"sigv4",[is]:N2,[sr]:"{bucketArn#region}"}]},UA={[Ie]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[F]:Ie},p1={[Ie]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[F]:Ie},m1={[Ie]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[F]:Ie},g1={[Ie]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[F]:Ie},VA={[Ie]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[F]:Ie},WA={[Ie]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[F]:Ie},ah={[zs]:[{[os]:!0,[In]:"sigv4",[is]:Zu,[sr]:"{bucketArn#region}"}]},HA={[zs]:[{[os]:!0,[In]:k2,[is]:Tf,[C2]:["*"]},{[os]:!0,[In]:"sigv4",[is]:Tf,[sr]:"{bucketArn#region}"}]},GA={[te]:uj,[ne]:[wt]},qA={[Re]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:Ln,[De]:{}},KA={[Re]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:Ln,[De]:{}},XA={[Re]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:Ln,[De]:{}},x1={[Re]:pj,[Ae]:Ln,[De]:{}},YA={[Re]:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:Ln,[De]:{}},JA={[Me]:"UseObjectLambdaEndpoint"},y1={[zs]:[{[os]:!0,[In]:"sigv4",[is]:N2,[sr]:"{Region}"}]},ZA={[Re]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},QA={[Re]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},eD={[Re]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},v1={[Re]:Wg,[Ae]:Ln,[De]:{}},tD={[Re]:"https://s3.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ln,[De]:{}},b1=[{[Me]:"Region"}],Xae=[{[Me]:"Endpoint"}],Yae=[wt],nD=[Bt],w1=[oo],Zc=[kn,Xs],sD=[{[te]:Lr,[ne]:[{[Me]:"DisableS3ExpressSessionAuth"}]},{[te]:Rn,[ne]:[{[Me]:"DisableS3ExpressSessionAuth"},!0]}],Jae=[xj],rD=[yj],no=[mj],Qc=[Gt],oD=[{[te]:Wt,[ne]:[wt,6,14,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,14,16,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],ei=[{[H]:[Gt],[me]:{[Re]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ol,[De]:{}},[F]:me},{[me]:{[Re]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ol,[De]:{}},[F]:me}],iD=[{[te]:Wt,[ne]:[wt,6,15,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,15,17,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],aD=[{[te]:Wt,[ne]:[wt,6,19,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,19,21,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],lD=[{[te]:Wt,[ne]:[wt,6,20,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,20,22,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],cD=[{[te]:Wt,[ne]:[wt,6,26,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,26,28,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],ti=[{[H]:[Gt],[me]:{[Re]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[Ae]:{[Vl]:"S3Express",[zs]:[{[os]:!0,[In]:"sigv4-s3express",[is]:"s3express",[sr]:"{Region}"}]},[De]:{}},[F]:me},{[me]:{[Re]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[Ae]:{[Vl]:"S3Express",[zs]:[{[os]:!0,[In]:"sigv4-s3express",[is]:"s3express",[sr]:"{Region}"}]},[De]:{}},[F]:me}],uD=[wt,0,7,!0],dD=[{[te]:Wt,[ne]:[wt,7,15,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,15,17,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],hD=[{[te]:Wt,[ne]:[wt,7,16,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,16,18,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],fD=[{[te]:Wt,[ne]:[wt,7,20,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,20,22,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],pD=[{[te]:Wt,[ne]:[wt,7,21,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,21,23,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],mD=[{[te]:Wt,[ne]:[wt,7,27,!0],[lt]:"s3expressAvailabilityZoneId"},{[te]:Wt,[ne]:[wt,27,29,!0],[lt]:"s3expressAvailabilityZoneDelim"},{[te]:Nt,[ne]:[{[Me]:"s3expressAvailabilityZoneDelim"},"--"]}],Zae=[Wh],gD=[{[te]:Oc,[ne]:[{[Me]:DC},!1]}],xD=[{[te]:Nt,[ne]:[{[Me]:aj},"beta"]}],Qae=["*"],yD=[{[te]:Oc,[ne]:[{[Me]:"Region"},!1]}],ma=[{[te]:Nt,[ne]:[{[Me]:"Region"},"us-east-1"]}],C1=[{[te]:Nt,[ne]:[vj,fj]}],vD=[{[te]:un,[ne]:[vr,"resourceId[1]"],[lt]:E2},{[te]:yi,[ne]:[{[te]:Nt,[ne]:[$2,Wx]}]}],ele=[vr,"resourceId[1]"],S1=[{[te]:yi,[ne]:[{[te]:Nt,[ne]:[{[te]:un,[ne]:[vr,"region"]},Wx]}]}],bD=[{[te]:yi,[ne]:[{[te]:Lr,[ne]:[{[te]:un,[ne]:[vr,"resourceId[2]"]}]}]}],tle=[vr,"resourceId[2]"],k1=[{[te]:zx,[ne]:[{[te]:un,[ne]:[vr,"region"]}],[lt]:"bucketPartition"}],wD=[{[te]:Nt,[ne]:[bj,{[te]:un,[ne]:[{[Me]:"partitionResult"},In]}]}],N1=[{[te]:Oc,[ne]:[{[te]:un,[ne]:[vr,"region"]},!0]}],E1=[{[te]:Oc,[ne]:[wj,!1]}],CD=[{[te]:Oc,[ne]:[$2,!1]}],SD=[{[te]:Oc,[ne]:[{[Me]:"Region"},!0]}],nle={parameters:{Bucket:Yc,Region:Yc,UseFIPS:Jc,UseDualStack:Jc,Endpoint:Yc,ForcePathStyle:Jc,Accelerate:Jc,UseGlobalEndpoint:Jc,UseObjectLambdaEndpoint:ih,Key:Yc,Prefix:Yc,CopySource:Yc,DisableAccessPoints:ih,DisableMultiRegionAccessPoints:Jc,UseArnRegion:ih,UseS3ExpressControlEndpoint:ih,DisableS3ExpressSessionAuth:ih},[le]:[{[H]:[{[te]:Lr,[ne]:b1}],[le]:[{[H]:[oo,Gt],error:"Accelerate cannot be used with FIPS",[F]:Ie},{[H]:[Bt,kn],error:"Cannot set dual-stack in combination with a custom endpoint.",[F]:Ie},{[H]:[kn,Gt],error:"A custom endpoint cannot be combined with FIPS",[F]:Ie},{[H]:[kn,oo],error:"A custom endpoint cannot be combined with S3 Accelerate",[F]:Ie},{[H]:[Gt,mj,SA],error:"Partition does not support FIPS",[F]:Ie},{[H]:[Wh,{[te]:Wt,[ne]:[wt,0,Gae,Qo],[lt]:fA},{[te]:Nt,[ne]:[{[Me]:fA},"--x-s3"]}],[le]:[kA,NA,EA,{[H]:[IA,TA],[le]:[{[H]:no,[le]:[{[H]:[xj,et],[le]:[{[H]:Qc,endpoint:{[Re]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:Ol,[De]:Qe},[F]:me},{endpoint:{[Re]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:Ol,[De]:Qe},[F]:me}],[F]:ce}],[F]:ce}],[F]:ce},{[H]:rD,[le]:[{[H]:no,[le]:[{[H]:sD,[le]:[{[H]:oD,[le]:ei,[F]:ce},{[H]:iD,[le]:ei,[F]:ce},{[H]:aD,[le]:ei,[F]:ce},{[H]:lD,[le]:ei,[F]:ce},{[H]:cD,[le]:ei,[F]:ce},og],[F]:ce},{[H]:oD,[le]:ti,[F]:ce},{[H]:iD,[le]:ti,[F]:ce},{[H]:aD,[le]:ti,[F]:ce},{[H]:lD,[le]:ti,[F]:ce},{[H]:cD,[le]:ti,[F]:ce},og],[F]:ce}],[F]:ce},$A],[F]:ce},{[H]:[Wh,{[te]:Wt,[ne]:uD,[lt]:pA},{[te]:Nt,[ne]:[{[Me]:pA},"--xa-s3"]}],[le]:[kA,NA,EA,{[H]:rD,[le]:[{[H]:no,[le]:[{[H]:sD,[le]:[{[H]:dD,[le]:ei,[F]:ce},{[H]:hD,[le]:ei,[F]:ce},{[H]:fD,[le]:ei,[F]:ce},{[H]:pD,[le]:ei,[F]:ce},{[H]:mD,[le]:ei,[F]:ce},og],[F]:ce},{[H]:dD,[le]:ti,[F]:ce},{[H]:hD,[le]:ti,[F]:ce},{[H]:fD,[le]:ti,[F]:ce},{[H]:pD,[le]:ti,[F]:ce},{[H]:mD,[le]:ti,[F]:ce},og],[F]:ce}],[F]:ce},$A],[F]:ce},{[H]:[RA,IA,TA],[le]:[{[H]:no,[le]:[{[H]:Zc,endpoint:{[Re]:Wg,[Ae]:Ol,[De]:Qe},[F]:me},{[H]:Qc,endpoint:{[Re]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ol,[De]:Qe},[F]:me},{endpoint:{[Re]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}",[Ae]:Ol,[De]:Qe},[F]:me}],[F]:ce}],[F]:ce},{[H]:[Wh,{[te]:Wt,[ne]:[wt,49,50,Qo],[lt]:ij},{[te]:Wt,[ne]:[wt,8,12,Qo],[lt]:aj},{[te]:Wt,[ne]:uD,[lt]:mA},{[te]:Wt,[ne]:[wt,32,49,Qo],[lt]:DC},{[te]:zx,[ne]:b1,[lt]:"regionPartition"},{[te]:Nt,[ne]:[{[Me]:mA},"--op-s3"]}],[le]:[{[H]:gD,[le]:[{[H]:[{[te]:Nt,[ne]:[AA,"e"]}],[le]:[{[H]:xD,[le]:[DA,{[H]:Zc,endpoint:{[Re]:"https://{Bucket}.ec2.{url#authority}",[Ae]:ig,[De]:Qe},[F]:me}],[F]:ce},{endpoint:{[Re]:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[Ae]:ig,[De]:Qe},[F]:me}],[F]:ce},{[H]:[{[te]:Nt,[ne]:[AA,"o"]}],[le]:[{[H]:xD,[le]:[DA,{[H]:Zc,endpoint:{[Re]:"https://{Bucket}.op-{outpostId}.{url#authority}",[Ae]:ig,[De]:Qe},[F]:me}],[F]:ce},{endpoint:{[Re]:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[Ae]:ig,[De]:Qe},[F]:me}],[F]:ce},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[F]:Ie}],[F]:ce},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[F]:Ie}],[F]:ce},{[H]:Zae,[le]:[{[H]:[kn,{[te]:yi,[ne]:[{[te]:Lr,[ne]:[{[te]:S2,[ne]:Xae}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[F]:Ie},{[H]:[a1,yj],[le]:[{[H]:no,[le]:[{[H]:yD,[le]:[{[H]:[oo,SA],error:"S3 Accelerate cannot be used in this region",[F]:Ie},{[H]:[Bt,Gt,Dn,et,Wn],endpoint:{[Re]:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[Bt,Gt,Dn,et,vt,ts],[le]:[{endpoint:OA,[F]:me}],[F]:ce},{[H]:[Bt,Gt,Dn,et,vt,ns],endpoint:OA,[F]:me},{[H]:[xt,Gt,Dn,et,Wn],endpoint:{[Re]:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,Gt,Dn,et,vt,ts],[le]:[{endpoint:FA,[F]:me}],[F]:ce},{[H]:[xt,Gt,Dn,et,vt,ns],endpoint:FA,[F]:me},{[H]:[Bt,dt,oo,et,Wn],endpoint:{[Re]:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[Bt,dt,oo,et,vt,ts],[le]:[{endpoint:PA,[F]:me}],[F]:ce},{[H]:[Bt,dt,oo,et,vt,ns],endpoint:PA,[F]:me},{[H]:[Bt,dt,Dn,et,Wn],endpoint:{[Re]:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[Bt,dt,Dn,et,vt,ts],[le]:[{endpoint:_A,[F]:me}],[F]:ce},{[H]:[Bt,dt,Dn,et,vt,ns],endpoint:_A,[F]:me},{[H]:[xt,dt,Dn,kn,Xs,i1,Wn],endpoint:{[Re]:lj,[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,dt,Dn,kn,Xs,l1,Wn],endpoint:{[Re]:Vx,[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,dt,Dn,kn,Xs,i1,vt,ts],[le]:[{[H]:ma,endpoint:c1,[F]:me},{endpoint:c1,[F]:me}],[F]:ce},{[H]:[xt,dt,Dn,kn,Xs,l1,vt,ts],[le]:[{[H]:ma,endpoint:OC,[F]:me},MA],[F]:ce},{[H]:[xt,dt,Dn,kn,Xs,i1,vt,ns],endpoint:c1,[F]:me},{[H]:[xt,dt,Dn,kn,Xs,l1,vt,ns],endpoint:OC,[F]:me},{[H]:[xt,dt,oo,et,Wn],endpoint:{[Re]:cj,[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,dt,oo,et,vt,ts],[le]:[{[H]:ma,endpoint:u1,[F]:me},{endpoint:u1,[F]:me}],[F]:ce},{[H]:[xt,dt,oo,et,vt,ns],endpoint:u1,[F]:me},{[H]:[xt,dt,Dn,et,Wn],endpoint:{[Re]:gA,[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,dt,Dn,et,vt,ts],[le]:[{[H]:ma,endpoint:{[Re]:gA,[Ae]:Ln,[De]:Qe},[F]:me},{endpoint:LA,[F]:me}],[F]:ce},{[H]:[xt,dt,Dn,et,vt,ns],endpoint:LA,[F]:me}],[F]:ce},ag],[F]:ce}],[F]:ce},{[H]:[kn,Xs,{[te]:Nt,[ne]:[{[te]:un,[ne]:[gj,"scheme"]},"http"]},{[te]:Ux,[ne]:[wt,Qo]},a1,dt,xt,Dn],[le]:[{[H]:no,[le]:[{[H]:yD,[le]:[MA],[F]:ce},ag],[F]:ce}],[F]:ce},{[H]:[a1,{[te]:uj,[ne]:Yae,[lt]:dj}],[le]:[{[H]:[{[te]:un,[ne]:[vr,"resourceId[0]"],[lt]:hj},{[te]:yi,[ne]:[{[te]:Nt,[ne]:[vj,Wx]}]}],[le]:[{[H]:[{[te]:Nt,[ne]:[d1,N2]}],[le]:[{[H]:C1,[le]:[{[H]:vD,[le]:[jA,BA,{[H]:S1,[le]:[zA,{[H]:bD,[le]:[h1,{[H]:k1,[le]:[{[H]:no,[le]:[{[H]:wD,[le]:[{[H]:N1,[le]:[{[H]:[{[te]:Nt,[ne]:[wj,Wx]}],error:"Invalid ARN: Missing account id",[F]:Ie},{[H]:E1,[le]:[{[H]:CD,[le]:[{[H]:Zc,endpoint:{[Re]:xA,[Ae]:f1,[De]:Qe},[F]:me},{[H]:Qc,endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[Ae]:f1,[De]:Qe},[F]:me},{endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[Ae]:f1,[De]:Qe},[F]:me}],[F]:ce},UA],[F]:ce},p1],[F]:ce},m1],[F]:ce},g1],[F]:ce}],[F]:ce}],[F]:ce},VA],[F]:ce},{error:"Invalid ARN: bucket ARN is missing a region",[F]:Ie}],[F]:ce},WA],[F]:ce},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[F]:Ie}],[F]:ce},{[H]:C1,[le]:[{[H]:vD,[le]:[{[H]:S1,[le]:[{[H]:C1,[le]:[{[H]:S1,[le]:[zA,{[H]:bD,[le]:[h1,{[H]:k1,[le]:[{[H]:no,[le]:[{[H]:[{[te]:Nt,[ne]:[bj,"{partitionResult#name}"]}],[le]:[{[H]:N1,[le]:[{[H]:[{[te]:Nt,[ne]:[d1,Zu]}],[le]:[{[H]:E1,[le]:[{[H]:CD,[le]:[{[H]:w1,error:"Access Points do not support S3 Accelerate",[F]:Ie},{[H]:[Gt,Bt],endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[Ae]:ah,[De]:Qe},[F]:me},{[H]:[Gt,xt],endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[Ae]:ah,[De]:Qe},[F]:me},{[H]:[dt,Bt],endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[Ae]:ah,[De]:Qe},[F]:me},{[H]:[dt,xt,kn,Xs],endpoint:{[Re]:xA,[Ae]:ah,[De]:Qe},[F]:me},{[H]:[dt,xt],endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[Ae]:ah,[De]:Qe},[F]:me}],[F]:ce},UA],[F]:ce},p1],[F]:ce},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[F]:Ie}],[F]:ce},m1],[F]:ce},g1],[F]:ce}],[F]:ce}],[F]:ce},VA],[F]:ce}],[F]:ce}],[F]:ce},{[H]:[{[te]:Oc,[ne]:[$2,Qo]}],[le]:[{[H]:nD,error:"S3 MRAP does not support dual-stack",[F]:Ie},{[H]:Qc,error:"S3 MRAP does not support FIPS",[F]:Ie},{[H]:w1,error:"S3 MRAP does not support S3 Accelerate",[F]:Ie},{[H]:[{[te]:Rn,[ne]:[{[Me]:"DisableMultiRegionAccessPoints"},Qo]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[F]:Ie},{[H]:[{[te]:zx,[ne]:b1,[lt]:yA}],[le]:[{[H]:[{[te]:Nt,[ne]:[{[te]:un,[ne]:[{[Me]:yA},In]},{[te]:un,[ne]:[vr,"partition"]}]}],[le]:[{endpoint:{[Re]:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[Ae]:{[zs]:[{[os]:Qo,name:k2,[is]:Zu,[C2]:Qae}]},[De]:Qe},[F]:me}],[F]:ce},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[F]:Ie}],[F]:ce}],[F]:ce},{error:"Invalid Access Point Name",[F]:Ie}],[F]:ce},WA],[F]:ce},{[H]:[{[te]:Nt,[ne]:[d1,Tf]}],[le]:[{[H]:nD,error:"S3 Outposts does not support Dual-stack",[F]:Ie},{[H]:Qc,error:"S3 Outposts does not support FIPS",[F]:Ie},{[H]:w1,error:"S3 Outposts does not support S3 Accelerate",[F]:Ie},{[H]:[{[te]:Lr,[ne]:[{[te]:un,[ne]:[vr,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[F]:Ie},{[H]:[{[te]:un,[ne]:ele,[lt]:DC}],[le]:[{[H]:gD,[le]:[h1,{[H]:k1,[le]:[{[H]:no,[le]:[{[H]:wD,[le]:[{[H]:N1,[le]:[{[H]:E1,[le]:[{[H]:[{[te]:un,[ne]:tle,[lt]:vA}],[le]:[{[H]:[{[te]:un,[ne]:[vr,"resourceId[3]"],[lt]:E2}],[le]:[{[H]:[{[te]:Nt,[ne]:[{[Me]:vA},fj]}],[le]:[{[H]:Zc,endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[Ae]:HA,[De]:Qe},[F]:me},{endpoint:{[Re]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[Ae]:HA,[De]:Qe},[F]:me}],[F]:ce},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[F]:Ie}],[F]:ce},{error:"Invalid ARN: expected an access point name",[F]:Ie}],[F]:ce},{error:"Invalid ARN: Expected a 4-component resource",[F]:Ie}],[F]:ce},p1],[F]:ce},m1],[F]:ce},g1],[F]:ce}],[F]:ce}],[F]:ce},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[F]:Ie}],[F]:ce},{error:"Invalid ARN: The Outpost Id was not set",[F]:Ie}],[F]:ce},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[F]:Ie}],[F]:ce},{error:"Invalid ARN: No ARN type specified",[F]:Ie}],[F]:ce},{[H]:[{[te]:Wt,[ne]:[wt,0,4,qae],[lt]:bA},{[te]:Nt,[ne]:[{[Me]:bA},"arn:"]},{[te]:yi,[ne]:[{[te]:Lr,[ne]:[GA]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[F]:Ie},{[H]:[{[te]:Rn,[ne]:[Kae,Qo]},GA],error:"Path-style addressing cannot be used with ARN buckets",[F]:Ie},{[H]:Jae,[le]:[{[H]:no,[le]:[{[H]:[Dn],[le]:[{[H]:[Bt,et,Gt,Wn],endpoint:{[Re]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[Bt,et,Gt,vt,ts],[le]:[{endpoint:qA,[F]:me}],[F]:ce},{[H]:[Bt,et,Gt,vt,ns],endpoint:qA,[F]:me},{[H]:[xt,et,Gt,Wn],endpoint:{[Re]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,et,Gt,vt,ts],[le]:[{endpoint:KA,[F]:me}],[F]:ce},{[H]:[xt,et,Gt,vt,ns],endpoint:KA,[F]:me},{[H]:[Bt,et,dt,Wn],endpoint:{[Re]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[Bt,et,dt,vt,ts],[le]:[{endpoint:XA,[F]:me}],[F]:ce},{[H]:[Bt,et,dt,vt,ns],endpoint:XA,[F]:me},{[H]:[xt,kn,Xs,dt,Wn],endpoint:{[Re]:pj,[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,kn,Xs,dt,vt,ts],[le]:[{[H]:ma,endpoint:x1,[F]:me},{endpoint:x1,[F]:me}],[F]:ce},{[H]:[xt,kn,Xs,dt,vt,ns],endpoint:x1,[F]:me},{[H]:[xt,et,dt,Wn],endpoint:{[Re]:wA,[Ae]:es,[De]:Qe},[F]:me},{[H]:[xt,et,dt,vt,ts],[le]:[{[H]:ma,endpoint:{[Re]:wA,[Ae]:Ln,[De]:Qe},[F]:me},{endpoint:YA,[F]:me}],[F]:ce},{[H]:[xt,et,dt,vt,ns],endpoint:YA,[F]:me}],[F]:ce},{error:"Path-style addressing cannot be used with S3 Accelerate",[F]:Ie}],[F]:ce}],[F]:ce}],[F]:ce},{[H]:[{[te]:Lr,[ne]:[JA]},{[te]:Rn,[ne]:[JA,Qo]}],[le]:[{[H]:no,[le]:[{[H]:SD,[le]:[jA,BA,{[H]:Zc,endpoint:{[Re]:Wg,[Ae]:y1,[De]:Qe},[F]:me},{[H]:Qc,endpoint:{[Re]:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[Ae]:y1,[De]:Qe},[F]:me},{endpoint:{[Re]:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[Ae]:y1,[De]:Qe},[F]:me}],[F]:ce},ag],[F]:ce}],[F]:ce},{[H]:[RA],[le]:[{[H]:no,[le]:[{[H]:SD,[le]:[{[H]:[Gt,Bt,et,Wn],endpoint:{[Re]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[Gt,Bt,et,vt,ts],[le]:[{endpoint:ZA,[F]:me}],[F]:ce},{[H]:[Gt,Bt,et,vt,ns],endpoint:ZA,[F]:me},{[H]:[Gt,xt,et,Wn],endpoint:{[Re]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[Gt,xt,et,vt,ts],[le]:[{endpoint:QA,[F]:me}],[F]:ce},{[H]:[Gt,xt,et,vt,ns],endpoint:QA,[F]:me},{[H]:[dt,Bt,et,Wn],endpoint:{[Re]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[Ae]:es,[De]:Qe},[F]:me},{[H]:[dt,Bt,et,vt,ts],[le]:[{endpoint:eD,[F]:me}],[F]:ce},{[H]:[dt,Bt,et,vt,ns],endpoint:eD,[F]:me},{[H]:[dt,xt,kn,Xs,Wn],endpoint:{[Re]:Wg,[Ae]:es,[De]:Qe},[F]:me},{[H]:[dt,xt,kn,Xs,vt,ts],[le]:[{[H]:ma,endpoint:v1,[F]:me},{endpoint:v1,[F]:me}],[F]:ce},{[H]:[dt,xt,kn,Xs,vt,ns],endpoint:v1,[F]:me},{[H]:[dt,xt,et,Wn],endpoint:{[Re]:CA,[Ae]:es,[De]:Qe},[F]:me},{[H]:[dt,xt,et,vt,ts],[le]:[{[H]:ma,endpoint:{[Re]:CA,[Ae]:Ln,[De]:Qe},[F]:me},{endpoint:tD,[F]:me}],[F]:ce},{[H]:[dt,xt,et,vt,ns],endpoint:tD,[F]:me}],[F]:ce},ag],[F]:ce}],[F]:ce}],[F]:ce},{error:"A region must be set when sending requests to S3.",[F]:Ie}]},sle=nle,rle=new fie({size:50,params:["Accelerate","Bucket","DisableAccessPoints","DisableMultiRegionAccessPoints","DisableS3ExpressSessionAuth","Endpoint","ForcePathStyle","Region","UseArnRegion","UseDualStack","UseFIPS","UseGlobalEndpoint","UseObjectLambdaEndpoint","UseS3ExpressControlEndpoint"]}),Cj=(t,e={})=>rle.get(t,()=>Die(sle,{endpointParams:t,logger:e.logger}));Lx.aws=Z4;const ole=t=>async(e,n,s)=>{var a,l,c;if(!s)throw new Error("Could not find `input` for `defaultEndpointRuleSetHttpAuthSchemeParametersProvider`");const r=await t(e,n,s),o=(c=(l=(a=Nd(n))==null?void 0:a.commandInstance)==null?void 0:l.constructor)==null?void 0:c.getEndpointParameterInstructions;if(!o)throw new Error(`getEndpointParameterInstructions() is not defined on \`${n.commandName}\``);const i=await nj(s,{getEndpointParameterInstructions:o},e);return Object.assign(r,i)},ile=async(t,e,n)=>({operation:Nd(e).operation,region:await xi(t.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()}),ale=ole(ile);function Sj(t){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"s3",region:t.region},propertiesExtractor:(e,n)=>({signingProperties:{config:e,context:n}})}}function kj(t){return{schemeId:"aws.auth#sigv4a",signingProperties:{name:"s3",region:t.region},propertiesExtractor:(e,n)=>({signingProperties:{config:e,context:n}})}}const lle=(t,e,n)=>r=>{var l;const i=(l=t(r).properties)==null?void 0:l.authSchemes;if(!i)return e(r);const a=[];for(const c of i){const{name:u,properties:d={},...h}=c,f=u.toLowerCase();u!==f&&console.warn(`HttpAuthScheme has been normalized with lowercasing: \`${u}\` to \`${f}\``);let m;if(f==="sigv4a"){if(m="aws.auth#sigv4a",i.find(v=>{const b=v.name.toLowerCase();return b!=="sigv4a"&&b.startsWith("sigv4")}))continue}else if(f.startsWith("sigv4"))m="aws.auth#sigv4";else throw new Error(`Unknown HttpAuthScheme found in \`@smithy.rules#endpointRuleSet\`: \`${f}\``);const g=n[m];if(!g)throw new Error(`Could not find HttpAuthOption create function for \`${m}\``);const y=g(r);y.schemeId=m,y.signingProperties={...y.signingProperties||{},...h,...d},a.push(y)}return a},cle=t=>{const e=[];switch(t.operation){default:e.push(Sj(t)),e.push(kj(t))}return e},ule=lle(Cj,cle,{"aws.auth#sigv4":Sj,"aws.auth#sigv4a":kj}),dle=t=>{const e=fse(t),n=zne(e);return Object.assign(n,{})},hle=t=>Object.assign(t,{useFipsEndpoint:t.useFipsEndpoint??!1,useDualstackEndpoint:t.useDualstackEndpoint??!1,forcePathStyle:t.forcePathStyle??!1,useAccelerateEndpoint:t.useAccelerateEndpoint??!1,useGlobalEndpoint:t.useGlobalEndpoint??!1,disableMultiregionAccessPoints:t.disableMultiregionAccessPoints??!1,defaultSigningName:"s3"}),fle={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class Gs extends vu{constructor(e){super(e),Object.setPrototypeOf(this,Gs.prototype)}}class I2 extends Gs{constructor(n){super({name:"NoSuchUpload",$fault:"client",...n});at(this,"name","NoSuchUpload");at(this,"$fault","client");Object.setPrototypeOf(this,I2.prototype)}}class T2 extends Gs{constructor(n){super({name:"ObjectNotInActiveTierError",$fault:"client",...n});at(this,"name","ObjectNotInActiveTierError");at(this,"$fault","client");Object.setPrototypeOf(this,T2.prototype)}}class R2 extends Gs{constructor(n){super({name:"BucketAlreadyExists",$fault:"client",...n});at(this,"name","BucketAlreadyExists");at(this,"$fault","client");Object.setPrototypeOf(this,R2.prototype)}}class A2 extends Gs{constructor(n){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...n});at(this,"name","BucketAlreadyOwnedByYou");at(this,"$fault","client");Object.setPrototypeOf(this,A2.prototype)}}class D2 extends Gs{constructor(n){super({name:"NoSuchBucket",$fault:"client",...n});at(this,"name","NoSuchBucket");at(this,"$fault","client");Object.setPrototypeOf(this,D2.prototype)}}var kD;(function(t){t.visit=(e,n)=>e.Prefix!==void 0?n.Prefix(e.Prefix):e.Tag!==void 0?n.Tag(e.Tag):e.And!==void 0?n.And(e.And):n._(e.$unknown[0],e.$unknown[1])})(kD||(kD={}));var ND;(function(t){t.visit=(e,n)=>e.Prefix!==void 0?n.Prefix(e.Prefix):e.Tag!==void 0?n.Tag(e.Tag):e.AccessPointArn!==void 0?n.AccessPointArn(e.AccessPointArn):e.And!==void 0?n.And(e.And):n._(e.$unknown[0],e.$unknown[1])})(ND||(ND={}));class O2 extends Gs{constructor(n){super({name:"InvalidObjectState",$fault:"client",...n});at(this,"name","InvalidObjectState");at(this,"$fault","client");at(this,"StorageClass");at(this,"AccessTier");Object.setPrototypeOf(this,O2.prototype),this.StorageClass=n.StorageClass,this.AccessTier=n.AccessTier}}class F2 extends Gs{constructor(n){super({name:"NoSuchKey",$fault:"client",...n});at(this,"name","NoSuchKey");at(this,"$fault","client");Object.setPrototypeOf(this,F2.prototype)}}class P2 extends Gs{constructor(n){super({name:"NotFound",$fault:"client",...n});at(this,"name","NotFound");at(this,"$fault","client");Object.setPrototypeOf(this,P2.prototype)}}const ple=t=>({...t,...t.SecretAccessKey&&{SecretAccessKey:Xu},...t.SessionToken&&{SessionToken:Xu}}),mle=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:Xu},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:Xu},...t.Credentials&&{Credentials:ple(t.Credentials)}}),gle=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:Xu},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:Xu}});class _2 extends Gs{constructor(n){super({name:"EncryptionTypeMismatch",$fault:"client",...n});at(this,"name","EncryptionTypeMismatch");at(this,"$fault","client");Object.setPrototypeOf(this,_2.prototype)}}class M2 extends Gs{constructor(n){super({name:"InvalidRequest",$fault:"client",...n});at(this,"name","InvalidRequest");at(this,"$fault","client");Object.setPrototypeOf(this,M2.prototype)}}class L2 extends Gs{constructor(n){super({name:"InvalidWriteOffset",$fault:"client",...n});at(this,"name","InvalidWriteOffset");at(this,"$fault","client");Object.setPrototypeOf(this,L2.prototype)}}class j2 extends Gs{constructor(n){super({name:"TooManyParts",$fault:"client",...n});at(this,"name","TooManyParts");at(this,"$fault","client");Object.setPrototypeOf(this,j2.prototype)}}class B2 extends Gs{constructor(n){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...n});at(this,"name","ObjectAlreadyInActiveTierError");at(this,"$fault","client");Object.setPrototypeOf(this,B2.prototype)}}var ED;(function(t){t.visit=(e,n)=>e.Records!==void 0?n.Records(e.Records):e.Stats!==void 0?n.Stats(e.Stats):e.Progress!==void 0?n.Progress(e.Progress):e.Cont!==void 0?n.Cont(e.Cont):e.End!==void 0?n.End(e.End):n._(e.$unknown[0],e.$unknown[1])})(ED||(ED={}));const xle=async(t,e)=>{const n=Dne(t,e),s=bs({},KR,{[Mle]:t[Ple],[Ij]:t[Nj],[Tj]:t[$j],[Rj]:t[Ej],[PC]:[()=>KR(t[FC]),()=>t[FC].toString()]});n.bp("/"),n.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const r=bs({[_le]:[,""]});return n.m("GET").h(s).q(r).b(void 0),n.build()},yle=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return vle(t,e);const n=bs({$metadata:Fr(t),[Nj]:[,t.headers[Ij]],[$j]:[,t.headers[Tj]],[Ej]:[,t.headers[Rj]],[FC]:[()=>t.headers[PC]!==void 0,()=>yse(t.headers[PC])]}),s=T4(Sse(await z4(t.body,e)),"body");return s[T1]!=null&&(n[T1]=Fle(s[T1])),n},vle=async(t,e)=>{const n={...t,body:await hoe(t.body,e)},s=foe(t,n.body);switch(s){case"NoSuchUpload":case"com.amazonaws.s3#NoSuchUpload":throw await Tle(n);case"ObjectNotInActiveTierError":case"com.amazonaws.s3#ObjectNotInActiveTierError":throw await Dle(n);case"BucketAlreadyExists":case"com.amazonaws.s3#BucketAlreadyExists":throw await wle(n);case"BucketAlreadyOwnedByYou":case"com.amazonaws.s3#BucketAlreadyOwnedByYou":throw await Cle(n);case"NoSuchBucket":case"com.amazonaws.s3#NoSuchBucket":throw await $le(n);case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await kle(n);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await Ile(n);case"NotFound":case"com.amazonaws.s3#NotFound":throw await Rle(n);case"EncryptionTypeMismatch":case"com.amazonaws.s3#EncryptionTypeMismatch":throw await Sle(n);case"InvalidRequest":case"com.amazonaws.s3#InvalidRequest":throw await Nle(n);case"InvalidWriteOffset":case"com.amazonaws.s3#InvalidWriteOffset":throw await Ele(n);case"TooManyParts":case"com.amazonaws.s3#TooManyParts":throw await Ole(n);case"ObjectAlreadyInActiveTierError":case"com.amazonaws.s3#ObjectAlreadyInActiveTierError":throw await Ale(n);default:const r=n.body;return ble({output:t,parsedBody:r,errorCode:s})}},ble=Lse(Gs),wle=async(t,e)=>{const n=bs({});t.body;const s=new R2({$metadata:Fr(t),...n});return Or(s,t.body)},Cle=async(t,e)=>{const n=bs({});t.body;const s=new A2({$metadata:Fr(t),...n});return Or(s,t.body)},Sle=async(t,e)=>{const n=bs({});t.body;const s=new _2({$metadata:Fr(t),...n});return Or(s,t.body)},kle=async(t,e)=>{const n=bs({}),s=t.body;s[I1]!=null&&(n[I1]=Uh(s[I1])),s[D1]!=null&&(n[D1]=Uh(s[D1]));const r=new O2({$metadata:Fr(t),...n});return Or(r,t.body)},Nle=async(t,e)=>{const n=bs({});t.body;const s=new M2({$metadata:Fr(t),...n});return Or(s,t.body)},Ele=async(t,e)=>{const n=bs({});t.body;const s=new L2({$metadata:Fr(t),...n});return Or(s,t.body)},$le=async(t,e)=>{const n=bs({});t.body;const s=new D2({$metadata:Fr(t),...n});return Or(s,t.body)},Ile=async(t,e)=>{const n=bs({});t.body;const s=new F2({$metadata:Fr(t),...n});return Or(s,t.body)},Tle=async(t,e)=>{const n=bs({});t.body;const s=new I2({$metadata:Fr(t),...n});return Or(s,t.body)},Rle=async(t,e)=>{const n=bs({});t.body;const s=new P2({$metadata:Fr(t),...n});return Or(s,t.body)},Ale=async(t,e)=>{const n=bs({});t.body;const s=new B2({$metadata:Fr(t),...n});return Or(s,t.body)},Dle=async(t,e)=>{const n=bs({});t.body;const s=new T2({$metadata:Fr(t),...n});return Or(s,t.body)},Ole=async(t,e)=>{const n=bs({});t.body;const s=new j2({$metadata:Fr(t),...n});return Or(s,t.body)},Fle=(t,e)=>{const n={};return t[$1]!=null&&(n[$1]=Uh(t[$1])),t[A1]!=null&&(n[A1]=Uh(t[A1])),t[O1]!=null&&(n[O1]=Uh(t[O1])),t[R1]!=null&&(n[R1]=T4(Rse(t[R1]))),n},Fr=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),$1="AccessKeyId",I1="AccessTier",FC="BucketKeyEnabled",T1="Credentials",R1="Expiration",A1="SecretAccessKey",D1="StorageClass",Ple="SessionMode",Nj="ServerSideEncryption",Ej="SSEKMSEncryptionContext",$j="SSEKMSKeyId",O1="SessionToken",_le="session",Mle="x-amz-create-session-mode",Ij="x-amz-server-side-encryption",Tj="x-amz-server-side-encryption-aws-kms-key-id",PC="x-amz-server-side-encryption-bucket-key-enabled",Rj="x-amz-server-side-encryption-context";class Lle extends $4.classBuilder().ep({...fle,DisableS3ExpressSessionAuth:{type:"staticContextParams",value:!0},Bucket:{type:"contextParams",name:"Bucket"}}).m(function(e,n,s,r){return[hne(s,this.serialize,this.deserialize),hae(s,e.getEndpointParameterInstructions()),sie(s)]}).s("AmazonS3","CreateSession",{}).n("S3Client","CreateSessionCommand").f(gle,mle).ser(xle).de(yle).build(){}const jle="3.787.0",Ble={version:jle},zle=t=>new TextEncoder().encode(t);function $D(t){return typeof t=="string"?t.length===0:t.byteLength===0}var Aj={name:"SHA-1"},ID={name:"HMAC",hash:Aj},Ule=new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]);const Vle={};function Ha(){return typeof window<"u"?window:typeof self<"u"?self:Vle}var Wle=function(){function t(e){this.toHash=new Uint8Array(0),e!==void 0&&(this.key=new Promise(function(n,s){Ha().crypto.subtle.importKey("raw",TD(e),ID,!1,["sign"]).then(n,s)}),this.key.catch(function(){}))}return t.prototype.update=function(e){if(!$D(e)){var n=TD(e),s=new Uint8Array(this.toHash.byteLength+n.byteLength);s.set(this.toHash,0),s.set(n,this.toHash.byteLength),this.toHash=s}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(n){return Ha().crypto.subtle.sign(ID,n,e.toHash).then(function(s){return new Uint8Array(s)})}):$D(this.toHash)?Promise.resolve(Ule):Promise.resolve().then(function(){return Ha().crypto.subtle.digest(Aj,e.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},t.prototype.reset=function(){this.toHash=new Uint8Array(0)},t}();function TD(t){return typeof t=="string"?zle(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}var Hle=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function Dj(t){if(Gle(t)&&typeof t.crypto.subtle=="object"){var e=t.crypto.subtle;return qle(e)}return!1}function Gle(t){if(typeof t=="object"&&typeof t.crypto=="object"){var e=t.crypto.getRandomValues;return typeof e=="function"}return!1}function qle(t){return t&&Hle.every(function(e){return typeof t[e]=="function"})}var Kle=function(){function t(e){if(Dj(Ha()))this.hash=new Wle(e);else throw new Error("SHA1 not supported")}return t.prototype.update=function(e,n){this.hash.update(Yu(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}(),Oj={name:"SHA-256"},RD={name:"HMAC",hash:Oj},Xle=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]),Yle=function(){function t(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return t.prototype.update=function(e){if(!EC(e)){var n=Yu(e),s=new Uint8Array(this.toHash.byteLength+n.byteLength);s.set(this.toHash,0),s.set(n,this.toHash.byteLength),this.toHash=s}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(n){return Ha().crypto.subtle.sign(RD,n,e.toHash).then(function(s){return new Uint8Array(s)})}):EC(this.toHash)?Promise.resolve(Xle):Promise.resolve().then(function(){return Ha().crypto.subtle.digest(Oj,e.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},t.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(n,s){Ha().crypto.subtle.importKey("raw",Yu(e.secret),RD,!1,["sign"]).then(n,s)}),this.key.catch(function(){}))},t}(),ao=64,Jle=32,Zle=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Qle=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],ece=Math.pow(2,53)-1,Hg=function(){function t(){this.state=Int32Array.from(Qle),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,s=e.byteLength;if(this.bytesHashed+=s,this.bytesHashed*8>ece)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;s>0;)this.buffer[this.bufferLength++]=e[n++],s--,this.bufferLength===ao&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),s=this.bufferLength;if(n.setUint8(this.bufferLength++,128),s%ao>=ao-8){for(var r=this.bufferLength;r<ao;r++)n.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(var r=this.bufferLength;r<ao-8;r++)n.setUint8(r,0);n.setUint32(ao-8,Math.floor(e/4294967296),!0),n.setUint32(ao-4,e),this.hashBuffer(),this.finished=!0}for(var o=new Uint8Array(Jle),r=0;r<8;r++)o[r*4]=this.state[r]>>>24&255,o[r*4+1]=this.state[r]>>>16&255,o[r*4+2]=this.state[r]>>>8&255,o[r*4+3]=this.state[r]>>>0&255;return o},t.prototype.hashBuffer=function(){for(var e=this,n=e.buffer,s=e.state,r=s[0],o=s[1],i=s[2],a=s[3],l=s[4],c=s[5],u=s[6],d=s[7],h=0;h<ao;h++){if(h<16)this.temp[h]=(n[h*4]&255)<<24|(n[h*4+1]&255)<<16|(n[h*4+2]&255)<<8|n[h*4+3]&255;else{var f=this.temp[h-2],m=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[h-15];var g=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(m+this.temp[h-7]|0)+(g+this.temp[h-16]|0)}var y=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&c^~l&u)|0)+(d+(Zle[h]+this.temp[h]|0)|0)|0,x=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&o^r&i^o&i)|0;d=u,u=c,c=l,l=a+y|0,a=i,i=o,o=r,r=y+x|0}s[0]+=r,s[1]+=o,s[2]+=i,s[3]+=a,s[4]+=l,s[5]+=c,s[6]+=u,s[7]+=d},t}(),tce=function(){function t(e){this.secret=e,this.hash=new Hg,this.reset()}return t.prototype.update=function(e){if(!(EC(e)||this.error))try{this.hash.update(Yu(e))}catch(n){this.error=n}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return poe(this,void 0,void 0,function(){return moe(this,function(e){return[2,this.digestSync()]})})},t.prototype.reset=function(){if(this.hash=new Hg,this.secret){this.outer=new Hg;var e=nce(this.secret),n=new Uint8Array(ao);n.set(e);for(var s=0;s<ao;s++)e[s]^=54,n[s]^=92;this.hash.update(e),this.outer.update(n);for(var s=0;s<e.byteLength;s++)e[s]=0}},t}();function nce(t){var e=Yu(t);if(e.byteLength>ao){var n=new Hg;n.update(e),e=n.digest()}var s=new Uint8Array(ao);return s.set(e),s}var sce=function(){function t(e){Dj(Ha())?this.hash=new Yle(e):this.hash=new tce(e)}return t.prototype.update=function(e,n){this.hash.update(Yu(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}();const rce={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},Fj={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Sn={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Ys={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},xa={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class he{static getFirstMatch(e,n){const s=n.match(e);return s&&s.length>0&&s[1]||""}static getSecondMatch(e,n){const s=n.match(e);return s&&s.length>1&&s[2]||""}static matchAndReturnConst(e,n,s){if(e.test(n))return s}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const n=e.split(".").splice(0,2).map(s=>parseInt(s,10)||0);if(n.push(0),n[0]===10)switch(n[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const n=e.split(".").splice(0,2).map(s=>parseInt(s,10)||0);if(n.push(0),!(n[0]===1&&n[1]<5)){if(n[0]===1&&n[1]<6)return"Cupcake";if(n[0]===1&&n[1]>=6)return"Donut";if(n[0]===2&&n[1]<2)return"Eclair";if(n[0]===2&&n[1]===2)return"Froyo";if(n[0]===2&&n[1]>2)return"Gingerbread";if(n[0]===3)return"Honeycomb";if(n[0]===4&&n[1]<1)return"Ice Cream Sandwich";if(n[0]===4&&n[1]<4)return"Jelly Bean";if(n[0]===4&&n[1]>=4)return"KitKat";if(n[0]===5)return"Lollipop";if(n[0]===6)return"Marshmallow";if(n[0]===7)return"Nougat";if(n[0]===8)return"Oreo";if(n[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,n,s=!1){const r=he.getVersionPrecision(e),o=he.getVersionPrecision(n);let i=Math.max(r,o),a=0;const l=he.map([e,n],c=>{const u=i-he.getVersionPrecision(c),d=c+new Array(u+1).join(".0");return he.map(d.split("."),h=>new Array(20-h.length).join("0")+h).reverse()});for(s&&(a=i-Math.min(r,o)),i-=1;i>=a;){if(l[0][i]>l[1][i])return 1;if(l[0][i]===l[1][i]){if(i===a)return 0;i-=1}else if(l[0][i]<l[1][i])return-1}}static map(e,n){const s=[];let r;if(Array.prototype.map)return Array.prototype.map.call(e,n);for(r=0;r<e.length;r+=1)s.push(n(e[r]));return s}static find(e,n){let s,r;if(Array.prototype.find)return Array.prototype.find.call(e,n);for(s=0,r=e.length;s<r;s+=1){const o=e[s];if(n(o,s))return o}}static assign(e,...n){const s=e;let r,o;if(Object.assign)return Object.assign(e,...n);for(r=0,o=n.length;r<o;r+=1){const i=n[r];typeof i=="object"&&i!==null&&Object.keys(i).forEach(l=>{s[l]=i[l]})}return e}static getBrowserAlias(e){return rce[e]}static getBrowserTypeByAlias(e){return Fj[e]||""}}const jt=/version\/(\d+(\.?_?\d+)+)/i,oce=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},n=he.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},n=he.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},n=he.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},n=he.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},n=he.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},n=he.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},n=he.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},n=he.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=he.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},n=he.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},n=he.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},n=he.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},n=he.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},n=he.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},n=he.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},n=he.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},n=he.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},n=he.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},n=he.getFirstMatch(jt,t)||he.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},n=he.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},n=he.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},n=he.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},n=he.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},n=he.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},n=he.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},n=he.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},n=he.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},n=he.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e={name:"Android Browser"},n=he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},n=he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},n=he.getFirstMatch(jt,t);return n&&(e.version=n),e}},{test:[/.*/i],describe(t){const e=/^(.*)\/(.*) /,n=/^(.*)\/(.*)[ \t]\((.*)/,r=t.search("\\(")!==-1?n:e;return{name:he.getFirstMatch(r,t),version:he.getSecondMatch(r,t)}}}],ice=[{test:[/Roku\/DVP/],describe(t){const e=he.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:Ys.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=he.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:Ys.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=he.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=he.getWindowsVersionName(e);return{name:Ys.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:Ys.iOS},n=he.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return n&&(e.version=n),e}},{test:[/macintosh/i],describe(t){const e=he.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=he.getMacOSVersionName(e),s={name:Ys.MacOS,version:e};return n&&(s.versionName=n),s}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=he.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:Ys.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e=he.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=he.getAndroidVersionName(e),s={name:Ys.Android,version:e};return n&&(s.versionName=n),s}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=he.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:Ys.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=he.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||he.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||he.getFirstMatch(/\bbb(\d+)/i,t);return{name:Ys.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=he.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:Ys.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=he.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:Ys.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:Ys.Linux}}},{test:[/CrOS/],describe(){return{name:Ys.ChromeOS}}},{test:[/PlayStation 4/],describe(t){const e=he.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:Ys.PlayStation4,version:e}}}],ace=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(t){const e=he.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:Sn.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:Sn.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:Sn.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:Sn.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:Sn.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:Sn.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:Sn.tablet}}},{test(t){const e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe(t){const e=he.getFirstMatch(/(ipod|iphone)/i,t);return{type:Sn.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:Sn.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:Sn.mobile}}},{test(t){return t.getBrowserName(!0)==="blackberry"},describe(){return{type:Sn.mobile,vendor:"BlackBerry"}}},{test(t){return t.getBrowserName(!0)==="bada"},describe(){return{type:Sn.mobile}}},{test(t){return t.getBrowserName()==="windows phone"},describe(){return{type:Sn.mobile,vendor:"Microsoft"}}},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe(){return{type:Sn.tablet}}},{test(t){return t.getOSName(!0)==="android"},describe(){return{type:Sn.mobile}}},{test(t){return t.getOSName(!0)==="macos"},describe(){return{type:Sn.desktop,vendor:"Apple"}}},{test(t){return t.getOSName(!0)==="windows"},describe(){return{type:Sn.desktop}}},{test(t){return t.getOSName(!0)==="linux"},describe(){return{type:Sn.desktop}}},{test(t){return t.getOSName(!0)==="playstation 4"},describe(){return{type:Sn.tv}}},{test(t){return t.getOSName(!0)==="roku"},describe(){return{type:Sn.tv}}}],lce=[{test(t){return t.getBrowserName(!0)==="microsoft edge"},describe(t){if(/\sedg\//i.test(t))return{name:xa.Blink};const n=he.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:xa.EdgeHTML,version:n}}},{test:[/trident/i],describe(t){const e={name:xa.Trident},n=he.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){return t.test(/presto/i)},describe(t){const e={name:xa.Presto},n=he.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe(t){const e={name:xa.Gecko},n=he.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:xa.Blink}}},{test:[/(apple)?webkit/i],describe(t){const e={name:xa.WebKit},n=he.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];class AD{constructor(e,n=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},n!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=he.find(oce,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=he.find(ice,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:n}=this.getOS();return e?String(n).toLowerCase()||"":n||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:n}=this.getPlatform();return e?String(n).toLowerCase()||"":n||""}parsePlatform(){this.parsedResult.platform={};const e=he.find(ace,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=he.find(lce,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return he.assign({},this.parsedResult)}satisfies(e){const n={};let s=0;const r={};let o=0;if(Object.keys(e).forEach(a=>{const l=e[a];typeof l=="string"?(r[a]=l,o+=1):typeof l=="object"&&(n[a]=l,s+=1)}),s>0){const a=Object.keys(n),l=he.find(a,u=>this.isOS(u));if(l){const u=this.satisfies(n[l]);if(u!==void 0)return u}const c=he.find(a,u=>this.isPlatform(u));if(c){const u=this.satisfies(n[c]);if(u!==void 0)return u}}if(o>0){const a=Object.keys(r),l=he.find(a,c=>this.isBrowser(c,!0));if(l!==void 0)return this.compareVersion(r[l])}}isBrowser(e,n=!1){const s=this.getBrowserName().toLowerCase();let r=e.toLowerCase();const o=he.getBrowserTypeByAlias(r);return n&&o&&(r=o.toLowerCase()),r===s}compareVersion(e){let n=[0],s=e,r=!1;const o=this.getBrowserVersion();if(typeof o=="string")return e[0]===">"||e[0]==="<"?(s=e.substr(1),e[1]==="="?(r=!0,s=e.substr(2)):n=[],e[0]===">"?n.push(1):n.push(-1)):e[0]==="="?s=e.substr(1):e[0]==="~"&&(r=!0,s=e.substr(1)),n.indexOf(he.compareVersions(o,s,r))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,n=!1){return this.isBrowser(e,n)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(n=>this.is(n))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class Pj{static getParser(e,n=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new AD(e,n)}static parse(e){return new AD(e).getResult()}static get BROWSER_MAP(){return Fj}static get ENGINE_MAP(){return xa}static get OS_MAP(){return Ys}static get PLATFORMS_MAP(){return Sn}}const cce=({serviceId:t,clientVersion:e})=>async n=>{var i,a,l,c,u,d;const s=typeof window<"u"&&((i=window==null?void 0:window.navigator)!=null&&i.userAgent)?Pj.parse(window.navigator.userAgent):void 0,r=[["aws-sdk-js",e],["ua","2.1"],[`os/${((a=s==null?void 0:s.os)==null?void 0:a.name)||"other"}`,(l=s==null?void 0:s.os)==null?void 0:l.version],["lang/js"],["md/browser",`${((c=s==null?void 0:s.browser)==null?void 0:c.name)??"unknown"}_${((u=s==null?void 0:s.browser)==null?void 0:u.version)??"unknown"}`]];t&&r.push([`api/${t}`,e]);const o=await((d=n==null?void 0:n.userAgentAppId)==null?void 0:d.call(n));return o&&r.push([`app/${o}`]),r};class Hh{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const n=new Uint8Array(8);for(let s=7,r=Math.abs(Math.round(e));s>-1&&r>0;s--,r/=256)n[s]=r;return e<0&&DD(n),new Hh(n)}valueOf(){const e=this.bytes.slice(0),n=e[0]&128;return n&&DD(e),parseInt(gr(e),16)*(n?-1:1)}toString(){return String(this.valueOf())}}function DD(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class uce{constructor(e,n){this.toUtf8=e,this.fromUtf8=n}format(e){const n=[];for(const o of Object.keys(e)){const i=this.fromUtf8(o);n.push(Uint8Array.from([i.byteLength]),i,this.formatHeaderValue(e[o]))}const s=new Uint8Array(n.reduce((o,i)=>o+i.byteLength,0));let r=0;for(const o of n)s.set(o,r),r+=o.byteLength;return s}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,e.value,!1),new Uint8Array(n.buffer);case"integer":const s=new DataView(new ArrayBuffer(5));return s.setUint8(0,4),s.setInt32(1,e.value,!1),new Uint8Array(s.buffer);case"long":const r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":const o=new DataView(new ArrayBuffer(3+e.value.byteLength));o.setUint8(0,6),o.setUint16(1,e.value.byteLength,!1);const i=new Uint8Array(o.buffer);return i.set(e.value,3),i;case"string":const a=this.fromUtf8(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set(Hh.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!vce.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const d=new Uint8Array(17);return d[0]=9,d.set(y4(e.value.replace(/\-/g,"")),1),d}}parse(e){const n={};let s=0;for(;s<e.byteLength;){const r=e.getUint8(s++),o=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,r));switch(s+=r,e.getUint8(s++)){case 0:n[o]={type:FD,value:!0};break;case 1:n[o]={type:FD,value:!1};break;case 2:n[o]={type:dce,value:e.getInt8(s++)};break;case 3:n[o]={type:hce,value:e.getInt16(s,!1)},s+=2;break;case 4:n[o]={type:fce,value:e.getInt32(s,!1)},s+=4;break;case 5:n[o]={type:pce,value:new Hh(new Uint8Array(e.buffer,e.byteOffset+s,8))},s+=8;break;case 6:const i=e.getUint16(s,!1);s+=2,n[o]={type:mce,value:new Uint8Array(e.buffer,e.byteOffset+s,i)},s+=i;break;case 7:const a=e.getUint16(s,!1);s+=2,n[o]={type:gce,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,a))},s+=a;break;case 8:n[o]={type:xce,value:new Date(new Hh(new Uint8Array(e.buffer,e.byteOffset+s,8)).valueOf())},s+=8;break;case 9:const l=new Uint8Array(e.buffer,e.byteOffset+s,16);s+=16,n[o]={type:yce,value:`${gr(l.subarray(0,4))}-${gr(l.subarray(4,6))}-${gr(l.subarray(6,8))}-${gr(l.subarray(8,10))}-${gr(l.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return n}}var OD;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(OD||(OD={}));const FD="boolean",dce="byte",hce="short",fce="integer",pce="long",mce="binary",gce="string",xce="timestamp",yce="uuid",vce=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,_j=4,ya=_j*2,Al=4,bce=ya+Al*2;function wce({byteLength:t,byteOffset:e,buffer:n}){if(t<bce)throw new Error("Provided message too short to accommodate event stream message overhead");const s=new DataView(n,e,t),r=s.getUint32(0,!1);if(t!==r)throw new Error("Reported message length does not match received message length");const o=s.getUint32(_j,!1),i=s.getUint32(ya,!1),a=s.getUint32(t-Al,!1),l=new V4().update(new Uint8Array(n,e,ya));if(i!==l.digest())throw new Error(`The prelude checksum specified in the message (${i}) does not match the calculated CRC32 checksum (${l.digest()})`);if(l.update(new Uint8Array(n,e+ya,t-(ya+Al))),a!==l.digest())throw new Error(`The message checksum (${l.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(n,e+ya+Al,o),body:new Uint8Array(n,e+ya+Al+o,r-o-(ya+Al+Al))}}class Cce{constructor(e,n){this.headerMarshaller=new uce(e,n),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),n=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return n}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const n=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return n}}}encode({headers:e,body:n}){const s=this.headerMarshaller.format(e),r=s.byteLength+n.byteLength+16,o=new Uint8Array(r),i=new DataView(o.buffer,o.byteOffset,o.byteLength),a=new V4;return i.setUint32(0,r,!1),i.setUint32(4,s.byteLength,!1),i.setUint32(8,a.update(o.subarray(0,8)).digest(),!1),o.set(s,12),o.set(n,s.byteLength+12),i.setUint32(r-4,a.update(o.subarray(8,r-4)).digest(),!1),o}decode(e){const{headers:n,body:s}=wce(e);return{headers:this.headerMarshaller.parse(n),body:s}}formatHeaders(e){return this.headerMarshaller.format(e)}}class Sce{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class kce{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class Nce{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const n=await this.options.deserializer(e);n!==void 0&&(yield n)}}}class Ece{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}function $ce(t){let e=0,n=0,s=null,r=null;const o=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,n=4,s=new Uint8Array(a),new DataView(s.buffer).setUint32(0,a,!1)},i=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:l,done:c}=await a.next();if(c){if(e)if(e===n)yield s;else throw new Error("Truncated event message received.");else return;return}const u=l.length;let d=0;for(;d<u;){if(!s){const f=u-d;r||(r=new Uint8Array(4));const m=Math.min(4-n,f);if(r.set(l.slice(d,d+m),n),n+=m,d+=m,n<4)break;o(new DataView(r.buffer).getUint32(0,!1)),r=null}const h=Math.min(e-n,u-d);s.set(l.slice(d,d+h),n),n+=h,d+=h,e&&e===n&&(yield s,s=null,e=0,n=0)}}};return{[Symbol.asyncIterator]:i}}function Ice(t,e){return async function(n){const{value:s}=n.headers[":message-type"];if(s==="error"){const r=new Error(n.headers[":error-message"].value||"UnknownError");throw r.name=n.headers[":error-code"].value,r}else if(s==="exception"){const r=n.headers[":exception-type"].value,o={[r]:n},i=await t(o);if(i.$unknown){const a=new Error(e(n.body));throw a.name=r,a}throw i[r]}else if(s==="event"){const r={[n.headers[":event-type"].value]:n},o=await t(r);return o.$unknown?void 0:o}else throw Error(`Unrecognizable event type: ${n.headers[":event-type"].value}`)}}let Tce=class{constructor({utf8Encoder:e,utf8Decoder:n}){this.eventStreamCodec=new Cce(e,n),this.utfEncoder=e}deserialize(e,n){const s=$ce(e);return new Nce({messageStream:new Sce({inputStream:s,decoder:this.eventStreamCodec}),deserializer:Ice(n,this.utfEncoder)})}serialize(e,n){return new kce({messageStream:new Ece({inputStream:e,serializer:n}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const Rce=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)return;yield s}}finally{e.releaseLock()}}}),Ace=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(n){const{done:s,value:r}=await e.next();if(s)return n.close();n.enqueue(r)}})};class Dce{constructor({utf8Encoder:e,utf8Decoder:n}){this.universalMarshaller=new Tce({utf8Decoder:n,utf8Encoder:e})}deserialize(e,n){const s=Oce(e)?Rce(e):e;return this.universalMarshaller.deserialize(s,n)}serialize(e,n){const s=this.universalMarshaller.serialize(e,n);return typeof ReadableStream=="function"?Ace(s):s}}const Oce=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,Fce=t=>new Dce(t);async function Pce(t,e,n=1024*1024){const s=t.size;let r=0;for(;r<s;){const o=t.slice(r,Math.min(s,r+n));e(new Uint8Array(await o.arrayBuffer())),r+=o.size}}const _ce=async function(e,n){const s=new e;return await Pce(n,r=>{s.update(r)}),s.digest()},Mce=t=>()=>Promise.reject(t),ga=64,Lce=16,jce=[1732584193,4023233417,2562383102,271733878];class Bce{constructor(){this.reset()}update(e){if(zce(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const n=Uce(e);let s=0,{byteLength:r}=n;for(this.bytesHashed+=r;r>0;)this.buffer.setUint8(this.bufferLength++,n[s++]),r--,this.bufferLength===ga&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:n,bufferLength:s,bytesHashed:r}=this,o=r*8;if(n.setUint8(this.bufferLength++,128),s%ga>=ga-8){for(let i=this.bufferLength;i<ga;i++)n.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(let i=this.bufferLength;i<ga-8;i++)n.setUint8(i,0);n.setUint32(ga-8,o>>>0,!0),n.setUint32(ga-4,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(Lce));for(let n=0;n<4;n++)e.setUint32(n*4,this.state[n],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:n}=this;let s=n[0],r=n[1],o=n[2],i=n[3];s=Ts(s,r,o,i,e.getUint32(0,!0),7,3614090360),i=Ts(i,s,r,o,e.getUint32(4,!0),12,3905402710),o=Ts(o,i,s,r,e.getUint32(8,!0),17,606105819),r=Ts(r,o,i,s,e.getUint32(12,!0),22,3250441966),s=Ts(s,r,o,i,e.getUint32(16,!0),7,4118548399),i=Ts(i,s,r,o,e.getUint32(20,!0),12,1200080426),o=Ts(o,i,s,r,e.getUint32(24,!0),17,2821735955),r=Ts(r,o,i,s,e.getUint32(28,!0),22,4249261313),s=Ts(s,r,o,i,e.getUint32(32,!0),7,1770035416),i=Ts(i,s,r,o,e.getUint32(36,!0),12,2336552879),o=Ts(o,i,s,r,e.getUint32(40,!0),17,4294925233),r=Ts(r,o,i,s,e.getUint32(44,!0),22,2304563134),s=Ts(s,r,o,i,e.getUint32(48,!0),7,1804603682),i=Ts(i,s,r,o,e.getUint32(52,!0),12,4254626195),o=Ts(o,i,s,r,e.getUint32(56,!0),17,2792965006),r=Ts(r,o,i,s,e.getUint32(60,!0),22,1236535329),s=Rs(s,r,o,i,e.getUint32(4,!0),5,4129170786),i=Rs(i,s,r,o,e.getUint32(24,!0),9,3225465664),o=Rs(o,i,s,r,e.getUint32(44,!0),14,643717713),r=Rs(r,o,i,s,e.getUint32(0,!0),20,3921069994),s=Rs(s,r,o,i,e.getUint32(20,!0),5,3593408605),i=Rs(i,s,r,o,e.getUint32(40,!0),9,38016083),o=Rs(o,i,s,r,e.getUint32(60,!0),14,3634488961),r=Rs(r,o,i,s,e.getUint32(16,!0),20,3889429448),s=Rs(s,r,o,i,e.getUint32(36,!0),5,568446438),i=Rs(i,s,r,o,e.getUint32(56,!0),9,3275163606),o=Rs(o,i,s,r,e.getUint32(12,!0),14,4107603335),r=Rs(r,o,i,s,e.getUint32(32,!0),20,1163531501),s=Rs(s,r,o,i,e.getUint32(52,!0),5,2850285829),i=Rs(i,s,r,o,e.getUint32(8,!0),9,4243563512),o=Rs(o,i,s,r,e.getUint32(28,!0),14,1735328473),r=Rs(r,o,i,s,e.getUint32(48,!0),20,2368359562),s=As(s,r,o,i,e.getUint32(20,!0),4,4294588738),i=As(i,s,r,o,e.getUint32(32,!0),11,2272392833),o=As(o,i,s,r,e.getUint32(44,!0),16,1839030562),r=As(r,o,i,s,e.getUint32(56,!0),23,4259657740),s=As(s,r,o,i,e.getUint32(4,!0),4,2763975236),i=As(i,s,r,o,e.getUint32(16,!0),11,1272893353),o=As(o,i,s,r,e.getUint32(28,!0),16,4139469664),r=As(r,o,i,s,e.getUint32(40,!0),23,3200236656),s=As(s,r,o,i,e.getUint32(52,!0),4,681279174),i=As(i,s,r,o,e.getUint32(0,!0),11,3936430074),o=As(o,i,s,r,e.getUint32(12,!0),16,3572445317),r=As(r,o,i,s,e.getUint32(24,!0),23,76029189),s=As(s,r,o,i,e.getUint32(36,!0),4,3654602809),i=As(i,s,r,o,e.getUint32(48,!0),11,3873151461),o=As(o,i,s,r,e.getUint32(60,!0),16,530742520),r=As(r,o,i,s,e.getUint32(8,!0),23,3299628645),s=Ds(s,r,o,i,e.getUint32(0,!0),6,4096336452),i=Ds(i,s,r,o,e.getUint32(28,!0),10,1126891415),o=Ds(o,i,s,r,e.getUint32(56,!0),15,2878612391),r=Ds(r,o,i,s,e.getUint32(20,!0),21,4237533241),s=Ds(s,r,o,i,e.getUint32(48,!0),6,1700485571),i=Ds(i,s,r,o,e.getUint32(12,!0),10,2399980690),o=Ds(o,i,s,r,e.getUint32(40,!0),15,4293915773),r=Ds(r,o,i,s,e.getUint32(4,!0),21,2240044497),s=Ds(s,r,o,i,e.getUint32(32,!0),6,1873313359),i=Ds(i,s,r,o,e.getUint32(60,!0),10,4264355552),o=Ds(o,i,s,r,e.getUint32(24,!0),15,2734768916),r=Ds(r,o,i,s,e.getUint32(52,!0),21,1309151649),s=Ds(s,r,o,i,e.getUint32(16,!0),6,4149444226),i=Ds(i,s,r,o,e.getUint32(44,!0),10,3174756917),o=Ds(o,i,s,r,e.getUint32(8,!0),15,718787259),r=Ds(r,o,i,s,e.getUint32(36,!0),21,3951481745),n[0]=s+n[0]&4294967295,n[1]=r+n[1]&4294967295,n[2]=o+n[2]&4294967295,n[3]=i+n[3]&4294967295}reset(){this.state=Uint32Array.from(jce),this.buffer=new DataView(new ArrayBuffer(ga)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function E0(t,e,n,s,r,o){return e=(e+t&4294967295)+(s+o&4294967295)&4294967295,(e<<r|e>>>32-r)+n&4294967295}function Ts(t,e,n,s,r,o,i){return E0(e&n|~e&s,t,e,r,o,i)}function Rs(t,e,n,s,r,o,i){return E0(e&s|n&~s,t,e,r,o,i)}function As(t,e,n,s,r,o,i){return E0(e^n^s,t,e,r,o,i)}function Ds(t,e,n,s,r,o,i){return E0(n^(e|~s),t,e,r,o,i)}function zce(t){return typeof t=="string"?t.length===0:t.byteLength===0}function Uce(t){return typeof t=="string"?fc(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}const PD=typeof TextEncoder=="function"?new TextEncoder:null,Vce=t=>{if(typeof t=="string"){if(PD)return PD.encode(t).byteLength;let e=t.length;for(let n=e-1;n>=0;n--){const s=t.charCodeAt(n);s>127&&s<=2047?e++:s>2047&&s<=65535&&(e+=2),s>=56320&&s<=57343&&n--}return e}else{if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size}throw new Error(`Body Length computation failed for ${t}`)},Wce=t=>({apiVersion:"2006-03-01",base64Decoder:(t==null?void 0:t.base64Decoder)??u2,base64Encoder:(t==null?void 0:t.base64Encoder)??h2,disableHostPrefix:(t==null?void 0:t.disableHostPrefix)??!1,endpointProvider:(t==null?void 0:t.endpointProvider)??Cj,extensions:(t==null?void 0:t.extensions)??[],getAwsChunkedEncodingStream:(t==null?void 0:t.getAwsChunkedEncodingStream)??bne,httpAuthSchemeProvider:(t==null?void 0:t.httpAuthSchemeProvider)??ule,httpAuthSchemes:(t==null?void 0:t.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new p4},{schemeId:"aws.auth#sigv4a",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4a"),signer:new rne}],logger:(t==null?void 0:t.logger)??new F4,sdkStreamMixin:(t==null?void 0:t.sdkStreamMixin)??Ine,serviceId:(t==null?void 0:t.serviceId)??"S3",signerConstructor:(t==null?void 0:t.signerConstructor)??Hae,signingEscapePath:(t==null?void 0:t.signingEscapePath)??!1,urlParser:(t==null?void 0:t.urlParser)??jx,useArnRegion:(t==null?void 0:t.useArnRegion)??!1,utf8Decoder:(t==null?void 0:t.utf8Decoder)??fc,utf8Encoder:(t==null?void 0:t.utf8Encoder)??d2}),Hce=["in-region","cross-region","mobile","standard","legacy"],Gce=({defaultsMode:t}={})=>Bne(async()=>{const e=typeof t=="function"?await t():t;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(qce()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${Hce.join(", ")}, got ${e}`)}}),qce=()=>{var n,s;const t=typeof window<"u"&&((n=window==null?void 0:window.navigator)!=null&&n.userAgent)?Pj.parse(window.navigator.userAgent):void 0,e=(s=t==null?void 0:t.platform)==null?void 0:s.type;return e==="tablet"||e==="mobile"},Kce=t=>{const e=Gce(t),n=()=>e().then(Bse),s=Wce(t);return{...s,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:(t==null?void 0:t.bodyLengthChecker)??Vce,credentialDefaultProvider:(t==null?void 0:t.credentialDefaultProvider)??(r=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(t==null?void 0:t.defaultUserAgentProvider)??cce({serviceId:s.serviceId,clientVersion:Ble.version}),eventStreamSerdeProvider:(t==null?void 0:t.eventStreamSerdeProvider)??Fce,maxAttempts:(t==null?void 0:t.maxAttempts)??Bx,md5:(t==null?void 0:t.md5)??Bce,region:(t==null?void 0:t.region)??Mce("Region is missing"),requestHandler:f2.create((t==null?void 0:t.requestHandler)??n),retryMode:(t==null?void 0:t.retryMode)??(async()=>(await n()).retryMode||pae),sha1:(t==null?void 0:t.sha1)??Kle,sha256:(t==null?void 0:t.sha256)??sce,streamCollector:(t==null?void 0:t.streamCollector)??g4,streamHasher:(t==null?void 0:t.streamHasher)??_ce,useDualstackEndpoint:(t==null?void 0:t.useDualstackEndpoint)??(()=>Promise.resolve(Kie)),useFipsEndpoint:(t==null?void 0:t.useFipsEndpoint)??(()=>Promise.resolve(Xie))}},Xce=t=>({setRegion(e){t.region=e},region(){return t.region}}),Yce=t=>({region:t.region()}),Jce=t=>{const e=t.httpAuthSchemes;let n=t.httpAuthSchemeProvider,s=t.credentials;return{setHttpAuthScheme(r){const o=e.findIndex(i=>i.schemeId===r.schemeId);o===-1?e.push(r):e.splice(o,1,r)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(r){n=r},httpAuthSchemeProvider(){return n},setCredentials(r){s=r},credentials(){return s}}},Zce=t=>({httpAuthSchemes:t.httpAuthSchemes(),httpAuthSchemeProvider:t.httpAuthSchemeProvider(),credentials:t.credentials()}),Qce=(t,e)=>{const n=Object.assign(Xce(t),Hse(t),Kte(t),Jce(t));return e.forEach(s=>s.configure(n)),Object.assign(t,Yce(n),Gse(n),Xte(n),Zce(n))};class eue extends gse{constructor(...[n]){const s=Kce(n||{});super(s);at(this,"config");this.initConfig=s;const r=hle(s),o=hie(r),i=Coe(o),a=Pae(i),l=Yie(a),c=l,u=fae(c),d=Jie(u),h=dle(d),f=Joe(h,{session:[()=>this,Lle]}),m=Qce(f,(n==null?void 0:n.extensions)||[]);this.config=m,this.middlewareStack.use(qie(this.config)),this.middlewareStack.use(Uae(this.config)),this.middlewareStack.use(eae(this.config)),this.middlewareStack.use(Noe(this.config)),this.middlewareStack.use(Ioe(this.config)),this.middlewareStack.use(Ooe(this.config)),this.middlewareStack.use(lne(this.config,{httpAuthSchemeParametersProvider:ale,identityProviderConfigProvider:async g=>new Pne({"aws.auth#sigv4":g.credentials,"aws.auth#sigv4a":g.credentials})})),this.middlewareStack.use(gne(this.config)),this.middlewareStack.use(cie(this.config)),this.middlewareStack.use(Qte(this.config)),this.middlewareStack.use(Loe(this.config)),this.middlewareStack.use(Hoe(this.config)),this.middlewareStack.use(Yoe(this.config))}destroy(){super.destroy()}}var tue={};new eue({region:tue.AWS_REGION});function nue({milestone:t,onReviewComplete:e}){var c;const[n,s]=S.useState(!1),[r,o]=S.useState({status:"",comment:""}),i=u=>{const{name:d,value:h}=u.target;o(f=>({...f,[d]:h}))},a=async u=>{var d,h;if(!r.comment&&u==="rejected"){xe.error("Please provide feedback for rejection");return}try{s(!0),console.log(`Submitting review for milestone: ${t._id}, status: ${u}`);const f=await We.post(`/milestones/${t._id}/review`,{status:u,comment:r.comment||""});console.log("Review submission successful:",f.data),xe.success(`Work ${u==="approved"?"approved":"rejected"} successfully`),e&&e(f.data)}catch(f){console.error("Review submission error:",f),xe.error(((h=(d=f.response)==null?void 0:d.data)==null?void 0:h.message)||"Failed to submit review")}finally{s(!1)}},l=u=>u!=null&&u.startsWith("http")?u:`${u}`;return p.jsx(be,{children:p.jsxs(be.Body,{children:[p.jsx("h4",{className:"mb-4",children:"Review Submission"}),p.jsxs("div",{className:"mb-4",children:[p.jsx("h5",{children:"Work Description"}),p.jsx("p",{className:"text-muted",children:t.submission.description})]}),((c=t.submission.files)==null?void 0:c.length)>0&&p.jsxs("div",{className:"mb-4",children:[p.jsx("h5",{children:"Attachments"}),p.jsx("div",{className:"list-group",children:t.submission.files.map((u,d)=>p.jsxs("div",{className:"list-group-item d-flex justify-content-between align-items-center",children:[p.jsx("span",{children:u.originalname}),p.jsx("a",{href:l(u.path),target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",download:u.originalname,children:p.jsx(fL,{size:16})})]},d))})]}),p.jsxs(L.Group,{className:"mb-4",children:[p.jsx(L.Label,{children:"Review Comments"}),p.jsx(L.Control,{as:"textarea",rows:4,name:"comment",value:r.comment,onChange:i,placeholder:"Provide feedback about the work..."})]}),p.jsxs("div",{className:"d-flex gap-2",children:[p.jsx(Ve,{variant:"success",onClick:()=>a("approved"),disabled:n,children:n?p.jsx(ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):p.jsxs(p.Fragment,{children:[p.jsx(wf,{size:16,className:"me-2"}),"Approve & Release Payment"]})}),p.jsx(Ve,{variant:"danger",onClick:()=>a("rejected"),disabled:n,children:n?p.jsx(ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):p.jsxs(p.Fragment,{children:[p.jsx(yL,{size:16,className:"me-2"}),"Request Changes"]})})]})]})})}function sue({job:t,onComplete:e}){const n=Dr(),[s,r]=S.useState(!1),[o,i]=S.useState(null),[a,l]=S.useState({rating:5,communication:5,quality:5,timeliness:5,comment:"",skills:t.skills.map(h=>({skill:h,rating:5}))});S.useEffect(()=>{(async()=>{try{const m=(await We.get(`/jobs/${t._id}/applications`)).data.find(g=>g.status==="accepted");m?i(m):xe.error("No accepted application found for this job")}catch(f){console.error("Error fetching accepted application:",f),xe.error("Failed to fetch freelancer information")}})()},[t._id]);const c=h=>{const{name:f,value:m}=h.target;l(g=>({...g,[f]:m}))},u=(h,f)=>{l(m=>({...m,skills:m.skills.map((g,y)=>y===h?{...g,rating:Number(f)}:g)}))},d=async h=>{var f,m,g;if(h.preventDefault(),!a.comment.trim()){xe.error("Please provide a review comment");return}if(!o){xe.error("Unable to complete project without freelancer information");return}try{if(r(!0),(f=t.reviews)!=null&&f.employer){console.log("Job already has an employer review, just updating status to closed"),await We.patch(`/jobs/${t._id}/complete`,{review:t.reviews.employer}),xe.success("Project marked as closed"),e&&e(),n("/dashboard/projects");return}const y=await We.post("/reviews",{job:t._id,reviewee:o.freelancer._id,...a});await We.patch(`/jobs/${t._id}/complete`,{review:y.data._id}),xe.success("Project completed and review submitted"),e&&e(),n("/dashboard/projects")}catch(y){console.error("Error completing project:",y),xe.error(((g=(m=y.response)==null?void 0:m.data)==null?void 0:g.message)||"Failed to complete project")}finally{r(!1)}};return p.jsx(be,{children:p.jsxs(be.Body,{children:[p.jsxs("div",{className:"d-flex align-items-center mb-4",children:[p.jsx(Gk,{size:24,className:"text-primary me-2"}),p.jsx("h4",{className:"mb-0",children:"Complete Project & Review"})]}),o?p.jsxs(L,{onSubmit:d,children:[p.jsx("div",{className:"mb-4",children:p.jsxs("h5",{children:["Reviewing work by: ",o.freelancer.firstName," ",o.freelancer.lastName]})}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Communication"}),p.jsx("div",{className:"d-flex align-items-center",children:[1,2,3,4,5].map(h=>p.jsx(_i,{size:24,className:`cursor-pointer ${h<=a.communication?"text-warning":"text-gray-300"}`,onClick:()=>c({target:{name:"communication",value:h}})},h))})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Quality of Work"}),p.jsx("div",{className:"d-flex align-items-center",children:[1,2,3,4,5].map(h=>p.jsx(_i,{size:24,className:`cursor-pointer ${h<=a.quality?"text-warning":"text-gray-300"}`,onClick:()=>c({target:{name:"quality",value:h}})},h))})]})})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Timeliness"}),p.jsx("div",{className:"d-flex align-items-center",children:[1,2,3,4,5].map(h=>p.jsx(_i,{size:24,className:`cursor-pointer ${h<=a.timeliness?"text-warning":"text-gray-300"}`,onClick:()=>c({target:{name:"timeliness",value:h}})},h))})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Overall Rating"}),p.jsx("div",{className:"d-flex align-items-center",children:[1,2,3,4,5].map(h=>p.jsx(_i,{size:24,className:`cursor-pointer ${h<=a.rating?"text-warning":"text-gray-300"}`,onClick:()=>c({target:{name:"rating",value:h}})},h))})]})})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("h5",{className:"mb-3",children:"Skills Rating"}),a.skills.map((h,f)=>p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:h.skill}),p.jsx("div",{className:"d-flex align-items-center",children:[1,2,3,4,5].map(m=>p.jsx(_i,{size:20,className:`cursor-pointer ${m<=h.rating?"text-warning":"text-gray-300"}`,onClick:()=>u(f,m)},m))})]},f))]}),p.jsxs(L.Group,{className:"mb-4",children:[p.jsx(L.Label,{children:"Review Comment"}),p.jsx(L.Control,{as:"textarea",rows:4,name:"comment",value:a.comment,onChange:c,placeholder:"Share your experience working with this freelancer...",required:!0})]}),p.jsx(Ve,{type:"submit",variant:"primary",className:"w-100",disabled:s,children:s?p.jsxs(p.Fragment,{children:[p.jsx(ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Submitting..."]}):p.jsxs(p.Fragment,{children:[p.jsx($u,{size:16,className:"me-2"}),"Complete Project & Submit Review"]})})]}):p.jsxs("div",{className:"text-center py-4",children:[p.jsx(ir,{animation:"border",role:"status"}),p.jsx("p",{className:"mt-3",children:"Loading freelancer information..."})]})]})})}function Mj(){const{id:t}=yd(),e=Dr(),{user:n}=Hs(),s=(n==null?void 0:n.role)==="employer",[r,o]=S.useState([]),[i,a]=S.useState(!0),[l,c]=S.useState(null),[u,d]=S.useState(!1),[h,f]=S.useState(!1),[m,g]=S.useState(!1),[y,x]=S.useState(!1),[v,b]=S.useState(!1),[w,C]=S.useState(null),[k,N]=S.useState(null),[E,$]=S.useState(null),[I,A]=S.useState(!1),[P,_]=S.useState({title:"",description:"",amount:"",currency:"USD",dueDate:""}),[U,V]=S.useState({description:"",files:[]}),D=S.useCallback(async()=>{try{a(!0),c(null);const ue=await We.get(`/milestones/job/${t}`);console.log("Fetched milestones:",ue.data),o(ue.data)}catch(ue){console.error("Error fetching milestones:",ue),c("Failed to load milestones. Please try refreshing the page."),xe.error("Failed to load milestones")}finally{a(!1)}},[t]),W=S.useCallback(async()=>{try{const ue=await We.get(`/jobs/${t}`);console.log("Fetched job details:",ue.data),$(ue.data)}catch(ue){console.error("Error fetching job details:",ue),xe.error("Failed to load job details")}},[t]);S.useEffect(()=>{D(),W()},[D,W]);const R=async ue=>{var Ue,sn;ue.preventDefault();try{const gt={...P,job:t,amount:parseFloat(P.amount)};if(!w){N(gt),d(!1),g(!0);return}await We.patch(`/milestones/${w._id}`,gt),xe.success("Milestone updated successfully"),d(!1),C(null),_({title:"",description:"",amount:"",currency:"USD",dueDate:""}),D()}catch(gt){console.error("Error saving milestone:",gt),xe.error(((sn=(Ue=gt.response)==null?void 0:Ue.data)==null?void 0:sn.message)||"Failed to save milestone")}},j=async ue=>{try{xe.success("Milestone created and escrow funded successfully"),g(!1),N(null),D()}catch(Ue){console.error("Error creating milestone:",Ue),xe.error("Failed to create milestone")}},G=async ue=>{try{await We.post(`/payments/release/${ue.payment._id}`),xe.success("Payment released successfully"),D()}catch(Ue){console.error("Error releasing payment:",Ue),xe.error("Failed to release payment")}},O=async ue=>{try{xe.success("Work submitted successfully"),D(),f(!1)}catch(Ue){console.error("Error handling submission completion:",Ue),xe.error("Failed to process submission")}},B=ue=>{N(ue),x(!0)},z=async ue=>{try{xe.success("Review submitted successfully"),setTimeout(()=>{W(),D()},500),x(!1)}catch(Ue){console.error("Error handling review completion:",Ue),xe.error("Failed to process review")}},K=ue=>{C(ue),_({title:ue.title,description:ue.description,amount:ue.amount.toString(),currency:ue.currency,dueDate:ue.dueDate.split("T")[0]}),d(!0)},J=async ue=>{if(window.confirm("Are you sure you want to delete this milestone?"))try{await We.delete(`/milestones/${ue}`),xe.success("Milestone deleted successfully"),D()}catch(Ue){console.error("Error deleting milestone:",Ue),xe.error("Failed to delete milestone")}},re=async ue=>{try{await We.patch(`/milestones/${ue._id}/status`,{status:"in-progress"}),xe.success("Work started successfully"),D()}catch(Ue){console.error("Error starting work:",Ue),xe.error("Failed to start work on milestone")}},de=async()=>{try{await We.patch(`/jobs/${t}`,{status:"closed"}),xe.success("Project closed successfully!"),b(!1),W(),D()}catch(ue){console.error("Error closing project:",ue),b(!1)}},pe=r.filter(ue=>ue.status==="completed").length,we=r.length,Ce=we>0&&pe===we,Ne=(E==null?void 0:E.status)==="closed",ze=s&&Ce&&!Ne,_e=ue=>{const Ue={pending:"warning","in-progress":"info",completed:"success",overdue:"danger"};return p.jsx(Zs,{bg:Ue[ue],children:ue})},st=ue=>{const Ue={open:"primary","in-progress":"info",completed:"success",closed:"secondary",cancelled:"danger"};return p.jsx(Zs,{bg:Ue[ue]||"light",children:ue})},je=ue=>{if(!ue.payment)return p.jsx(Zs,{bg:"danger",children:"Unfunded"});switch(ue.payment.status){case"held":return p.jsx(Zs,{bg:"warning",children:"In Escrow"});case"released":return p.jsx(Zs,{bg:"success",children:"Released"});default:return p.jsx(Zs,{bg:"secondary",children:ue.payment.status})}},rt=async()=>{var ue,Ue;try{if(!E){xe.error("Please wait while job data is loading...");return}if(!E.employer){console.error("Missing employer data:",{jobId:t,job:E}),xe.error("Unable to start chat. Please try again later.");return}if(s&&!E.freelancer){xe.error("No freelancer has been assigned to this project yet.");return}if(!s&&(!E.freelancer||E.freelancer._id!==n._id)){xe.error("You are not assigned to this project.");return}const sn=s?((ue=E.freelancer)==null?void 0:ue._id)||E.freelancer:((Ue=E.employer)==null?void 0:Ue._id)||E.employer;if(!sn){console.error("Missing participant ID:",{isEmployer:s,job:{employer:E.employer,freelancer:E.freelancer}}),xe.error("Unable to start chat. Please try again later.");return}e(`/chat?with=${sn}`)}catch(sn){console.error("Error handling chat navigation:",sn),xe.error("Unable to open chat at this time. Please try again later.")}};return i?p.jsx("div",{className:"text-center py-5",children:p.jsx("div",{className:"spinner-border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):l?p.jsxs(Wa,{variant:"danger",children:[p.jsx(Wa.Heading,{children:"Error Loading Milestones"}),p.jsx("p",{children:l}),p.jsx("div",{className:"d-flex justify-content-end",children:p.jsx(Ve,{onClick:D,variant:"outline-danger",children:"Try Again"})})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"text-2xl font-bold",children:"Project Milestones"}),E&&p.jsxs("div",{className:"d-flex align-items-center mt-2",children:[p.jsx("h5",{className:"mb-0 me-2",children:E.title}),st(E.status),Ne&&p.jsx("div",{className:"ms-3",children:p.jsx(Zs,{bg:"info",children:"This project is closed and cannot be edited"})})]})]}),p.jsxs("div",{className:"d-flex gap-2",children:[p.jsxs(Ve,{variant:"light",onClick:rt,title:"Open Chat",children:[p.jsx($u,{size:16,className:"me-2"}),"Chat"]}),ze&&p.jsxs(Ve,{variant:"success",onClick:()=>b(!0),children:[p.jsx(Gk,{size:16,className:"me-2"}),"Complete Project & Review"]}),s&&!ze&&we>0&&p.jsx(Wa,{variant:"info",className:"mb-0 py-2 px-3",children:p.jsx("small",{children:pe===0?"Complete milestones to finish the project":pe<we?`${pe}/${we} milestones completed`:Ne?"Project is closed":"All milestones completed"})}),s&&!Ne&&p.jsxs(Ve,{variant:"primary",onClick:()=>{C(null),_({title:"",description:"",amount:"",currency:"USD",dueDate:""}),d(!0)},children:[p.jsx(DJ,{size:16,className:"me-2"}),"Add Milestone"]})]})]}),p.jsx(be,{children:p.jsx(be.Body,{children:r.length===0?p.jsx("div",{className:"text-center py-4",children:p.jsx("p",{className:"text-muted mb-0",children:"No milestones created yet"})}):p.jsxs(bf,{responsive:!0,hover:!0,children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Title"}),p.jsx("th",{children:"Description"}),p.jsx("th",{children:"Amount"}),p.jsx("th",{children:"Due Date"}),p.jsx("th",{children:"Status"}),p.jsx("th",{children:"Payment Status"}),p.jsx("th",{children:"Actions"})]})}),p.jsx("tbody",{children:r.map(ue=>{var Ue;return p.jsxs("tr",{children:[p.jsx("td",{children:ue.title}),p.jsx("td",{children:p.jsxs("div",{style:{maxWidth:"300px"},children:[ue.description.substring(0,100),ue.description.length>100?"...":""]})}),p.jsx("td",{children:hC(ue.amount,ue.currency)}),p.jsx("td",{children:new Date(ue.dueDate).toLocaleDateString()}),p.jsx("td",{children:_e(ue.status)}),p.jsx("td",{children:je(ue)}),p.jsx("td",{children:p.jsx("div",{className:"d-flex gap-2",children:s?p.jsxs(p.Fragment,{children:[!Ne&&p.jsxs(p.Fragment,{children:[p.jsx(Ve,{variant:"light",size:"sm",onClick:()=>K(ue),title:"Edit Milestone",children:p.jsx(TJ,{size:16})}),p.jsx(Ve,{variant:"light",size:"sm",onClick:()=>J(ue._id),title:"Delete Milestone",className:"text-danger",children:p.jsx(xL,{size:16})})]}),p.jsx(Ve,{variant:"light",size:"sm",onClick:rt,title:"Open Chat",children:p.jsx($u,{size:16})}),ue.status==="in-progress"&&ue.submission&&((Ue=ue.payment)==null?void 0:Ue.status)==="held"&&!Ne&&p.jsxs(Ve,{variant:"success",size:"sm",onClick:()=>G(ue),title:"Release Payment",children:[p.jsx(wf,{size:16,className:"me-1"}),"Release Payment"]}),ue.status==="in-progress"&&ue.submission&&!Ne&&p.jsxs(Ve,{variant:"primary",size:"sm",onClick:()=>B(ue),title:"Review Work",children:[p.jsx(wf,{size:16,className:"me-1"}),"Review Work"]}),Ne&&p.jsx(Zs,{bg:"secondary",children:"Project Closed"})]}):p.jsxs(p.Fragment,{children:[p.jsx(Ve,{variant:"light",size:"sm",onClick:rt,title:"Open Chat",children:p.jsx($u,{size:16})}),ue.status==="pending"&&ue.payment&&!Ne&&p.jsxs(Ve,{variant:"primary",size:"sm",onClick:()=>re(ue),title:"Start Work",children:[p.jsx(Cf,{size:16,className:"me-1"}),"Start"]}),ue.status==="in-progress"&&!Ne&&p.jsxs(Ve,{variant:"success",size:"sm",onClick:()=>{N(ue),f(!0)},title:"Submit Work",children:[p.jsx(jJ,{size:16,className:"me-1"}),ue.submission?"Update":"Submit"]}),Ne&&p.jsx(Zs,{bg:"secondary",children:"Project Closed"})]})})})]},ue._id)})})]})})}),p.jsxs(Qt,{show:u,onHide:()=>d(!1),children:[p.jsx(Qt.Header,{closeButton:!0,children:p.jsx(Qt.Title,{children:w?"Edit Milestone":"Create Milestone"})}),p.jsx(Qt.Body,{children:p.jsxs(L,{onSubmit:R,children:[p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Title"}),p.jsx(L.Control,{type:"text",value:P.title,onChange:ue=>_({...P,title:ue.target.value}),required:!0})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Description"}),p.jsx(L.Control,{as:"textarea",rows:3,value:P.description,onChange:ue=>_({...P,description:ue.target.value}),required:!0})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:8,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Amount"}),p.jsx(L.Control,{type:"number",min:"0",step:"0.01",value:P.amount,onChange:ue=>_({...P,amount:ue.target.value}),required:!0})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Currency"}),p.jsxs(L.Select,{value:P.currency,onChange:ue=>_({...P,currency:ue.target.value}),children:[p.jsx("option",{value:"USD",children:"USD"}),p.jsx("option",{value:"EUR",children:"EUR"}),p.jsx("option",{value:"GBP",children:"GBP"})]})]})})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Due Date"}),p.jsx(L.Control,{type:"date",value:P.dueDate,onChange:ue=>_({...P,dueDate:ue.target.value}),required:!0})]}),p.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[p.jsx(Ve,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),p.jsx(Ve,{variant:"primary",type:"submit",children:w?"Update":"Continue"})]})]})})]}),p.jsxs(Qt,{show:m,onHide:()=>g(!1),backdrop:"static",size:"lg",children:[p.jsx(Qt.Header,{closeButton:!0,children:p.jsx(Qt.Title,{children:"Fund Escrow for Milestone"})}),p.jsx(Qt.Body,{children:k&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"mb-4",children:[p.jsx("h5",{children:"Milestone Details"}),p.jsxs("p",{children:[p.jsx("strong",{children:"Title:"})," ",k.title]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Amount:"})," ",hC(k.amount,k.currency)]})]}),p.jsx(Hte,{milestone:k,onPaymentComplete:j})]})})]}),p.jsxs(Qt,{show:h,onHide:()=>f(!1),backdrop:"static",size:"lg",children:[p.jsx(Qt.Header,{closeButton:!0,children:p.jsx(Qt.Title,{children:"Submit Work for Milestone"})}),p.jsx(Qt.Body,{children:k&&p.jsx(qte,{milestone:k,onSubmissionComplete:O,onClose:()=>f(!1)})})]}),p.jsxs(Qt,{show:v,onHide:()=>b(!1),backdrop:"static",size:"lg",children:[p.jsx(Qt.Header,{closeButton:!0,children:p.jsx(Qt.Title,{children:"Complete Project & Review"})}),p.jsx(Qt.Body,{children:E&&p.jsx(sue,{job:E,onComplete:de})})]}),p.jsxs(Qt,{show:y,onHide:()=>x(!1),backdrop:"static",size:"lg",children:[p.jsx(Qt.Header,{closeButton:!0,children:p.jsx(Qt.Title,{children:"Review Work for Milestone"})}),p.jsx(Qt.Body,{children:k&&p.jsx(nue,{milestone:k,onReviewComplete:z})})]})]})}function Lj(){var N,E,$,I;const{id:t}=yd(),e=Dr(),{user:n}=Hs(),[s,r]=S.useState(null),[o,i]=S.useState(!0),[a,l]=S.useState(!1),[c,u]=S.useState(!1),[d,h]=S.useState(""),[f,m]=S.useState({amount:"",currency:"USD"}),[g,y]=S.useState("details"),[x,v]=S.useState(!1);S.useEffect(()=>{(async()=>{var P,_,U,V,D,W;i(!0);try{const R=await We.get(`/jobs/${t}`);if(console.log("Job details:",R.data),r(R.data),R.data.hasApplied!==void 0)v(R.data.isAccepted||!1);else if(n&&n.role==="freelancer")try{const j=await We.get(`/jobs/${t}/applications`);console.log("Applications response:",j.data);const G=j.data.filter(O=>O.freelancer._id===n._id);G.length>0&&(r(O=>({...O,hasApplied:!0})),G.some(O=>O.status==="accepted")&&v(!0))}catch(j){console.error("Error fetching application status:",j)}m(j=>({...j,amount:R.data.salary.min,currency:R.data.salary.currency}))}catch(R){console.error("Error fetching job:",R),console.error("Error details:",{status:(P=R.response)==null?void 0:P.status,message:(U=(_=R.response)==null?void 0:_.data)==null?void 0:U.message,error:R.message}),xe.error(((D=(V=R.response)==null?void 0:V.data)==null?void 0:D.message)||"Failed to load job details"),((W=R.response)==null?void 0:W.status)===404&&e("/find-projects")}finally{i(!1)}})()},[t,e,n]),S.useEffect(()=>{s&&s.isAccepted&&v(!0)},[s]),S.useEffect(()=>{s&&console.log("Application status check:",{jobId:s._id,hasApplied:s.hasApplied,isAccepted:x,applicationStatus:s.applicationStatus,userRole:n==null?void 0:n.role,loggedIn:!!n})},[s,x,n]);const b=async A=>{var P,_,U,V,D,W,R;if(A.preventDefault(),!n){xe.error("Please log in to apply for jobs"),e("/login");return}if(n.role!=="freelancer"){xe.error("Only freelancers can apply for jobs");return}if(!(d!=null&&d.trim())){xe.error("Please provide a cover letter");return}if(!(f!=null&&f.amount)||f.amount<=0){xe.error("Please provide a valid expected rate");return}if(f.amount<s.salary.min||f.amount>s.salary.max){xe.error(`Expected rate must be between ${s.salary.currency} ${s.salary.min} and ${s.salary.max}`);return}try{l(!0),console.log("Attempting to submit application:",{jobId:t,fullJobId:s._id,application:{coverLetter:d.trim(),expectedRate:f},user:n});const j=await We.post(`/jobs/${s._id}/apply`,{coverLetter:d.trim(),expectedRate:f});console.log("Application submission response:",j),r(G=>({...G,hasApplied:!0,applicationStatus:"pending"})),u(!1),xe.success("Application submitted successfully!")}catch(j){console.error("Error applying for job:",j),console.error("Error details:",{status:(P=j.response)==null?void 0:P.status,message:(U=(_=j.response)==null?void 0:_.data)==null?void 0:U.message,error:j.message,config:j.config,jobId:t,fullJobId:s._id}),((V=j.response)==null?void 0:V.status)===404?(xe.error("Job not found or has been removed"),e("/find-projects")):((D=j.response)==null?void 0:D.status)===401?(xe.error("Please log in to apply for this job"),e("/login")):((W=j.response)==null?void 0:W.status)===403?xe.error("Only freelancers can apply for jobs"):((R=j.response)==null?void 0:R.status)===400?xe.error(j.response.data.message||"Invalid application data"):xe.error("Failed to submit application. Please try again later.")}finally{l(!1)}},w=A=>{const{name:P,value:_}=A.target;if(P.startsWith("expectedRate.")){const U=P.split(".")[1];m(V=>({...V,[U]:_}))}else h(_)};if(o)return p.jsx(Kt,{className:"py-5",children:p.jsx("div",{className:"text-center",children:p.jsx(ir,{animation:"border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(!s)return p.jsx(Kt,{className:"py-5",children:p.jsx(be,{children:p.jsxs(be.Body,{className:"text-center",children:[p.jsx("h2",{className:"mb-4",children:"Job Not Found"}),p.jsx("p",{className:"text-muted mb-4",children:"The job you're looking for doesn't exist or has been removed."}),p.jsx(Ve,{variant:"primary",onClick:()=>e("/find-projects"),children:"Browse Projects"})]})})});const C=(n==null?void 0:n.role)==="employer",k=((N=s.employer)==null?void 0:N._id)===(n==null?void 0:n._id);return p.jsxs(p.Fragment,{children:[p.jsx(Kt,{className:"py-5",children:p.jsxs(ot,{children:[p.jsxs(ve,{lg:8,children:[p.jsxs(zt,{variant:"tabs",className:"mb-4",children:[p.jsx(zt.Item,{children:p.jsx(zt.Link,{active:g==="details",onClick:()=>y("details"),children:"Job Details"})}),(C||(s==null?void 0:s.status)==="in-progress"||(s==null?void 0:s.status)==="completed")&&p.jsx(zt.Item,{children:p.jsx(zt.Link,{active:g==="milestones",onClick:()=>y("milestones"),children:"Milestones"})})]}),g==="details"?p.jsx(p.Fragment,{children:p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[p.jsx("h1",{className:"h2 mb-0",children:s.title}),p.jsx("span",{className:`badge ${s.type==="full-time"?"bg-primary":"bg-secondary"}`,children:s.type})]}),p.jsxs(ot,{className:"mb-4 g-3",children:[p.jsx(ve,{sm:6,md:3,children:p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx(qk,{size:20,className:"me-2 text-muted"}),p.jsxs("span",{className:"text-muted",children:[(E=s.employer)==null?void 0:E.firstName," ",($=s.employer)==null?void 0:$.lastName]})]})}),p.jsx(ve,{sm:6,md:3,children:p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx(Qa,{size:20,className:"me-2 text-muted"}),p.jsx("span",{className:"text-muted",children:s.location})]})}),p.jsx(ve,{sm:6,md:3,children:p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx(o0,{size:20,className:"me-2 text-muted"}),p.jsxs("span",{className:"text-muted",children:[s.salary.currency," ",s.salary.min.toLocaleString()," - ",s.salary.max.toLocaleString()]})]})}),p.jsx(ve,{sm:6,md:3,children:p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx(Cf,{size:20,className:"me-2 text-muted"}),p.jsx("span",{className:"text-muted",children:s.type})]})})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("h2",{className:"h4 mb-3",children:"Job Description"}),p.jsx("p",{className:"text-muted white-space-pre-line",children:s.description})]}),((I=s.skills)==null?void 0:I.length)>0&&p.jsxs("div",{className:"mb-4",children:[p.jsx("h2",{className:"h4 mb-3",children:"Required Skills"}),p.jsx("div",{className:"d-flex flex-wrap gap-2",children:s.skills.map((A,P)=>p.jsx("span",{className:"badge bg-light text-dark",children:A},P))})]})]})})}):p.jsx(Mj,{})]}),p.jsx(ve,{lg:4,children:p.jsx(be,{className:"sticky-top",style:{top:"2rem"},children:p.jsxs(be.Body,{children:[p.jsx("h3",{className:"h4 mb-4",children:"Apply for this position"}),p.jsxs("div",{className:"mb-4",children:[p.jsx(yJ,{size:20,className:"me-2 text-muted"}),p.jsxs("span",{className:"text-muted",children:["Posted ",new Date(s.createdAt).toLocaleDateString()]})]}),!C&&(n==null?void 0:n.role)==="freelancer"&&p.jsxs(p.Fragment,{children:[!s.hasApplied&&!x&&p.jsx(Ve,{variant:"primary",size:"lg",className:"w-100 mb-3",onClick:()=>u(!0),children:"Apply Now"}),s.hasApplied&&!x&&p.jsx(Ve,{variant:"success",size:"lg",className:"w-100 mb-3",disabled:!0,children:"Already Applied"}),x&&p.jsxs("div",{className:"mb-3",children:[p.jsx("div",{className:"alert alert-success mb-2 text-center",children:p.jsx("strong",{children:"You're working on this project!"})}),p.jsx(Ve,{variant:"primary",size:"lg",className:"w-100",onClick:()=>e("/dashboard/projects"),children:"Go to Project Dashboard"})]})]}),k&&p.jsx(Ve,{variant:"outline-primary",size:"lg",className:"w-100",onClick:()=>e(`/jobs/${t}/applications`),children:"View Applications"})]})})})]})}),p.jsxs(Qt,{show:c,onHide:()=>u(!1),size:"lg",children:[p.jsx(Qt.Header,{closeButton:!0,children:p.jsxs(Qt.Title,{children:["Apply for ",s.title]})}),p.jsxs(L,{onSubmit:b,children:[p.jsxs(Qt.Body,{children:[p.jsxs(L.Group,{className:"mb-4",children:[p.jsx(L.Label,{children:"Cover Letter"}),p.jsx(L.Control,{as:"textarea",rows:6,name:"coverLetter",value:d,onChange:w,placeholder:"Introduce yourself and explain why you're a great fit for this position...",required:!0})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Expected Rate"}),p.jsxs(DT,{children:[p.jsx(L.Control,{type:"number",name:"expectedRate.amount",value:f.amount,onChange:w,min:s.salary.min,max:s.salary.max,required:!0}),p.jsx(DT.Text,{children:f.currency})]})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Currency"}),p.jsxs(L.Control,{as:"select",name:"expectedRate.currency",value:f.currency,onChange:w,required:!0,children:[p.jsx("option",{value:"USD",children:"USD"}),p.jsx("option",{value:"EUR",children:"EUR"}),p.jsx("option",{value:"GBP",children:"GBP"}),p.jsx("option",{value:"INR",children:"INR"})]})]})})]})]}),p.jsxs(Qt.Footer,{children:[p.jsx(Ve,{variant:"secondary",onClick:()=>u(!1),children:"Cancel"}),p.jsx(Ve,{type:"submit",variant:"primary",disabled:a,children:a?p.jsxs(p.Fragment,{children:[p.jsx(ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Submitting..."]}):"Submit Application"})]})]})]})]})}function jj(){const{id:t}=yd(),e=Dr(),{user:n}=Hs(),[s,r]=S.useState(!0),[o,i]=S.useState(null),[a,l]=S.useState([]);S.useEffect(()=>{c()},[t]);const c=async()=>{try{const f=await We.get(`/jobs/${t}`);i(f.data);const m=await We.get(`/jobs/${t}/applications`);l(m.data)}catch(f){console.error("Error fetching job applications:",f),bt.error("Failed to load applications"),e("/dashboard/projects")}finally{r(!1)}},u=async f=>{try{await We.put(`/jobs/${t}/applications/${f}/status`,{status:"accepted"}),bt.success("Application accepted"),c()}catch(m){console.error("Error accepting application:",m),bt.error("Failed to accept application")}},d=async f=>{try{await We.put(`/jobs/${t}/applications/${f}/status`,{status:"rejected"}),bt.success("Application rejected"),c()}catch(m){console.error("Error rejecting application:",m),bt.error("Failed to reject application")}},h=f=>{const m={pending:"warning",accepted:"success",rejected:"danger"};return p.jsx(Zs,{bg:m[f]||"secondary",children:f})};return s?p.jsx(Kt,{className:"py-5",children:p.jsx("div",{className:"text-center",children:p.jsx("div",{className:"spinner-border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):p.jsxs(Kt,{className:"py-5",children:[p.jsxs("div",{className:"d-flex align-items-center mb-4",children:[p.jsx(Ve,{variant:"link",className:"p-0 me-3",onClick:()=>e(-1),children:p.jsx(dL,{size:24})}),p.jsxs("div",{children:[p.jsxs("h2",{className:"mb-0",children:["Applications for ",o==null?void 0:o.title]}),p.jsxs("p",{className:"text-muted mb-0",children:[a.length," application",a.length!==1?"s":""]})]})]}),p.jsx(be,{children:p.jsx(be.Body,{children:a.length===0?p.jsx("div",{className:"text-center py-4",children:p.jsx("p",{className:"text-muted mb-0",children:"No applications yet"})}):p.jsxs(bf,{responsive:!0,hover:!0,children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Freelancer"}),p.jsx("th",{children:"Cover Letter"}),p.jsx("th",{children:"Expected Rate"}),p.jsx("th",{children:"Status"}),p.jsx("th",{children:"Applied On"}),p.jsx("th",{children:"Actions"})]})}),p.jsx("tbody",{children:a.map(f=>{var m,g,y;return p.jsxs("tr",{children:[p.jsxs("td",{children:[p.jsxs("div",{className:"font-semibold",children:[(m=f.freelancer)==null?void 0:m.firstName," ",(g=f.freelancer)==null?void 0:g.lastName]}),p.jsx("small",{className:"text-muted",children:(y=f.freelancer)==null?void 0:y.email})]}),p.jsx("td",{children:p.jsxs("div",{style:{maxWidth:"300px"},children:[f.coverLetter.substring(0,100),f.coverLetter.length>100?"...":""]})}),p.jsxs("td",{children:[f.expectedRate.currency," ",f.expectedRate.amount]}),p.jsx("td",{children:h(f.status)}),p.jsx("td",{children:new Date(f.createdAt).toLocaleDateString()}),p.jsx("td",{children:p.jsxs("div",{className:"d-flex gap-2",children:[f.status==="pending"&&p.jsxs(p.Fragment,{children:[p.jsx(Ve,{variant:"success",size:"sm",onClick:()=>u(f._id),title:"Accept Application",children:p.jsx(wf,{size:16})}),p.jsx(Ve,{variant:"danger",size:"sm",onClick:()=>d(f._id),title:"Reject Application",children:p.jsx(yL,{size:16})})]}),p.jsx(Ve,{variant:"primary",size:"sm",onClick:()=>e(`/chat?with=${f.freelancer._id}`),title:"Message Freelancer",children:p.jsx($u,{size:16})})]})})]},f._id)})})]})})})]})}function rue(){const{user:t}=Hs(),e=(t==null?void 0:t.role)==="freelancer";return p.jsx(Kt,{fluid:!0,className:"py-4",children:p.jsxs(ot,{children:[p.jsx(ve,{md:3,lg:2,className:"mb-4",children:p.jsx(be,{children:p.jsx(be.Body,{className:"p-2",children:p.jsxs(zt,{className:"flex-column",children:[p.jsxs(zt.Link,{as:ms,to:"/dashboard",className:"d-flex align-items-center p-3",children:[p.jsx(mL,{size:18,className:"me-3"}),"Overview"]}),p.jsxs(zt.Link,{as:ms,to:"/dashboard/projects",className:"d-flex align-items-center p-3",children:[p.jsx(op,{size:18,className:"me-3"}),e?"My Projects":"Posted Jobs"]}),e&&p.jsxs(zt.Link,{as:ms,to:"/find-projects",className:"d-flex align-items-center p-3",children:[p.jsx(MJ,{size:18,className:"me-3"}),"Find Projects"]}),!e&&p.jsxs(p.Fragment,{children:[p.jsxs(zt.Link,{as:ms,to:"/find-candidates",className:"d-flex align-items-center p-3",children:[p.jsx(a0,{size:18,className:"me-3"}),"Find Candidates"]}),p.jsxs(zt.Link,{as:ms,to:"/dashboard/post-job",className:"d-flex align-items-center p-3",children:[p.jsx(AJ,{size:18,className:"me-3"}),"Post Job"]})]}),p.jsxs(zt.Link,{as:ms,to:"/dashboard/messages",className:"d-flex align-items-center p-3",children:[p.jsx($u,{size:18,className:"me-3"}),"Messages"]}),p.jsxs(zt.Link,{as:ms,to:"/dashboard/payments",className:"d-flex align-items-center p-3",children:[p.jsx(hL,{size:18,className:"me-3"}),"Payments"]}),p.jsxs(zt.Link,{as:ms,to:"/dashboard/profile",className:"d-flex align-items-center p-3",children:[p.jsx(PJ,{size:18,className:"me-3"}),"Profile"]})]})})})}),p.jsx(ve,{md:9,lg:10,children:p.jsxs(WP,{children:[p.jsx(ln,{index:!0,element:p.jsx(GJ,{})}),p.jsx(ln,{path:"projects",element:p.jsx(qJ,{})}),p.jsx(ln,{path:"projects/:id",element:p.jsx(Lj,{})}),p.jsx(ln,{path:"projects/:id/edit",element:p.jsx(CR,{})}),p.jsx(ln,{path:"projects/:id/milestones",element:p.jsx(Mj,{})}),p.jsx(ln,{path:"projects/:id/applications",element:p.jsx(jj,{})}),p.jsx(ln,{path:"messages",element:p.jsx(KJ,{})}),p.jsx(ln,{path:"payments",element:p.jsx(Wte,{})}),p.jsx(ln,{path:"profile",element:p.jsx(Vte,{})}),!e&&p.jsx(ln,{path:"post-job",element:p.jsx(CR,{})})]})})]})})}function oue(){const[t,e]=S.useState([]),[n,s]=S.useState(!0),[r,o]=S.useState({keyword:"",location:"",type:"",salary:""});S.useEffect(()=>{(async()=>{try{s(!0);const l=await We.get("/jobs");e(l.data)}catch(l){console.error("Error fetching jobs:",l),xe.error("Failed to load projects. Please try again.")}finally{s(!1)}})()},[]);const i=a=>{o({...r,[a.target.name]:a.target.value})};return p.jsxs(Kt,{className:"py-8",children:[p.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Find Projects"}),p.jsx(be,{className:"mb-6",children:p.jsx(be.Body,{children:p.jsxs(ot,{children:[p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Keyword"}),p.jsxs("div",{className:"relative",children:[p.jsx(i0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),p.jsx(L.Control,{type:"text",name:"keyword",placeholder:"Job title or keyword",value:r.keyword,onChange:i,className:"pl-10"})]})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Location"}),p.jsxs("div",{className:"relative",children:[p.jsx(Qa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),p.jsx(L.Control,{type:"text",name:"location",placeholder:"City or remote",value:r.location,onChange:i,className:"pl-10"})]})]})}),p.jsx(ve,{md:2,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Type"}),p.jsxs(L.Select,{name:"type",value:r.type,onChange:i,children:[p.jsx("option",{value:"",children:"All Types"}),p.jsx("option",{value:"full-time",children:"Full Time"}),p.jsx("option",{value:"part-time",children:"Part Time"}),p.jsx("option",{value:"contract",children:"Contract"}),p.jsx("option",{value:"freelance",children:"Freelance"})]})]})}),p.jsx(ve,{md:2,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Salary Range"}),p.jsxs(L.Select,{name:"salary",value:r.salary,onChange:i,children:[p.jsx("option",{value:"",children:"Any Range"}),p.jsx("option",{value:"0-25000",children:"$0 - $25,000"}),p.jsx("option",{value:"25000-50000",children:"$25,000 - $50,000"}),p.jsx("option",{value:"50000-75000",children:"$50,000 - $75,000"}),p.jsx("option",{value:"75000+",children:"$75,000+"})]})]})})]})})}),p.jsx(ot,{children:t.map(a=>{var l,c;return p.jsx(ve,{md:6,lg:4,className:"mb-4",children:p.jsx(be,{className:"h-100 hover:shadow-lg transition-shadow",children:p.jsxs(be.Body,{children:[p.jsxs("div",{className:"flex items-center justify-between mb-3",children:[p.jsx("span",{className:`badge ${a.type==="full-time"?"bg-primary":"bg-secondary"}`,children:a.type}),a.isRemote&&p.jsx("span",{className:"badge bg-success",children:"Remote"})]}),p.jsx(be.Title,{className:"font-bold mb-2",children:a.title}),p.jsxs(be.Subtitle,{className:"mb-2 text-gray-600",children:[(l=a.employer)==null?void 0:l.firstName," ",(c=a.employer)==null?void 0:c.lastName]}),p.jsxs("div",{className:"mb-3 text-gray-600",children:[p.jsxs("div",{className:"flex items-center mb-1",children:[p.jsx(Qa,{size:16,className:"mr-2"}),p.jsx("span",{children:a.location})]}),p.jsxs("div",{className:"flex items-center mb-1",children:[p.jsx(op,{size:16,className:"mr-2"}),p.jsx("span",{children:a.category})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(o0,{size:16,className:"mr-2"}),p.jsxs("span",{children:["$",a.salary.min," - $",a.salary.max]})]})]}),p.jsx("div",{className:"mt-3",children:p.jsx(Ve,{variant:"primary",href:`/jobs/${a._id}`,className:"w-100",children:"View Details"})})]})})},a._id)})})]})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iue=1e-7,aue=1e-4;class Bj{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class z2{refCount(e){return pr("refCount")}incRef(e){return pr("incRef")}timerAvailable(){return!0}time(e){return pr("time")}read(e){return pr("read")}readSync(e){return pr("readSync")}readToGPU(e,n){return pr("readToGPU")}numDataIds(){return pr("numDataIds")}disposeData(e,n){return pr("disposeData")}write(e,n,s){return pr("write")}move(e,n,s,r,o){return pr("move")}createTensorFromGPUData(e,n,s){return pr("createTensorFromGPUData")}memory(){return pr("memory")}floatPrecision(){return pr("floatPrecision")}epsilon(){return this.floatPrecision()===32?iue:aue}dispose(){return pr("dispose")}}function pr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,su(t,e,n)}function pc(t,e,n){return Math.max(t,Math.min(e,n))}function U2(t){return t%2===0?t:t+1}function su(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function cue(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function T(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function V2(t,e,n=""){T(Rt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function zj(t){T(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ie(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Rt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Qu(t){return t%1===0}function _C(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Au(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function _D(t,e=r=>0,n,s){return new Promise((r,o)=>{let i=0;const a=()=>{if(t()){r();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function Uj(t,e){let n=1,s=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function ft(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),T(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),T(t.every(s=>Qu(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function ml(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||r?null:ft(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function ws(t,e){return gn(t,e)}function gn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function uue(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function due(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function Vj(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Hx(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function hue(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function ap(t){return typeof t=="string"||t instanceof String}function fue(t){return typeof t=="boolean"}function MC(t){return typeof t=="number"}function $d(t){return Array.isArray(t)?$d(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":MC(t)?"float32":ap(t)?"string":fue(t)?"bool":"float32"}function LC(t){return!!(t&&t.constructor&&t.call&&t.apply)}function jC(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Be(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function Wj(t,e,n,s=!1){const r=new Array;if(e.length===1){const o=e[0]*(s?2:1);for(let i=0;i<o;i++)r[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<o;l++)r[l]=Wj(t+l*a,i,n,s)}return r}function zo(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,o)=>r*o)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return Wj(0,t,e,n)}function pue(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function W2(t,e){const n=Cs(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Cs(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function Hj(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return zo(t,new Float32Array(n));if(e==="int32")return zo(t,new Int32Array(n));if(e==="bool")return zo(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function ca(t){t.forEach(e=>{T(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function vi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Id(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function H2(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MD="tfjsflags";class mue{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=gue,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(H2(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);MD in e&&e[MD].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=yue(r,o)})}}function gue(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(xue(e,s[0],s[1]),s.join("="))),e}function xue(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function yue(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function se(){return Gj}let Gj=null;function vue(t){Gj=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let F1;function qj(){if(F1==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");F1=t}return F1}function bue(){const t=qj();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function G2(t,e){const n=bue();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const $0="Abs",lp="Acos",cp="Acosh",Td="Add",q2="AddN",K2="All",X2="Any",I0="ArgMax",T0="ArgMin",up="Asin",dp="Asinh",hp="Atan",fp="Atanh",pp="Atan2",R0="AvgPool",Y2="AvgPoolGrad",A0="AvgPool3D",J2="AvgPool3DGrad",D0="BatchMatMul",O0="BatchToSpaceND",Z2="Bincount",Q2="BitwiseAnd",wue="BroadcastTo",Kj="BroadcastArgs",mp="Cast",gp="Ceil",xp="ClipByValue",eN="Complex",F0="ComplexAbs",P0="Concat",_0="Conv2D",tN="Conv2DBackpropFilter",M0="Conv2DBackpropInput",L0="Conv3D",nN="Conv3DBackpropFilterV2",sN="Conv3DBackpropInputV2",yp="Cos",vp="Cosh",rN="Cumprod",j0="Cumsum",oN="CropAndResize",iN="DenseBincount",aN="DepthToSpace",B0="DepthwiseConv2dNative",lN="DepthwiseConv2dNativeBackpropFilter",cN="DepthwiseConv2dNativeBackpropInput",Xj="Diag",z0="Dilation2D",BC="Dilation2DBackpropInput",zC="Dilation2DBackpropFilter",Cue="Draw",bp="RealDiv",uN="Einsum",wp="Elu",dN="EluGrad",Cp="Erf",U0="Equal",Sp="Exp",V0="ExpandDims",kp="Expm1",hN="FFT",fN="Fill",pN="FlipLeftRight",Np="Floor",Ep="FloorDiv",W0="FusedBatchNorm",H0="GatherV2",Yj="GatherNd",G0="Greater",$p="GreaterEqual",Ip="Identity",mN="IFFT",gN="Imag",Tp="IsFinite",Rp="IsInf",Ap="IsNan",q0="LeakyRelu",K0="Less",X0="LessEqual",Jj="LinSpace",Dp="Log",Op="Log1p",Y0="LogicalAnd",J0="LogicalNot",Z0="LogicalOr",Sue="LogSoftmax",Q0="LRN",xN="LRNGrad",ev="Max",Fp="Maximum",tv="MaxPool",yN="MaxPoolGrad",nv="MaxPool3D",vN="MaxPool3DGrad",Zj="MaxPoolWithArgmax",sv="Mean",rv="Min",Pp="Minimum",ov="MirrorPad",_p="Mod",Qj="Multinomial",Mp="Multiply",iv="Neg",av="NotEqual",bN="NonMaxSuppressionV3",wN="NonMaxSuppressionV4",CN="NonMaxSuppressionV5",lv="OnesLike",cv="OneHot",uv="Pack",dv="PadV2",Lp="Pow",hv="Prelu",fv="Prod",eB="RaggedGather",tB="RaggedRange",nB="RaggedTensorToTensor",SN="Range",kN="Real",jp="Reciprocal",Bp="Relu",pv="Reshape",mv="ResizeNearestNeighbor",NN="ResizeNearestNeighborGrad",gv="ResizeBilinear",EN="ResizeBilinearGrad",zp="Relu6",xv="Reverse",Up="Round",Vp="Rsqrt",sB="ScatterNd",rB="TensorScatterUpdate",oB="SearchSorted",yv="Select",Wp="Selu",vv="Slice",Hp="Sin",Gp="Sinh",qp="Sign",Kp="Sigmoid",Xp="Softplus",Yp="Sqrt",bv="Sum",wv="SpaceToBatchND",Cv="SplitV",Sv="Softmax",iB="SparseFillEmptyRows",aB="SparseReshape",lB="SparseSegmentMean",cB="SparseSegmentSum",uB="SparseToDense",Jp="SquaredDifference",$N="Square",IN="StaticRegexReplace",TN="StridedSlice",dB="StringNGrams",hB="StringSplit",fB="StringToHashBucketFast",Zp="Sub",Qp="Tan",em="Tanh",tm="Tile",RN="TopK",AN="Transform",Du="Transpose",DN="Unique",kv="Unpack",Nv="UnsortedSegmentSum",Ev="ZerosLike",nm="Step",kue="FromPixels",ON="RotateWithOffset",Gx="_FusedMatMul",qx="FusedConv2D",pB="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jr(...t){se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(...t)}function Nue(...t){se().getBool("IS_TEST")||se().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kx=G2("kernelRegistry",()=>new Map),UC=G2("gradRegistry",()=>new Map);function LD(t,e){const n=gB(t,e);return Kx.get(n)}function jD(t){return UC.get(t)}function BD(t){const e=Kx.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[o,i]=r,[a]=o.split("_");a===t&&n.push(i)}return n}function mB(t){const{kernelName:e,backendName:n}=t,s=gB(e,n);Kx.has(s)&&jr(`The kernel '${e}' for backend '${n}' is already registered`),Kx.set(s,t)}function Eue(t){const{kernelName:e}=t;UC.has(e)&&se().getBool("DEBUG")&&jr(`Overriding the gradient for '${e}'`),UC.set(e,t)}function gB(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xB(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var yB=Yt,fo=null;try{fo=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Yt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Yt.prototype.__isLong__;Object.defineProperty(Yt.prototype,"__isLong__",{value:!0});function Pr(t){return(t&&t.__isLong__)===!0}Yt.isLong=Pr;var zD={},UD={};function Fc(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=UD[t],s)?s:(n=Jt(t,(t|0)<0?-1:0,!0),r&&(UD[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=zD[t],s)?s:(n=Jt(t,t<0?-1:0,!1),r&&(zD[t]=n),n))}Yt.fromInt=Fc;function po(t,e){if(isNaN(t))return e?Wl:mo;if(e){if(t<0)return Wl;if(t>=vB)return CB}else{if(t<=-9223372036854776e3)return br;if(t+1>=Iue)return wB}return t<0?po(-t,e).neg():Jt(t%ed|0,t/ed|0,e)}Yt.fromNumber=po;function Jt(t,e,n){return new Yt(t,e,n)}Yt.fromBits=Jt;var Xx=Math.pow;function FN(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return mo;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return FN(t.substring(1),e,n).neg();for(var r=po(Xx(n,8)),o=mo,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var c=po(Xx(n,a));o=o.mul(c).add(po(l))}else o=o.mul(r),o=o.add(po(l))}return o.unsigned=e,o}Yt.fromString=FN;function Xo(t,e){return typeof t=="number"?po(t,e):typeof t=="string"?FN(t,e):Jt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Yt.fromValue=Xo;var VD=65536,$ue=1<<24,ed=VD*VD,vB=ed*ed,Iue=vB/2,WD=Fc($ue),mo=Fc(0);Yt.ZERO=mo;var Wl=Fc(0,!0);Yt.UZERO=Wl;var bu=Fc(1);Yt.ONE=bu;var bB=Fc(1,!0);Yt.UONE=bB;var VC=Fc(-1);Yt.NEG_ONE=VC;var wB=Jt(-1,2147483647,!1);Yt.MAX_VALUE=wB;var CB=Jt(-1,-1,!0);Yt.MAX_UNSIGNED_VALUE=CB;var br=Jt(0,-2147483648,!1);Yt.MIN_VALUE=br;var ke=Yt.prototype;ke.toInt=function(){return this.unsigned?this.low>>>0:this.low};ke.toNumber=function(){return this.unsigned?(this.high>>>0)*ed+(this.low>>>0):this.high*ed+(this.low>>>0)};ke.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(br)){var n=po(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=po(Xx(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),c=i.sub(l.mul(o)).toInt()>>>0,u=c.toString(e);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};ke.getHighBits=function(){return this.high};ke.getHighBitsUnsigned=function(){return this.high>>>0};ke.getLowBits=function(){return this.low};ke.getLowBitsUnsigned=function(){return this.low>>>0};ke.getNumBitsAbs=function(){if(this.isNegative())return this.eq(br)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ke.isZero=function(){return this.high===0&&this.low===0};ke.eqz=ke.isZero;ke.isNegative=function(){return!this.unsigned&&this.high<0};ke.isPositive=function(){return this.unsigned||this.high>=0};ke.isOdd=function(){return(this.low&1)===1};ke.isEven=function(){return(this.low&1)===0};ke.equals=function(e){return Pr(e)||(e=Xo(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ke.eq=ke.equals;ke.notEquals=function(e){return!this.eq(e)};ke.neq=ke.notEquals;ke.ne=ke.notEquals;ke.lessThan=function(e){return this.comp(e)<0};ke.lt=ke.lessThan;ke.lessThanOrEqual=function(e){return this.comp(e)<=0};ke.lte=ke.lessThanOrEqual;ke.le=ke.lessThanOrEqual;ke.greaterThan=function(e){return this.comp(e)>0};ke.gt=ke.greaterThan;ke.greaterThanOrEqual=function(e){return this.comp(e)>=0};ke.gte=ke.greaterThanOrEqual;ke.ge=ke.greaterThanOrEqual;ke.compare=function(e){if(Pr(e)||(e=Xo(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ke.comp=ke.compare;ke.negate=function(){return!this.unsigned&&this.eq(br)?br:this.not().add(bu)};ke.neg=ke.negate;ke.add=function(e){Pr(e)||(e=Xo(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=o+c,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+i,u&=65535,Jt(h<<16|f,u<<16|d,this.unsigned)};ke.subtract=function(e){return Pr(e)||(e=Xo(e)),this.add(e.neg())};ke.sub=ke.subtract;ke.multiply=function(e){if(this.isZero())return mo;if(Pr(e)||(e=Xo(e)),fo){var n=fo.mul(this.low,this.high,e.low,e.high);return Jt(n,fo.get_high(),this.unsigned)}if(e.isZero())return mo;if(this.eq(br))return e.isOdd()?br:mo;if(e.eq(br))return this.isOdd()?br:mo;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(WD)&&e.lt(WD))return po(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,m=0;return m+=i*u,f+=m>>>16,m&=65535,f+=o*u,h+=f>>>16,f&=65535,f+=i*c,h+=f>>>16,f&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,h+=i*l,d+=h>>>16,h&=65535,d+=s*u+r*c+o*l+i*a,d&=65535,Jt(f<<16|m,d<<16|h,this.unsigned)};ke.mul=ke.multiply;ke.divide=function(e){if(Pr(e)||(e=Xo(e)),e.isZero())throw Error("division by zero");if(fo){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?fo.div_u:fo.div_s)(this.low,this.high,e.low,e.high);return Jt(n,fo.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Wl:mo;var s,r,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Wl;if(e.gt(this.shru(1)))return bB;o=Wl}else{if(this.eq(br)){if(e.eq(bu)||e.eq(VC))return br;if(e.eq(br))return bu;var i=this.shr(1);return s=i.div(e).shl(1),s.eq(mo)?e.isNegative()?bu:VC:(r=this.sub(e.mul(s)),o=s.add(r.div(e)),o)}else if(e.eq(br))return this.unsigned?Wl:mo;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=mo}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:Xx(2,a-48),c=po(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=po(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=bu),o=o.add(c),r=r.sub(u)}return o};ke.div=ke.divide;ke.modulo=function(e){if(Pr(e)||(e=Xo(e)),fo){var n=(this.unsigned?fo.rem_u:fo.rem_s)(this.low,this.high,e.low,e.high);return Jt(n,fo.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ke.mod=ke.modulo;ke.rem=ke.modulo;ke.not=function(){return Jt(~this.low,~this.high,this.unsigned)};ke.and=function(e){return Pr(e)||(e=Xo(e)),Jt(this.low&e.low,this.high&e.high,this.unsigned)};ke.or=function(e){return Pr(e)||(e=Xo(e)),Jt(this.low|e.low,this.high|e.high,this.unsigned)};ke.xor=function(e){return Pr(e)||(e=Xo(e)),Jt(this.low^e.low,this.high^e.high,this.unsigned)};ke.shiftLeft=function(e){return Pr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Jt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Jt(0,this.low<<e-32,this.unsigned)};ke.shl=ke.shiftLeft;ke.shiftRight=function(e){return Pr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Jt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Jt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ke.shr=ke.shiftRight;ke.shiftRightUnsigned=function(e){if(Pr(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return Jt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Jt(n,0,this.unsigned):Jt(n>>>e-32,0,this.unsigned)};ke.shru=ke.shiftRightUnsigned;ke.shr_u=ke.shiftRightUnsigned;ke.toSigned=function(){return this.unsigned?Jt(this.low,this.high,!1):this};ke.toUnsigned=function(){return this.unsigned?this:Jt(this.low,this.high,!0)};ke.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ke.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ke.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Yt.fromBytes=function(e,n,s){return s?Yt.fromBytesLE(e,n):Yt.fromBytesBE(e,n)};Yt.fromBytesLE=function(e,n){return new Yt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Yt.fromBytesBE=function(e,n){return new Yt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const SB=dd(yB),Tue=bF({__proto__:null,default:SB},[yB]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fl=SB||Tue;function $v(t){return Fl.fromString(t,!0,16)}const kB=$v("c3a5c85c97cb3127"),Dl=$v("b492b66fbe98f273"),Ms=$v("9ae16a3b2f90404f");function WC(t){return t.xor(t.shru(47))}function NB(t,e,n){const s=t.slice(e,e+n);return Fl.fromBytes(Array.from(s),!0,!0)}function Ut(t,e){return NB(t,e,8)}function HD(t,e){return NB(t,e,4)}function Gn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Ga(t,e,n=$v("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function Rue(t,e,n,s,r,o){r=r.add(t),o=Gn(o.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(n),o=o.add(Gn(r,44)),[r.add(s),o.add(i)]}function lg(t,e,n,s){return Rue(Ut(t,e),Ut(t,e+8),Ut(t,e+16),Ut(t,e+24),n,s)}function Aue(t,e=t.length){if(e>=8){const n=Ms.add(e*2),s=Ut(t,0).add(Ms),r=Ut(t,e-8),o=Gn(r,37).mul(n).add(s),i=Gn(s,25).add(r).mul(n);return Ga(o,i,n)}if(e>=4){const n=Ms.add(e*2),s=HD(t,0);return Ga(s.shl(3).add(e),HD(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],o=n+(s<<8),i=e+(r<<2);return WC(Ms.mul(o).xor(kB.mul(i))).mul(Ms)}return Ms}function Due(t,e=t.length){const n=Ms.add(e*2),s=Ut(t,0).mul(Dl),r=Ut(t,8),o=Ut(t,e-8).mul(n),i=Ut(t,e-16).mul(Ms);return Ga(Gn(s.add(r),43).add(Gn(o,30)).add(i),s.add(Gn(r.add(Ms),18)).add(o),n)}function Oue(t,e=t.length){const n=Ms.add(e*2),s=Ut(t,0).mul(Ms),r=Ut(t,8),o=Ut(t,e-8).mul(n),i=Ut(t,e-16).mul(Ms),a=Gn(s.add(r),43).add(Gn(o,30)).add(i),l=Ga(a,s.add(Gn(r.add(Ms),18)).add(o),n),c=Ut(t,16).mul(n),u=Ut(t,24),d=a.add(Ut(t,e-32)).mul(n),h=l.add(Ut(t,e-24)).mul(n);return Ga(Gn(c.add(u),43).add(Gn(d,30)).add(h),c.add(Gn(u.add(s),18)).add(d),n)}function Fue(t,e=t.length){const n=Fl.fromNumber(81,!0);if(e<=32)return e<=16?Aue(t,e):Due(t,e);if(e<=64)return Oue(t,e);let s=n,r=n.mul(Dl).add(113),o=WC(r.mul(Ms).add(113)).mul(Ms),i=[Fl.UZERO,Fl.UZERO],a=[Fl.UZERO,Fl.UZERO];s=s.mul(Ms).add(Ut(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=Gn(s.add(r).add(i[0]).add(Ut(t,l+8)),37).mul(Dl),r=Gn(r.add(i[1]).add(Ut(t,l+48)),42).mul(Dl),s=s.xor(a[1]),r=r.add(i[0]).add(Ut(t,l+40)),o=Gn(o.add(a[0]),33).mul(Dl),i=lg(t,l,i[1].mul(Dl),s.add(a[0])),a=lg(t,l+32,o.add(a[1]),r.add(Ut(t,l+16))),[o,s]=[s,o],l+=64;while(l!==c);const d=Dl.add(o.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=Gn(s.add(r).add(i[0]).add(Ut(t,l+8)),37).mul(d),r=Gn(r.add(i[1]).add(Ut(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(i[0].mul(9).add(Ut(t,l+40))),o=Gn(o.add(a[0]),33).mul(d),i=lg(t,l,i[1].mul(d),s.add(a[0])),a=lg(t,l+32,o.add(a[1]),r.add(Ut(t,l+16))),[o,s]=[s,o],Ga(Ga(i[0],a[0],d).add(WC(r).mul(kB)).add(o),Ga(i[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gl(t,e){return e==="string"?qa(t):Pc([t],e)}function Pue(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Pc(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=mc(t)),se().getBool("DEBUG")&&uue(t,e),Pue(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Qs(){return se().platform.now()}function qa(t,e="utf-8"){return e=e||"utf-8",se().platform.encode(t,e)}function nl(t,e="utf-8"){return e=e||"utf-8",se().platform.decode(t,e)}function So(t){return se().platform.isTypedArray!=null?se().platform.isTypedArray(t):xB(t)}function mc(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||H2(t)||t==null||So(t)&&n)e.push(t);else if(Array.isArray(t)||So(t))for(let s=0;s<t.length;++s)mc(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)mc(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ue{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Lue)}profileKernel(e,n,s){let r;const o=()=>{r=s()};let i;const a=Qs();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const c of r)c.dataSync();i=Promise.resolve({kernelMs:Qs()-a})}if(se().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{Mue(d,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:o,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),r,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function Mue(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class Lue{logKernelProfile(e,n,s,r,o,i){const a=typeof r=="number"?Au(`${r}ms`,9):r.error,l=Au(e,25),c=n.rank,u=n.size,d=Au(n.shape.toString(),14);let h="";for(const f in o){const m=o[f];if(m!=null){const g=m.shape||n.shape,y=g.length;h+=`${f}: ${y}D ${y>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jue(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let m=0;m<e.length;m++)if(s[h.id]){c.outputs.forEach(g=>s[g.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(o[c.outputs[d].id]){for(const h in u)o[u[h].id]=!0,i[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&i[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];s[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function Bue(t,e,n,s){for(let r=e.length-1;r>=0;r--){const o=e[r],i=[];if(o.outputs.forEach(l=>{const c=t[l.id];c!=null?i.push(c):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=o.inputs[l];if(!Rt(c.shape,u.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GD=20,lh=3,P1=7;function zue(t,e,n,s){const r=Be(e),o=Uue(t,e,n,r),i=e.length,a=Gg(t,e,n,r,o),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Uue(t,e,n,s){const r=ie(e),o=s[s.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?bh(t):t;if(a>1)for(let c=0;c<r/o;c++){const u=c*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],vh(l[u+d],0,n).length)}return i}function vh(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(P1))} + ${parseFloat(t[1].toFixed(P1))}j`:ap(t)?s=`'${t}'`:n==="bool"?s=EB(t):s=parseFloat(t.toFixed(P1)).toString(),Au(s,e)}function EB(t){return t===0?"false":"true"}function Gg(t,e,n,s,r,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=bh(t);return[vh(g[0],0,n)]}return n==="bool"?[EB(t[0])]:[t[0].toString()]}if(l===1){if(a>GD){const y=lh*i;let x=Array.from(t.slice(0,y)),v=Array.from(t.slice((a-lh)*i,a*i));return n==="complex64"&&(x=bh(x),v=bh(v)),["["+x.map((b,w)=>vh(b,r[w],n)).join(", ")+", ..., "+v.map((b,w)=>vh(b,r[a-lh+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?bh(t):Array.from(t)).map((y,x)=>vh(y,r[x],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),d=s[0]*i,h=[];if(a>GD){for(let g=0;g<lh;g++){const y=g*d,x=y+d;h.push(...Gg(t.slice(y,x),c,n,u,r,!1))}h.push("...");for(let g=a-lh;g<a;g++){const y=g*d,x=y+d;h.push(...Gg(t.slice(y,x),c,n,u,r,g===a-1))}}else for(let g=0;g<a;g++){const y=g*d,x=y+d;h.push(...Gg(t.slice(y,x),c,n,u,r,g===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let g=1;g<h.length-1;g++)h[g]=" "+h[g]+f;let m=`,
`;for(let g=2;g<l;g++)m+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":m),h}function bh(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ls{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=ie(e),s!=null){const r=s.length;T(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||gn(n,this.size),this.strides=Be(e)}set(e,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return _o().makeTensor(this.values,this.shape,this.dtype)}}let _o=null,ru=null;function Vue(t){_o=t}function Wue(t){ru=t}class Fn{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=ie(e),this.strides=Be(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return ru.buffer(this.shape,this.dtype,e)}bufferSync(){return ru.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return zo(this.shape,e,this.dtype==="complex64")}arraySync(){return zo(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=_o().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>nl(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),_o().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=_o().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>nl(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await _o().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),_o().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return ru.print(this,e)}clone(){return this.throwIfDisposed(),ru.clone(this)}toString(e=!1){const n=this.dataSync();return zue(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),ru.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),_o().makeVariable(this,e,n,s)}}Object.defineProperty(Fn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function oe(){return G2("Tensor",()=>Fn)}oe();class Yx extends Fn{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Rt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);_o().disposeTensor(this),this.dataId=e.dataId,_o().incRef(this,null)}dispose(){_o().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Yx,Symbol.hasInstance,{value:t=>t instanceof Fn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qD;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(qD||(qD={}));var HC;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(HC||(HC={}));var GC;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(GC||(GC={}));var qC;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(qC||(qC={}));var KC;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(KC||(KC={}));const Hue={float32:qC,int32:HC,bool:GC,complex64:KC};function Tr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Hue[t][e]}function PN(t){return Tr(t,"int32")}function $B(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function IB(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(t,e){if(t.dtype===e.dtype)return[t,e];const n=Tr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function TB(t){const e=[];return RB(t,e,new Set),e}function RB(t,e,n){if(t==null)return;if(t instanceof Fn){e.push(t);return}if(!Gue(t))return;const s=t;for(const r in s){const o=s[r];n.has(o)||(n.add(o),RB(o,e,n))}}function Gue(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1(t){return t.kernelName!=null}class KD{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class td{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new KD}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(jr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new _ue(this.backendInstance),!0}setupRegisteredKernels(){BD(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){BD(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof z2)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,jr(`Initialization of backend ${e} failed`),jr(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return jr(`Initialization of backend ${e} failed`),jr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,o=this.readSync(n),i=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,o,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return td.nextTensorId++}nextVariableId(){return td.nextVariableId++}clone(e){const n=Y.runKernel(Ip,{x:e}),s={x:e},r=i=>({x:()=>{const a="float32",l={x:i},c={dtype:a};return Y.runKernel(mp,l,c)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,o,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(LD(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let o=0;s.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=_1(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(_1(e)){const{kernelName:m,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;const x=LD(m,this.backendName);T(x!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();l=x.kernelFunc({inputs:g,attrs:y,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,v,b);const w=b.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(r){const C=this.getTensorsForGradient(m,g,w);s=this.saveTensorsForBackwardMode(C)}return w}}else{const{forwardFunc:m}=e,g=y=>{r&&(s=y.map(x=>this.keep(this.clone(x))))};a=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>m(this.backend,g));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,y,x),x}}const{inputs:u,attrs:d}=e,h=_1(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(m=>u[m]!=null?u[m].shape:null),outputShapes:n.map(m=>m.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=jD(e);if(r!=null){const o=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=o.map(c=>n[c]);const l=s.filter((c,u)=>i[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=e;s==="string"&&ap(e[0])&&(o=e.map(l=>qa(l)));const i=r.write(o,n,s),a=new Fn(n,s,i,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(i),c=hue(o);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const o={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:o}=e,i=new Fn(r,o,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const o=new Yx(e,n,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Hx(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Yx||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Hx(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:o},l=jD(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],f=Cs(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=TB(e),s=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(e,n,s,r=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));T(o instanceof Fn,()=>"The result y returned by f() must be a tensor.");const i=jue(this.state.activeTape,n,o);if(!r&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=s??que(o.shape),Bue(a,i,c=>this.tidy(c),Kue);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return T(LC(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof Fn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const o=(a,l)=>(s=e(...n,l),T(s.value instanceof Fn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(LC(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];T(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(u.every(h=>h instanceof Fn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Qs(),s=await this.backend.time(e);return s.wallMs=Qs()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new KD;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}td.nextTensorId=0;td.nextVariableId=0;function que(t){const e=W2(ie(t),"float32");return Y.makeTensor(e,t,"float32")}function AB(){const t=qj();if(t._tfengine==null){const e=new mue(t);t._tfengine=new td(e)}return vue(t._tfengine.ENV),Vue(()=>t._tfengine),t._tfengine}const Y=AB();function Kue(t,e){const n={a:t,b:e};return Y.runKernel(Td,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(){return typeof navigator<"u"&&navigator!=null}function DB(t){if(t||Xue()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function OB(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ar=se();ar.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ar.registerFlag("IS_BROWSER",()=>OB());ar.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ar.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ar.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ar.registerFlag("PROD",()=>!1);ar.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ar.getBool("DEBUG"));ar.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ar.registerFlag("IS_TEST",()=>!1);ar.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ar.getBool("DEBUG"));ar.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ar.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ar.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iv(t,e){let n=t;if(So(t))return e==="string"?[]:[t.length];if($B(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(IB(t))return[t.buffer.size/(e==null?4:Hx(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||So(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&se().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&FB(t,s,[]),s}function FB(t,e,n){if(n=n||[],!Array.isArray(t)&&!So(t)){T(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}T(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),T(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)FB(t[r],s,n.concat(r))}function XD(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function M(t,e,n,s="numeric"){if(t instanceof oe())return XD(s,t.dtype,e,n),t;let r=$d(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),XD(s,r,e,n),t==null||!So(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Iv(t,r);!So(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Pc(t,r):mc(t,[],!0);return Y.makeTensor(a,o,r)}function PB(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>M(o,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yue="__op";function Q(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Yue;const r=(...o)=>{Y.startScope(n);try{const i=s(...o);return H2(i)&&console.error("Cannot return a Promise inside of tidy."),Y.endScope(i),i}catch(i){throw Y.endScope(null),i}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(t,e){const n=M(t,"real","complex"),s=M(e,"imag","complex");V2(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return Y.runKernel(eN,r)}const nd=Q({complex_:Jue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tv(t,e,n,s){if(s==null)s=$d(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(IB(t)||$B(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return Y.backend.createTensorFromGPUData(t,e||n,s)}if(!So(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ca(e);const r=ie(e),o=ie(n);T(r===o,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==ie(e.slice(i)):!0;T(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!So(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Pc(t,s):mc(t,[],!0),Y.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _B(t,e,n){const s=Iv(t,n);return Tv(t,e,s,n)}class Rd{static join(e){return new Rd(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>So(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+r.byteLength;this.shards.push({buffer:r,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,o=new ArrayBuffer(r),i=new Uint8Array(o);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,m=Math.min(n,c.end)-c.start,g=new Uint8Array(c.buffer,d,m-d);if(i.set(g,h),a+=g.length,n<c.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=Zue(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function Zue(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,o=e(t[r]);if(o===0)return r;o<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function si(){return Y}function YD(){return Y.memory()}function ee(t,e){return Y.tidy(t,e)}function mt(t){TB(t).forEach(n=>n.dispose())}function bi(t){return Y.keep(t)}function MB(t,e,n=1){return Y.registerBackend(t,e,n)}function Que(){return Y.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JD=4;async function ZD(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<r.length;++i){const a=r[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((y,x)=>y+x.length,0)+JD*h.length,m=new Uint8Array(f);let g=0;for(let y=0;y<h.length;y++){const x=h[y],v=new Uint8Array(new Uint32Array([x.length]).buffer);m.set(v,g),g+=JD,m.set(x,g),g+=x.length}d(m)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const o=await Promise.all(s);return{data:ede(o),specs:n}}function ede(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const _N=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function QD(t){return _N?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function tde(t){if(_N)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function nde(t){if(_N){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function sde(t){return Rd.join(t)}function LB(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:QD(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:QD(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Rd(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fs{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Fs.instance==null&&(Fs.instance=new Fs),Fs.instance}static registerSaveRouter(e){Fs.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Fs.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Fs.getHandlers(e,"save")}static getLoadHandlers(e,n){return Fs.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Fs.getInstance().loadRouters:Fs.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&r.push(a)}),r}}const rde=t=>Fs.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XC="tensorflowjs",YC=1,Hl="models_store",Da="model_info_store";function jB(){if(!se().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function JC(t){const e=t.result;e.createObjectStore(Hl,{keyPath:"modelPath"}),e.createObjectStore(Da,{keyPath:"modelPath"})}class gc{constructor(e){if(this.indexedDB=jB(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const o=this.indexedDB.open(XC,YC);o.onupgradeneeded=()=>JC(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(Hl,"readonly"),c=a.objectStore(Hl).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(i.close(),r(c.error)),a.oncomplete=()=>i.close()}else{n.weightData=Rd.join(n.weightData);const a=LB(n),l=i.transaction(Da,"readwrite");let c=l.objectStore(Da),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;u.onsuccess=()=>{d=i.transaction(Hl,"readwrite");const h=d.objectStore(Hl);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(m){return r(m)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=m=>{c=l.objectStore(Da);const g=c.delete(this.modelPath);g.onsuccess=()=>(i.close(),r(f.error)),g.onerror=y=>(i.close(),r(f.error))}},u.onerror=h=>(i.close(),r(u.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>r(o.error)})}}gc.URL_SCHEME="indexeddb://";const BB=t=>se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(gc.URL_SCHEME)?ode(t.slice(gc.URL_SCHEME.length)):null;Fs.registerSaveRouter(BB);Fs.registerLoadRouter(BB);function ode(t){return new gc(t)}function ide(t){return t.startsWith(gc.URL_SCHEME)?t.slice(gc.URL_SCHEME.length):t}class ade{constructor(){this.indexedDB=jB()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(XC,YC);s.onupgradeneeded=()=>JC(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(Da,"readonly"),a=o.objectStore(Da).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),o.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=ide(e),new Promise((n,s)=>{const r=this.indexedDB.open(XC,YC);r.onupgradeneeded=()=>JC(r),r.onsuccess=()=>{const o=r.result,i=o.transaction(Da,"readwrite"),a=i.objectStore(Da),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=o.transaction(Hl,"readwrite");const f=c.objectStore(Hl).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=m=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),o.close(),s(l.error))}},l.onerror=u=>(o.close(),s(l.error)),i.oncomplete=()=>{c==null?o.close():c.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mi="/",ou="tensorflowjs_models",zB="info",lde="model_topology",cde="weight_specs",ude="weight_data",dde="model_metadata";function UB(t){return{info:[ou,t,zB].join(Mi),topology:[ou,t,lde].join(Mi),weightSpecs:[ou,t,cde].join(Mi),weightData:[ou,t,ude].join(Mi),modelMetadata:[ou,t,dde].join(Mi)}}function VB(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function hde(t){const e=t.split(Mi);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Mi)}function fde(t){return t.startsWith(xc.URL_SCHEME)?t.slice(xc.URL_SCHEME.length):t}class xc{constructor(e){if(!se().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=UB(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=LB(e),o=Rd.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,tde(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw VB(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=nde(i),n}}xc.URL_SCHEME="localstorage://";const WB=t=>se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(xc.URL_SCHEME)?pde(t.slice(xc.URL_SCHEME.length)):null;Fs.registerSaveRouter(WB);Fs.registerLoadRouter(WB);function pde(t){return new xc(t)}class mde{constructor(){T(se().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=ou+Mi,s=Mi+zB;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(n)&&o.endsWith(s)){const i=hde(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=fde(e);const n=UB(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return VB(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eO="://";class ri{constructor(){this.managers={}}static getInstance(){return ri.instance==null&&(ri.instance=new ri),ri.instance}static registerManager(e,n){T(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(eO)&&(e=e.slice(0,e.indexOf(eO))),T(e.length>0,()=>"scheme must not be an empty string.");const s=ri.getInstance();T(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=ri.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ri.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gde{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!se().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return xB(e)}}if(se().get("IS_BROWSER")){se().setPlatform("browser",new gde);try{ri.registerManager(xc.URL_SCHEME,new mde)}catch{}try{ri.registerManager(gc.URL_SCHEME,new ade)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xde={importFetch:()=>require("node-fetch")};let M1;class yde{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return se().global.fetch!=null?se().global.fetch(e,n):(M1==null&&(M1=xde.importFetch()),M1(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}se().get("IS_NODE")&&!se().get("IS_BROWSER")&&se().setPlatform("node",new yde);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ht(t,e="float32",n){return e=e||"float32",ca(t),new ls(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vde(t,e){const n=M(t,"x","cast");if(!due(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return Y.runKernel(mp,s,r)}const $e=Q({cast_:vde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bde(t){const n={x:M(t,"x","clone","string_or_numeric")};return Y.runKernel(Ip,n)}const ec=Q({clone_:bde});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */AB();const Cde={buffer:ht,cast:$e,clone:ec,print:wde};Wue(Cde);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde(t,e){let n=M(t,"a","add"),s=M(e,"b","add");[n,s]=vn(n,s);const r={a:n,b:s};return Y.runKernel(Td,r)}const ge=Q({add_:Sde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kde(t,e){let n=M(t,"a","floorDiv"),s=M(e,"b","floorDiv");[n,s]=vn(n,s);const r={a:n,b:s};return Y.runKernel(Ep,r)}const HB=Q({floorDiv_:kde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t,e){let n=M(t,"a","div"),s=M(e,"b","div");if([n,s]=vn(n,s),n.dtype==="int32"&&s.dtype==="int32")return HB(n,s);const r={a:n,b:s},o={};return Y.runKernel(bp,r,o)}const qe=Q({div_:Nde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ede(t,e){let n=M(t,"a","mul"),s=M(e,"b","mul");[n,s]=vn(n,s);const r={a:n,b:s};return Y.runKernel(Mp,r)}const X=Q({mul_:Ede});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $de(t){const e=M(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return Y.runKernel(F0,n)}else{const n={x:e};return Y.runKernel($0,n)}}const Ps=Q({abs_:$de});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ide(t){const n={x:M(t,"x","acos")};return Y.runKernel(lp,n)}const Tde=Q({acos_:Ide});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rde(t){const n={x:M(t,"x","acosh")};return Y.runKernel(cp,n)}const Ade=Q({acosh_:Rde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dde(t,e=null,n=!1){const r={x:M(t,"x","all","bool")},o={axis:e,keepDims:n};return Y.runKernel(K2,r,o)}const GB=Q({all_:Dde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ode(t,e=null,n=!1){const r={x:M(t,"x","any","bool")},o={axis:e,keepDims:n};return Y.runKernel(X2,r,o)}const ZC=Q({any_:Ode});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fde(t,e=0){const s={x:M(t,"x","argMax")},r={axis:e};return Y.runKernel(I0,s,r)}const Rf=Q({argMax_:Fde});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pde(t,e=0){const s={x:M(t,"x","argMin")},r={axis:e};return Y.runKernel(T0,s,r)}const _de=Q({argMin_:Pde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mde(t){const n={x:M(t,"x","asin")};return Y.runKernel(up,n)}const Lde=Q({asin_:Mde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(t){const n={x:M(t,"x","asinh")};return Y.runKernel(dp,n)}const Bde=Q({asinh_:jde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zde(t){const n={x:M(t,"x","atan")};return Y.runKernel(hp,n)}const Ude=Q({atan_:zde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vde(t,e){let n=M(t,"a","atan2"),s=M(e,"b","atan2");[n,s]=vn(n,s);const r={a:n,b:s};return Y.runKernel(pp,r)}const Wde=Q({atan2_:Vde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hde(t){const n={x:M(t,"x","atanh")};return Y.runKernel(fp,n)}const Gde=Q({atanh_:Hde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sm(t,e,n,s,r="NHWC",o){const i=t[3],a=[...e,i],l=da(r);return us(t,a,n,o,s,null,null,l)}function No(t,e,n,s,r,o,i="channelsLast"){const[a,l]=Af(e);let c;if(i==="channelsLast")c=[a,l,t[3],t[3]];else if(i==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return us(t,c,n,s,r,o,!1,i)}function ua(t,e,n,s,r,o,i="NDHWC"){const[a,l,c]=QC(e);let u,d;if(i==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return xl(t,u,n,s,r,!1,d,o)}function us(t,e,n,s,r,o,i=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,m]=e,[g,y]=Af(n),[x,v]=Af(s),b=Ou(h,x),w=Ou(f,v),{padInfo:C,outHeight:k,outWidth:N}=Xde(r,c,u,g,y,b,w,o,a),E=i?m*d:m;let $;return a==="channelsFirst"?$=[l,E,k,N]:a==="channelsLast"&&($=[l,k,N,E]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:k,outWidth:N,outChannels:E,padInfo:C,strideHeight:g,strideWidth:y,filterHeight:h,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:x,dilationWidth:v,inShape:t,outShape:$,filterShape:e}}function xl(t,e,n,s,r,o=!1,i="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,d,h]=t;else if(i==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[f,m,g,,y]=e,[x,v,b]=QC(n),[w,C,k]=QC(s),N=Ou(f,w),E=Ou(m,C),$=Ou(g,k),{padInfo:I,outDepth:A,outHeight:P,outWidth:_}=Yde(r,c,u,d,x,v,b,N,E,$,a),U=o?y*h:y;let V;return i==="channelsFirst"?V=[l,U,A,P,_]:i==="channelsLast"&&(V=[l,A,P,_,U]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:A,outHeight:P,outWidth:_,outChannels:U,padInfo:I,strideDepth:x,strideHeight:v,strideWidth:b,filterDepth:f,filterHeight:m,filterWidth:g,effectiveFilterDepth:N,effectiveFilterHeight:E,effectiveFilterWidth:$,dilationDepth:w,dilationHeight:C,dilationWidth:k,inShape:t,outShape:V,filterShape:e}}function qde(t,e,n,s,r){s==null&&(s=MN(t,e,n));const o=t[0],i=t[1],a=Df((o-e+2*s)/n+1,r),l=Df((i-e+2*s)/n+1,r);return[a,l]}function Kde(t,e,n,s,r,o){r==null&&(r=MN(t,e[0],s[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(i[a]=Df((t[a]-e[a]+2*r)/s[a]+1,o));return i}function MN(t,e,n,s=1){const r=Ou(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function Af(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function QC(t){return typeof t=="number"?[t,t,t]:t}function Ou(t,e){return e<=1?t:t+(t-1)*(e-1)}function Xde(t,e,n,s,r,o,i,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=qde([e,n],o,s,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+o-e),f=Math.max(0,(d-1)*r+i-n),m=Math.floor(h/2),g=h-m,y=Math.floor(f/2),x=f-y;c={top:m,bottom:g,left:y,right:x,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-o+1)/s),d=Math.ceil((n-i+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],m=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:m,right:g,type:h===0&&f===0&&m===0&&g===0?"VALID":"EXPLICIT"},u=Df((e-o+h+f)/s+1,a),d=Df((n-i+m+g)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function Yde(t,e,n,s,r,o,i,a,l,c,u){let d,h,f,m;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=Kde([e,n,s,1],[a,l,c],1,[r,o,i],t,u);h=y[0],f=y[1],m=y[2]}else if(t==="same"){h=Math.ceil(e/r),f=Math.ceil(n/o),m=Math.ceil(s/i);const g=(h-1)*r+a-e,y=(f-1)*o+l-n,x=(m-1)*i+c-s,v=Math.floor(g/2),b=g-v,w=Math.floor(y/2),C=y-w,k=Math.floor(x/2),N=x-k;d={top:w,bottom:C,left:k,right:N,front:v,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:m}}function Df(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function yc(t){const[e,n,s]=Af(t);return e===1&&n===1&&s===1}function ks(t,e){return yc(t)||yc(e)}function vc(t){return Af(t).every(e=>e>0)}function da(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function dr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")T(Qu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{T(Qu(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jde(t,e){const s={x:M(t,"x","reshape","string_or_numeric")},r={shape:e};return Y.runKernel(pv,s,r)}const Z=Q({reshape_:Jde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(t,e,n,s,r){const o=M(t,"x","avgPool","float32"),i=1;T(ks(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),dr("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=Y.runKernel(R0,c,u);return d=$e(d,o.dtype),l?Z(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const LN=Q({avgPool_:Zde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qde(t,e,n,s,r,o="NDHWC"){const i=M(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),T(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),dr("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o};let d=Y.runKernel(A0,c,u);return d=$e(d,a.dtype),l?Z(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const ehe=Q({avgPool3d_:Qde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(t,e=0){T(t.length>=1,()=>"Pass at least one tensor to concat");const n=PB(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return ec(n[0]);const s=n,r={axis:e};return Y.runKernel(P0,s,r)}const or=Q({concat_:the});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(t,e,n=!1,s=!1){let r=M(t,"a","matMul"),o=M(e,"b","matMul");[r,o]=vn(r,o);const i={a:r,b:o},a={transposeA:n,transposeB:s};return Y.runKernel(D0,i,a)}const It=Q({matMul_:nhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function she(t){const n={x:M(t,"x","sigmoid","float32")};return Y.runKernel(Kp,n)}const Ad=Q({sigmoid_:she});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rhe(t,e,n){const s=M(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:e,size:n};return Y.runKernel(vv,r,o)}const Vt=Q({slice_:rhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(t){const n={x:M(t,"x","tanh","float32")};return Y.runKernel(em,n)}const Rv=Q({tanh_:ohe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(t,e,n){const s=M(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);T(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),T(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),T(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const o={x:s},i={blockShape:e,crops:n};return Y.runKernel(O0,o,i)}const jN=Q({batchToSpaceND_:ihe});function ahe(t){let e;return t.rank===0||t.rank===1?e=Z(t,[1,1,1,t.size]):t.rank===2?e=Z(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=Z(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lhe(t,e,n,s,r,o){o==null&&(o=.001);const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let u;s!=null&&(u=M(s,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:ahe(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:o},m=Y.runKernel(W0,h,f);return Z(m,i.shape)}const Av=Q({batchNorm_:lhe});function che(t,e,n,s,r,o){const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let u;return s!=null&&(u=M(s,"offset","batchNorm")),T(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Av(i,a,l,u,c,o)}const uhe=Q({batchNorm2d_:che});function dhe(t,e,n,s,r,o){const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let u;return s!=null&&(u=M(s,"offset","batchNorm")),T(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Av(i,a,l,u,c,o)}const hhe=Q({batchNorm3d_:dhe});function fhe(t,e,n,s,r,o){const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;r!=null&&(c=M(r,"scale","batchNorm"));let u;return s!=null&&(u=M(s,"offset","batchNorm")),T(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Av(i,a,l,u,c,o)}const phe=Q({batchNorm4d_:fhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(t,e,n){const s=M(t,"x","bincount"),r=M(e,"weights","bincount");T(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},i={size:n};return Y.runKernel(Z2,o,i)}const ghe=Q({bincount_:mhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xhe(t,e){let n=M(t,"broadcastTo","x");const s=n.shape;if(ca(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=Z(n,c)}const r=n.shape,o=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])o[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(o.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return ec(n);const a={x:n},l={reps:o};return Y.runKernel(tm,a,l)}const Gh=Q({broadcastTo_:xhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(t){const n={x:M(t,"x","ceil","float32")};return Y.runKernel(gp,n)}const vhe=Q({ceil_:yhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dv(t,e,n){ca(t),n=n||$d(e);const s={shape:t,value:e,dtype:n};return Y.runKernel(fN,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bhe(t,e,n){const s=M(t,"x","clipByValue");if(T(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Dv(s.shape,e,s.dtype);const r={x:s},o={clipValueMin:e,clipValueMax:n};return Y.runKernel(xp,r,o)}const Yr=Q({clipByValue_:bhe});function whe(t){return or(t,0)}const Che=Q({concat1d_:whe});function She(t,e){return or(t,e)}const khe=Q({concat2d_:She});function Nhe(t,e){return or(t,e)}const Ehe=Q({concat3d_:Nhe});function $he(t,e){return or(t,e)}const Ihe=Q({concat4d_:$he});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(t,e,n,s,r="NHWC",o=[1,1],i){const a=M(t,"x","conv2d","float32"),l=M(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),dr("conv2d",s,i);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),T(ks(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(vc(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(vc(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},m=Y.runKernel(_0,h,f);return u?Z(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const bc=Q({conv2d_:The});function Rhe(t,e,n,s,r="NWC",o=1,i){const a=M(t,"x","conv1d"),l=M(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=Z(a,[1,a.shape[0],a.shape[1]])),T(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),dr("conv1d",s,i),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(ks(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),T(vc(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(vc(n),()=>"Error in conv1D: Stride should be larger than 0."),T(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=Z(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=Z(c,[c.shape[0],1,c.shape[1],c.shape[2]]),y=bc(h,d,[1,n],s,"NHWC",[1,o],i);return u?Z(y,[y.shape[2],y.shape[3]]):Z(y,[y.shape[0],y.shape[2],y.shape[3]])}const qB=Q({conv1d_:Rhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(t,e,n,s,r,o="NHWC",i){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];T(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),T(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),dr("conv2dDerInput",r,i);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,inputShape:a},m=Y.runKernel(M0,h,f);return c?Z(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const BN=Q({conv2DBackpropInput_:Ahe});function Dhe(t,e,n,s,r,o){const i=M(t,"x","conv2dTranspose"),a=M(e,"filter","conv2dTranspose");return BN(n,i,a,s,r,"NHWC",o)}const KB=Q({conv2dTranspose_:Dhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(t,e,n,s,r="NDHWC",o=[1,1,1]){const i=M(t,"x","conv3d"),a=M(e,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(ks(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),T(vc(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(vc(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:o},h=Y.runKernel(L0,u,d);return c?Z(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Fhe=Q({conv3d_:Ohe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(t,e,n,s,r){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=Z(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],c=i.shape[4];T(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),T(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:i,filter:n},d={pad:r,strides:s,inputShape:o},h=Y.runKernel(sN,u,d);return a?Z(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const XB=Q({conv3DBackpropInput_:Phe});function _he(t,e,n,s,r){const o=M(t,"x","conv3dTranspose"),i=M(e,"filter","conv3dTranspose");return XB(n,o,i,s,r)}const Mhe=Q({conv3dTranspose_:_he});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lhe(t){const n={x:M(t,"x","cos","float32")};return Y.runKernel(yp,n)}const zN=Q({cos_:Lhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jhe(t){const n={x:M(t,"x","cosh","float32")};return Y.runKernel(vp,n)}const YB=Q({cosh_:jhe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(t,e=0,n=!1,s=!1){const o={x:M(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return Y.runKernel(rN,o,i)}const eS=Q({cumprod_:Bhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(t,e=0,n=!1,s=!1){const o={x:M(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return Y.runKernel(j0,o,i)}const JB=Q({cumsum_:zhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uhe(t,e,n,s=!1){const r=M(t,"x","denseBincount"),o=M(e,"weights","denseBincount");T(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),T(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},a={size:n,binaryOutput:s};return Y.runKernel(iN,i,a)}const tO=Q({denseBincount_:Uhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(t,e,n="NHWC"){const s=M(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],o=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];T(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),T(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),T(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${s.shape}`),T(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return Y.runKernel(aN,a,l)}const Whe=Q({depthToSpace_:Vhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(t,e,n,s,r="NHWC",o=[1,1],i){const a=M(t,"x","depthwiseConv2d","float32"),l=M(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),dr("depthwiseConv2d",s,i);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},m=Y.runKernel(B0,h,f);return u?Z(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const UN=Q({depthwiseConv2d_:Hhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t,e,n,s,r=[1,1],o="NHWC"){const i=M(t,"x","dilation2d"),a=M(e,"filter","dilation2d");T(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,c=!1;i.rank===3&&(l=Z(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=Y.runKernel(z0,u,d);return c?Z(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const qhe=Q({dilation2d_:Ghe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sd(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const o=n-1-r,i=t[o]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(o)}return s}function zn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],o=e.length-s-1,i=e[o];(r==null||r===1&&i>1)&&n.unshift(o)}return n}function nt(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let o=t[t.length-r-1];o==null&&(o=1);let i=e[e.length-r-1];if(i==null&&(i=1),o===1)s[n-r-1]=i;else if(i===1)s[n-r-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(t,e){let n=M(t,"a","equal","string_or_numeric"),s=M(e,"b","equal","string_or_numeric");[n,s]=vn(n,s),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(U0,r)}const ki=Q({equal_:Khe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xhe(t,e,n){const s=M(e,"a","where"),r=M(n,"b","where"),o=M(t,"condition","where","bool"),i=nt(nt(o.shape,s.shape),r.shape),a=Gh(o,i),l=Gh(s,i),c=Gh(r,i),u={condition:a,t:l,e:c};return Y.runKernel(yv,u)}const Us=Q({where_:Xhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(t){const n={x:M(t,"x","zerosLike")};return Y.runKernel(Ev,n)}const St=Q({zerosLike_:Yhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jhe(t,e){let n=M(t,"a","div"),s=M(e,"b","div");[n,s]=vn(n,s);const r=qe(n,s),o=St(r),i=ki(s,o);return Us(i,o,r)}const Zhe=Q({divNoNan_:Jhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(t,e){const n=M(t,"t1","dot"),s=M(e,"t2","dot");T((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],o=s.rank===1?s.size:s.shape[0];if(T(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),n.rank===1&&s.rank===1){const i=Z(n,[1,-1]),a=Z(s,[-1,1]),l=It(i,a);return Z(l,[])}else if(n.rank===1&&s.rank===2){const i=Z(n,[1,-1]),a=Z(s,[s.shape[0],s.shape[1]]),l=It(i,a);return Z(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=Z(s,[-1,1]),a=It(n,i);return Z(a,[a.size])}else{const i=Z(s,[s.shape[0],s.shape[1]]);return It(n,i)}}const efe=Q({dot_:Qhe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tfe(t,...e){const n=e.map((r,o)=>M(r,`tensors${o}`,"einsum")),s={equation:t};return Y.runKernel(uN,n,s)}const ch=Q({einsum_:tfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nfe(t){const n={x:M(t,"x","elu","float32")};return Y.runKernel(wp,n)}const Ov=Q({elu_:nfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sfe(t){let e=M(t,"x","erf");T(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=$e(e,"float32"));const n={x:e};return Y.runKernel(Cp,n)}const ZB=Q({erf_:sfe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VN(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function QB(t,e,n){const s=t.length+e.length,r=[];let o=0,i=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[o++]):r.push(e[i++]);return r}function Yn(t,e){const n=[],s=t.length;for(let o=0;o<s;o++)e.indexOf(o)===-1&&n.push(t[o]);const r=e.map(o=>t[o]);return[n,r]}function An(t,e){const n=e.map(s=>1);return QB(t,n,e)}function ds(t,e,n){T(VN(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function an(t,e){if(VN(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function yl(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function bn(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(t,e=null,n=!1){const r={x:M(t,"x","max")},o={reductionIndices:e,keepDims:n};return Y.runKernel(ev,r,o)}const Uo=Q({max_:rfe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ofe(t,e=null,n=!1){const r={x:M(t,"x","min")},o={axis:e,keepDims:n};return Y.runKernel(rv,r,o)}const Jx=Q({min_:ofe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(t,e){let n=M(t,"base","pow"),s=M(e,"exp","pow");[n,s]=vn(n,s);const r={a:n,b:s};return Y.runKernel(Lp,r)}const wc=Q({pow_:ife});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tt(t,e){if((So(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&So(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Tv(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(t){const n={x:M(t,"x","sqrt","float32")};return Y.runKernel(Yp,n)}const Ss=Q({sqrt_:afe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(t){const e=M(t,"x","square"),n={};return Y.runKernel("Square",{x:e},n)}const Xt=Q({square_:lfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(t,e=null,n=!1){let s=M(t,"x","sum");s.dtype==="bool"&&(s=$e(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return Y.runKernel(bv,r,o)}const He=Q({sum_:cfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ufe(t,e="euclidean",n=null,s=!1){t=M(t,"x","norm");const r=ez(t,e,n);let o=r.shape;if(s){const i=ft(n,t.shape);o=An(r.shape,i)}return Z(r,o)}function ez(t,e,n=null){if(t.rank===0)return Ps(t);if(t.rank!==1&&n===null)return ez(Z(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return He(Ps(t),n);if(e===1/0)return Uo(Ps(t),n);if(e===-1/0)return Jx(Ps(t),n);if(e==="euclidean"||e===2)return Ss(He(wc(Ps(t),Tt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Uo(He(Ps(t),n[0]),n[1]-1);if(e===1/0)return Uo(He(Ps(t),n[1]),n[0]);if(e===-1/0)return Jx(He(Ps(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Ss(He(Xt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Fv=Q({norm_:ufe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dfe(t,e=null,n=!1){return Fv(t,"euclidean",e,n)}const hfe=Q({euclideanNorm_:dfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ffe(t){const n={x:M(t,"x","exp")};return Y.runKernel(Sp,n)}const Ni=Q({exp_:ffe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(t,e=0){const n=M(t,"x","expandDims","string_or_numeric");T(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return Y.runKernel(V0,s,r)}const er=Q({expandDims_:pfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mfe(t){const n={x:M(t,"x","expm1")};return Y.runKernel(kp,n)}const gfe=Q({expm1_:mfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe(t,e){const n=M(t,"x","tile","string_or_numeric");T(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return Y.runKernel(tm,s,r)}const Lo=Q({tile_:xfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yfe(t,e,n,s="float32"){e==null&&(e=t);const r=ht([t,e],s),o=t<=e?t:e;for(let a=0;a<o;++a)r.set(1,a,a);const i=Z(r.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return Lo(er(i,0),[n[0],1,1]);if(n.length===2)return Lo(er(er(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return Lo(er(er(er(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const tz=Q({eye_:yfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(t){const n={x:M(t,"x","floor","float32")};return Y.runKernel(Np,n)}const Pv=Q({floor_:vfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bfe(t,e,n=0,s=0){const r=M(t,"x","gather"),o=M(e,"indices","gather","int32"),i={x:r,indices:o},a={axis:n,batchDims:s};return Y.runKernel(H0,i,a)}const WN=Q({gather_:bfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe(t,e){let n=M(t,"a","greater","string_or_numeric"),s=M(e,"b","greater","string_or_numeric");[n,s]=vn(n,s),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(G0,r)}const eo=Q({greater_:wfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(t,e){let n=M(t,"a","greaterEqual","string_or_numeric"),s=M(e,"b","greaterEqual","string_or_numeric");[n,s]=vn(n,s),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel($p,r)}const _c=Q({greaterEqual_:Cfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(t){const n={input:M(t,"input","imag")};return Y.runKernel(gN,n)}const HN=Q({imag_:Sfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kfe(t){const n={x:M(t,"x","isFinite")};return Y.runKernel(Tp,n)}const Nfe=Q({isFinite_:kfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Efe(t){const n={x:M(t,"x","isInf")};return Y.runKernel(Rp,n)}const $fe=Q({isInf_:Efe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(t){const n={x:M(t,"x","isNaN")};return Y.runKernel(Ap,n)}const Tfe=Q({isNaN_:Ife});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t,e=.2){const s={x:M(t,"x","leakyRelu")},r={alpha:e};return Y.runKernel(q0,s,r)}const GN=Q({leakyRelu_:Rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(t,e){let n=M(t,"a","less","string_or_numeric"),s=M(e,"b","less","string_or_numeric");[n,s]=vn(n,s),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(K0,r)}const Zx=Q({less_:Afe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dfe(t,e){let n=M(t,"a","lessEqual","string_or_numeric"),s=M(e,"b","lessEqual","string_or_numeric");[n,s]=vn(n,s),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(X0,r)}const Dd=Q({lessEqual_:Dfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ofe(t,e=5,n=1,s=1,r=.5){const o=M(t,"x","localResponseNormalization");T(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),T(Qu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},c={depthRadius:e,bias:n,alpha:s,beta:r},u=Y.runKernel(Q0,l,c);return a?Z(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Ffe=Q({localResponseNormalization_:Ofe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pfe(t){const n={x:M(t,"x","log","float32")};return Y.runKernel(Dp,n)}const Ei=Q({log_:Pfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _fe(t){const n={x:M(t,"x","log1p")};return Y.runKernel(Op,n)}const nz=Q({log1p_:_fe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mfe(t,e){T(LC(t),()=>"The f passed in variableGrads(f) must be a function"),T(e==null||Array.isArray(e)&&e.every(c=>c instanceof Yx),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in Y.registeredVariables)e.push(Y.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),T(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:i,grads:a}=Y.gradients(t,e,null,o);T(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:i,grads:l}}function rd(t){return Y.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lfe(t){const n={x:M(t,"x","neg")};return Y.runKernel(iv,n)}const yn=Q({neg_:Lfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(t){const n={x:M(t,"x","softplus")};return Y.runKernel(Xp,n)}const rm=Q({softplus_:jfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bfe(t){const e=M(t,"x","logSigmoid");return rd(s=>({value:yn(rm(yn(s))),gradFunc:i=>X(i,Ad(yn(s)))}))(e)}const zfe=Q({logSigmoid_:Bfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ufe(t,e){let n=M(t,"a","sub"),s=M(e,"b","sub");[n,s]=vn(n,s);const r={a:n,b:s};return Y.runKernel(Zp,r)}const Ye=Q({sub_:Ufe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vfe(t,e=-1){const n=M(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return rd((r,o)=>{const a=Uo(r,e,!0),l=Ye(r,a),c=Ye($e(l,"float32"),Ei(He(Ni(l),e,!0)));return o([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,m=!0,g=Ni(f);return Ye(d,X(He(d,e,m),g))}}})(n)}const sz=Q({logSoftmax_:Vfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wfe(t,e=null,n=!1){const s=M(t,"x","logSumExp"),r=ft(e,s.shape),o=Uo(s,r,!0),i=Ye(s,o),a=Ni(i),l=He(a,r),c=Ei(l),u=ge(Z(o,c.shape),c);if(n){const d=An(u.shape,r);return Z(u,d)}return u}const rz=Q({logSumExp_:Wfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hfe(t,e){const n=M(t,"a","logicalAnd","bool"),s=M(e,"b","logicalAnd","bool");nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(Y0,r)}const ta=Q({logicalAnd_:Hfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(t){const n={x:M(t,"x","logicalNot","bool")};return Y.runKernel(J0,n)}const qN=Q({logicalNot_:Gfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qfe(t,e){const n=M(t,"a","logicalOr","bool"),s=M(e,"b","logicalOr","bool");nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(Z0,r)}const oz=Q({logicalOr_:qfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kfe(t,e){const n=M(t,"a","logicalXor","bool"),s=M(e,"b","logicalXor","bool");return nt(n.shape,s.shape),ta(oz(t,e),qN(ta(t,e)))}const Xfe=Q({logicalXor_:Kfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yfe(t,e,n,s,r){const o=M(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(ks(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),dr("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=Y.runKernel(tv,c,u);return l?Z(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const KN=Q({maxPool_:Yfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jfe(t,e=[1,1,1],n,s,r,o="NDHWC"){const i=M(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),dr("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o},d=Y.runKernel(nv,c,u);return l?Z(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Zfe=Q({maxPool3d_:Jfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(t,e){let n=M(t,"a","maximum"),s=M(e,"b","maximum");[n,s]=vn(n,s),n.dtype==="bool"&&(n=$e(n,"int32"),s=$e(s,"int32")),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(Fp,r)}const vl=Q({maximum_:Qfe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function epe(t,e=null,n=!1){const r={x:M(t,"x","mean")},o={axis:e,keepDims:n};return Y.runKernel(sv,r,o)}const $n=Q({mean_:epe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(t,e="float32"){if(ca(t),e==="complex64"){const s=qn(t,"float32"),r=qn(t,"float32");return nd(s,r)}const n=Cs(ie(t),e);return Y.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bl(t,e="float32"){if(ca(t),e==="complex64"){const s=bl(t,"float32"),r=qn(t,"float32");return nd(s,r)}const n=W2(ie(t),e);return Y.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(t,e){let n=M(t,"a","minimum"),s=M(e,"b","minimum");[n,s]=vn(n,s),n.dtype==="bool"&&(n=$e(n,"int32"),s=$e(s,"int32")),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(Pp,r)}const Of=Q({minimum_:tpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npe(t,e,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=M(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)T(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:e,mode:n},i={x:s};return Y.runKernel(ov,i,o)}const spe=Q({mirrorPad_:npe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rpe(t,e){let n=M(t,"a","mod"),s=M(e,"b","mod");[n,s]=vn(n,s);const r={a:n,b:s};return Y.runKernel(_p,r)}const ope=Q({mod_:rpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipe(t,e=null,n=!1){t=M(t,"x","moments");const s=ft(e,t.shape),r=$n(t,s,n);let o=r.shape;n||(o=An(r.shape,s));const i=Xt(Ye($e(t,"float32"),Z(r,o))),a=$n(i,s,n);return{mean:r,variance:a}}const XN=Q({moments_:ipe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ape(t,e){let n=M(t,"a","notEqual","string_or_numeric"),s=M(e,"b","notEqual","string_or_numeric");[n,s]=vn(n,s),nt(n.shape,s.shape);const r={a:n,b:s};return Y.runKernel(av,r)}const Qx=Q({notEqual_:ape});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lpe(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:M(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return Y.runKernel(cv,i,a)}const iz=Q({oneHot_:lpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpe(t){const n={x:M(t,"x","onesLike")};return Y.runKernel(lv,n)}const ko=Q({onesLike_:cpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function upe(t,e,n=0){const s=M(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},o={x:s};return Y.runKernel(dv,o,r)}const YN=Q({pad_:upe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t,e,n){const s=M(t,"x","spaceToBatchND");T(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),T(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),T(s.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},o={blockShape:e,paddings:n};return Y.runKernel(wv,r,o)}const JN=Q({spaceToBatchND_:dpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpe(t,e,n,s,r,o,i){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const a=M(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(ks(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const u=No(l.shape,e,o,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=ppe([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[m,g]=fpe([u.inHeight,u.inWidth],d,h),y=f?s:"valid",x=f?l:JN(l,d,m),b=(n==="avg"?()=>LN(x,e,o,y,i):()=>KN(x,e,o,y,i))(),w=f?b:jN(b,d,g);return c?Z(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function fpe(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),o=t.concat(s,r),i=e.map((u,d)=>(u-o[d]%u)%u),a=r.map((u,d)=>u+i[d]),l=e.map((u,d)=>[s[d],a[d]]),c=e.map((u,d)=>[0,i[d]]);return[l,c]}function ppe(t,e){const s=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),o=s.map((i,a)=>i-r[a]);return s.map((i,a)=>[r[a],o[a]])}const mpe=Q({pool_:hpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpe(t,e){const n=M(t,"x","prelu"),s=M(e,"alpha","prelu"),r={x:n,alpha:s};return Y.runKernel(hv,r)}const ZN=Q({prelu_:gpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(t,e=null,n=!1){let s=M(t,"x","prod");s.dtype==="bool"&&(s=$e(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return Y.runKernel(fv,r,o)}const ype=Q({prod_:xpe});var QN={exports:{}};QN.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function o(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&o(d,u),h.state=function(){return o(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:this.alea=i})(Ic,t)})(QN);var vpe=QN.exports,eE={exports:{}};eE.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(Ic,t)})(eE);var bpe=eE.exports,tE={exports:{}};tE.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(Ic,t)})(tE);var wpe=tE.exports,nE={exports:{}};nE.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=c.next,d.quick=d,u&&(u.x&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(Ic,t)})(nE);var Cpe=nE.exports,sE={exports:{}};sE.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,m;return l.w=u=u+1640531527|0,m=d[h+34&127],f=d[h=h+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=d[h]=m^f,l.i=h,m+(u^u>>>16)|0};function c(u,d){var h,f,m,g,y,x=[],v=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,v=Math.max(v,d.length)),m=0,g=-32;g<v;++g)d&&(f^=d.charCodeAt((g+32)%d.length)),g===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(y=y+1640531527|0,h=x[g&127]^=f+y,m=h==0?m+1:0);for(m>=128&&(x[(d&&d.length||0)&127]=-1),m=127,g=4*128;g>0;--g)f=x[m+34&127],h=x[m=m+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,x[m]=f^h;u.w=y,u.X=x,u.i=m}c(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=c.next,d.quick=d,u&&(u.X&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(Ic,t)})(sE);var Spe=sE.exports,rE={exports:{}};rE.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,m=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^m,m=m-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^m,l.a=m-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(Ic,t)})(rE);var kpe=rE.exports,az={exports:{}};const Npe={},Epe=Object.freeze(Object.defineProperty({__proto__:null,default:Npe},Symbol.toStringTag,{value:"Module"})),$pe=R5(Epe);(function(t){(function(e,n,s){var r=256,o=6,i=52,a="random",l=s.pow(r,o),c=s.pow(2,i),u=c*2,d=r-1,h;function f(w,C,k){var N=[];C=C==!0?{entropy:!0}:C||{};var E=x(y(C.entropy?[w,b(n)]:w??v(),3),N),$=new m(N),I=function(){for(var A=$.g(o),P=l,_=0;A<c;)A=(A+_)*r,P*=r,_=$.g(1);for(;A>=u;)A/=2,P/=2,_>>>=1;return(A+_)/P};return I.int32=function(){return $.g(4)|0},I.quick=function(){return $.g(4)/4294967296},I.double=I,x(b($.S),n),(C.pass||k||function(A,P,_,U){return U&&(U.S&&g(U,$),A.state=function(){return g($,{})}),_?(s[a]=A,P):A})(I,E,"global"in C?C.global:this==s,C.state)}function m(w){var C,k=w.length,N=this,E=0,$=N.i=N.j=0,I=N.S=[];for(k||(w=[k++]);E<r;)I[E]=E++;for(E=0;E<r;E++)I[E]=I[$=d&$+w[E%k]+(C=I[E])],I[$]=C;(N.g=function(A){for(var P,_=0,U=N.i,V=N.j,D=N.S;A--;)P=D[U=d&U+1],_=_*r+D[d&(D[U]=D[V=d&V+P])+(D[V]=P)];return N.i=U,N.j=V,_})(r)}function g(w,C){return C.i=w.i,C.j=w.j,C.S=w.S.slice(),C}function y(w,C){var k=[],N=typeof w,E;if(C&&N=="object")for(E in w)try{k.push(y(w[E],C-1))}catch{}return k.length?k:N=="string"?w:w+"\0"}function x(w,C){for(var k=w+"",N,E=0;E<k.length;)C[d&E]=d&(N^=C[d&E]*19)+k.charCodeAt(E++);return b(C)}function v(){try{var w;return h&&(w=h.randomBytes)?w=w(r):(w=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(w)),b(w)}catch{var C=e.navigator,k=C&&C.plugins;return[+new Date,e,k,e.screen,b(n)]}}function b(w){return String.fromCharCode.apply(0,w)}if(x(s.random(),n),t.exports){t.exports=f;try{h=$pe}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:Ic,[],Math)})(az);var Ipe=az.exports,Tpe=vpe,Rpe=bpe,Ape=wpe,Dpe=Cpe,Ope=Spe,Fpe=kpe,Mc=Ipe;Mc.alea=Tpe;Mc.xor128=Rpe;Mc.xorwow=Ape;Mc.xorshift7=Dpe;Mc.xor4096=Ope;Mc.tychei=Fpe;var oE=Mc;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lz{constructor(e,n,s,r,o){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=oE.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,o,i;do r=2*this.random()-1,o=2*this.random()-1,i=r*r+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Ppe{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=oE.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _pe(t,e=0,n=1,s,r){if(ca(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new lz(e,n,s,!1,r),i=ht(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Mpe=Q({randomNormal_:_pe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lpe(t,e=0,n=1,s="float32",r){ca(t);const o=ht(t,s),i=new Ppe(e,n,null,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const om=Q({randomUniform_:Lpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ff(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return Y.runKernel(SN,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jpe(t){const n={input:M(t,"input","real")};return Y.runKernel(kN,n)}const ey=Q({real_:jpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpe(t){const n={x:M(t,"x","reciprocal")};return Y.runKernel(jp,n)}const zpe=Q({reciprocal_:Bpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upe(t){const n={x:M(t,"x","relu")};return Y.runKernel(Bp,n)}const Lc=Q({relu_:Upe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(t){const n={x:M(t,"x","relu6")};return Y.runKernel(zp,n)}const cz=Q({relu6_:Vpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpe(t,e){const s={x:M(t,"x","reverse")},r={dims:e};return Y.runKernel(xv,s,r)}const Cc=Q({reverse_:Wpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(t){const n={x:M(t,"x","round")};return Y.runKernel(Up,n)}const uz=Q({round_:Hpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpe(t){const n={x:M(t,"x","rsqrt","float32")};return Y.runKernel(Vp,n)}const dz=Q({rsqrt_:Gpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpe(t){const n={x:M(t,"x","selu")};return Y.runKernel(Wp,n)}const hz=Q({selu_:qpe});function Kpe(t,e,n,s,r,o=[1,1],i="NHWC"){const a=M(t,"x","separableConv2d"),l=M(e,"depthwiseFilter","separableConv2d"),c=M(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];T(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const m=UN(u,l,s,r,i,o),y=bc(m,c,1,"valid",i);return d?Z(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const fz=Q({separableConv2d_:Kpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xpe(t){const n={x:M(t,"x","sign")};return Y.runKernel(qp,n)}const Ype=Q({sign_:Xpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpe(t){const n={x:M(t,"x","sin","float32")};return Y.runKernel(Hp,n)}const pz=Q({sin_:Jpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(t){const n={x:M(t,"x","sinh")};return Y.runKernel(Gp,n)}const mz=Q({sinh_:Zpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpe(t,e,n){const s=M(t,"x","slice1d");return T(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Vt(s,[e],[n])}const iE=Q({slice1d_:Qpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eme(t,e,n){const s=M(t,"x","slice2d");return T(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Vt(s,e,n)}const gz=Q({slice2d_:eme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tme(t,e,n){const s=M(t,"x","slice3d");return T(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Vt(s,e,n)}const aE=Q({slice3d_:tme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nme(t,e,n){const s=M(t,"x","slice4d");return T(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Vt(s,e,n)}const ty=Q({slice4d_:nme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sme(t,e=-1){const n=M(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return Y.runKernel(Sv,s,r)}const lE=Q({softmax_:sme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rme(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Y.runKernel(hN,e)}const xz=Q({fft_:rme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ome(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Y.runKernel(mN,e)}const tS=Q({ifft_:ome});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ime(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=Z(t,[n,e]);s=tS(r)}else{const r=[n,2*(e-1)],o=Z(ey(t),[n,e]),i=Z(HN(t),[n,e]),a=Cc(Vt(o,[0,1],[n,e-2]),1),l=X(Cc(Vt(i,[0,1],[n,e-2]),1),Tt(-1)),c=or([o,a],1),u=or([i,l],1),d=Z(nd(c,u),[r[0],r[1]]);s=tS(d)}if(s=ey(s),t.rank===3&&t.shape[0]!==0){const r=s,o=t.shape[0];s=Z(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const ame=Q({irfft_:ime});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lme(t,e,n=0){const r={x:M(t,"x","split")},o={numOrSizeSplits:e,axis:n};return Y.runKernel(Cv,r,o)}const Gr=Q({split_:lme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cme(t,e){T(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const m=t.shape.map(y=>0),g=t.shape.map(y=>y);g[t.shape.length-1]=e,r=Vt(t,m,g),n=e}else if(e!=null&&e>n){const m=t.shape.map(g=>g);m[t.shape.length-1]=e-n,r=or([t,qn(m)],t.shape.length-1),n=e}else r=t;const o=St(r),i=Z(nd(r,o),[s,n]),a=xz(i),l=Math.floor(n/2)+1,c=ey(a),u=HN(a),d=Gr(c,[l,n-l],c.shape.length-1),h=Gr(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,Z(nd(d[0],h[0]),f)}const ume=Q({rfft_:cme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dme(t,e){let n=M(t,"a","squaredDifference"),s=M(e,"b","squaredDifference");[n,s]=vn(n,s),nt(n.shape,s.shape);const r={a:n,b:s},o={};return Y.runKernel(Jp,r,o)}const hme=Q({squaredDifference_:dme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fme(t,e){const n=M(t,"x","squeeze","string_or_numeric");return Z(n,ml(n.shape,e).newShape)}const im=Q({squeeze_:fme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pme(t,e=0){const n=PB(t,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return Y.runKernel(uv,s,r)}const na=Q({stack_:pme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mme(t,e=0){const s={x:M(t,"x","step")},r={alpha:e};return Y.runKernel(nm,s,r)}const am=Q({step_:mme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gme(t,e,n,s,r=0,o=0,i=0,a=0,l=0){const u={x:M(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return Y.runKernel(TN,u,d)}const xme=Q({stridedSlice_:gme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yme(t){const n={x:M(t,"x","tan","float32")};return Y.runKernel(Qp,n)}const vme=Q({tan_:yme});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wr(t,e){zj(t);const n=Iv(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Tv(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ea(t,e,n){if(zj(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Iv(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Tv(t,e,s,n)}function yz(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(o+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(o+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(o+` update.rank != ${r+t.length-s}`);for(let i=0;i<r;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==t[i+s])throw new Error(o+` updates.shape[${i+r}] (${n.shape[i+r]}) != shape[${i+r}] (${t[i+r]})`)}function bme(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}yz(n,e,t)}function jc(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,o=n.length;let i=1;for(let d=r;d<o;++d)i*=n[d];const a=r<1?1:r,l=ie(e.shape)/a,c=[...Be(n.slice(0,r)),1],u=ie(n);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wme(t,e=1,n=!0){const s=M(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const o={x:s},i={k:e,sorted:n},[a,l]=Y.runKernel(RN,o,i);return{values:a,indices:l}}const Cme=Q({topk_:wme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sme(t,e=0,n=1,s,r){if(ca(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new lz(e,n,s,!0,r),i=ht(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const vz=Q({truncatedNormal_:Sme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kme(t,e=0){const n=M(t,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[o,i]=Y.runKernel(DN,s,r);return{values:o,indices:i}}const Nme=Q({unique_:kme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eme(t,e,n){const s=M(t,"x","unsortedSegmentSum"),r=M(e,"segmentIds","unsortedSegmentSum","int32");T(Qu(n),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},i={numSegments:n};return Y.runKernel(Nv,o,i)}const bz=Q({unsortedSegmentSum_:Eme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $me(t,e=0){const n=M(t,"x","unstack","string_or_numeric");T(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return Y.runKernel(kv,s,r)}const Sc=Q({unstack_:$me});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ime(t,e=!0,n,s){return Y.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const s=ht(t,"int32"),r=ht([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=s.indexToLoc(n[o]),a=o*t.length;r.values.set(i,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tme(t,e,n){const s=M(t,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),T(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{T(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:e};return s.dtype==="complex64"?ee(()=>{let i=ey(s),a=HN(s);return i=Y.runKernel(Du,{x:i},o),a=Y.runKernel(Du,{x:a},o),n&&(a=yn(a)),nd(i,a)}):Y.runKernel(Du,r,o)}const Ct=Q({transpose_:Tme});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rme(t,e){if(e==null)return t.shape.slice();if(Rt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ame(t,e,n,s){const r=M(t,"x","dropout");if(T(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),T(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Fn?r.clone():r;const o=Rme(r,n),i=1-e,a=qe(Pv(ge(om(o,0,1,"float32",s),i)),i);return X(r,a)}const Dme=Q({dropout_:Ame});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ome(t,e,n,s,r,o="NHWC",i){let a=t;t.rank===3&&(a=Z(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=o==="NHWC"?a.shape[3]:a.shape[1],u=o==="NHWC"?l.shape[3]:l.shape[1];T(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),T(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),dr("conv2dDerFilter",r,i);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,filterShape:n};return Y.runKernel(tN,d,h)}const cE=Q({conv2DBackpropFilter_:Ome});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uE(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return X(t,am(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function dE(t,e){let n=e;const s=zn(t.shape,e.shape);return s.length>0&&(n=He(n,s)),Z(n,t.shape)}function hE(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Lc(t);if(e==="elu")return Ov(t);if(e==="relu6")return cz(t);if(e==="prelu")return ZN(t,n);if(e==="leakyrelu")return GN(t,s);if(e==="sigmoid")return Ad(t);throw new Error(`Unknown fused activation ${e}.`)}const fE=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fme({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",fE(Y.state.gradientDepth,l)===!1){T(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=bc(t,e,n,s,r,o,i);return a!=null&&(k=ge(k,a)),hE(k,l,c,u)}const d=M(t,"x","conv2d","float32"),h=M(e,"filter","conv2d","float32");let f=d,m=!1;d.rank===3&&(m=!0,f=Z(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),dr("fused conv2d",s,i);const g=r==="NHWC"?f.shape[3]:f.shape[1];T(h.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${h.shape[2]}.`),T(ks(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const y=us(f.shape,h.shape,n,o,s,i);let x;a!=null&&(x=M(a,"bias","fused conv2d"),[x]=vn(x,d),r==="NHWC"?nt(y.outShape,x.shape):(T(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),T(x.shape.length===0||x.shape[0]===y.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let v;if(c!=null){const k=c.shape;if(T(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)T(k[0]===1||k[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${y.outChannels}).`);else if(k.length===3)try{nt(k,y.outShape)}catch{const E=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(E)}v=M(c,"prelu weights","fused conv2d")}const b=(k,N)=>{T(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[E,$,I,A]=N,P=uE(k,I,l);T(yc(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const _=BN($.shape,P,E,n,s),U=cE($,P,E.shape,n,s),V=[_,U];if(A!=null){const D=dE(A,P);V.push(D)}return V},w={x:f,filter:h,bias:x,preluActivationWeights:v},C={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?rd((N,E,$)=>{let I=Y.runKernel(qx,w,C);return $([E,N,I]),m&&(I=Z(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:b}})(f,h):rd((N,E,$,I)=>{let A=Y.runKernel(qx,w,C);return I([E,N,A,$]),m&&(A=Z(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:b}})(f,h,x)}const Pme=Q({fusedConv2d_:Fme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _me(t,e,n,s,r,o=[1,1],i){let a=t;t.rank===3&&(a=Z(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:i,dilations:o,filterShape:n};return Y.runKernel(lN,c,u)}const Mme=Q({depthwiseConv2dNativeBackpropFilter_:_me});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lme(t,e,n,s,r,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:i,dilations:o,inputShape:t},d=Y.runKernel(cN,c,u);return l?Z(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const jme=Q({depthwiseConv2dNativeBackpropInput_:Lme});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bme({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(fE(Y.state.gradientDepth,o)===!1){let A=It(t,e,n,s);return r!=null&&(A=ge(A,r)),hE(A,o,i,a)}let l=M(t,"a","fused matMul"),c=M(e,"b","fused matMul");[l,c]=vn(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],m=l.shape.slice(0,-2),g=c.shape.slice(0,-2),y=ie(m),x=ie(g);T(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const b=nt(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),w=n?Z(l,[y,u,h]):Z(l,[y,h,u]),C=s?Z(c,[x,f,d]):Z(c,[x,d,f]);let k;r!=null&&(k=M(r,"bias","fused matMul"),[k]=vn(k,l),nt(b,k.shape));let N;i!=null&&(N=M(i,"prelu weights","fused matMul"));const E=(A,P)=>{const[_,U,V,D]=P,W=uE(Z(A,V.shape),V,o);let R,j;if(!n&&!s?(R=It(W,U,!1,!0),j=It(_,W,!0,!1)):!n&&s?(R=It(W,U,!1,!1),j=It(W,_,!0,!1)):n&&!s?(R=It(U,W,!1,!0),j=It(_,W,!1,!1)):(R=It(U,W,!0,!0),j=It(W,_,!0,!0)),r!=null){const G=dE(D,W);return[R,j,G]}else return[R,j]},$={a:w,b:C,bias:k,preluActivationWeights:N},I={transposeA:n,transposeB:s,activation:o,leakyreluAlpha:a};return r==null?rd((P,_,U)=>{const V=Y.runKernel(Gx,$,I);return U([P,_,V]),{value:Z(V,b),gradFunc:E}})(w,C):rd((P,_,U,V)=>{const D=Y.runKernel(Gx,$,I);return V([P,_,D,U]),{value:Z(D,b),gradFunc:E}})(w,C,k)}const nO=Q({fusedMatMul_:Bme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zme(t,e,n,s,r="bilinear",o=0){const i=M(t,"image","cropAndResize"),a=M(e,"boxes","cropAndResize","float32"),l=M(n,"boxInd","cropAndResize","int32"),c=a.shape[0];T(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),T(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),T(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:i,boxes:a,boxInd:l},d={method:r,extrapolationValue:o,cropSize:s};return Y.runKernel(oN,u,d)}const Ume=Q({cropAndResize_:zme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vme(t){const e=M(t,"image","flipLeftRight","float32");T(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return Y.runKernel(pN,n,{})}const Wme=Q({flipLeftRight_:Vme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hme(t){const e=M(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),T(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Lo(e,r)}const Gme=Q({grayscaleToRGB_:Hme});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qme(t){const e=M(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),T(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,o=$e(e,"float32"),i=wr([.2989,.587,.114]);let a;switch(e.rank){case 2:a=ch("ij,j->i",o,i);break;case 3:a=ch("ijk,k->ij",o,i);break;case 4:a=ch("ijkl,l->ijk",o,i);break;case 5:a=ch("ijklm,m->ijkl",o,i);break;case 6:a=ch("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=er(a,-1),$e(a,r)}const Kme=Q({rgbToGrayscale_:qme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xme(t,e,n=0,s=.5){const r=M(t,"image","rotateWithOffset","float32");T(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},i={radians:e,fillValue:n,center:s};return Y.runKernel(ON,o,i)}const Yme=Q({rotateWithOffset_:Xme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Od(t,e,n,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),T(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),T(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),T(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),T(e.rank===1,()=>"scores must be a 1D tensor"),T(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),T(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jme(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=M(t,"boxes","nonMaxSuppression","float32"),i=M(e,"scores","nonMaxSuppression","float32"),a=Od(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return Y.runKernel(bN,{boxes:o,scores:i},l)}const Zme=Q({nonMaxSuppression_:Jme});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qme(t,e,n){const s=ege(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function ege(t,e,n){return nge(t,e,n||tge)}function tge(t,e){return t>e?1:t<e?-1:0}function nge(t,e,n){let s=0,r=t.length,o=0,i=!1;for(;s<r;){o=s+(r-s>>>1);const a=n(e,t[o]);a>0?s=o+1:(r=o,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pE(t,e,n,s,r){return xE(t,e,n,s,r,0)}function mE(t,e,n,s,r,o){return xE(t,e,n,s,r,0,!1,o,!0)}function gE(t,e,n,s,r,o){return xE(t,e,n,s,r,o,!0)}function xE(t,e,n,s,r,o,i=!1,a=!1,l=!1){const c=[];for(let y=0;y<e.length;y++)e[y]>r&&c.push({score:e[y],boxIndex:y,suppressBeginIndex:0});c.sort(sO);const u=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&c.length>0;){const y=c.pop(),{score:x,boxIndex:v,suppressBeginIndex:b}=y;if(x<r)break;let w=!1;for(let C=d.length-1;C>=b;--C){const k=sge(t,v,d[C]);if(k>=s){w=!0;break}if(y.score=y.score*rge(s,u,k),y.score<=r)break}y.suppressBeginIndex=d.length,w||(y.score===x?(d.push(v),h.push(y.score)):y.score>r&&Qme(c,y,sO))}const f=d.length,m=n-f;a&&m>0&&(d.push(...new Array(m).fill(0)),h.push(...new Array(m).fill(0)));const g={selectedIndices:d};return i&&(g.selectedScores=h),l&&(g.validOutputs=f),g}function sge(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),o=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-o)*(l-i),m=(d-c)*(h-u);if(f<=0||m<=0)return 0;const g=Math.max(o,c),y=Math.max(i,u),x=Math.min(a,d),v=Math.min(l,h),b=Math.max(x-g,0)*Math.max(v-y,0);return b/(f+m-b)}function rge(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function sO(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oge(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=M(t,"boxes","nonMaxSuppressionAsync"),i=M(e,"scores","nonMaxSuppressionAsync"),a=Od(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:d}=pE(c,u,n,s,r);return o!==t&&o.dispose(),i!==e&&i.dispose(),wr(d,"int32")}const ige=oge;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function age(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=M(t,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=Od(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const c={boxes:i,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},d=Y.runKernel(CN,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const lge=Q({nonMaxSuppressionWithScore_:age});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function cge(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=M(t,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=Od(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const c=await Promise.all([i.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=gE(u,d,n,s,r,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:wr(h,"int32"),selectedScores:wr(f)}}const uge=cge;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dge(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=M(t,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=Od(i,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:o},m=Y.runKernel(wN,h,f);return{selectedIndices:m[0],validOutputs:m[1]}}const hge=Q({nonMaxSuppressionPadded_:dge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fge(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=M(t,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=Od(i,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([i.data(),a.data()]),{selectedIndices:m,validOutputs:g}=mE(h,f,c,u,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:wr(m,"int32"),validOutputs:Tt(g,"int32")}}const pge=fge;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mge(t,e,n=!1,s=!1){const r=M(t,"images","resizeBilinear");T(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),T(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},c=Y.runKernel(gv,a,l);return i?Z(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Cz=Q({resizeBilinear_:mge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gge(t,e,n=!1,s=!1){const r=M(t,"images","resizeNearestNeighbor");T(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),T(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},c=Y.runKernel(mv,a,l);return i?Z(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Sz=Q({resizeNearestNeighbor_:gge});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xge(t,e="binary",n=!1,s=.5){const r=M(t,"image","threshold"),o=.2989,i=.587,a=.114,l=r.shape[0]*r.shape[1];let c=X(wr([s]),255),u,d,h,f;if(T(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),T(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),T(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),T(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,d,h]=Gr(r,[1,1,1],-1);const y=X(u,o),x=X(d,i),v=X(h,a);f=ge(ge(y,x),v)}else f=t;if(e==="otsu"){const y=ghe($e(uz(f),"int32"),_B([]),256);c=yge(y,l)}const m=n?Dd(f,c):eo(f,c);return $e(X(m,255),"int32")}function yge(t,e){let n=wr([-1]),s=wr([0]),r=wr([0]),o,i,a,l,c,u;for(let d=0;d<t.size-1;d++){o=Vt(t,0,d+1),i=Vt(t,d+1),c=qe(He(o),e),u=qe(He(i),e);const h=He(X(o,Ff(0,o.size)));a=qe(h,He(o));const f=Dv(i.shape,o.size),m=ge(Ff(0,i.size),f),g=X(i,m);l=qe(He(g),He(i));const y=Ye(a,l),x=Ye(a,l),v=X(c,u);r=X(X(v,y),x);const b=eo(r,s);s=Us(b,r,s),n=Us(b,wr([d]),n)}return n}const vge=Q({threshold_:xge});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bge(t,e,n="nearest",s="constant",r=0,o){const i=M(t,"image","transform","float32"),a=M(e,"transforms","transform","float32");T(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:o};return Y.runKernel(AN,l,c)}const wge=Q({transform_:bge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cge(t,e,n){const s=M(t,"a","bandPart");T(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,i]=s.shape.slice(-2);let a,l;typeof e=="number"?(T(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),T(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=M(e<0?o:e,"numLower","bandPart")):(T(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Us(Zx(e,0),o,Of(e,o))),typeof n=="number"?(T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),T(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=M(n<0?i:n,"numUpper","bandPart")):(T(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Us(Zx(n,0),i,Of(n,i)));const c=Z(Ff(0,o,1,"int32"),[-1,1]),u=Ff(0,i,1,"int32"),d=Ye(c,u),h=ta(Dd(d,a),_c(d,yn(l))),f=qn([o,i],s.dtype);return Z(na(Sc(Z(s,[-1,o,i])).map(m=>Us(h,m,f))),r)}const Sge=Q({bandPart_:Cge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kge(t){let e;if(Array.isArray(t)){e=!1,T(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let o=1;o<t.length;++o)T(t[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${r})`)}else e=!0,t=Gr(t,t.shape[0],0).map(r=>im(r,[0]));T(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(Y.tidy(()=>{let o=s[r];if(r>0)for(let i=0;i<r;++i){const a=X(He(X(n[i],o)),n[i]);o=Ye(o,a)}return qe(o,Fv(o,"euclidean"))}));return e?na(n,0):n}const Nge=Q({gramSchmidt_:kge});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ege(t,e=!1){if(T(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return rO(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=Sc(Z(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],o=[];s.forEach(l=>{const[c,u]=rO(l,e);r.push(c),o.push(u)});const i=Z(na(r,0),t.shape),a=Z(na(o,0),t.shape);return[i,a]}}function rO(t,e=!1){return Y.tidy(()=>{T(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=tz(n),o=ec(t);const i=Ea([[1]],[1,1]);let a=ec(i);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=o,d=a,h=r;[a,o,r]=Y.tidy(()=>{const f=Vt(o,[c,c],[n-c,1]),m=Fv(f),g=Vt(o,[c,c],[1,1]),y=Us(eo(g,0),Ea([[-1]]),Ea([[1]])),x=Ye(g,X(y,m)),v=qe(f,x);v.shape[0]===1?a=ec(i):a=or([i,Vt(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const b=yn(qe(It(y,x),m)),w=Vt(o,[c,0],[n-c,s]),C=X(b,a),k=Ct(a);if(c===0)o=Ye(w,It(C,It(k,w)));else{const $=Ye(w,It(C,It(k,w)));o=or([Vt(o,[0,0],[c,s]),$],0)}const N=Ct(C),E=Vt(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=Ye(E,It(It(E,a),N));else{const $=Ye(E,It(It(E,a),N));r=or([Vt(r,[0,0],[n,c]),$],1)}return[a,o,r]}),mt([u,d,h])}return!e&&n>s&&(r=Vt(r,[0,0],[n,s]),o=Vt(o,[0,0],[s,s])),[r,o]})}const $ge=Q({qr_:Ege});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bi={flipLeftRight:Wme,grayscaleToRGB:Gme,resizeNearestNeighbor:Sz,resizeBilinear:Cz,rgbToGrayscale:Kme,rotateWithOffset:Yme,cropAndResize:Ume,nonMaxSuppression:Zme,nonMaxSuppressionAsync:ige,nonMaxSuppressionWithScore:lge,nonMaxSuppressionWithScoreAsync:uge,nonMaxSuppressionPadded:hge,nonMaxSuppressionPaddedAsync:pge,threshold:vge,transform:wge},Ige={bandPart:Sge,gramSchmidt:Nge,qr:$ge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tge=new Map,Rge=new Map;class Fd{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class uo{constructor(){this.classNameMap={}}static getMap(){return uo.instance==null&&(uo.instance=new uo),uo.instance}static register(e){uo.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function fe(t,e,n){T(t.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),T(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return uo.register(t),Tge.set(r,t),Rge.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wl extends Fd{minimize(e,n=!1,s){const{value:r,grads:o}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return mt(o),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return Mfe(e,n)}dispose(){this.iterations_!=null&&mt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Tt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(wl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kz extends wl{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Y.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:ee(()=>St(o).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:ee(()=>St(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;ee(()=>{const u=ge(X(l,this.rho),X(Xt(a),1-this.rho)),d=X(qe(Ss(ge(c,this.epsilon)),Ss(ge(l,this.epsilon))),a),h=ge(X(c,this.rho),X(Xt(d),1-this.rho));l.assign(u),c.assign(h);const f=ge(X(d,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(mt(this.accumulatedGrads.map(e=>e.variable)),mt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nz extends wl{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Y.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:ee(()=>Dv(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[r].variable;ee(()=>{const l=ge(a,Xt(i));a.assign(l);const c=ge(X(qe(i,Ss(ge(l,Y.backend.epsilon()))),-this.learningRate),o);o.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&mt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ez extends wl{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ee(()=>{this.accBeta1=Tt(n).variable(),this.accBeta2=Tt(s).variable()}),r==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ee(()=>{const s=Ye(1,this.accBeta1),r=Ye(1,this.accBeta2);n.forEach((o,i)=>{const a=Y.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:ee(()=>St(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:ee(()=>St(a).variable(l))});const c=Array.isArray(e)?e[i].tensor:e[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,h=ge(X(u,this.beta1),X(c,1-this.beta1)),f=ge(X(d,this.beta2),X(Xt(c),1-this.beta2)),m=qe(h,s),g=qe(f,r);u.assign(h),d.assign(f);const y=ge(X(qe(m,ge(Ss(g),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(X(this.accBeta1,this.beta1)),this.accBeta2.assign(X(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&mt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),ee(()=>{this.accBeta1.assign(wc(this.beta1,this.iterations_+1)),this.accBeta2.assign(wc(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $z extends wl{static get className(){return"Adamax"}constructor(e,n,s,r=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ee(()=>{this.iteration=Tt(0).variable(),this.accBeta1=Tt(n).variable()}),r==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ee(()=>{const s=Ye(1,this.accBeta1),r=qe(-this.learningRate,ge(X(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=Y.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:St(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:St(a).variable(l)});const c=Array.isArray(e)?e[i].tensor:e[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,h=ge(X(u,this.beta1),X(c,1-this.beta1)),f=X(d,this.beta2),m=Ps(c),g=vl(f,m);u.assign(h),d.assign(g);const y=ge(X(qe(r,s),qe(h,ge(g,this.epsilon))),a);a.assign(y)}),this.iteration.assign(ge(this.iteration,1)),this.accBeta1.assign(X(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&mt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yE extends wl{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const i=Y.registeredVariables[s];ee(()=>{const a=ge(X(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=bi(Tt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iz extends yE{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Tt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Y.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:ee(()=>St(o).variable(!1))});const i=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&ee(()=>{let l;const c=ge(X(this.m,i),a);this.useNesterov?l=ge(X(this.c,ge(a,X(c,this.m))),o):l=ge(X(this.c,c),o),i.assign(c),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&mt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tz extends wl{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=Y.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Y.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:ee(()=>St(o).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:ee(()=>St(o).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:ee(()=>St(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;ee(()=>{const u=ge(X(l,this.decay),X(Xt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=ge(X(d,this.decay),X(a,1-this.decay)),f=qe(X(a,this.learningRate),Ss(Ye(u,ge(Xt(h),this.epsilon)))),m=ge(X(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(m);const g=Ye(o,m);o.assign(g)}else{const d=ge(X(l,this.decay),X(Xt(a),1-this.decay)),h=ge(X(c,this.momentum),qe(X(a,this.learningRate),Ss(ge(d,this.epsilon))));l.assign(d),c.assign(h);const f=Ye(o,h);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&mt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&mt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&mt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Age=[kz,Nz,Ez,$z,Iz,Tz,yE];function Dge(){for(const t of Age)fe(t)}function vE(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(ie(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,o=r[r.length-1];let i=1;for(let d=0;d<r.length-1;++d)i*=r[d];const a=t.shape,l=r.slice();l.pop();let c=1;for(let d=o;d<n;++d)c*=a[d],l.push(a[d]);const u=[...Be(t.shape).map(d=>d/c),1].slice(0,o);return[l,i,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nS=-2,Oge=-1;function bE(t,e,n){const s=t.shape.length;T(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),T(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)T(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function Fge(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function wE(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function Rz(t,e,n,s){const r=[...t];for(let o=r.length;o<s.length;o++)r.push(1);for(let o=0;o<n;o++)o===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function Az(t,e,n){return n<=t?n:n-(e-1)}function Dz(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function Pge(t,e,n,s,r,o,i,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],m=n+1;u=Oz(i,f,m,s,t),d=Fz(a,f,m,r,t),h=Rz(o,f,m,t)}else for(let f=0;f<c;f++)u[f]=_z(i,s,o,t,f,l),d[f]=Mz(a,r,o,t,f,l),h[f]=Pz(o,f,l);return{begin:u,end:d,strides:h}}function Oz(t,e,n,s,r){const o=[...r],i=Dz(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=Az(e,n,a);let c=s[l];t&1<<l&&(c=0),o[a]=c}return o}function Fz(t,e,n,s,r){const o=[...r],i=Dz(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=Az(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),o[a]=c}for(let a=0;a<o.length;a++){const l=r[a];o[a]<0&&(o[a]+=l),o[a]=pc(0,o[a],r[a])}return o}function Pz(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function _z(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=pc(0,i,l-1),i}function Mz(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),a>0?i=pc(0,i,l):i=pc(-1,i,l-1),i}function CE(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function SE(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function _v(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{T(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(r).fill(-1):typeof n=="number"?o=[n,...new Array(r-1).fill(-1)]:n.length<r?o=n.concat(new Array(r-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(T(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,o]}function kE(t,e,n,s,r,o,i,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&a&&d.numAddAxisAfterEllipsis++,1<<b&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};_ge(d,h);let f=!0,m=!0,g=!0;const y=[],x=[];for(let b=0;b<t.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(h.shrinkAxisMask&1<<b),C=t[b];if(C===-1){y.push(w?1:-1);continue}const k=[h.beginMask&1<<b,h.endMask&1<<b],N=[h.strides[b]>0?0:-1,h.strides[b]>0?C:C-1];if(w&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&h.strides[b]===1;const E=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(w){const P=h.begin[b]<0?C+h.begin[b]:h.begin[b];if(h.begin[b]=P,h.end[b]=h.begin[b]+1,P<0||P>=C)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=oO(h.begin[b],0,h.strides[b],C,k,N),h.end[b]=oO(h.end[b],1,h.strides[b],C,k,N);const A=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===C;f=f&&A,m=m&&(b===0&&h.strides[b]===1||A)}else f=f&&h.strides[b]===1&&E,m=m&&(b===0&&h.strides[b]===1||E);let $,I=!1;if(h.beginValid&&h.endValid?($=h.end[b]-h.begin[b],I=!0):w?($=1,I=!0):E&&C>=0&&(h.strides[b]<0?$=-C:$=C,I=!0),I){let A;$===0||$<0!=h.strides[b]<0?A=0:A=Math.trunc($/h.strides[b])+($%h.strides[b]!==0?1:0),y.push(A)}else y.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const w=h.finalShapeGatherIndices[b];w>=0?x.push(y[w]):w===nS&&x.push(1)}return{finalShapeSparse:x.filter((b,w)=>h.finalShapeGatherIndices[w]!==nS),finalShape:x,isIdentity:f,sliceDim0:m,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function _ge(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(nS),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Oge),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function oO(t,e,n,s,r,o){if(r[e])return n>0?o[e]:o[e+1&1];{const i=t<0?s+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const Mge=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:bE,computeFlatOffset:SE,computeOutShape:wE,getNormalizedAxes:Pge,isSliceContinous:CE,maskToAxes:Fge,parseSliceParams:_v,sliceInfo:kE,startForAxis:_z,startIndicesWithElidedDims:Oz,stopForAxis:Mz,stopIndicesWithElidedDims:Fz,stridesForAxis:Pz,stridesWithElidedDims:Rz},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lge{static sgd(e){return new yE(e)}static momentum(e,n,s=!1){return new Iz(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,o=!1){return new Tz(e,n,s,r,o)}static adam(e=.001,n=.9,s=.999,r=null){return new Ez(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new kz(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,o=0){return new $z(e,n,s,r,o)}static adagrad(e,n=.1){return new Nz(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eu=Lge;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jge=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function Lz(){return new Promise(t=>jge(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NE(t,e){const n=t[0].length;t.forEach((r,o)=>{T(r.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),T(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,o)=>{for(let i=0;i<n;i++)T(i===e||r[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function wi(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Mo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Mo||(Mo={}));function jz(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const o=n[r],i=s[s.length-n.length+r],a=s[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${o} but shape[${r+t}] = ${a}`)}else s[i]=o}return s}function Bz(t){const e={FIRST_DIM_SIZE:Mo.FIRST_DIM_SIZE,VALUE_ROWIDS:Mo.VALUE_ROWIDS,ROW_LENGTHS:Mo.ROW_LENGTHS,ROW_SPLITS:Mo.ROW_SPLITS,ROW_LIMITS:Mo.ROW_LIMITS,ROW_STARTS:Mo.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function zz(t){return t.length===0?0:t[0]===Mo.FIRST_DIM_SIZE?t.length-1:t.length}function Uz(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const o=t[r],i=e[r+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${o} but ragged tensor input.flatValues.shape[${r-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EE=30;function Mv(t){return t<=EE?t:jC(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $E(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lm(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(o+1))}return r}function cm(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):r.push(i);s.push(...r),s.push(0),s.push(...o)}return s}function um(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?s?r.push(e[o-1]*t[o]):r.push(t[o]/e[o-1]):r.push(t[o]);return r}function IE(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function TE(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lv=1.7580993408473768,jv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RE=.3275911,AE=.254829592,DE=-.284496736,OE=1.421413741,FE=-1.453152027,PE=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sa(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function Vz(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function Wz(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function Hz(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function _E(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function Gz(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function qz(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const o=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:n,imag:s}}function Kz(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L1="->",Bge=/->/g,iO=",",aO="...";function ME(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Bge,"").length)/L1.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${L1}").`);const[s,r]=t.split(L1);T(s.indexOf(aO)===-1,()=>`The ellipsis notation ("${aO}") is not supported yet.`);const o=s.split(iO),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!o.some(m=>m.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==iO&&a.push(f)}const l=new Array(o.length);for(let h=0;h<i;++h){if(new Set(o[h].split("")).size!==o[h].length)throw new Error(`Found duplicate axes in input component ${o[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<o[h].length;++f)l[h].push(a.indexOf(o[h][f]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function LE(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function jE(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const o=n[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=o[i]:T(s[e[r][i]]===o[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function BE(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let i=0;i<r;++i)s.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=zge(e,a);for(const c of l)o.indexOf(c)===-1&&(s[i].push(c),o.push(c))}return{path:n,steps:s}}function zE(t){return t.every((e,n)=>e===n)}function zge(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function UE(t,e,n=0){let s=[];if(typeof e=="number")T(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);T(r<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}T(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function Yz(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function Jz(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Qz(t,e){return`size ${t} must be non-negative, not ${e}`}function eU(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function tU(t,e){const n=ie(t),s=ie(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function nU(t,e){const n=ie(t),s=ie(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sS(){return"segment ids must be >= 0"}function sU(){return"segment ids are not increasing"}function rU(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function oU(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(t,e){let n=!1,s;for(t<=EE?(s=t,n=!0):s=jC(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=jC(t,s+1);return s}function aU(t,e,n){const s=[],r=t.length;for(let o=0;o<r;o++)o!==e?s.push(t[o]):s.push(n);return s}function VE(t,e,n,s){const r=e.shape.length,o=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}const Uge=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:VE,computeOutShape:aU,segOpComputeOptimalWindowSize:iU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ra(t){try{return t.map(e=>nl(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function lU(t){return t.map(e=>qa(e))}const Vge=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:AE,ERF_A2:DE,ERF_A3:OE,ERF_A4:FE,ERF_A5:PE,ERF_P:RE,PARALLELIZE_THRESHOLD:EE,get RowPartitionType(){return Mo},SELU_SCALE:jv,SELU_SCALEALPHA:Lv,applyActivation:hE,assertAndGetBroadcastShape:nt,assertAxesAreInnerMostDims:ds,assertParamsConsistent:NE,assignToTypedArray:Gz,axesAreInnerMostDims:VN,calculateShapes:jc,checkEinsumDimSizes:jE,checkPadOnDimRoundingMode:dr,combineLocations:QB,combineRaggedTensorToTensorShapes:jz,complexWithEvenIndex:Wz,complexWithOddIndex:Hz,computeConv2DInfo:us,computeConv3DInfo:xl,computeDefaultPad:MN,computeDilation2DInfo:sm,computeOptimalWindowSize:Mv,computeOutAndReduceShapes:Yn,computeOutShape:wi,computePool2DInfo:No,computePool3DInfo:ua,convertConv2DDataFormat:da,decodeEinsumEquation:ME,eitherStridesOrDilationsAreOne:ks,expandShapeToKeepDim:An,exponent:Kz,exponents:qz,fromStringArrayToUint8:lU,fromUint8ToStringArray:ra,getAxesPermutation:an,getBroadcastDims:sd,getComplexWithIndex:_E,getEinsumComputePath:BE,getEinsumPermutation:LE,getFusedBiasGradient:dE,getFusedDyActivation:uE,getImageCenter:$E,getInnerMostAxes:bn,getPermuted:cm,getRaggedRank:zz,getReductionAxes:zn,getReshaped:lm,getReshapedPermuted:um,getRowPartitionTypesHelper:Bz,getSliceBeginCoords:IE,getSliceSize:TE,getSparseFillEmptyRowsIndicesDenseShapeMismatch:Xz,getSparseFillEmptyRowsNegativeIndexErrorMessage:Yz,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:Jz,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:eU,getSparseReshapeInputOutputMismatchErrorMessage:nU,getSparseReshapeInputOutputMultipleErrorMessage:tU,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Zz,getSparseReshapeNegativeOutputDimErrorMessage:Qz,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:oU,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:sS,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:sU,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:rU,getUndoAxesPermutation:yl,isIdentityPermutation:zE,log:Nue,mergeRealAndImagArrays:sa,prepareAndValidate:vE,prepareSplitSize:UE,segment_util:Uge,shouldFuse:fE,slice_util:Mge,splitRealAndImagArrays:Vz,stridesOrDilationsArePositive:vc,tupleValuesAreOne:yc,upcastType:Tr,validateDefaultValueShape:Uz,validateInput:bme,validateUpdateShape:yz,warn:jr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dge();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cU={kernelName:$0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(t,am($e(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wge={kernelName:lp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Xt($e(n,"float32")),r=Ss(Ye(Tt(1),s));return yn(qe(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hge={kernelName:cp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ss(Ye(Xt($e(n,"float32")),1));return qe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gge={kernelName:Td,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=nt(n.shape,s.shape);return{a:()=>{let a=t;const l=zn(n.shape,r);return l.length>0&&(a=He(a,l)),Z(a,n.shape)},b:()=>{let a=t;const l=zn(s.shape,r);return l.length>0&&(a=He(a,l)),Z(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qge={kernelName:q2,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kge={kernelName:I0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>St(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xge={kernelName:T0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>St(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yge={kernelName:up,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,Ss(Ye(Tt(1),Xt($e(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jge={kernelName:dp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ss(ge(Tt(1),Xt($e(n,"float32"))));return qe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zge={kernelName:pp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=nt(n.shape,s.shape);return{a:()=>{const a=ge(Xt(n),Xt(s));let l=X(t,qe(s,a));const c=zn(n.shape,r);return c.length>0&&(l=He(l,c)),Z(l,n.shape)},b:()=>{const a=ge(Xt(n),Xt(s));let l=yn(X(t,qe(n,a)));const c=zn(s.shape,r);return c.length>0&&(l=He(l,c)),Z(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qge={kernelName:hp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,ge(Xt($e(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const exe={kernelName:fp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,Ye(Tt(1),Xt($e(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function txe(t,e,n,s,r,o){const i=M(t,"dy","avgPool3dGrad"),a=M(e,"input","avgPool3dGrad");let l=i,c=a,u=!1;a.rank===4&&(u=!0,l=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=Z(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),dr("avgPool3dGrad",r,o);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:o},f=Y.runKernel(J2,d,h);return u?Z(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const nxe=Q({avgPool3dGrad_:txe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sxe={kernelName:A0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i,dimRoundingMode:a}=n;return{x:()=>nxe(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rxe(t,e,n,s,r){const o=M(t,"dy","avgPoolGrad"),i=M(e,"input","avgPoolGrad");T(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,c=!1;i.rank===3&&(c=!0,a=Z(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=Y.runKernel(Y2,u,d);return c?Z(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const oxe=Q({avgPoolGrad_:rxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ixe={kernelName:R0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i}=n;return{x:()=>oxe(t,s,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const axe={kernelName:D0,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:o,transposeB:i}=n;return!o&&!i?{a:()=>It(t,r,!1,!0),b:()=>It(s,t,!0,!1)}:!o&&i?{a:()=>It(t,r,!1,!1),b:()=>It(t,s,!0,!1)}:o&&!i?{a:()=>It(r,t,!1,!0),b:()=>It(s,t,!1,!1)}:{a:()=>It(r,t,!0,!0),b:()=>It(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lxe={kernelName:O0,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>JN(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cxe={kernelName:wue,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,o=s.shape,i=Array.from(o);for(let l=r.length-1;l>=0;l--)if(r[l]===o[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>He(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uxe={kernelName:mp,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dxe={kernelName:gp,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hxe={kernelName:xp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:o}=n;return{x:()=>Us(ta(_c(s,r),Dd(s,o)),t,St(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fxe={kernelName:F0,inputsToSave:["x"],gradFunc:cU.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pxe={kernelName:P0,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,o=ft(r,e[0].shape)[0],i=s.map(l=>l[o]);return Gr(t,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mxe={kernelName:_0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=n;return T(yc(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>BN(s.shape,t,r,i,a,l),filter:()=>cE(s,t,r.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gxe={kernelName:M0,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>bc(t,r,o,i,a,1,l),filter:()=>cE(t,s,r.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xxe(t,e,n,s,r){let o=t;t.rank===4&&(o=Z(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=Z(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),T(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),T(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),T(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:o,dy:i},l={strides:s,pad:r,filterShape:n};return Y.runKernel(nN,a,l)}const yxe=Q({conv3DBackpropFilter_:xxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vxe={kernelName:L0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o}=n;T(yc(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>XB(i.shape,t,a,r,o),filter:()=>yxe(i,t,a.shape,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bxe={kernelName:yp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(yn(pz($e(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wxe={kernelName:vp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(mz($e(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cxe={kernelName:j0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:o,reverse:i}=n;return{x:()=>{const a=an([r],s.rank);let l=JB(t,r,o,!i);return a!=null&&(l=Ct(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sxe={kernelName:B0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o,dimRoundingMode:i}=n,a=s??[1,1];T(yc(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(ks(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),dr("depthwiseConv2d",o,i),{x:()=>jme(l.shape,t,c,r,o,a,i),filter:()=>Mme(l,t,c.shape,r,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxe={kernelName:z0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,o={x:s,filter:r,dy:t},i={x:s,filter:r,dy:t};return{x:()=>Y.runKernel(BC,o,n),filter:()=>Y.runKernel(zC,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nxe={kernelName:wp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>Y.runKernel(dN,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Exe={kernelName:Cp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=X(Ni(yn(Xt(n))),2/Math.sqrt(Math.PI));return{x:()=>X(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $xe={kernelName:Sp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ixe={kernelName:V0,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Z(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Txe={kernelName:kp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(t,Ni(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rxe={kernelName:Np,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Axe={kernelName:Ep,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=nt(n.shape,s.shape);return{a:()=>{const a=qe(t,$e(s,"float32")),l=zn(n.shape,r);return l.length>0?Z(He(a,l),n.shape):a},b:()=>{let a=X(t,$e(n,"float32"));const l=zn(s.shape,r);l.length>0&&(a=Z(He(a,l),s.shape));const c=Xt(s);return yn(qe(a,$e(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dxe={kernelName:W0,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,o,i,a]=e,l=a??Tt(1),c=zn(o.shape,r.shape),u=[];if(o.rank===1){for(let w=0;w<r.shape.length-1;++w)u.push(r.shape[w]);u.push(1)}const d=Ye(r,o),h=X(t,l),f=dz(ge(i,Tt(s))),m=X(X(X(f,f),f),Tt(-.5));return{x:()=>o.rank===1?Z(X(X(t,Lo(Z(f,[1,1,1,o.shape[0]]),u)),l),r.shape):Z(X(X(t,f),l),r.shape),mean:()=>{let w=X(X(f,Tt(-1)),h);return o.rank===1&&(w=He(w,c)),Z(w,o.shape)},variance:()=>{let w=X(X(m,d),h);return o.rank===1&&(w=He(w,c)),Z(w,o.shape)},scale:()=>{const w=X(d,f);let C=X(t,w);return o.rank===1&&(C=He(C,c)),Z(C,o.shape)},offset:()=>{let w=t;return o.rank===1&&(w=He(w,c)),Z(w,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oxe={kernelName:H0,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:o,batchDims:i}=n,a=ft(o,s.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,m=h.slice(0,a),g=m.length,y=h.slice(o,h.length).slice(1),x=y.length,v=lO(0,g),b=lO(g+1,g+1+x),w=cO([m,[f],y]),C=Z(d,w),k=Z(u,[f]),N=cO([[g],v,b]),E=Ct(C,N);let $=bz(E,k,c.shape[a]);const I=yl(N);return $=Ct($,I),$};if(i===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>na(u.map((f,m)=>l(f,r.slice(m,1),t.slice(m,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function lO(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function cO(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fxe={kernelName:$p,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>St(n),b:()=>St(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pxe={kernelName:Ip,gradFunc:t=>({x:()=>$e(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _xe={kernelName:Tp,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mxe={kernelName:Rp,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lxe={kernelName:Ap,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jxe={kernelName:q0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,o=eo(s,0);return{x:()=>Us(o,t,X(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bxe={kernelName:Op,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,ge(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zxe={kernelName:Dp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,$e(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uxe={kernelName:Sue,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const i=Ni(s);return Ye(t,X(He(t,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(t,e,n,s=5,r=1,o=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:o,beta:i};return Y.runKernel(xN,a,l)}const Wxe=Q({localResponseNormalizationBackprop_:Vxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hxe={kernelName:Q0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=n;return{x:()=>Wxe(s,r,t,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e,n,s){return e.rank<n.rank&&(e=Z(e,An(e.shape,s))),t.rank<n.rank&&(t=Z(t,An(t.shape,s))),{x:()=>X(t,$e(ki(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uO={kernelName:ev,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,o=e[0],i=e[1],a=ft(r,o.shape),l=uU(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gxe={kernelName:Fp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>X(t,$e(_c(n,s),"float32")),b:()=>X(t,$e(Zx(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t,e,n,s,r,o,i){const a=M(t,"dy","maxPool3dGrad"),l=M(e,"input","maxPool3dGrad"),c=M(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=Z(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=Z(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=Z(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),dr("maxPool3dGrad",o,i);const m={dy:u,input:d,output:h},g={filterSize:s,strides:r,pad:o,dimRoundingMode:i},y=Y.runKernel(vN,m,g);return f?Z(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const Kxe=Q({maxPool3dGrad_:qxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xxe={kernelName:nv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>Kxe(t,s,r,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yxe(t,e,n,s,r,o,i){const a=M(t,"dy","maxPoolGrad"),l=M(e,"input","maxPoolGrad"),c=M(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),dr("maxPoolGrad",o,i);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:o,dimRoundingMode:i};return Y.runKernel(yN,u,d)}const Jxe=Q({maxPoolGrad_:Yxe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zxe={kernelName:tv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a}=n;return{x:()=>Jxe(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qxe={kernelName:sv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,o=ft(r,s.shape),a=Yn(s.shape,o)[1],l=ie(a);return{x:()=>{const u=s.shape.slice();o.forEach(f=>{u[f]=1});const d=Z(t,u);return qe(X(d,bl(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eye={kernelName:rv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[o,i]=e,a=ft(r,o.shape),l=uU(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tye={kernelName:Pp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>X(t,$e(Dd(n,s),"float32")),b:()=>X(t,$e(eo(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nye={kernelName:ov,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>Vt(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sye={kernelName:_p,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=nt(n.shape,s.shape);return{a:()=>{const a=zn(n.shape,r);return a.length>0?Z(He(t,a),n.shape):t},b:()=>{const a=X(t,yn(Pv(qe(n,s)))),l=zn(s.shape,r);return l.length>0?Z(He(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rye={kernelName:Mp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=nt(n.shape,s.shape);return{a:()=>{const a=X(t,$e(s,"float32")),l=zn(n.shape,r);return l.length>0?Z(He(a,l),n.shape):a},b:()=>{const a=X(t,$e(n,"float32")),l=zn(s.shape,r);return l.length>0?Z(He(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oye={kernelName:iv,gradFunc:t=>({x:()=>yn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iye={kernelName:cv,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>qn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aye={kernelName:lv,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye={kernelName:uv,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return Sc(t,s).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dO={kernelName:dv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>Vt(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye={kernelName:Lp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,o=n,i=s,a=nt(o.shape,i.shape);return{a:()=>{const u=$e(i,"float32");let d=X(t,X(u,wc(o,Ye(u,Tt(1)))));const h=zn(o.shape,a);return h.length>0&&(d=He(d,h)),Z(d,o.shape)},b:()=>{const u=eo(o,0),d=Us(u,Ei(o),St(o));let h=X(t,X(r,d));const f=zn(i.shape,a);return f.length>0&&(h=He(h,f)),Z(h,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uye={kernelName:hv,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=eo(n,0);return{x:()=>Us(r,t,X(t,s)),alpha:()=>{let o=Us(r,St(t),X(t,n));const i=zn(s.shape,t.shape);return i.length>0&&(o=He(o,i)),Z(o,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dye(t,e,n){const s=t.shape.slice();s[n]=1;const r=Z(e,s),o=eS(t,n,!0,!1),i=eS(t,n,!0,!0),a=X(o,i);return X(r,a)}function hye(t,e,n){const s=t.shape.length,r=s-n.length,o=an(n,s);let i=t;o!=null&&(i=Ct(t,o));const a=i.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=i.reshape(a);let d=dye(u,e,r);if(d=d.reshape(i.shape),o!=null){const h=yl(o);d=Ct(d,h)}return d}const fye={kernelName:fv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let o=[];return r==null?o=s.shape.map((i,a)=>a):typeof r=="number"?o=[r]:o=r,{x:()=>hye(s,t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pye={kernelName:bp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=nt(n.shape,s.shape);return{a:()=>{const a=qe(t,$e(s,"float32")),l=zn(n.shape,r);return l.length>0?Z(He(a,l),n.shape):a},b:()=>{let a=X(t,$e(n,"float32"));const l=zn(s.shape,r);l.length>0&&(a=Z(He(a,l),s.shape));const c=Xt(s);return yn(qe(a,$e(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mye={kernelName:jp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,yn(Xt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gye={kernelName:zp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=X(Dd(n,6),am(n));return{x:()=>X(t,$e(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xye={kernelName:Bp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(t,$e(am(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yye={kernelName:pv,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vye={kernelName:gv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>Y.runKernel(EN,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bye={kernelName:mv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>Y.runKernel(NN,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wye={kernelName:xv,gradFunc:(t,e,n)=>{const{dims:s}=n,r=ft(s,t.shape);return{x:()=>Cc(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cye={kernelName:Up,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sye={kernelName:Vp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yn(qe(t,X(wc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kye={kernelName:yv,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>$e(St(n),"float32"),t:()=>X(t,$e(n,t.dtype)),e:()=>X(t,$e(qN(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nye={kernelName:Wp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=eo(n,Tt(0)),r=Tt(Lv),o=Tt(jv),i=X(t,o),a=X(X(t,r),Ni($e(n,"float32")));return Us(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eye={kernelName:Kp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(t,X(n,Ye(Tt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ye={kernelName:qp,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iye={kernelName:Hp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(zN($e(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tye={kernelName:Gp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(YB($e(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rye={kernelName:vv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:o}=n,i=s.shape,[a,l]=_v(s,r,o),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>YN(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aye={kernelName:Sv,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,o=!0,i=X(t,s);return{logits:()=>Ye(i,X(He(i,[r],o),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dye={kernelName:Xp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(t,Ad(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hO={kernelName:wv,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>jN(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fO={kernelName:Cv,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>or(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oye={kernelName:Yp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,X(Ss($e(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fye={kernelName:$N,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(t,X($e(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pye={kernelName:Jp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Tt(2);return{a:()=>X(t,X(r,Ye(n,s))),b:()=>X(t,X(r,Ye(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ye={kernelName:nm,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mye={kernelName:Zp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=nt(n.shape,s.shape);return{a:()=>{let a=t;const l=zn(n.shape,r);return l.length>0&&(a=He(a,l)),Z(a,n.shape)},b:()=>{let a=t;const l=zn(s.shape,r);return l.length>0&&(a=He(a,l)),Z(yn(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lye={kernelName:bv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:o}=n;ft(o,s.shape).forEach(c=>{r[c]=1});const a=Z(t,r),l=X(a,bl(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jye={kernelName:Qp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>qe(t,Xt(zN(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bye={kernelName:em,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>X(Ye(Tt(1),Xt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zye={kernelName:tm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let i=St(s);if(s.rank===1)for(let a=0;a<r[0];++a)i=ge(i,Vt(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)i=ge(i,Vt(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)i=ge(i,Vt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)i=ge(i,Vt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uye={kernelName:Du,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,o=yl(r);return{x:()=>Ct(t,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vye={kernelName:kv,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>na(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wye={kernelName:Nv,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Hye(t,n)}}};function Hye(t,e){const n=vl(e,St(e)),s=WN(t,n);let r=_c(e,Tt(0,"int32"));const o=s.rank-r.rank;for(let a=0;a<o;++a)r=er(r,a+1);r=ta(r,bl(s.shape,"bool"));const i=St(s);return Us(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gye={kernelName:Ev,gradFunc:t=>({x:()=>St(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qye=[cU,Wge,Hge,Gge,qge,Kge,Xge,Yge,Jge,Zge,Qge,exe,sxe,ixe,axe,lxe,cxe,uxe,dxe,hxe,fxe,pxe,gxe,mxe,vxe,bxe,wxe,Cxe,Sxe,kxe,pye,Nxe,Exe,$xe,Ixe,Txe,Axe,Rxe,Dxe,Oxe,Fxe,Pxe,_xe,Mxe,Lxe,jxe,Bxe,zxe,Uxe,Hxe,uO,uO,Gxe,Xxe,Zxe,Qxe,eye,tye,nye,sye,rye,oye,iye,aye,lye,dO,dO,cye,uye,fye,mye,gye,xye,yye,vye,bye,wye,Cye,Sye,kye,Nye,Eye,$ye,Iye,Tye,Rye,Aye,Dye,hO,hO,fO,fO,Oye,Pye,Fye,_ye,Mye,Lye,jye,Bye,zye,Uye,Vye,Wye,Gye];for(const t of qye)Eue(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.abs=function(){return this.throwIfDisposed(),Ps(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.acos=function(){return this.throwIfDisposed(),Tde(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.acosh=function(){return this.throwIfDisposed(),Ade(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.add=function(t){return this.throwIfDisposed(),ge(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.all=function(t,e){return this.throwIfDisposed(),GB(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.any=function(t,e){return this.throwIfDisposed(),ZC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.argMax=function(t){return this.throwIfDisposed(),Rf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.argMin=function(t){return this.throwIfDisposed(),_de(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),Z(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asType=function(t){return this.throwIfDisposed(),$e(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as1D=function(){return this.throwIfDisposed(),Z(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as2D=function(t,e){return this.throwIfDisposed(),Z(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Z(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),Z(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),Z(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asin=function(){return this.throwIfDisposed(),Lde(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asinh=function(){return this.throwIfDisposed(),Bde(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atan=function(){return this.throwIfDisposed(),Ude(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atan2=function(t){return this.throwIfDisposed(),Wde(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atanh=function(){return this.throwIfDisposed(),Gde(this)};oe().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),LN(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),jN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),Av(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Gh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cast=function(t){return this.throwIfDisposed(),$e(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.ceil=function(){return this.throwIfDisposed(),vhe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Yr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Fn&&(t=[t]),or([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv1d=function(t,e,n,s,r,o){return this.throwIfDisposed(),qB(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),KB(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),bc(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cos=function(){return this.throwIfDisposed(),zN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cosh=function(){return this.throwIfDisposed(),YB(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),eS(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),JB(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Whe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.depthwiseConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),UN(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),qhe(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.divNoNan=function(t){return this.throwIfDisposed(),Zhe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.div=function(t){return this.throwIfDisposed(),qe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.dot=function(t){return this.throwIfDisposed(),efe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.elu=function(){return this.throwIfDisposed(),Ov(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.equal=function(t){return this.throwIfDisposed(),ki(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.erf=function(){return this.throwIfDisposed(),ZB(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),hfe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.exp=function(){return this.throwIfDisposed(),Ni(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.expandDims=function(t){return this.throwIfDisposed(),er(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.expm1=function(){return this.throwIfDisposed(),gfe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.fft=function(){return this.throwIfDisposed(),xz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.flatten=function(){return this.throwIfDisposed(),Z(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.floor=function(){return this.throwIfDisposed(),Pv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.floorDiv=function(t){return this.throwIfDisposed(),HB(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.gather=function(t,e,n){return this.throwIfDisposed(),WN(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.greaterEqual=function(t){return this.throwIfDisposed(),_c(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.greater=function(t){return this.throwIfDisposed(),eo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.ifft=function(){return this.throwIfDisposed(),tS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.irfft=function(){return this.throwIfDisposed(),ame(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isFinite=function(){return this.throwIfDisposed(),Nfe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isInf=function(){return this.throwIfDisposed(),$fe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isNaN=function(){return this.throwIfDisposed(),Tfe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.leakyRelu=function(t){return this.throwIfDisposed(),GN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.lessEqual=function(t){return this.throwIfDisposed(),Dd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.less=function(t){return this.throwIfDisposed(),Zx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),Ffe(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSigmoid=function(){return this.throwIfDisposed(),zfe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSoftmax=function(t){return this.throwIfDisposed(),sz(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),rz(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.log=function(){return this.throwIfDisposed(),Ei(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.log1p=function(){return this.throwIfDisposed(),nz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalAnd=function(t){return this.throwIfDisposed(),ta(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalNot=function(){return this.throwIfDisposed(),qN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalOr=function(t){return this.throwIfDisposed(),oz(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalXor=function(t){return this.throwIfDisposed(),Xfe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),It(this,t,e,n)};oe().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),KN(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.max=function(t,e){return this.throwIfDisposed(),Uo(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.maximum=function(t){return this.throwIfDisposed(),vl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mean=function(t,e){return this.throwIfDisposed(),$n(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.min=function(t,e){return this.throwIfDisposed(),Jx(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.minimum=function(t){return this.throwIfDisposed(),Of(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),spe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mod=function(t){return this.throwIfDisposed(),ope(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mul=function(t){return this.throwIfDisposed(),X(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.neg=function(){return this.throwIfDisposed(),yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Fv(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.notEqual=function(t){return this.throwIfDisposed(),Qx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),iz(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.onesLike=function(){return this.throwIfDisposed(),ko(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.pad=function(t,e){return this.throwIfDisposed(),YN(this,t,e)};oe().prototype.pool=function(t,e,n,s,r,o){return this.throwIfDisposed(),mpe(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.pow=function(t){return this.throwIfDisposed(),wc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.prelu=function(t){return this.throwIfDisposed(),ZN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.prod=function(t,e){return this.throwIfDisposed(),ype(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reciprocal=function(){return this.throwIfDisposed(),zpe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.relu=function(){return this.throwIfDisposed(),Lc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.relu6=function(){return this.throwIfDisposed(),cz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reshapeAs=function(t){return this.throwIfDisposed(),Z(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reshape=function(t){return this.throwIfDisposed(),Z(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Cz(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),Sz(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reverse=function(t){return this.throwIfDisposed(),Cc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.rfft=function(){return this.throwIfDisposed(),ume(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.round=function(){return this.throwIfDisposed(),uz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.rsqrt=function(){return this.throwIfDisposed(),dz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.selu=function(){return this.throwIfDisposed(),hz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.separableConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),fz(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sigmoid=function(){return this.throwIfDisposed(),Ad(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sign=function(){return this.throwIfDisposed(),Ype(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sin=function(){return this.throwIfDisposed(),pz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sinh=function(){return this.throwIfDisposed(),mz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.slice=function(t,e){return this.throwIfDisposed(),Vt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.softmax=function(t){return this.throwIfDisposed(),lE(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.softplus=function(){return this.throwIfDisposed(),rm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),JN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.split=function(t,e){return this.throwIfDisposed(),Gr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sqrt=function(){return this.throwIfDisposed(),Ss(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.square=function(){return this.throwIfDisposed(),Xt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.squaredDifference=function(t){return this.throwIfDisposed(),hme(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.squeeze=function(t){return this.throwIfDisposed(),im(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Fn?[this,t]:[this,...t];return na(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.step=function(t){return this.throwIfDisposed(),am(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.stridedSlice=function(t,e,n,s,r,o,i,a){return this.throwIfDisposed(),xme(this,t,e,n,s,r,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sub=function(t){return this.throwIfDisposed(),Ye(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sum=function(t,e){return this.throwIfDisposed(),He(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tan=function(){return this.throwIfDisposed(),vme(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tanh=function(){return this.throwIfDisposed(),Rv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tile=function(t){return this.throwIfDisposed(),Lo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toBool=function(){return this.throwIfDisposed(),$e(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toFloat=function(){return this.throwIfDisposed(),$e(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toInt=function(){return this.throwIfDisposed(),$e(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.topk=function(t,e){return this.throwIfDisposed(),Cme(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.transpose=function(t){return this.throwIfDisposed(),Ct(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unique=function(t){return this.throwIfDisposed(),Nme(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),bz(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unstack=function(t){return this.throwIfDisposed(),Sc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.where=function(t,e){return this.throwIfDisposed(),Us(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.zerosLike=function(){return this.throwIfDisposed(),St(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ai extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ai.prototype)}}class go extends Error{constructor(e){super(e),Object.setPrototypeOf(this,go.prototype)}}class q extends Error{constructor(e){super(e),Object.setPrototypeOf(this,q.prototype)}}class ut extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ut.prototype)}}class WE extends Error{constructor(e){super(e),Object.setPrototypeOf(this,WE.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dU{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kc(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function li(t,e){if(!t)throw new WE(e)}function pO(t,e){let n=0;for(const s of t)s===e&&n++;return n}function tr(t){return t.length===1?t[0]:t}function Ot(t){return Array.isArray(t)?t:[t]}function Fi(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Pl(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let so={};function HE(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function rS(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>rS(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:rS(s))}}}function dm(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const o=t;let i;if(o in n)i=n[o];else if(o in so)i=so[o];else if(i=e[o],i==null)throw new q(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=t;if(o.className==null||o.config==null)throw new q(`${s}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in n?[a,l]=n[i]:i in so?[a,l]=so.className:i in e&&([a,l]=e[i]),a==null)throw new q(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(so))c[f]=so[f];for(const f of Object.keys(n))c[f]=n[f];const u=o.config;u.customObjects=c;const d=Object.assign({},so);for(const f of Object.keys(n))so[f]=n[f];rS(o.config);const h=l(a,o.config,n,r);return so=Object.assign({},d),h}else{const c=Object.assign({},so);for(const d of Object.keys(n))so[d]=n[d];const u=new a(o.config);return so=Object.assign({},c),u}}}function Kye(t,e){return t<e?-1:t>e?1:0}function cg(t,e){return-1*Kye(t,e)}function Ka(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function Xye(t){if(t==null)throw new q(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Bc(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new q(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function GE(t,e,n=0,s=1/0){return li(n>=0),li(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function Xn(t,e){Array.isArray(t)?(T(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Xn(n,`element ${s+1} of ${e}`))):T(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${hU(t)}.`)}function hU(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>hU(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Yye(t,e,n){let s=n!=null?n():Qs(),r;return(...i)=>{const a=n!=null?n():Qs();return a-s<e||(s=a,r=t(...i)),r}}function fU(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Jye=0;function pU(){return Jye++}const ug={};function Bv(t=""){return t in ug||(ug[t]=0),ug[t]+=1,t+ug[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Zye=["channelsFirst","channelsLast"],Qye=["nearest","bilinear"],e0e=["valid","same","causal"],t0e=["max","avg"],n0e=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const tu=new Map;function wn(t){Bc(Zye,"DataFormat",t)}function s0e(t){Bc(Qye,"InterpolationFormat",t)}function to(t){Bc(e0e,"PaddingMode",t)}function mU(t){Bc(t0e,"PoolMode",t)}const qh=[],mO="/";function tc(t,e){qh.push(t);try{const n=e();return qh.pop(),n}catch(n){throw qh.pop(),n}}function r0e(){return qh.length===0?"":qh.join(mO)+mO}function gU(t){if(!yU(t))throw new Error("Not a valid tensor name: '"+t+"'");return r0e()+t}function xU(t){if(!yU(t))throw new Error("Not a valid tensor name: '"+t+"'");tu.has(t)||tu.set(t,0);const e=tu.get(t);if(tu.set(t,tu.get(t)+1),e>0){const n=`${t}_${e}`;return tu.set(n,1),n}else return t}const o0e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function yU(t){return!!t.match(o0e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function i0e(t){return t===parseInt(t.toString(),10)}function Xa(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function od(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function sl(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function Ho(t,e){if(e<t)throw new q(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let j1;function _n(){return j1==null&&(j1=Que().epsilon()),j1}function Go(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ci(t,e){return $e(t,e)}function hm(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),Z(t,n)}function a0e(t,e){return ee(()=>{if(t.shape.length!==2)throw new q(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=hm(t,1);return oS(n,[1,e,1])})}function l0e(t){const e=[Xa(t.shape)];return Z(t,e)}function c0e(t){if(t.rank<=1)throw new q(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Xa(t.shape,1)];return Z(t,e)}function nc(t,e,n){return ee(()=>{switch(t.rank){case 1:return iE(t,e,n);case 2:return gz(t,[e,0],[n,t.shape[1]]);case 3:return aE(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return ty(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Vt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Vt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new q(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function B1(t,e,n){return ee(()=>{switch(t.rank){case 1:return iE(t,e,n);case 2:return gz(t,[0,e],[t.shape[0],n]);case 3:return aE(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return ty(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new q(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function dg(t,e,n,s){return ee(()=>{switch(t.rank){case 1:return iE(t,e,n);case 2:switch(s){case 1:return nc(t,e,n);case 2:return B1(t,e,n);default:throw new q(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return nc(t,e,n);case 2:return aE(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return B1(t,e,n);default:throw new q(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return nc(t,e,n);case 2:return ty(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return ty(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return B1(t,e,n);default:throw new q(`The axis is not within the rank of the tensor ${s}`)}default:throw new q(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function qE(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),or(t,e)}function gO(t,e){switch(t.rank){case 1:return Che([t,e]);case 2:return khe([t,e],0);case 3:return Ehe([t,e],0);case 4:return Ihe([t,e],0);default:throw new q(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function oS(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new q(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Lo(t,e)}function zv(t,e=0,n=1,s,r){return Mpe(t,e,n,s,r)}function Si(t,e,n,s){if(t.rank<2||e.rank<2)throw new ut(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(r!==o)throw new ut(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return nO({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?iS(t.rank,s,Go()):null,activation:n});{const r=t.shape.slice(),o=r.pop();t=Z(t,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:e.rank},(m,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=Z(Ct(e,u),[l,-1]);const d=[...r,...c];return Z(nO({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?iS(t.rank,s,Go()):null,activation:n}),d)}}function vU(t,e,n){return ee(()=>(Array.isArray(e)?e=wr(e,"int32"):e=$e(e,"int32"),WN(t,e,n)))}function fm(t){return X(t,t)}function iS(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new q(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?Z(e,[1,s[0],1,1,1]):Z(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?Z(e,[1,1,1,1,s[0]]):Z(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?Z(e,[1,s[0],1,1]):Z(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?Z(e,[1,1,1,s[0]]):Z(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?Z(e,[1,s[0],1]):Z(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?Z(e,[1,1,s[0]]):Z(e,[1].concat(s))}else if(t<3)return e;throw new q(`Unsupported input rank by biasAdd: ${e.rank}`)}function Yo(t,e,n){return ee(()=>(n==null&&(n=Go()),wn(n),ge(t,iS(t.rank,e,n))))}function u0e(t,e=1){if(e!==1)throw new ut(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Ov(t)}function d0e(t){return ee(()=>qe(t,ge(Ps(t),1)))}function bU(t,e,n,s){return ee(()=>Dme(t,e,n,s))}function h0e(t){return ee(()=>{const e=ge(.5,X(.2,t));return Yr(e,0,1)})}function pm(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const f0e=["fanIn","fanOut","fanAvg"],p0e=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function m0e(t){Bc(f0e,"FanMode",t)}function g0e(t){Bc(p0e,"Distribution",t)}class Eo extends Fd{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class wU extends Eo{apply(e,n){return qn(e,n)}}wU.className="Zeros";fe(wU);class KE extends Eo{apply(e,n){return bl(e,n)}}KE.className="Ones";fe(KE);class CU extends Eo{constructor(e){if(super(),typeof e!="object")throw new q(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new q(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return ee(()=>X(Tt(this.value),bl(e,n)))}getConfig(){return{value:this.value}}}CU.className="Constant";fe(CU);class SU extends Eo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return om(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}SU.className="RandomUniform";fe(SU);class kU extends Eo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ut(`randomNormal does not support dType ${n}.`);return zv(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}kU.className="RandomNormal";fe(kU);class NU extends Eo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ut(`truncatedNormal does not support dType ${n}.`);return vz(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}NU.className="TruncatedNormal";fe(NU);class EU extends Eo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return ee(()=>{if(e.length!==2||e[0]!==e[1])throw new q("Identity matrix initializer can only be used for 2D square matrices.");return X(this.gain,tz(e[0]))})}getConfig(){return{gain:this.gain}}}EU.className="Identity";fe(EU);function x0e(t,e="channelsLast"){let n,s;if(wn(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Xa(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Xa(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Xa(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class Rr extends Eo{constructor(e){if(super(),e.scale<0)throw new q(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,m0e(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,g0e(this.distribution),this.seed=e.seed}apply(e,n){const s=x0e(e),r=s[0],o=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(r+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ut(`${this.getClassName()} does not support dType ${n}.`);return vz(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return om(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Rr.className="VarianceScaling";fe(Rr);class XE extends Rr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Rr.className}}XE.className="GlorotUniform";fe(XE);class YE extends Rr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Rr.className}}YE.className="GlorotNormal";fe(YE);class JE extends Rr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Rr.className}}JE.className="HeNormal";fe(JE);class ZE extends Rr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Rr.className}}ZE.className="HeUniform";fe(ZE);class QE extends Rr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Rr.className}}QE.className="LeCunNormal";fe(QE);class e$ extends Rr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Rr.className}}e$.className="LeCunUniform";fe(e$);class $U extends Eo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return ee(()=>{if(e.length<2)throw new ut("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=ie(e.slice(0,-1)),r=e[e.length-1],o=s*r;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],a=zv(i,0,1,n,this.seed),l=Ige.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=X(c,d.sign()),s<r&&(c=c.transpose()),X(Tt(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}$U.className="Orthogonal";fe($U);const xO={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function yO(t,e={}){return dm(t,uo.getMap().classNameMap,e,"initializer")}function on(t){return HE(t)}function tn(t){if(typeof t=="string"){const e=t in xO?xO[t]:t;if(e==="GlorotNormal")return new YE;if(e==="GlorotUniform")return new XE;if(e==="HeNormal")return new JE;if(e==="HeUniform")return new ZE;if(e==="LeCunNormal")return new QE;if(e==="LeCunUniform")return new e$;{const n={};return n.className=e,n.config={},yO(n)}}else return t instanceof Eo?t:yO(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aS(t){return Array.isArray(t)&&Array.isArray(t[0])}function ny(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Je(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new q(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Et(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new q(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sy(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vO="Variable";class y0e{constructor(e,n="float32",s=vO,r=!0,o=null){this.dtype=n??"float32",this.shape=e.shape,this.id=pU(),s=s??vO,this.originalName=gU(s),this.name=xU(this.originalName),this.trainable_=r,this.constraint=o,this.val=Ime(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),v0e(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function v0e(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function lS(t){return t.map(e=>e.read())}function t$(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class $i{constructor(e,n,s,r,o,i,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=pU(),i!=null&&(this.originalName=gU(i),this.name=xU(this.originalName)),this.rank=n.length}}let b0e=0,Uv=class{constructor(e,n){this.callArgs=n,this.id=b0e++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},w0e=0;class pt extends Fd{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=w0e++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=Fi(s)+"_"+Bv(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),s=[o].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new go(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new q(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return tr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return tr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ai(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ai(`Layer ${this.name} is not connected, no input to return.`);return tr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ai(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ai(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return tr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Ot(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Ot(this.inputSpec);if(n.length!==s.length)throw new q(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const o=n[r],i=s[r];if(i==null)continue;const a=o.rank;if(i.ndim!=null&&a!==i.ndim)throw new q(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new q(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new q(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&o.dtype!==i.dtype)throw new q(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${o.dtype}.`);if(i.axes){const l=o.shape;for(const c in i.axes){const u=Number(c),d=i.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new q(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const c=i.shape[l],u=o.shape[l];if(c!=null&&u!=null&&c!==u)throw new q(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${o.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Ot(e),r=k0e(e),o=N0e(e);if(r===o)throw new q("Arguments to apply() must be all SymbolicTensors or all Tensors");return tc(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of Ot(e))i.push(a.shape);this.build(tr(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const a=Ot(i),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=tr(l),this.activityRegularizer!=null)throw new ut("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=C0e(e),a=this.computeOutputShape(i);let l;const c=S0e(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new $i(c,u,this,Ot(e),n,this.name,d)):l=new $i(c,a,this,Ot(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new ut("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ai(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ai(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new go(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return sy(this.weights)}build(e){this.built=!0}getWeights(e=!1){return lS(e?this.trainableWeights:this.weights)}setWeights(e){ee(()=>{const n=this.weights;if(n.length!==e.length)throw new q(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=lS(n);for(let o=0;o<r.length;++o){const i=r[o],a=n[o],l=e[o];if(!Rt(i.shape,l.shape))throw new q(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}t$(s)})}addWeight(e,n,s,r,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new q(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():tn("zeros"));const c=r.apply(n,s),u=new y0e(c,s,e,i,a);return c.dispose(),o!=null&&this.addLoss(()=>o.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Ot(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),o=Ot(n),i=Ot(r);if(o.length!==i.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=i[a]}addInboundNode(e,n,s,r,o,i,a=null){const l=Ot(e);n=Ot(n),s=Ot(s),r=Ot(r),o=ny(o),i=ny(i);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new Uv({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:o,outputShapes:i},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function C0e(t){t=Ot(t);const e=[];for(const n of t)e.push(n.shape);return tr(e)}function S0e(t){return"float32"}function IU(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let o=0;o<s.inboundLayers.length;o++){const i=s.inputTensors[o],a=s.inboundLayers[o],l=s.nodeIndices[o],c=IU(i,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function k0e(t){let e=!0;for(const n of Ot(t))if(!(n instanceof $i)){e=!1;break}return e}function N0e(t){let e=!0;for(const n of Ot(t))if(n instanceof $i){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mm extends pt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Bv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new q("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new q("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new q("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new $i(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Uv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new q(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}mm.className="InputLayer";fe(mm);function TU(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new q("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new mm({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function E0e(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return $e(e,t.dtype)}catch{throw new q(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Oa{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Oa)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=E0e(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new q(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof $i){if(this.id2Value[e.id]==null)throw new q(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new q(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof $i){if(this.id2Value[e.id]==null)throw new q(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new q(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&mt(this.id2Mask)}}const ry=new dU,oy=new dU;function $0e(t){ry!=null&&ry.setMaxEntries(t),oy!=null&&oy.setMaxEntries(t)}function wh(t,e,n,s){const r=n==null?!1:n.training,o=Array.isArray(t),i=o?t:[t],a=i.map(m=>m.name),l=[],c=e.names();for(const m of a)c.indexOf(m)!==-1?l.push(e.getValue(m)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let d=ry.get(u),h;if(d==null){const m=I0e(i,e);d=m.sorted,h=m.recipientCounts,ry.put(u,d),oy.put(u,h)}h={},r||Object.assign(h,oy.get(u));const f=new Oa(e);for(let m=0;m<d.length;++m){const g=d[m],y=g.sourceLayer;if(y instanceof mm)continue;const x=[],v=[],b=[];let w=!1;for(const $ of g.inputs){const I=f.getValue($),A=f.getMask($);x.push(I),v.push(A),A!=null&&(w=!0),r||(h[$.name]--,h[$.name]===0&&!e.hasKey($)&&a.indexOf($.name)===-1&&!I.isDisposed&&$.sourceLayer.stateful!==!0&&b.push(I))}w&&(n=n||{},n.mask=v[0]);const C=Ot(y.apply(x,n));let k=null;y.supportsMasking&&(k=y.computeMask(x,v));const N=R0e(g),E=Array.isArray(N)?N:[N];for(let $=0;$<E.length;++$){f.hasKey(E[$])||f.add(E[$],C[$],Array.isArray(k)?k[0]:k);const I=a.indexOf(E[$].name);I!==-1&&(l[I]=C[$])}r||mt(b)}return f.disposeMasks(),o?l:l[0]}function I0e(t,e){T(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=bO(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const o of t){const{sorted:i,recipientMap:a}=bO(o,e);for(const l of i)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:T0e(s)}}function T0e(t){const e={};for(const n in t)e[n]=t[n].size;return e}function bO(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const o=[],i=[];for(o.push(t);o.length>0;){const a=o[o.length-1];if(n.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),s.push(a),n.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&o.push(c)}}return{sorted:s,recipientMap:r}}function R0e(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0e=se();A0e.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,$0e);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function n$(t,e){return ee(()=>Ss(He(X(t,t),e,!0)))}class gm extends Fd{getConfig(){return{}}}class RU extends gm{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ee(()=>{const n=n$(e,this.axis),s=Yr(n,0,this.maxValue);return X(e,qe(s,ge(_n(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}RU.className="MaxNorm";fe(RU);class AU extends gm{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ee(()=>qe(e,ge(_n(),n$(e,this.axis))))}getConfig(){return{axis:this.axis}}}AU.className="UnitNorm";fe(AU);class DU extends gm{apply(e){return Lc(e)}}DU.className="NonNeg";fe(DU);class OU extends gm{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ee(()=>{const n=n$(e,this.axis),s=ge(X(this.rate,Yr(n,this.minValue,this.maxValue)),X(1-this.rate,n));return X(e,qe(s,ge(_n(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}OU.className="MinMaxNorm";fe(OU);const wO={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function jn(t){return HE(t)}function CO(t,e={}){return dm(t,uo.getMap().classNameMap,e,"constraint")}function Bn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in wO?wO[t]:t,config:{}};return CO(n)}else return t instanceof gm?t:CO(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function $l(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const o=t[r];if(typeof o!="number"){const i=o;e.push(i.data()),n.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let o=0;o<r.length;++o)t[n[o]]=r[o][0];mt(s)}}function FU(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var SO;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(SO||(SO={}));const D0e=125;class Pf{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class O0e{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class F0e extends Pf{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const o=n[r];if(typeof o=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+o*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const a=ee(()=>ge(this.totals[r],X(o,s)));this.totals[r]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:ee(()=>{const r=X(qe(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),bi(n[s])}))}}class P0e extends Pf{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(o),s.push(a)}}const r=await Promise.all(e);for(let o=0;o<r.length;++o)this.history[n[o]][s[o]].dispose(),this.history[n[o]][s[o]]=r[o][0]}}class _0e extends Pf{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||Lz,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=D0e),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");MC(this.yieldEvery)&&(this.maybeWait=Yye(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await $l(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await $l(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await $l(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await $l(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await $l(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):MC(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await $l(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await $l(e),await this.trainEnd(e))}}function PU(t,e){return t==null&&(t={}),t instanceof Pf?[t]:Array.isArray(t)&&t[0]instanceof Pf?t:Ot(t).map(s=>new _0e(s,e))}class io{constructor(){}static registerCallbackConstructor(e,n){T(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),io.checkForDuplicate(n),io.constructors[e]==null&&(io.constructors[e]=[]),io.constructors[e].push(n)}static checkForDuplicate(e){for(const n in io.constructors)io.constructors[+n].forEach(r=>{if(r===e)throw new q("Duplicate callback constructor.")})}static clear(){io.constructors={}}static createCallbacks(e){const n=[];for(const s in io.constructors){const r=+s;e>=r&&n.push(...io.constructors[r])}return n.map(s=>new s)}}io.constructors={};function _U(t,e,n,s,r,o,i,a,l){const c=new P0e,u=[new F0e,...io.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new O0e(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hi(t,e={},n=!1){return dm(t,uo.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function iy(t,e){return ee(()=>{t.dtype!=="float32"&&(t=$e(t,"float32"));const n=He(fm(t),e,!0),s=Dv(n.shape,_n()),r=Ss(vl(n,s));return qe(t,r)})}function Vv(t,e){return ee(()=>$n(fm(Ye(e,t)),-1))}function s$(t,e){return ee(()=>$n(Ps(Ye(e,t)),-1))}function r$(t,e){return ee(()=>{const n=Ye(t,e),s=Yr(Ps(t),_n(),Number.MAX_VALUE),r=Ps(qe(n,s));return X(100,$n(r,-1))})}function M0e(t,e){return ee(()=>{const n=Yr(e,_n(),Number.MAX_VALUE),s=Ei(ge(1,n)),r=Yr(t,_n(),Number.MAX_VALUE),o=Ei(ge(1,r));return $n(fm(Ye(s,o)),-1)})}function L0e(t,e){return ee(()=>{const n=vl(0,Ye(1,X(t,e)));return $n(fm(n),-1)})}function j0e(t,e){return ee(()=>{const n=vl(0,Ye(1,X(t,e)));return $n(n,-1)})}function B0e(t,e){return ee(()=>{const n=He(X(t,e),-1),s=Uo(X(Ye(1,t),e),-1);return vl(0,ge(1,Ye(s,n)))})}function z0e(t,e){return ee(()=>{const n=Math.log(2),s=Ye(e,t),r=Ye(ge(s,rm(X(-2,s))),n);return $n(r,-1)})}function _f(t,e,n=!1){return ee(()=>{if(n)e=lE(e);else{const s=He(e,e.shape.length-1,!0);e=qe(e,s)}return e=Yr(e,_n(),1-_n()),yn(He(X($e(t,"float32"),Ei(e)),e.shape.length-1))})}function ay(t,e,n=!1){return ee(()=>{const s=$e(Pv(l0e(t)),"int32");e=Yr(e,_n(),1-_n());const r=e.shape,o=Z(iz(s,r[r.length-1]),r);return _f(o,e,n)})}function U0e(t,e){if(!Rt(t.shape,e.shape))throw new q(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return ee(()=>{const n=Lc(e),s=yn(Ps(e));return ge(Ye(n,X(e,t)),nz(Ni(s)))})}function Wv(t,e){return ee(()=>{let n;return n=Yr(e,_n(),1-_n()),n=Ei(qe(n,Ye(1,n))),$n(U0e(t,n),-1)})}function V0e(t,e){return ee(()=>{const n=Yr(t,_n(),1),s=Yr(e,_n(),1);return He(X(t,Ei(qe(n,s))),-1)})}function W0e(t,e){return ee(()=>{const n=Ei(ge(_n(),e));return $n(Ye(e,X(t,n)),-1)})}function MU(t,e){return ee(()=>{const n=iy(t,-1),s=iy(e,-1),r=X(n,s);return yn(He(r,-1))})}const ly={meanSquaredError:Vv,meanAbsoluteError:s$,meanAbsolutePercentageError:r$,meanSquaredLogarithmicError:M0e,squaredHinge:L0e,hinge:j0e,categoricalHinge:B0e,logcosh:z0e,categoricalCrossentropy:_f,sparseCategoricalCrossentropy:ay,binaryCrossentropy:Wv,kullbackLeiblerDivergence:V0e,poisson:W0e,cosineProximity:MU};function z1(t){if(typeof t=="string"){if(t in ly)return ly[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new q(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function LU(t,e){return ee(()=>{const n=X(.5,ko(e)),s=Ci(eo(e,n),t.dtype);return $n(ki(t,s),-1)})}function jU(t,e){return ee(()=>Ci(ki(Rf(t,-1),Rf(e,-1)),"float32"))}function H0e(t,e){return ee(()=>$e(He(ta(ki(t,1),ki(e,1))),"float32"))}function G0e(t,e){return ee(()=>$e(He(ta(ki(t,0),ki(e,1))),"float32"))}function q0e(t,e){return ee(()=>{const n=H0e(t,e),s=G0e(t,e),r=ge(n,s);return $e(Us(eo(r,0),qe(n,r),0),"float32")})}function K0e(t,e){return Wv(t,e)}function X0e(t,e){return t.rank===e.rank&&(t=im(t,[t.rank-1])),e=Rf(e,-1),e.dtype!==t.dtype&&(e=$e(e,t.dtype)),$e(ki(t,e),"float32")}const Y0e=Vv,J0e=Vv,Z0e=s$,Q0e=s$,eve=r$,tve=r$,BU=_f,nve=MU,zU=ay,cy={binaryAccuracy:LU,categoricalAccuracy:jU,precision:q0e,categoricalCrossentropy:BU,sparseCategoricalCrossentropy:zU,mse:Y0e,MSE:J0e,mae:Z0e,MAE:Q0e,mape:eve,MAPE:tve,cosine:nve};function sve(t){if(typeof t=="string"&&t in cy)return cy[t];if(typeof t!="string"&&t!=null)return t;throw new q(`Unknown metric ${t}`)}function hg(t){if(li(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(ly))if(ly[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(cy))if(cy[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rve(t){const e={Adagrad:()=>eu.adagrad(.01),Adadelta:()=>eu.adadelta(1,.95,_n()),Adam:()=>eu.adam(.001,.9,.999,_n()),Adamax:()=>eu.adamax(.002,.9,.999,_n(),0),RMSProp:()=>eu.rmsprop(.001,.9,0,_n()),SGD:()=>eu.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new q(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const kO=1*1024*1024;function NO(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!cS(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>kO&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${kO}.`)}}function cS(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!cS(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!cS(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ove(t,e,n,s=console.log){const r=ave(t),o=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let i;if(!r){o.push("Receives inputs"),i=[];for(const u in t.nodesByDepth)i.push(...t.nodesByDepth[u])}s("_".repeat(e)),uy(o,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?lve(a[u],n,s):cve(a[u],n,i,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=ive(t),c=sy(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function ive(t){let e;return t.collectedTrainableWeights!=null?e=sy(t.collectedTrainableWeights):e=sy(t.trainableWeights),e}function ave(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let o=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function uy(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function lve(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=t.name,i=t.getClassName(),a=[`${o} (${i})`,r,s,t.countParams().toString()];uy(a,e,n)}function cve(t,e,n,s){let r,o;try{o=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,m=d.nodeIndices[h],g=d.tensorIndices[h];i.push(`${f}[${m}][${g}]`)}const a=t.name,l=t.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,o,r,t.countParams().toString(),c];uy(u,e,s);for(let d=1;d<i.length;++d)uy(["","","","",i[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UU(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function uS(t,e){if(t===null)return null;if(typeof t=="string")return Pl(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];UU(e,r,o)?n.push(o):n.push(uS(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const o=Pl(s);n[o]=uS(r,o)}}return n}}function dS(t,e){if(t==null)return null;if(typeof t=="string")return Fi(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];UU(e,r,o)?n.push(o):n.push(dS(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],o=Fi(s);(s==="name"||s==="className")&&typeof r=="string"?n[o]=r:n[o]=dS(r,s)}return n}}/** @license See the LICENSE file. */const VU="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const uve=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Ao extends pt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const v=this.getClassName().toLowerCase();this.name=Bv(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ka(this.inputs).length!==this.inputs.length)throw new q(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);Ka(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const b=v.sourceLayer,w=v.nodeIndex,C=v.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(C)}for(const v of this.inputs){const b=v.sourceLayer,w=v.nodeIndex,C=v.tensorIndex;li(w===0,"input layer has >1 nodes"),li(C===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const b=this.inputLayers[v];if(!(b instanceof mm))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${v} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);const n={},s={},r={},o={},i={},a=[],l=(v,b,w,C,k,N)=>{(C==null||k==null||N==null)&&(C=v.sourceLayer,k=v.nodeIndex,N=v.tensorIndex);const E=C.inboundNodes[k];if(w.indexOf(E)!==-1)throw new go(`The tensor ${v.name} at layer "${C.name}" is part of a cycle.`);if(b.indexOf(E)!==-1)return;this.containerNodes.add(Ao.nodeKey(C,k)),C.id in i||(i[C.id]=Object.keys(i).length),w.indexOf(E)===-1&&w.push(E);const $=E.inboundLayers.length;for(let I=0;I<$;I++){const A=E.inputTensors[I],P=E.inboundLayers[I],_=E.nodeIndices[I],U=E.tensorIndices[I];l(A,b,w,P,_,U)}for(b.push(E);w.indexOf(E)>=0;)w.splice(w.indexOf(E),1);a.push(E)},c=[],u=[];for(const v of this.outputs)l(v,c,u);const d=a.slice().reverse();for(const v of d){s[v.id]=v,v.id in n||(n[v.id]=0);let b=n[v.id];const w=r[v.outboundLayer.id]==null?0:r[v.outboundLayer.id];b=Math.max(b,w),r[v.outboundLayer.id]=b,o[v.outboundLayer.id]=v.outboundLayer,n[v.id]=b;for(let C=0;C<v.inboundLayers.length;C++){const k=v.inboundLayers[C],N=v.nodeIndices[C],E=k.inboundNodes[N],$=n[E.id]==null?0:n[E.id];n[E.id]=Math.max(b+1,$),s[E.id]=E}}const h={};for(const v in n){const b=n[v];b in h||(h[b]=[]),h[b].push(s[v])}const f={};for(const v in r){const b=r[v];b in f||(f[b]=[]),f[b].push(o[v])}let m=Object.keys(f).map(v=>parseInt(v,10)).sort(cg);this.layers=[];for(const v of m){const b=f[v];b.sort((w,C)=>{const k=i[w.id],N=i[C.id];return k<N?-1:k>N?1:0});for(const w of b)w instanceof Ao&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,m=Object.keys(h).map(v=>parseInt(v,10)).sort(cg);const g=this.inputs.slice(),y=[];for(const v of m)for(const b of h[v]){const w=b.outboundLayer;if(w!=null){for(const C of b.inputTensors)if(g.indexOf(C)===-1)throw new go(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${w.name}". The following previous layers were accessed without issue: ${y}`);for(const C of b.outputTensors)g.push(C);y.push(w.name)}}this.nodesByDepth=h;const x=this.layers.map(v=>v.name);for(const v of x){const b=x.filter(w=>w===v).length;if(b!==1)throw new go(`The name "${v}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new Uv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new q("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const o=uve(e);o&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=o?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new q(`Duplicate weight name: ${u}`);s[u]=c,r++}const i=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[a]]);else if(n)throw new q(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new q(`${a.length} of ${r} weights are not set: ${a}`)}t$(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],o=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");o!==n&&(e[o]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${VU}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=dS(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return ee(()=>{e=Ot(e);const s=new Oa;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return wh(this.outputs,s,n)})}computeMask(e,n){return ee(()=>{e=Ot(e);let s;return n==null?s=kc(null,e.length):s=Ot(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=ny(e);if(n.length!==this.inputLayers.length)throw new q(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(cg);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(u.id)!==-1)continue;const d=[];for(let g=0;g<c.inboundLayers.length;g++){const y=c.inboundLayers[g],x=c.nodeIndices[g],v=c.tensorIndices[g],b=`${y.name}_${x}_${v}`,w=s[b];d.push(w)}const h=u.computeOutputShape(tr(d)),f=ny(h),m=u.inboundNodes.indexOf(c);for(let g=0;g<f.length;g++){const y=`${u.name}_${m}_${g}`;s[y]=f[g]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;i.push(d)}for(let a=0;a<i.length;a++){const l=i[a];li(l in s),o.push(s[l])}return tr(o)}runInternalGraph(e,n){n==null&&(n=kc(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(cg);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,m=new Array;for(const g of h)g.id in s&&m.push(s[g.id]);if(m.length===h.length){let g={},y,x,v,b;if(u.callArgs!=null&&(g=u.callArgs),m.length===1){const[w,C]=m[0];g.mask==null&&(g.mask=C),v=Ot(d.call(w,g)),b=Ot(d.computeMask(w,C)),y=[w],x=[C]}else y=m.map(w=>w[0]),x=m.map(w=>w[1]),g.mask==null&&(g.mask=x),v=Ot(d.call(y,g)),b=Ot(d.computeMask(y,x));if(d.activityRegularizer)throw new ut("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){const C=f[w],k=v[w],N=b[w];s[C.id]=[k,N]}}}}const o=[],i=[],a=[];for(const l of this.outputs){li(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),o.push(c),i.push(u)}return[o,i,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Ao?1:0;for(let o=0;o<r.inboundNodes.length;o++){const i=Ao.nodeKey(r,o);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new q("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new q(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new q(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ee(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Ao.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),c=[];for(let d=0;d<i.inboundNodes.length;d++){const h=i.inboundNodes[d],f=Ao.nodeKey(i,d);let m={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),m=h.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(h.inboundLayers.length>0){const g=[];for(let y=0;y<h.inboundLayers.length;y++){const x=h.inboundLayers[y],v=h.nodeIndices[y],b=h.tensorIndices[y],w=Ao.nodeKey(x,v);let C=n[w];C==null&&(C=0),g.push([x.name,C,b,m])}c.push(g)}}}const u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=Ao.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[i];r.push([a.name,u,d])}e.inputLayers=r;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=Ao.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[i];o.push([a.name,u,d])}return e.outputLayers=o,e}static fromConfig(e,n,s={},r=!1){const o={},i={};function a(y,x){y.name in i?i[y.name].push(x):i[y.name]=[x]}function l(y,x){const v=[];let b;for(const w of x){const C=w[0],k=w[1],N=w[2];if(b=w[3]==null?{}:w[3],!(C in o)){a(y,x);return}const E=o[C];if(E.inboundNodes.length<=k){a(y,x);return}const $=E.inboundNodes[k];v.push($.outputTensors[N])}v.length>0&&y.apply(tr(v),b)}function c(y){const x=y.name,v=Hi(y,n.customObjects!=null?n.customObjects:{});v.setFastWeightInitDuringBuild(r),o[x]=v,y.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new q(`Corrupted configuration, expected array for nodeData: ${w}`);a(v,w)})}const u=n.name,d=n.layers;for(const y of d)c(y);for(;!Xye(i);)for(const y of d){const x=o[y.name];if(x.name in i){const v=i[x.name];delete i[x.name];for(const b of v)l(x,b)}}const h=[],f=[],m=n.inputLayers;for(const y of m){const x=y[0],v=y[1],b=y[2];li(x in o);const C=o[x].inboundNodes[v].outputTensors;h.push(C[b])}const g=n.outputLayers;for(const y of g){const x=y[0],v=y[1],b=y[2];li(x in o);const C=o[x].inboundNodes[v].outputTensors;f.push(C[b])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new q("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ee(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dve(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(o=>{o in t?r.push(t[o]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function WU(t,e){return dve(t,e,"classWeight")}async function HU(t,e,n,s){if(n!=null){const r=ee(()=>{if(t.shape.length===1)return ec(t);if(t.shape.length===2){if(t.shape[1]>1)return Rf(t,1);if(t.shape[1]===1)return Z(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await r.data());mt(r);const i=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),wr(i,"float32")}else return null}function hve(t,e){return X(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fve=32;function GU(t,e){let n,s;const r=e;n=r.xs,s=r.ys,T(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=EO("input",t.inputNames,n),i=EO("output",t.outputNames,s),a=o[0].shape[0];T(o.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),T(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:o,ys:i}}function EO(t,e,n){if(n instanceof Fn)return[n];if(Array.isArray(n))return T(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new q(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function pve(t){if(t.length===3)throw new ut("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function mve(t,e,n){const s=n.batchesPerEpoch!=null;if(T(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let o,i;if(r)if($O(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=pve(n.validationData);o=y.xs,i=y.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(y=>"val_"+y)):c=l.slice();const u=PU(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=_U(u,d,n.epochs,null,null,gve(e,n),null,r,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let m=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;m<n.epochs;){const y={};await h.onEpochBegin(m);let x=0,v=0;for(s||(g=await e.iterator());!s||x<n.batchesPerEpoch;){const b=await g.next();if(s&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:w,ys:C}=GU(t,b.value),k={};k.batch=v,k.size=w[0].shape[0],await h.onBatchBegin(v,k);const N=[];if(n.classWeight!=null){const I=WU(n.classWeight,t.outputNames);for(let A=0;A<I.length;++A)N.push(await HU(C[A],null,I[A]))}const E=w.concat(C).concat(N),$=a(E);mt(E);for(let I=0;I<l.length;++I){const A=l[I],P=$[I];k[A]=P,bi(P)}await h.onBatchEnd(v,k),FU(k),v++,x++}if(s?x>=n.batchesPerEpoch:b.done){if(r){let w;$O(n.validationData)?w=Ot(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):w=Ot(t.evaluate(o,i,{batchSize:n.validationBatchSize==null?fve:n.validationBatchSize,verbose:0}));for(let C=0;C<t.metricsNames.length;++C)y[`val_${t.metricsNames[C]}`]=w[C]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(m,y),m++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function gve(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function $O(t){return typeof t.iterator=="function"}function xve(t){return typeof t.next=="function"}async function yve(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let o=[];if(n.verbose>0)throw new ut("Verbose mode is not implemented yet.");T(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=xve(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await i.next();if(o=ee(()=>{if(c.value){const{xs:u,ys:d}=GU(t,c.value),h=u.concat(d),f=ee(()=>r(h));if(mt(h),l===0)for(let g=0;g<f.length;++g)o.push(Tt(0));const m=h[0].shape[0];for(let g=0;g<f.length;++g){const y=f[g],x=o[g];o[g]=ee(()=>ge(o[g],X(m,y))),l>0&&mt(x)}mt(f),a+=m,++l}return o}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<o.length;++c){const u=o[c];o[c]=qe(o[c],a),mt(u)}return tr(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function U1(t){T(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function uh(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>nc(s,e,n-e)):nc(t,e,n-e)}function hS(t,e){return ee(()=>t==null?null:Array.isArray(t)?t.map(n=>hS(n,e)):vU(t,e.dtype==="int32"?e:$e(e,"int32")))}function V1(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function qU(t){const e=[];t instanceof Fn&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(hm(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function To(t,e){if(t==null)return;const n=[];if(e instanceof Fn)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const o=e[r];n.push(o.id)}const s=[];if(t instanceof Fn)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const o=t[r];n.indexOf(o.id)===-1&&s.push(o)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vve(t){return t instanceof Fn}function fS(t){return Array.isArray(t)}function IO(t){return!vve(t)&&!fS(t)}function TO(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(fS(t)&&t.length>0)i=!0;else if(IO(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new q(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let o;if(IO(t)){t=t,o=[];for(const i of e){if(t[i]==null)throw new q(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(t[i])}}else if(fS(t)){if(t=t,t.length!==e.length)throw new q(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);o=t}else{if(t=t,e.length>1)throw new q(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);o=[t]}if(o=qU(o),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new q(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u>=0&&c!==u)throw new q(`${r} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function bve(t,e,n){const s=Ka(t.map(o=>o.shape[0]));s.sort();const r=Ka(e.map(o=>o.shape[0]));if(r.sort(),s.length>1)throw new q(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(r.length>1)throw new q(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(s.length>0&&r.length>0&&!Rt(s,r))throw new q(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function wve(t,e,n){const s=[Vv,Wv,_f];for(let r=0;r<t.length;++r){const o=t[r],i=e[r],a=n[r];if(i!=null){if(i===_f&&o.shape[o.shape.length-1]===1)throw new q(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=o.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new q(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function RO(t,e,n,s=!0,r=""){let o;if(Array.isArray(t)){if(t.length!==e.length)throw new q(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);o=t}else{if(e.length>1)throw new q(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);o=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new q(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u!==c)throw new q(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function Cve(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let o=n.hasOwnProperty(r)?n[r]:[];Array.isArray(o)||(o=[o]),s.push(o)}return s}}const Sve="layers-model";class sc extends Ao{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new q("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");ove(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=rve(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof wl))throw new q("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new q(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(z1(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new q(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>z1(a))}else{const i=z1(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],tc("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=Cve(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};tc("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=r[i];(c=>{const u="";let d,h,f;for(const m of c){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){const y=this.internalOutputShapes[i];y[y.length-1]===1||this.lossFunctions[i]===Wv?["accuracy","acc"].indexOf(m)!==-1?h=LU:["crossentropy","ce"].indexOf(m)!==-1&&(h=K0e):this.lossFunctions[i]===ay?["accuracy","acc"].indexOf(m)!==-1?h=X0e:["crossentropy","ce"].indexOf(m)!==-1&&(h=zU):["accuracy","acc"].indexOf(m)!==-1?h=jU:["crossentropy","ce"].indexOf(m)!==-1&&(h=BU);let x;["accuracy","acc"].indexOf(m)!==-1?x="acc":["crossentropy","ce"].indexOf(m)!==-1&&(x="ce"),f=h,d=u+x}else f=sve(m),d=u+hg(m);let g;tc(d,()=>{g=f}),o(i,d,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;U1(r);const i=this.standardizeUserDataXY(e,n,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return tr(c)}finally{To(i[0],e),To(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),yve(this,e,n)}checkNumSamples(e,n,s,r="steps"){let o;if(s!=null){if(o=null,n!=null)throw new q(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new q(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return o}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new q("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],o=this.retrieveSymbolicTensors(r),i=new Oa;if(e instanceof Fn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new q(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new q(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const a=wh(o,i);return s?a:a[0]}retrieveSymbolicTensors(e){const n=kc(null,e.length);let s=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=o[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((o,i)=>{o==null&&r.push(e[i])}),new q(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return ee(()=>{const r=this.checkNumSamples(e);if(s)throw new ut("Verbose predictLoop() is not implemented yet.");const o=V1(r,n),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)ee(()=>{const c=o[a][0],u=o[a][1],d=uh(e,c,u),h=[];if(Array.isArray(d))for(let m=0;m<d.length;++m)h.push({key:this.inputs[m],value:d[m]});else h.push({key:this.inputs[0],value:d});const f=new Oa(h);return wh(this.outputs,f)}).forEach((c,u)=>i[u].push(c));return tr(i.map(a=>or(a,0)))})}predict(e,n={}){const s=qU(e);RO(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return U1(r),this.predictLoop(s,r)}finally{To(s,e)}}predictOnBatch(e){RO(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new go("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===ay?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=TO(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=TO(n,this.feedOutputNames,o,!1,"target"),bve(e,n),wve(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new q(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,o,i);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=WU(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await HU(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,s,r=0,o){return ee(()=>{const i=this.checkNumSamples(n,s,o,"steps"),a=[];if(r>0)throw new ut("Verbose mode is not implemented yet.");if(o!=null)throw new ut("steps mode in testLoop() is not implemented yet");{const l=V1(i,s),c=wr(Ho(0,i));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=nc(c,d,h-d),m=hS(n,f),g=e(m);if(u===0)for(let y=0;y<g.length;++y)a.push(Tt(0));for(let y=0;y<g.length;++y){const x=g[y];a[y]=ge(a[y],X(h-d,x))}}for(let u=0;u<a.length;++u)a[u]=qe(a[u],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let o=r;if(pO(e,r)>1){const i=pO(e.slice(0,s),r);o+=`_${i}`}n.push(o)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:s[g]});const h=new Oa(d),f=wh(this.outputs,h,{training:!0});let m;for(let g=0;g<this.lossFunctions.length;++g){const y=this.lossFunctions[g];let x=y(r[g],f[g]);o[g]!=null&&(x=hve(x,o[g]));const v=$n(x);n.push(v),g===0?m=x:m=ge(m,x)}for(let g=0;g<this.metricsTensors.length;++g){let y;if(this.outputs.length>1&&g<this.outputs.length)y=n[g];else{const x=this.metricsTensors[g][0],v=this.metricsTensors[g][1];y=$n(x(r[v],f[v]))}bi(y),i.push(y)}return m=$n(m),this.calculateLosses().forEach(g=>{m=ge(m,g)}),m},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>ee(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:r[c]});const a=new Oa(i),l=wh(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=$n(u(o[c],l[c]));c===0?s=d:s=ge(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=$n(u(o[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,o,i,a,l,c,u,d,h;try{const f=s.batchSize==null?32:s.batchSize;U1(f);const g=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,f);r=g[0],o=g[1],h=g[2];let y=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(y=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new ut("validationData including sample weights is not supported yet."):new q(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const I=await this.standardizeUserData(l,c,null,null,!0,f);u=I[0],d=I[1],x=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){y=!0;const $=Math.floor(r[0].shape[0]*(1-s.validationSplit)),I=r[0].shape[0];u=uh(r,$,I),i=r,r=uh(r,0,$),d=uh(o,$,I),a=o,o=uh(o,0,$),x=u.concat(d)}else s.validationSteps!=null&&(y=!0);const v=r.concat(o).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),w=this.getDedupedMetricsNames();let C,k;y?(this.makeTestFunction(),C=this.testFunction,k=w.slice().concat(w.map($=>"val_"+$))):(C=null,x=[],k=w.slice());const N=PU(s.callbacks,s.yieldEvery);return await this.fitLoop(b,v,w,f,s.epochs,s.verbose,N,C,x,s.shuffle,k,s.initialEpoch,null,null)}finally{this.isTraining=!1,To(r,e),To(o,n),To(i,e),To(a,n),To(u,l),To(d,c),h!=null&&mt(h)}}async fitLoop(e,n,s,r,o,i,a,l,c,u,d,h,f,m){r==null&&(r=32),o==null&&(o=1),u==null&&(u=!0),h==null&&(h=0);let g=!1;if(l!=null&&c!=null&&(g=!0),m!=null&&(g=!0,f==null))throw new q("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,r,f,"steps_per_epoch");let x;y!=null&&(x=Ho(0,y)),i==null&&(i=1);const{callbackList:v,history:b}=_U(a,i,o,h,y,f,r,g,d);v.setModel(this),this.history=b,await v.onTrainBegin(),this.stopTraining_=!1;for(let w=h;w<o;++w){await v.onEpochBegin(w);const C={};if(f!=null)throw new ut("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new ut("batch shuffling is not implemneted yet");u&&lue(x);const k=wr(x),N=V1(y,r);for(let E=0;E<N.length;++E){const $={};if(await v.onBatchBegin(E,$),ee(()=>{const I=N[E][0],A=N[E][1],P=nc(k,I,A-I);$.batch=E,$.size=A-I;const _=hS(n,P),U=e(_);for(let V=0;V<s.length;++V){const D=s[V],W=U[V];$[D]=W,bi(W)}if(E===N.length-1&&g){const V=this.testLoop(l,c,r);for(let D=0;D<s.length;++D){const W=s[D],R=V[D];bi(R),C["val_"+W]=R}}}),await v.onBatchEnd(E,$),FU($),this.stopTraining_)break}k.dispose()}if(await v.onEpochEnd(w,C),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return mve(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],o=s[1],a=this.makeTrainFunction()(r.concat(o)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return mt(a),To(s[0],e),To(s[1],n),tr(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||n.push({name:r[i].originalName,tensor:o[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=YD().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-YD().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Fi(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Fi(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=Fi(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Fi(hg(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Fi(hg(e)));{const e={};for(const n in this.metrics)e[n]=Fi(hg(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=uS(e.optimizer_config),s=Hi(n);let r;if(typeof e.loss=="string")r=Pl(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Pl(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=Pl(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>Pl(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=Pl(e.metrics[i])}this.compile({loss:r,metrics:o,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=rde(e);if(c.length===0)throw new q(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new q(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new q("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await ZD(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:Sve,generatedBy:`TensorFlow.js tfjs-layers v${VU}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await ZD(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=sde([s.data,u])}return this.userDefinedMetadata!=null&&(NO(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){NO(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}sc.className="Model";fe(sc);class KU extends sc{}KU.className="Functional";fe(KU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mf extends sc{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Bv("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new q(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Mf||e instanceof sc;let s;if(n){if(s=e,s.outputs.length!==1)throw new q("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new q("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new q("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=TU({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new q(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new q("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=IU(this.outputs[0])}this.inboundNodes=[],new Uv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:kc(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Et(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new sc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new go("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new go("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new go("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new go("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let o,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new q("Legacy serialization format not supported yet.");o=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof Mf))throw new ut(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const u=Hi(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new q("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new q("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Mf.className="Sequential";fe(Mf);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kve(t){return new sc(t)}function AO(t){return TU(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ns=class extends Fd{getConfig(){return{}}};class XU extends Ns{apply(e,n=1){return u0e(e,n)}}XU.className="elu";fe(XU);class YU extends Ns{apply(e){return hz(e)}}YU.className="selu";fe(YU);class JU extends Ns{apply(e){return Lc(e)}}JU.className="relu";fe(JU);class ZU extends Ns{apply(e){return ee(()=>Of(6,Lc(e)))}}ZU.className="relu6";fe(ZU);class QU extends Ns{apply(e){return e}}QU.className="linear";fe(QU);class eV extends Ns{apply(e){return Ad(e)}}eV.className="sigmoid";fe(eV);class tV extends Ns{apply(e){return h0e(e)}}tV.className="hardSigmoid";fe(tV);class nV extends Ns{apply(e){return rm(e)}}nV.className="softplus";fe(nV);class sV extends Ns{apply(e){return d0e(e)}}sV.className="softsign";fe(sV);class rV extends Ns{apply(e){return Rv(e)}}rV.className="tanh";fe(rV);let o$=class extends Ns{apply(e,n=-1){return lE(e,n)}};o$.className="softmax";fe(o$);class oV extends Ns{apply(e,n=-1){return sz(e,n)}}oV.className="logSoftmax";fe(oV);class iV extends Ns{apply(e){return ee(()=>ee(()=>{const n=Math.sqrt(2),s=X(.5,ge(1,ZB(qe(e,n))));return X(e,s)}))}}iV.className="gelu";fe(iV);class aV extends Ns{apply(e){return ee(()=>X(.5,X(e,ge(1,Rv(X(Ss(qe(2,Math.PI)),ge(e,X(.044715,wc(e,3)))))))))}}aV.className="gelu_new";fe(aV);class lV extends Ns{apply(e){return ee(()=>X(e,Rv(rm(e))))}}lV.className="mish";fe(lV);class cV extends Ns{apply(e,n=1){return ee(()=>X(Ad(X(e,n)),e))}}cV.className="swish";fe(cV);function rl(t){return t.getClassName()}function W1(t,e={}){return dm(t,uo.getMap().classNameMap,e,"activation")}function ol(t){if(t==null){const e={};return e.className="linear",e.config={},W1(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},W1(e)}else return t instanceof Ns?t:W1(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nve(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class uV extends Fd{}class dV extends uV{constructor(e){super(),Nve(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ee(()=>{let n=qn([1]);return this.hasL1&&(n=ge(n,He(X(this.l1,Ps(e))))),this.hasL2&&(n=ge(n,He(X(this.l2,fm(e))))),Z(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}dV.className="L1L2";fe(dV);const DO={l1l2:"L1L2"};function Lt(t){return HE(t)}function OO(t,e={}){return dm(t,uo.getMap().classNameMap,e,"regularizer")}function nn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in DO?DO[t]:t,config:{}};return OO(n)}else return t instanceof uV?t:OO(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hV extends pt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=Je(e);let s=Lc(e);return this.maxValue!=null&&(s=Yr(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}hV.className="ReLU";fe(hV);class fV extends pt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Je(e);return GN(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}fV.className="LeakyReLU";fe(fV);class pV extends pt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=tn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=nn(e.alphaRegularizer),this.alphaConstraint=Bn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new q(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Et(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Mn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=Je(e),ZN(e,this.alpha.read())}getConfig(){const e={alphaInitializer:on(this.alphaInitializer),alphaRegularizer:Lt(this.alphaRegularizer),alphaConstraint:jn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}pV.className="PReLU";fe(pV);let mV=class extends pt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new ut(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Je(e);return Ov(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};mV.className="ELU";fe(mV);class gV extends pt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=Je(e);return X(s,$e(eo(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}gV.className="ThresholdedReLU";fe(gV);class xV extends pt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new o$().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return ee(()=>{let s=Je(e);const r=n.mask;if(r!=null){const o=X(Ye(bl(s.shape),$e(r,s.dtype)),Tt(-1e9));s=ge(s,o)}return this.axis instanceof Array?this.axis.length>1?Ni(Ye(s,rz(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}xV.className="Softmax";fe(xV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fu(t,e,n){if(typeof t=="number")return kc(t,e);if(t.length!==e)throw new q(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!i0e(r))throw new q(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function Vo(t,e,n,s,r=1){if(t==null)return t;const o=e+(e-1)*(r-1);let i;return n==="same"?i=t:i=t-o+1,Math.floor((i+s-1)/s)}function ci(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+sl([n-e,0]);else if(s==="same")t=t*e;else throw new q(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function i$(t,e){return ee(()=>(wn(e),e==="channelsFirst"?Ct(t,[0,2,3,1]):t))}function yV(t,e){return ee(()=>(wn(e),e==="channelsFirst"?Ct(t,[0,2,3,4,1]):t))}function Eve(t,e,n,s=1,r="valid",o,i=1){return ee(()=>{if(o==null&&(o=Go()),wn(o),t.shape.length!==3)throw new q(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new q(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new q(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(o==="channelsFirst"&&(t=Ct(t,[0,2,1])),r==="causal")throw new ut("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=qB(t,e,s,r==="same"?"same":"valid","NWC",i);return n!=null&&(a=Yo(a,n)),a})}function FO(t,e,n,s=[1,1],r="valid",o,i,a=null){return ee(()=>{if(o==null&&(o=Go()),wn(o),t.rank!==3&&t.rank!==4)throw new q(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new q(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=i$(t,o);if(r==="causal")throw new ut("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Pme({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=Ct(l,[0,3,1,2])),l})}function $ve(t,e,n,s=[1,1,1],r="valid",o,i){return ee(()=>{if(o==null&&(o=Go()),wn(o),t.rank!==4&&t.rank!==5)throw new q(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new q(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=yV(t,o);if(r==="causal")throw new ut("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=Fhe(a,e,s,r==="same"?"same":"valid","NDHWC",i),n!=null&&(a=Yo(a,n)),o==="channelsFirst"&&(a=Ct(a,[0,4,1,2,3])),a})}class Hv extends pt{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Hv.verifyArgs(n),this.rank=e,Xn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new ut(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Fu(n.kernelSize,e,"kernelSize"),this.strides=Fu(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,to(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,wn(this.dataFormat),this.activation=ol(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=tn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Bn(n.biasConstraint),this.biasRegularizer=nn(n.biasRegularizer),this.activityRegularizer=nn(n.activityRegularizer),this.dilationRate=Fu(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new q(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new q(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new q(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(li("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!GE(e.kernelSize,"number",1,3))throw new q(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:rl(this.activation),useBias:this.useBias,biasInitializer:on(this.biasInitializer),biasRegularizer:Lt(this.biasRegularizer),activityRegularizer:Lt(this.activityRegularizer),biasConstraint:jn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Pd extends Hv{constructor(e,n){super(e,n),this.kernel=null,Pd.verifyArgs(n),this.filters=n.filters,Xn(this.filters,"filters"),this.kernelInitializer=tn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Bn(n.kernelConstraint),this.kernelRegularizer=nn(n.kernelRegularizer)}build(e){e=Et(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new q(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return ee(()=>{e=Je(e);let s;const r=this.bias==null?null:this.bias.read(),o=fU(this.activation.getClassName());if(o!=null&&this.rank===2)s=FO(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)s=Eve(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=FO(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=$ve(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new ut("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Et(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<s.length;++o){const i=Vo(s[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:on(this.kernelInitializer),kernelRegularizer:Lt(this.kernelRegularizer),kernelConstraint:jn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new q(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class xm extends Pd{constructor(e){super(2,e),xm.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!GE(e.kernelSize,"number",1,2))throw new q(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}xm.className="Conv2D";fe(xm);class ym extends Pd{constructor(e){super(3,e),ym.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new q(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}ym.className="Conv3D";fe(ym);class vV extends xm{constructor(e){if(super(e),this.inputSpec=[new Mn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new q(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Et(e),e.length!==4)throw new q("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new q("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Mn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return ee(()=>{let s=Je(e);if(s.shape.length!==4)throw new q(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=r[i],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],m=ci(l,h,u,this.padding),g=ci(c,f,d,this.padding),y=[o,m,g,this.filters];this.dataFormat!=="channelsLast"&&(s=Ct(s,[0,2,3,1]));let x=KB(s,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=Ct(x,[0,3,1,2])),this.bias!=null&&(x=Yo(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=Et(e);const n=e.slice();let s,r,o;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3):(s=3,r=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=ci(n[r],l,i,this.padding),n[o]=ci(n[o],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}vV.className="Conv2DTranspose";fe(vV);class bV extends ym{constructor(e){if(super(e),this.inputSpec=[new Mn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new q(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Et(e),e.length!==5)throw new q("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new q("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Mn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return ee(()=>{let s=Je(e);if(s.shape.length!==5)throw new q(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const c=r[l],u=r[i],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],m=this.kernelSize[2],g=this.strides[0],y=this.strides[1],x=this.strides[2],v=ci(c,g,h,this.padding),b=ci(u,y,f,this.padding),w=ci(d,x,m,this.padding),C=[o,v,b,w,this.filters];this.dataFormat!=="channelsLast"&&(s=Ct(s,[0,2,3,4,1]));let k=Mhe(s,this.kernel.read(),C,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(k=Ct(k,[0,4,1,2,3])),this.bias!==null&&(k=Yo(k,this.bias.read(),this.dataFormat)),this.activation!==null&&(k=this.activation.apply(k)),k})}computeOutputShape(e){e=Et(e);const n=e.slice();let s,r,o,i;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3,i=4):(s=4,r=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=ci(n[r],u,a,this.padding),n[o]=ci(n[o],d,l,this.padding),n[i]=ci(n[i],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}bV.className="Conv3DTranspose";fe(bV);class wV extends Pd{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new q("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new q("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new q(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=tn(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=nn(n.depthwiseRegularizer),this.depthwiseConstraint=Bn(n.depthwiseConstraint),this.pointwiseInitializer=tn(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=nn(n.pointwiseRegularizer),this.pointwiseConstraint=Bn(n.pointwiseConstraint)}build(e){if(e=Et(e),e.length<this.rank+2)throw new q(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new q(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Mn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return ee(()=>{e=Je(e);let s;if(this.rank===1)throw new ut("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Ct(e,[0,2,3,1])),s=fz(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Yo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Ct(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=on(this.depthwiseInitializer),e.pointwiseInitializer=on(this.pointwiseInitializer),e.depthwiseRegularizer=Lt(this.depthwiseRegularizer),e.pointwiseRegularizer=Lt(this.pointwiseRegularizer),e.depthwiseConstraint=jn(this.depthwiseConstraint),e.pointwiseConstraint=jn(this.pointwiseConstraint),e}}wV.className="SeparableConv";class CV extends wV{constructor(e){super(2,e)}}CV.className="SeparableConv2D";fe(CV);class Gv extends Pd{constructor(e){super(1,e),Gv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!GE(e.kernelSize,"number",1,1))throw new q(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Gv.className="Conv1D";fe(Gv);class SV extends pt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return ee(()=>{if(e=Je(e),this.dataFormat==="channelsLast"){const s=dg(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return dg(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=dg(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return dg(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}SV.className="Cropping2D";fe(SV);class kV extends pt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,wn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,s0e(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return ee(()=>{let s=Je(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Ct(s,[0,2,3,1]);const o=this.size[0]*r[2],i=this.size[1]*r[3],a=this.interpolation==="nearest"?Bi.resizeNearestNeighbor(s,[o,i]):Bi.resizeBilinear(s,[o,i]);return Ct(a,[0,3,1,2])}else{const o=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Bi.resizeNearestNeighbor(s,[o,i]):Bi.resizeBilinear(s,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}kV.className="UpSampling2D";fe(kV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ive(t,e,n=[1,1],s="valid",r,o){return ee(()=>{r==null&&(r=Go()),wn(r);let i=i$(t,r);if(t.rank!==4)throw new q(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new q(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=UN(i,e,n,s==="same"?"same":"valid","NHWC",o),r==="channelsFirst"&&(i=Ct(i,[0,3,1,2])),i})}class NV extends Hv{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=tn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Bn(e.depthwiseConstraint),this.depthwiseRegularizer=nn(e.depthwiseRegularizer)}build(e){if(e=Et(e),e.length<4)throw new q(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new q(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ee(()=>{e=Je(e);let s=Ive(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Yo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Et(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=Vo(n,this.kernelSize[0],this.padding,this.strides[0]),i=Vo(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,o,i]:[e[0],o,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=on(this.depthwiseInitializer),e.depthwiseRegularizer=Lt(this.depthwiseRegularizer),e.depthwiseConstraint=jn(this.depthwiseRegularizer),e}}NV.className="DepthwiseConv2D";fe(NV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function EV(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new q("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(o){return o==null||Array.isArray(o)?o:[o]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function $V(t,e,n,s=!1,r,o,i=!1,a=!1){return ee(()=>{const l=e.shape.length;if(l<3)throw new q(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Ho(2,l));e=Ct(e,c),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=$e($e(r,"bool"),"float32"),r.rank===l-1&&(r=er(r,-1)),r=Ct(r,c)),s&&(e=Cc(e,0),r!=null&&(r=Cc(r,0)));const u=[];let d,h=n;const f=e.shape[0],m=Sc(e);let g;r!=null&&(g=Sc(r));for(let x=0;x<f;++x){const v=m[x],b=ee(()=>t(v,h));if(r==null)d=b[0],h=b[1];else{const w=ee(()=>{const C=g[x],k=Ye(ko(C),C),N=ge(X(b[0],C),X(h[0],k)),E=h.map(($,I)=>ge(X(b[1][I],C),X($,k)));return{output:N,newStates:E}});d=w.output,h=w.newStates}a&&u.push(d)}let y;return a&&(y=na(u,1)),[d,y,h]})}class Cl extends pt{constructor(e){super(e);let n;if(e.cell==null)throw new q("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new c$({cells:e.cell}):n=e.cell,n.stateSize==null)throw new q("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Mn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ho(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){aS(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const o=[];for(const i of n)o.push([e[0],i]);return[r].concat(o)}else return r}computeMask(e,n){return ee(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new ut("Constants support is not implemented in RNN yet.");aS(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Mn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!Rt(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new q(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new Mn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){ee(()=>{if(!this.stateful)throw new ai("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new q("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>qn([s,r])):this.states_=[qn([s,this.cell.stateSize])];else if(e==null)mt(this.states_),this.keptStates!=null&&(mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>qn([s,r])):this.states_[0]=qn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new q(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):mt(this.states_);for(let r=0;r<this.states_.length;++r){const o=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,i];if(!Rt(o.shape,a))throw new q(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>bi(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=EV(e,s,r,this.numConstants);e=o.inputs,s=o.initialState,r=o.constants;let i=[],a=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new Mn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof $i){const c=[e].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ee(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let o=n==null?null:n.initialState;e=Je(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new q(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=$V((m,g)=>{const y=this.cell.call([m].concat(g),a);return[y[0],y.slice(1)]},e,o,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return ee(()=>{let n=qn(e.shape);return n=He(n,[1,2]),n=hm(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?oS(n,[1,s]):n):this.cell.stateSize>1?[oS(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Cl.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,o=Hi(r,s);return new e(Object.assign(n,{cell:o}))}}Cl.className="RNN";fe(Cl);class qv extends pt{}class a$ extends qv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Xn(this.units,"units"),this.activation=ol(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=tn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=nn(e.kernelRegularizer),this.recurrentRegularizer=nn(e.recurrentRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.kernelConstraint=Bn(e.kernelConstraint),this.recurrentConstraint=Bn(e.recurrentConstraint),this.biasConstraint=Bn(e.biasConstraint),this.dropout=od([1,sl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=od([1,sl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Et(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ee(()=>{if(e=e,e.length!==2)throw new q(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=il({ones:()=>ko(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=il({ones:()=>ko(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=Si(X(e,i),this.kernel.read()):o=Si(e,this.kernel.read()),this.bias!=null&&(o=Yo(o,this.bias.read())),a!=null&&(s=X(s,a));let l=ge(o,Si(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:rl(this.activation),useBias:this.useBias,kernelInitializer:on(this.kernelInitializer),recurrentInitializer:on(this.recurrentInitializer),biasInitializer:on(this.biasInitializer),kernelRegularizer:Lt(this.kernelRegularizer),recurrentRegularizer:Lt(this.recurrentRegularizer),biasRegularizer:Lt(this.biasRegularizer),activityRegularizer:Lt(this.activityRegularizer),kernelConstraint:jn(this.kernelConstraint),recurrentConstraint:jn(this.recurrentConstraint),biasConstraint:jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}a$.className="SimpleRNNCell";fe(a$);class IV extends Cl{constructor(e){e.cell=new a$(e),super(e)}call(e,n){return ee(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return new e(n)}}IV.className="SimpleRNN";fe(IV);class l$ extends qv{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new q("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Xn(this.units,"units"),this.activation=ol(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ol(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=tn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=nn(e.kernelRegularizer),this.recurrentRegularizer=nn(e.recurrentRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.kernelConstraint=Bn(e.kernelConstraint),this.recurrentConstraint=Bn(e.recurrentConstraint),this.biasConstraint=Bn(e.biasConstraint),this.dropout=od([1,sl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=od([1,sl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Et(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ee(()=>{if(e=e,e.length!==2)throw new q(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=il({ones:()=>ko(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=il({ones:()=>ko(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=X(e,o[0]));let u=Si(e,this.kernel.read());this.useBias&&(u=Yo(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=X(r,i[0]));const d=this.recurrentKernel.read(),[h,f]=Gr(d,[2*this.units,this.units],d.rank-1),m=Si(r,h),[g,y,x]=Gr(u,3,u.rank-1),[v,b]=Gr(m,2,m.rank-1);a=this.recurrentActivation.apply(ge(g,v)),l=this.recurrentActivation.apply(ge(y,b));const w=Si(X(l,r),f);c=this.activation.apply(ge(x,w));const C=ge(X(a,r),X(ge(1,yn(a)),c));return[C,C]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:rl(this.activation),recurrentActivation:rl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:on(this.kernelInitializer),recurrentInitializer:on(this.recurrentInitializer),biasInitializer:on(this.biasInitializer),kernelRegularizer:Lt(this.kernelRegularizer),recurrentRegularizer:Lt(this.recurrentRegularizer),biasRegularizer:Lt(this.biasRegularizer),activityRegularizer:Lt(this.activityRegularizer),kernelConstraint:jn(this.kernelConstraint),recurrentConstraint:jn(this.recurrentConstraint),biasConstraint:jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}l$.className="GRUCell";fe(l$);class TV extends Cl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new l$(e),super(e)}call(e,n){return ee(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}TV.className="GRU";fe(TV);class Kv extends qv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Xn(this.units,"units"),this.activation=ol(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ol(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=tn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=nn(e.kernelRegularizer),this.recurrentRegularizer=nn(e.recurrentRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.kernelConstraint=Bn(e.kernelConstraint),this.recurrentConstraint=Bn(e.recurrentConstraint),this.biasConstraint=Bn(e.biasConstraint),this.dropout=od([1,sl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=od([1,sl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Et(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;r=new(n=class extends Eo{apply(l,c){const u=o.apply([i]),d=new KE().apply([i]),h=o.apply([i*2]);return gO(gO(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return ee(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new q(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=il({ones:()=>ko(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=il({ones:()=>ko(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=X(e,i[0]));let h=Si(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=X(r,a[0])),h=ge(h,Si(r,this.recurrentKernel.read())),this.useBias&&(h=Yo(h,this.bias.read()));const[f,m,g,y]=Gr(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(m),u=ge(X(c,o),X(l,this.activation.apply(g))),d=this.recurrentActivation.apply(y);const x=X(d,this.activation.apply(u));return[x,x,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:rl(this.activation),recurrentActivation:rl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:on(this.kernelInitializer),recurrentInitializer:on(this.recurrentInitializer),biasInitializer:on(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Lt(this.kernelRegularizer),recurrentRegularizer:Lt(this.recurrentRegularizer),biasRegularizer:Lt(this.biasRegularizer),activityRegularizer:Lt(this.activityRegularizer),kernelConstraint:jn(this.kernelConstraint),recurrentConstraint:jn(this.recurrentConstraint),biasConstraint:jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}Kv.className="LSTMCell";fe(Kv);class RV extends Cl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Kv(e),super(e)}call(e,n){return ee(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}RV.className="LSTM";fe(RV);class c$ extends qv{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return ee(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),o.push(i.slice(1))}s=[];for(const a of o.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){aS(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{tc(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=o=>({className:o.getClassName(),config:o.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const o of n.cells)r.push(Hi(o,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return lS(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,o=e.splice(r);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],o[i]])}t$(n)}}c$.className="StackedRNNCells";fe(c$);function il(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:o}=t,i=()=>o!=null?o(e(),n):bU(e(),n),a=()=>pm(i,e,s);return!r||r<=1?bi(a().clone()):Array(r).fill(void 0).map(a).map(c=>bi(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Tve=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class AV extends Cl{constructor(e){if(e.unroll)throw new ut("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new ut("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Mn({ndim:5})]}call(e,n){return ee(()=>{if(this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new q("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return ee(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)],i=qn(o);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){ee(()=>{if(!this.stateful)throw new ai("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(s[0]==null)throw new q("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>qn(o)):this.states_=[qn(o)];else if(e==null)mt(this.states_),this.keptStates!=null&&(mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>qn(o)):this.states_[0]=qn(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new q(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):mt(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=o;if(!Rt(l.shape,c))throw new q(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>bi(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:o,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=Vo(c,r[0],o,i[0],a[0]),h=Vo(u,r[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}AV.className="ConvRNN2D";class u$ extends Kv{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Xn(this.filters,"filters"),this.kernelSize=Fu(s,2,"kernelSize"),this.kernelSize.forEach(l=>Xn(l,"kernelSize")),this.strides=Fu(r||1,2,"strides"),this.strides.forEach(l=>Xn(l,"strides")),this.padding=o||"valid",to(this.padding),this.dataFormat=i||"channelsLast",wn(this.dataFormat),this.dilationRate=Fu(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Xn(l,"dilationRate"))}build(e){var n;e=Et(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new q(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],o=4,i=this.kernelSize.concat([r,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends Eo{apply(h,f){const m=c.apply([u]),g=bl([u]),y=c.apply([u*2]);return qE([m,g,y])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return ee(()=>{if(e.length!==3)throw new q(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=il({ones:()=>ko(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(G,O,B)=>!O||!O[B]?G:X(O[B],G);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=il({ones:()=>ko(o),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const m=this.recurrentDropoutMask;let g=c(o,m,0),y=c(o,m,1),x=c(o,m,2),v=c(o,m,3);const b=3,[w,C,k,N]=Gr(this.kernel.read(),a,b),[E,$,I,A]=this.useBias?Gr(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,w,E,this.padding),d=this.inputConv(d,C,$,this.padding),h=this.inputConv(h,k,I,this.padding),f=this.inputConv(f,N,A,this.padding);const[P,_,U,V]=Gr(this.recurrentKernel.read(),a,b);g=this.recurrentConv(g,P),y=this.recurrentConv(y,_),x=this.recurrentConv(x,U),v=this.recurrentConv(v,V);const D=this.recurrentActivation.apply(ge(u,g)),W=this.recurrentActivation.apply(ge(d,y)),R=ge(X(W,i),X(D,this.activation.apply(ge(h,x)))),j=X(this.recurrentActivation.apply(ge(f,v)),this.activation.apply(R));return[j,j,R]})}getConfig(){const e=super.getConfig(),{units:n}=e,s=Tve(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,n,s,r){const o=bc(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Yo(o,s,this.dataFormat):o}recurrentConv(e,n){return bc(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}u$.className="ConvLSTM2DCell";fe(u$);class DV extends AV{constructor(e){const n=new u$(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}DV.className="ConvLSTM2D";fe(DV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class d$ extends pt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const s=Je(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,o=this.getNoiseShape(s);return pm(()=>bU(s,this.rate,o,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}d$.className="Dropout";fe(d$);class OV extends d${constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}OV.className="SpatialDropout1D";fe(OV);class h$ extends pt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Xn(this.units,"units"),this.activation=ol(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Bn(e.kernelConstraint),this.biasConstraint=Bn(e.biasConstraint),this.kernelRegularizer=nn(e.kernelRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.activityRegularizer=nn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Et(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Et(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const s=Je(e),r=fU(this.activation.getClassName());let o;return r!=null?o=Si(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=Si(s,this.kernel.read()),this.bias!=null&&(o=Yo(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:rl(this.activation),useBias:this.useBias,kernelInitializer:on(this.kernelInitializer),biasInitializer:on(this.biasInitializer),kernelRegularizer:Lt(this.kernelRegularizer),biasRegularizer:Lt(this.biasRegularizer),activityRegularizer:Lt(this.activityRegularizer),kernelConstraint:jn(this.kernelConstraint),biasConstraint:jn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}h$.className="Dense";fe(h$);class FV extends pt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Et(e);for(const n of e.slice(1))if(n==null)throw new q(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Xa(e,1)]}call(e,n){return ee(()=>{this.invokeCallHook(e,n);let s=Je(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=Ct(s,r)}return c0e(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}FV.className="Flatten";fe(FV);class PV extends pt{constructor(e){super(e),this.supportsMasking=!0,this.activation=ol(e.activation)}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const s=Je(e);return this.activation.apply(s)})}getConfig(){const e={activation:rl(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}PV.className="Activation";fe(PV);class _V extends pt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return ee(()=>(e=Je(e),a0e(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}_V.className="RepeatVector";fe(_V);class MV extends pt{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let o=1,i=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(i===null)i=l;else throw new q("Can only specifiy one unknown dimension.");else o*=c}const a=Xa(e);if(i!==null){if(o===0||a%o!==0)throw new q(s);r[i]=a/o}else if(a!==o)throw new q(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const s=Je(e),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Z(s,o)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}MV.className="Reshape";fe(MV);class LV extends pt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Ho(1,e.dims.length+1);if(!Rt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Mn({ndim:this.dims.length+1})]}computeOutputShape(e){e=Et(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return Ct(Je(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}LV.className="Permute";fe(LV);class jV extends pt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=Je(e);return ZC(Qx(s,this.maskValue),-1)}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const s=Je(e),i=ZC(Qx(s,this.maskValue),-1,!0);return X(s,$e(i,s.dtype))})}}jV.className="Masking";fe(jV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class f$ extends pt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ot(e.inputLength))}this.inputDim=e.inputDim,Xn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Xn(this.outputDim,"outputDim"),this.embeddingsInitializer=tn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=nn(e.embeddingsRegularizer),this.activityRegularizer=nn(e.activityRegularizer),this.embeddingsConstraint=Bn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return ee(()=>this.maskZero?(e=Je(e),Qx(e,St(e))):null)}computeOutputShape(e){if(e=Et(e),this.inputLength==null)return[...e,this.outputDim];const n=Ot(this.inputLength);if(n.length!==e.length-1)throw new q(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const o=n[r],i=e[r+1];if(o!=null&&i!=null&&o!==i)throw new q(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return ee(()=>{this.invokeCallHook(e,n);let s=Je(e);s.dtype!=="int32"&&(s=Ci(s,"int32"));const r=vU(this.embeddings.read(),Z(s,[s.size]));return Z(r,Et(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:on(this.embeddingsInitializer),embeddingsRegularizer:Lt(this.embeddingsRegularizer),activityRegularizer:Lt(this.activityRegularizer),embeddingsConstraint:jn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}f$.className="Embedding";fe(f$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zc extends pt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new ut}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const o=e[e.length-n.length+r],i=n[r];if(o==null||i==null||o<0||i<0)s.push(null);else if(o===1)s.push(i);else if(i===1)s.push(o);else{if(o!==i)throw new q("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(o)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Et(e)]),e=e,e.length<2)throw new q(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const o of e)o!=null&&o[0]!==null&&n.push(o[0]);if(n=Ka(n),n.length>1)throw new q(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(o=>o.length);e.indexOf(null)===-1&&Ka(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return ee(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(o=>o.rank);if(r.indexOf(null)===-1){const o=sl(r);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=hm(i,1);s.push(i)}return this.mergeFunction(s)}else{let o=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=Z(l,[d].concat(Xa(u.slice(1))));f=Ct(f,[1,0]),f=Z(f,h),s.push(f),o=!0}else if(c>1){const u=Ho(1,c).concat([0]);s.push(Ct(l,u)),o=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(o){if(a==null){const l=i.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));i=Z(Ct(Z(i,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Ho(0,a-1));i=Ct(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const o=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Ka(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return ee(()=>{if(n==null)return null;if(!Array.isArray(n))throw new q("`mask` should be an Array");if(!Array.isArray(e))throw new q("`inputs` should be an Array");if(n.length!==e.length)throw new q(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:er(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=ta(s,n[r]);return s})}}class BV extends zc{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ge(n,e[s]);return n})}}BV.className="Add";fe(BV);class zV extends zc{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=X(n,e[s]);return n})}}zV.className="Multiply";fe(zV);class UV extends zc{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ge(n,e[s]);return X(1/e.length,n)})}}UV.className="Average";fe(UV);class VV extends zc{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=vl(n,e[s]);return n})}}VV.className="Maximum";fe(VV);class WV extends zc{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Of(n,e[s]);return n})}}WV.className="Minimum";fe(WV);class HV extends zc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new q("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const o=e[r].slice();o.splice(this.axis,1);let i=!1;for(const a of s)if(Rt(a,o)){i=!0;break}i||s.push(o)}if(s.length>1)throw new q("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ee(()=>qE(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new q("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of n.slice(1)){if(s[r]==null||o[r]==null){s[r]=null;break}s[r]+=o[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new q("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new q("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new q(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return ee(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)n[i]==null?r.push($e(ko(e[i]),"bool")):n[i].rank<e[i].rank?r.push(er(n[i],-1)):r.push(n[i]);const o=or(r,this.axis);return GB(o,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}HV.className="Concatenate";fe(HV);function dh(t,e){for(;t<0;)t+=e;return t}function Rve(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new ut("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),T(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new ut("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const o=n;return ee(()=>{let i;if(s>r){i=s-r;const l=[];for(let c=0;c<i;++c)l.push(1);e=Z(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let c=0;c<i;++c)l.push(1);t=Z(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=He(X(t,e),o[0]):a=He(X(Ct(t,[1,0]),e),o[1]);else{const l=o[0]!==t.shape.length-1,c=o[1]===e.shape.length-1;a=It(t,e,l,c)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+i;++u)c.push(u);a=im(a,c)}return a.shape.length===1&&(a=er(a,1)),a})}class p$ extends zc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new ut("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new q(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new q(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((o,i)=>dh(o,e[i].shape.length)):r=[dh(this.axes,n.shape.length),dh(this.axes,s.shape.length)],this.normalize&&(n=iy(n,r[0]),s=iy(s,r[1])),Rve(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[dh(this.axes,e.length),dh(this.axes,n.length)],s}computeOutputShape(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new ut("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=n.concat(s);return o.length===1&&o.push(1),o}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}p$.className="Dot";fe(p$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class GV extends pt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const s=Je(e);return pm(()=>ge(zv(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}GV.className="GaussianNoise";fe(GV);class qV extends pt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const s=Je(e);return this.rate>0&&this.rate<1?pm(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return X(s,zv(s.shape,1,o))},()=>s,n.training||!1):s})}}qV.className="GaussianDropout";fe(qV);class KV extends pt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Je(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ee(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return pm(()=>{const o=Je(e),a=-1.6732632423543772*1.0507009873554805;let l=_c(om(s),this.rate);l=Ci(l,"float32");const c=((1-this.rate)*(1+this.rate*a**2))**-.5,u=-c*a*this.rate,d=ge(X(o,l),X(ge(l,-1),a));return ge(X(d,c),u)},()=>Je(e),n.training||!1)}return e})}}KV.className="AlphaDropout";fe(KV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lf(t,e,n,s,r,o=.001){let i;if(t.rank===2)i=uhe(t,e,n,s,r,o);else if(t.rank===3)i=hhe(t,e,n,s,r,o);else if(t.rank===4)i=phe(t,e,n,s,r,o);else throw new ut(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function Ave(t,e,n,s,r=.001){return ee(()=>{const o=XN(t,s),i=o.mean,a=o.variance;return[Lf(t,i,a,n,e,r),i,a]})}function Dve(t,e,n,s,r=.001){return ee(()=>{const o=XN(t,s),i=o.mean,a=o.variance,l=[];for(const m of Ho(0,t.rank))s.indexOf(m)!==-1?l.push(1):l.push(t.shape[m]);const c=Z(i,l),u=Z(a,l),d=e==null?null:Z(e,l),h=n==null?null:Z(n,l);return[Lf(t,c,u,h,d,r),i,a]})}function Ove(t,e,n,s,r=.001){return Rt(s.slice().sort(),Ho(0,t.rank-1))?Ave(t,e,n,s,r):Dve(t,e,n,s,r)}class XV extends pt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=tn(e.betaInitializer||"zeros"),this.gammaInitializer=tn(e.gammaInitializer||"ones"),this.movingMeanInitializer=tn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=tn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Bn(e.betaConstraint),this.gammaConstraint=Bn(e.gammaConstraint),this.betaRegularizer=nn(e.betaRegularizer),this.gammaRegularizer=nn(e.gammaRegularizer)}build(e){e=Et(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new q(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Mn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return ee(()=>{const s=n.training==null?!1:n.training,r=Je(e),o=r.shape,i=o.length,a=Ho(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const c=kc(1,i);c[l]=o[l];const u=a.slice();u.sort();const d=!Rt(u,Ho(0,i).slice(0,i-1)),h=()=>{if(d){const v=Z(this.movingMean.read(),c),b=Z(this.movingVariance.read(),c),w=this.center?Z(this.beta.read(),c):null,C=this.scale?Z(this.gamma.read(),c):null;return Lf(r,v,b,w,C,this.epsilon)}else return Lf(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,m,g]=Ove(r,this.gamma.read(),this.beta.read(),a,this.epsilon),y=(v,b,w)=>{ee(()=>{const C=1-w,k=v.read(),N=X(Ye(k,b),C);v.write(Ye(k,N))})};return(()=>{y(this.movingMean,m,this.momentum),y(this.movingVariance,g,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:on(this.betaInitializer),gammaInitializer:on(this.gammaInitializer),movingMeanInitializer:on(this.movingMeanInitializer),movingVarianceInitializer:on(this.movingVarianceInitializer),betaRegularizer:Lt(this.betaRegularizer),gammaRegularizer:Lt(this.gammaRegularizer),betaConstraint:jn(this.betaConstraint),gammaConstraint:jn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}XV.className="BatchNormalization";fe(XV);class YV extends pt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=tn(e.betaInitializer||"zeros"),this.gammaInitializer=tn(e.gammaInitializer||"ones"),this.betaRegularizer=nn(e.betaRegularizer),this.gammaRegularizer=nn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Et(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=n);for(const o of this.axis)if(o<0||o>=n)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==Ka(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>e[o]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=Je(e),r=s.shape,o=r.length;return ee(()=>{let{mean:a,variance:l}=XN(s,this.axis,!0);const c=kc(1,o);for(const g of this.axis)c[g]=r[g];const u=g=>g!=null&&g.shape.length!==o?Z(g,c):g;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],m=[];for(let g=0;g<o;++g)this.axis.indexOf(g)!==-1?(f.push(r[g]),m.push(1)):(f.push(1),m.push(r[g]));return a=Lo(a,f),l=Lo(l,f),d!=null&&(d=Lo(d,m)),h!=null&&(h=Lo(h,m)),Lf(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:on(this.betaInitializer),gammaInitializer:on(this.gammaInitializer),betaRegularizer:Lt(this.betaRegularizer),gammaRegularizer:Lt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}YV.className="LayerNormalization";fe(YV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fve(t,e,n){return ee(()=>{if(t.rank!==4)throw new q(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new q("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Go()),n!=="channelsLast"&&n!=="channelsFirst")throw new q(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],YN(t,s)})}class JV extends pt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Go():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new q(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new q(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new q(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new Mn({ndim:4})]}computeOutputShape(e){e=Et(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return ee(()=>Fve(Je(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}JV.className="ZeroPadding2D";fe(JV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xv(t,e,n,s,r,o){return ee(()=>{wn(r),mU(o),to(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Go()),o==null&&(o="max"),t=i$(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=KN(t,e,n,a):i=LN(t,e,n,a),r==="channelsFirst"&&(i=Ct(i,[0,3,1,2])),i})}function ZV(t,e,n,s,r,o){return ee(()=>{wn(r),mU(o),to(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Go()),o==null&&(o="max"),t=yV(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=Zfe(t,e,n,a):i=ehe(t,e,n,a),r==="channelsFirst"&&(i=Ct(i,[0,4,1,2,3])),i})}class QV extends pt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new q(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Xn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new q(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Xn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,to(this.padding),this.inputSpec=[new Mn({ndim:3})]}computeOutputShape(e){e=Et(e);const n=Vo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return ee(()=>{this.invokeCallHook(e,n),e=hm(Je(e),2);const s=this.poolingFunction(Je(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return im(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class e6 extends QV{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return wn(o),to(r),Xv(e,n,s,r,o,"max")}}e6.className="MaxPooling1D";fe(e6);class t6 extends QV{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return wn(o),to(r),Xv(e,n,s,r,o,"avg")}}t6.className="AveragePooling1D";fe(t6);class n6 extends pt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new q(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Xn(this.poolSize,"poolSize"),Xn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,wn(this.dataFormat),to(this.padding),this.inputSpec=[new Mn({ndim:4})]}computeOutputShape(e){e=Et(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Vo(n,this.poolSize[0],this.padding,this.strides[0]),s=Vo(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return ee(()=>(this.invokeCallHook(e,n),this.poolingFunction(Je(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class s6 extends n6{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return wn(o),to(r),Xv(e,n,s,r,o,"max")}}s6.className="MaxPooling2D";fe(s6);class r6 extends n6{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return wn(o),to(r),Xv(e,n,s,r,o,"avg")}}r6.className="AveragePooling2D";fe(r6);class o6 extends pt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new q(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Xn(this.poolSize,"poolSize"),Xn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,wn(this.dataFormat),to(this.padding),this.inputSpec=[new Mn({ndim:5})]}computeOutputShape(e){e=Et(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Vo(n,this.poolSize[0],this.padding,this.strides[0]),s=Vo(s,this.poolSize[1],this.padding,this.strides[1]),r=Vo(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return ee(()=>(this.invokeCallHook(e,n),this.poolingFunction(Je(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class i6 extends o6{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return wn(o),to(r),ZV(e,n,s,r,o,"max")}}i6.className="MaxPooling3D";fe(i6);class a6 extends o6{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return wn(o),to(r),ZV(e,n,s,r,o,"avg")}}a6.className="AveragePooling3D";fe(a6);class l6 extends pt{constructor(e){super(e),this.inputSpec=[new Mn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new ut}}class c6 extends l6{constructor(e){super(e||{})}call(e,n){return ee(()=>{const s=Je(e);return $n(s,1)})}}c6.className="GlobalAveragePooling1D";fe(c6);class u6 extends l6{constructor(e){super(e||{})}call(e,n){return ee(()=>{const s=Je(e);return Uo(s,1)})}}u6.className="GlobalMaxPooling1D";fe(u6);class d6 extends pt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,wn(this.dataFormat),this.inputSpec=[new Mn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new ut}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class h6 extends d6{call(e,n){return ee(()=>{const s=Je(e);return this.dataFormat==="channelsLast"?$n(s,[1,2]):$n(s,[2,3])})}}h6.className="GlobalAveragePooling2D";fe(h6);class f6 extends d6{call(e,n){return ee(()=>{const s=Je(e);return this.dataFormat==="channelsLast"?Uo(s,[1,2]):Uo(s,[2,3])})}}f6.className="GlobalMaxPooling2D";fe(f6);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class p6 extends pt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,o=Hi(r,s);delete n.layer;const i={layer:o};return Object.assign(i,n),new e(i)}}class m6 extends p6{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Et(e),e.length<3)throw new q(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Et(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return ee(()=>(e=Je(e),$V((i,a)=>[Je(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}m6.className="TimeDistributed";fe(m6);function Pve(t){Bc(n0e,"BidirectionalMergeMode",t)}const _ve="concat";class g6 extends p6{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Hi(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=Hi(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?_ve:e.mergeMode,Pve(this.mergeMode),e.weights)throw new ut("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,o;return this.returnState&&(o=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):tr(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=EV(e,s,r,this.numConstants);if(e=o.inputs,s=o.initialState,r=o.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const i=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new q("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const u=s.map(d=>new Mn({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new ut("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof $i;for(const c of i)if(c instanceof $i!==l)throw new q("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ee(()=>{const s=n.initialState;let r,o;if(s==null)r=this.forwardLayer.call(e,n),o=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=Cc(o,1));let a;return this.mergeMode==="concat"?a=qE([r,o]):this.mergeMode==="sum"?a=ge(r,o):this.mergeMode==="ave"?a=X(.5,ge(r,o)):this.mergeMode==="mul"?a=X(r,o):this.mergeMode==null&&(a=[r,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){tc(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),tc(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Hi(n.layer);if(delete n.layer,n.numConstants!=null)throw new ut("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}g6.className="Bidirectional";fe(g6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class x6 extends pt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ee(()=>(e=Je(e),e.dtype!=="float32"&&(e=Ci(e,"float32")),ge(X(e,this.scale),this.offset)))}}x6.className="Rescaling";fe(x6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Mve,cropAndResize:Lve}=Bi;class y6 extends pt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,o,i,a,l){return ee(()=>{let c,u=!1;const d=n/i,h=s/a,f=(r+n)/i,m=(o+s)/a,g=[d,h,f,m],y=[];e.rank===3?(u=!0,c=na([e])):c=e;for(let C=0;C<c.shape[0];C++)y.push(g);const x=_B(y,[y.length,4]),v=Ff(0,y.length,1,"int32"),w=Lve(c,x,v,[r,o],"nearest");return Ci(u?Je(Sc(w)):w,l)})}upsize(e,n,s,r){return ee(()=>{const o=Mve(e,[n,s]);return Ci(o,r)})}call(e,n){return ee(()=>{const s=Je(e),r=s.dtype,o=s.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,i,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Et(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}y6.className="CenterCrop";fe(y6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jve(t,e,n,s){let r=Je(t);if(r.dtype!=="int32"&&(r=Ci(r,"int32")),e==="int")return r;const o=r.shape;if(r.rank===0&&(r=er(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=er(r,-1)),r.rank>2)throw new q(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=tO(a,s,n,i):l=tO(a,[],n,i),e!=="tfIdf")return l;if(s)return X(l,s);throw new q("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class v6 extends pt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Et(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return ee(()=>{e=Je(e),e.dtype!=="int32"&&(e=Ci(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new q(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=Je(n.countWeights)}const r=Uo(e),o=Jx(e),i=eo(this.numTokens,r).bufferSync().get(0),a=_c(o,0).bufferSync().get(0);if(!(i&&a))throw new q(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return jve(e,this.outputMode,this.numTokens,s)})}}v6.className="CategoryEncoding";fe(v6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Bve=["bilinear","nearest"],PO=new Set(Bve);class b6 extends pt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(PO.has(e.interpolation))this.interpolation=e.interpolation;else throw new q(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Et(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ee(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Bi.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Bi.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...PO]} are supported`)})}}b6.className="Resizing";fe(b6);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class w6{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}w6.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class C6 extends pt{constructor(e){super(e),this.randomGenerator=new w6(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}C6.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zve=["bilinear","nearest"],_O=new Set(zve);class S6 extends C6{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new q(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new q(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new q(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(_O.has(s))this.interpolation=s;else throw new q(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Et(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return ee(()=>{const s=Je(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=om([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*r;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return Bi.resizeBilinear(e,i);case"nearest":return Bi.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[..._O]} are supported`)}})}}S6.className="RandomWidth";fe(S6);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function H1(t){return new h$(t)}function MO(t){return new f$(t)}function Uve(t){return new p$(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vve=se();Vve.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var LO;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(LO||(LO={}));var jO;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(jO||(jO={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var BO;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(BO||(BO={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fe(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wve=wz;class Yv extends z2{nextDataId(){return Yv.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Bj(this,si())}write(e,n,s){this.firstUse&&(this.firstUse=!1,se().get("IS_NODE")&&jr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&ap(s[0])){const o=s.map(i=>qa(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,o){this.data.set(e,{values:n,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return sa(r,o)}return pue(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>nl(r));return ht(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ht(e.shape,e.dtype,n)}makeOutput(e,n,s){return si().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Qs();return e(),{kernelMs:Qs()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Fe([e],"where");const n=this.readSync(e.dataId);return Wve(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Yv.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k6(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Hve=t=>{const{x:e}=t.inputs,n=t.backend;Fe(e,"abs");let s=new Float32Array(ie(e.shape));const r=n.data.get(e.dataId).values;return s=k6(r),n.makeOutput(s,e.shape,e.dtype)},Gve={kernelName:$0,backendName:"cpu",kernelFunc:Hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cn(t){return(e,n,s,r,o)=>{const i=nt(e,n),a=i.length,l=Be(i),c=ie(i),u=ws(o,c),d=e.length,h=n.length,f=Be(e),m=Be(n),g=sd(e,i),y=sd(n,i);if(g.length+y.length===0)for(let x=0;x<u.length;++x)u[x]=t(s[x%s.length],r[x%r.length]);else for(let x=0;x<u.length;++x){const v=Id(x,a,l),b=v.slice(-d);g.forEach(N=>b[N]=0);const w=vi(b,d,f),C=v.slice(-h);y.forEach(N=>C[N]=0);const k=vi(C,h,m);u[x]=t(s[w],r[k])}return[u,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xr(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",o),imag:n.makeTensorInfo(r.shape,"float32",i)},a}const qve={kernelName:eN,backendName:"cpu",kernelFunc:xr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dy(t,e,n="float32"){if(n==="complex64"){const r=dy(t,e,"float32"),o=dy(t,e,"float32");return xr({inputs:{real:r,imag:o},backend:t})}const s=Cs(ie(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ii(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Kve={kernelName:Ip,backendName:"cpu",kernelFunc:Ii};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nc(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const Xve={kernelName:kN,backendName:"cpu",kernelFunc:Nc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Pc([0],n),[o,i]=Cn((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function al(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return Ii({inputs:{x:r},backend:n});const u=dy(n,r.shape,r.dtype),d=al({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=xr({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=Nc({inputs:{input:r},backend:n}),d=al({inputs:{x:u},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(u),d}if(!Vj(r.dtype,o)){const u=Ii({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:o}}const i=n.data.get(r.dataId).values,[a,l,c]=N6(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,c)}const Yve={kernelName:mp,backendName:"cpu",kernelFunc:al};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(t,e,n,s){return n==null?({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;Fe([i,a],t);const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=i.dtype==="string"?ra(c):c,h=i.dtype==="string"?ra(u):u,f=s||i.dtype,[m,g]=e(i.shape,a.shape,d,h,f);return l.makeTensorInfo(g,f,m)}:({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const c=al({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,m=l.data.get(h.dataId).values,g=al({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(g.dataId),x=y.complexTensorInfos.real,v=y.complexTensorInfos.imag,b=l.data.get(x.dataId).values,w=l.data.get(v.dataId).values,[C,k,N]=n(i.shape,a.shape,f,m,b,w),E=l.makeTensorInfo(N,"float32",C),$=l.makeTensorInfo(N,"float32",k),I=xr({inputs:{real:E,imag:$},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(E),l.disposeIntermediateTensorInfo($),I}else{const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=s||i.dtype,[h,f]=e(i.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function m$(t){return(e,n,s,r,o,i)=>{const a=nt(e,n),l=ie(a),c=a.length,u=Be(a),d=ws("float32",l),h=ws("float32",l),f=sd(e,a),m=sd(n,a),g=sa(s,r),y=sa(o,i),x=e.length,v=Be(e),b=n.length,w=Be(n);if(f.length+m.length===0)for(let C=0;C<d.length;C++){const k=C%g.length,N=C%y.length,E=t(g[k*2],g[k*2+1],y[N*2],y[N*2+1]);d[C]=E.real,h[C]=E.imag}else for(let C=0;C<d.length;C++){const k=Id(C,c,u),N=k.slice(-x);f.forEach(P=>N[P]=0);const E=vi(N,x,v),$=k.slice(-b);m.forEach(P=>$[P]=0);const I=vi($,b,w),A=t(g[E*2],g[E*2+1],y[I*2],y[I*2+1]);d[C]=A.real,h[C]=A.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E6=Cn((t,e)=>t+e),Jve=m$((t,e,n,s)=>({real:t+n,imag:e+s})),id=Un(Td,E6,Jve),Zve={kernelName:Td,backendName:"cpu",kernelFunc:id};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$(t,e,n,s,r){const o=ie(s),i=Cs(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function $6(t,e,n,s=!1){const r=t.shape[0],o=t.shape[1],i=ht([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?i.set(1,a,c):e.size>0?i.set(i.get(a,c)+e.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I6=Cn((t,e)=>t&e),Qve=Un(Q2,I6),ebe={kernelName:Q2,backendName:"cpu",kernelFunc:Qve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ti(t){return(e,n,s)=>{const r=gn(n,e.length);for(let o=0;o<e.length;++o)r[o]=t(e[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ft(t,e,n){const s=Ti(e);return Sl(t,s,n)}function Sl(t,e,n){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;Fe(i,t);const a=o,l=a.data.get(i.dataId).values;let c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=ra(l)}else c=l;const u=n||i.dtype,d=e(c,u,r);return a.makeTensorInfo(i.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T6=Ti(t=>Math.ceil(t)),tbe=Sl(gp,T6),nbe={kernelName:gp,backendName:"cpu",kernelFunc:tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6(t,e,n,s){const r=gn(n,ie(e));if(s&&n!=="string"){let o=0;t.forEach(i=>{const a=ie(i.shape);r.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?ra(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const u=c*e[1]+o;for(let d=0;d<i.shape[1];++d)r[u+d]=a[l++]}o+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A6=Cn((t,e)=>t===e?1:0),D6=Un(U0,A6,null,"bool"),sbe={kernelName:U0,backendName:"cpu",kernelFunc:D6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O6=Ti(t=>Math.exp(t)),F6=Sl(Sp,O6,"float32"),rbe={kernelName:Sp,backendName:"cpu",kernelFunc:F6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P6=Ti(t=>Math.expm1(t)),obe=Sl(kp,P6),ibe={kernelName:kp,backendName:"cpu",kernelFunc:obe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _6=Ti(t=>Math.floor(t)),abe=Sl(Np,_6),lbe={kernelName:Np,backendName:"cpu",kernelFunc:abe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M6=Cn((t,e)=>Math.floor(t/e)),cbe=Un(Ep,M6,null,"int32"),ube={kernelName:Ep,backendName:"cpu",kernelFunc:cbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t,e,n,s,r,o,i,a,l){const c=ht([s,o],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let f=0;f<r;f++){const m=t[u*r+f];h+=m*i[f],d.push(m)}if(h<0||h>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<o;f++)c.values[u*o+f]=e.get(...e.indexToLoc(h*o+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(t,e,n){const s=ht(n,t.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),a=i[0],l=i[2],c=e.locToIndex([a,l]);i[2]=e.values[c];const u=t.locToIndex(i);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B6=Cn((t,e)=>t>e?1:0),dbe=Un(G0,B6,null,"bool"),hbe={kernelName:G0,backendName:"cpu",kernelFunc:dbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6=Cn((t,e)=>t>=e?1:0),fbe=Un($p,z6,null,"bool"),pbe={kernelName:$p,backendName:"cpu",kernelFunc:fbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U6=Cn((t,e)=>t<e?1:0),mbe=Un(K0,U6,null,"bool"),gbe={kernelName:K0,backendName:"cpu",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V6=Cn((t,e)=>t<=e?1:0),xbe=Un(X0,V6,null,"bool"),ybe={kernelName:X0,backendName:"cpu",kernelFunc:xbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t,e,n){const s=(e-t)/(n-1),r=Cs(n,"float32");r[0]=t;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H6=Ti(t=>Math.log(t)),vbe=Sl(Dp,H6),bbe={kernelName:Dp,backendName:"cpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t,e,n,s){const r=ws(s,ie(n));for(let o=0;o<r.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const c=t[i+l];(Number.isNaN(c)||c>a)&&(a=c)}r[o]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q6=Cn((t,e)=>Math.max(t,e)),wbe=Un(Fp,q6),Cbe={kernelName:Fp,backendName:"cpu",kernelFunc:wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K6=Cn((t,e)=>Math.min(t,e)),Sbe=Un(Pp,K6),kbe={kernelName:Pp,backendName:"cpu",kernelFunc:Sbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x$=Cn((t,e)=>t*e),Nbe=m$((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),Jv=Un(Mp,x$,Nbe),Ebe={kernelName:Mp,backendName:"cpu",kernelFunc:Jv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(t,e,n){const s=gl(-1,n);return x$([],e,s,t,n)}function $be(t){const{inputs:e,backend:n}=t,{x:s}=e;Fe(s,"neg");const r=n.data.get(s.dataId).values,[o,i]=X6(r,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,o)}const Ibe={kernelName:iv,backendName:"cpu",kernelFunc:$be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y6=Cn((t,e)=>t!==e?1:0),Tbe=Un(av,Y6,null,"bool"),Rbe={kernelName:av,backendName:"cpu",kernelFunc:Tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$(t,e,n,s,r){const o=e.length,i=ie(e),a=Be(e),l=Be(r),c=ws(n,ie(r));for(let u=0;u<i;++u){const d=Id(u,o,a),h=new Array(d.length);for(let m=0;m<h.length;m++)h[m]=d[s[m]];const f=vi(h,o,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:o}=n;Fe(r,"transpose");const i=r.shape.length,a=new Array(i);for(let d=0;d<a.length;d++)a[d]=r.shape[o[d]];const l=s.data.get(r.dataId).values,c=y$(l,r.shape,r.dtype,o,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const Abe={kernelName:Du,backendName:"cpu",kernelFunc:lr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J6(t,e,n,s){const[r,o]=Yn(t,s),i=Tr(e,"int32"),a=Cs(ie(r),i),l=ie(o);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:i}}function Dbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"prod");const a=r.shape.length,l=ft(o,r.shape),c=an(l,a);let u=l,d=r;const h=[];c!=null&&(d=lr({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=bn(u.length,a));const f=n.data.get(d.dataId).values,{outVals:m,outShape:g,outDtype:y}=J6(d.shape,d.dtype,f,u);let x=g;return i&&(x=An(g,l)),h.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(x,y,m)}const Obe={kernelName:fv,backendName:"cpu",kernelFunc:Dbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const o=Id(r,e.length,Be(e)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${n})`)}})}function Pbe(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function _be(t,e,n,s){const r=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);Pbe(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],m=h+e.length-1;if(m>=0){const g=a[m],y=g[g.length-1]-f[u];for(let x=u;x<d;++x)a[m].push(f[x+1]+y)}u=f[u],d=f[d]}d!==u&&(r.push([u,d]),o+=d-u)}return{outSplits:a,valueSlices:r,numValues:o}}function Mbe(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=gn("int32",s);e.push(r),t[n].forEach((o,i)=>r[i]=o)}return e}function zO(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function Lbe(t,e,n,s,r,o){const i=zO(e,2)[1],a=zO(o,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=t[u*i+d];++l}}function jbe(t,e,n,s,r){const o=e.slice();o[0]=r;const i=gn(n,ie(o)),a=t.length,l=a===0?0:a/e[0];return Lbe(t,e,s,l,i,o),[i,o]}function Z6(t,e,n,s,r,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Fbe(o,i,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=_be(o,i,t,c),f=Mbe(u),m=jbe(n,s,r,d,h);return[f,m[0],m[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UO=2147483647;function Q6(t,e,n,s,r,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=i.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(i[0]);for(let y=1;y<u.length;++y)if(u[y]!==u[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=gn("int32",d+1);h[0]=0;for(let y=0;y<d;++y){const x=a?t[0]:t[y],v=l?s[0]:s[y],b=c?o[0]:o[y];if(b===0)throw new Error("Requires delta != 0");let w;if(b>0&&v<x||b<0&&v>x)w=0;else if(w=Math.ceil(Math.abs((v-x)/b)),w>UO)throw new Error(`Requires ((limit - start) / delta) <= ${UO}`);h[y+1]=h[y]+w}const f=h[d],m=gn(n,f);let g=0;for(let y=0;y<d;++y){const x=h[y+1]-h[y];let v=a?t[0]:t[y];const b=c?o[0]:o[y];for(let w=0;w<x;++w)m[g++]=v,v+=b}return[h,m]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ro=Mo;class hy{constructor(e,n,s,r,o,i,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=Bz(u),this.raggedRank=zz(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===ro.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===ro.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case ro.VALUE_ROWIDS:return hy.getMaxWidthValueRowID(n);case ro.ROW_SPLITS:return hy.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ro[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const o=e[r+1]-e[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==r&&(r=a,o=Math.max(i-s,o),s=i)}return Math.max(n-s,o)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return WO(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;Uz(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=jz(this.raggedRank,r,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),o=[];let i=0;for(let a=0;a<r;++a,i+=n)o.push(i);for(let a=r;a<e;++a)o.push(-1);return T(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,s,r){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)i.push(u),u+=s;for(let d=0;d<l-c;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,r){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let u=1;u<o;++u){const d=e[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,r){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case ro.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,s,r);case ro.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,s,r);default:throw new Error(`Unsupported partition type: ${ro[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ro.FIRST_DIM_SIZE:return e[0];case ro.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ro.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ro[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const o=WO(s,!1),i=gn(this.valuesDType,ie(o));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,s,r){if(s.length===0)return;const o=this.values,i=s;let a=r.slice();a=a.slice(e+1);const l=ie(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const m=this.defaultValueShape;ee(()=>{const g=Z(u,m);u=Gh(g,a).dataSync()})}let d=0,h=0,f=0;for(let m=0;m<=c;++m){let g=m<c?n[m]:-1;if(g===f){++f;continue}if(h<f){const y=o.subarray(d*l),x=i.subarray(h*l),v=(f-h)*l;VO(x,y,v)}if(m>=c){const y=s.length;g=Math.floor(y/l)}if(g>f)if(this.defaultValue.length===1)i.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const y=i.slice(f*l);VO(y,u,l),++f}g<0?(d=m+1,h=f):(d=m,h=f,f=h+1)}}}function VO(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function WO(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function eW(t,e,n,s,r,o,i,a,l,c){return new hy(t,e,n,s,r,o,i,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(t,e,n,s){const r=t===e,o=t<e&&n<0,i=e<t&&n>1;if(r||o||i)return Cs(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Cs(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nW=Ti(t=>1/Math.sqrt(t)),Bbe=Sl(Vp,nW),zbe={kernelName:Vp,backendName:"cpu",kernelFunc:Bbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gl(t,e,n,s,r,o,i,a,l,c){const u=[s/r,r],d=t.values,h=e.values;if(s===0)return ht(n,e.dtype);const f=l instanceof ls?l:ht(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let m=0;m<o;m++){const g=[];let y=0;for(let x=0;x<i;x++){const v=d[m*i+x];g.push(v),y+=v*a[x]}if(y<0||y>=s/r)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let x=0;x<r;x++)c?f.values[y*r+x]+=h[m*r+x]:f.values[y*r+x]=e.rank===0?h[0]:h[m*r+x]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ube=Ti(t=>1/(1+Math.exp(-t))),sW=Ft(Kp,t=>1/(1+Math.exp(-t))),Vbe={kernelName:Kp,backendName:"cpu",kernelFunc:sW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rW(t,e,n,s,r){const o=CE(s,e,n),i=ie(n),a=Be(s);if(o){const d=SE(e,a);return r==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=r==="string"?ra(t):t,c=ht(s,r,l),u=ht(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((m,g)=>m+e[g]);u.set(c.get(...f),...h)}return r==="string"?lU(u.values):u.values}function Ec(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s;Fe(r,"slice");const[a,l]=_v(r,o,i);bE(r,a,l);const c=n.data.get(r.dataId).values,u=rW(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const Wbe={kernelName:vv,backendName:"cpu",kernelFunc:Ec};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(t,e,n,s,r,o,i){const a=e[0],l=o[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(Xz(a));const y=gn(n,0),x=gn(r,0);return[y,[0,d],x,c,u]}let h=!0,f=0;const m=new Array(l).fill(0);for(let y=0;y<a;++y){const x=t[y*d];if(x<0)throw new Error(Yz(y,x));if(x>=l)throw new Error(Jz(y,x,l));++m[x],h=h&&x>=f,f=x}let g=!0;for(let y=0;y<l;++y){const x=m[y]===0;c[y]=x,g=g&&!x,m[y]=Math.max(m[y],1),y>0&&(m[y]+=m[y-1])}if(g&&h){const y=t,x=s;for(let v=0;v<a;++v)u[v]=v;return[y,[a,d],x,c,u]}else{const y=m[l-1],x=gn(n,y*d),v=gn(r,y),b=new Array(l).fill(0);for(let w=0;w<a;++w){const C=t[w*d],k=b[C],N=(C===0?0:m[C-1])+k;b[C]++;for(let E=0;E<d;++E)x[N*d+E]=t[w*d+E];v[N]=s[w],u[w]=N}for(let w=0;w<l;++w)if(b[w]===0){const k=w===0?0:m[w-1];x[k*d+0]=w;for(let N=1;N<d;++N)x[k*d+N]=0;v[k]=i}return[x,[y,d],v,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iW(t,e,n,s,r){const o=ie(s),i=e[0],a=r.length,l=[];let c=1,u=-1;for(let y=0;y<a;++y){const x=r[y];if(x===-1){if(u!==-1)throw new Error(Zz(u,y));u=y,l.push(1)}else{if(x<0)throw new Error(Qz(y,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(eU());const y=Math.trunc(o/c);if(c*y!==o)throw new Error(tU(s,l));l[u]=y}if(ie(l)!==o)throw new Error(nU(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let y=h-2;y>=0;--y)f[y]=f[y+1]*s[y+1]}const m=[];if(a>0){m[a-1]=1;for(let y=a-2;y>=0;--y)m[y]=m[y+1]*l[y+1]}const g=gn(n,i*a);for(let y=0;y<i;++y){let x=0;for(let v=0;v<h;++v)x+=t[y*h+v]*f[v];for(let v=0;v<a;++v)g[y*a+v]=Math.trunc(x/m[v]),x%=m[v]}return[g,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v$(t,e,n,s,r,o=!1,i=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(sS());const h=e.slice();h[0]=d;const f=h.reduce((b,w)=>b*w,1),m=gn(n,f);if(a===0)return d>0&&m.fill(i),[m,h];if(d<=0)throw new Error(sS());let g=0,y=1,x=0,v=r[g];for(;;){let b=0;if(y<a){if(b=r[y],v===b){++y;continue}if(v>=b)throw new Error(sU())}if(v<0||v>=d)throw new Error(rU(v,d));v>x&&m.fill(i,x*c,v*c);for(let w=g;w<y;++w){const C=s[w];if(C<0||C>=l[0])throw new Error(oU(w,s[w],l[0]));for(let k=0;k<c;k++)m[v*c+k]+=t[C*c+k]}if(o)for(let w=0;w<c;w++)m[v*c+w]/=y-g;if(g=y,++y,x=v+1,v=b,y>a)break}return x<d&&m.fill(i,x*c,d*c),[m,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hbe=Ti(t=>Math.sqrt(t)),Gbe=Ft(Yp,t=>Math.sqrt(t)),qbe={kernelName:Yp,backendName:"cpu",kernelFunc:Gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aW=Cn((t,e)=>{const n=t-e;return n*n}),Kbe=Un(Jp,aW),Xbe={kernelName:Jp,backendName:"cpu",kernelFunc:Kbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lW=Ti((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),Ybe=Sl(IN,lW),Jbe={kernelName:IN,backendName:"cpu",kernelFunc:Ybe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cW(t,e,n,s){const r=ht(t,e.dtype);for(let o=0;o<r.size;o++){const i=r.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+s[l];r.set(e.get(...a),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zbe{constructor(e,n,s,r,o,i){this.separator=qa(e),this.nGramWidths=n,this.leftPad=qa(s),this.rightPad=qa(r),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(o-(a+1))),d=i-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let v=0;v<d;++v)f+=e[h+v].length;f+=u*this.rightPad.length;const m=c+u+d-1;f+=m*this.separator.length,s[r+a]=new Uint8Array(f);const g=s[r+a];let y=0;const x=v=>v.forEach(b=>g[y++]=b);for(let v=0;v<c;++v)x(this.leftPad),x(this.separator);for(let v=0;v<d-1;++v)x(e[h+v]),x(this.separator);if(d>0){x(e[h+d-1]);for(let v=0;v<u;++v)x(this.separator),x(this.rightPad)}else{for(let v=0;v<u-1;++v)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const o=r-1,i=gn("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=o;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}const a=new Array(i[o]);for(let l=0;l<o;++l){const c=n[l];let u=i[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,a,u,1,h)}}return[a,i]}}function uW(t,e,n,s,r,o,i,a){return new Zbe(n,s,r,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qbe(t,e,n,s){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)s.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&s.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(r,o);(!n||i.length!==0)&&s.push(i),r=o+1}}function dW(t,e,n){const s=t.length,r=[];let o=0,i=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;Qbe(t[h],e,n,r);const m=r.length-f;a[h]=m,o+=m,i=Math.max(i,m)}const l=gn("int32",o*2),c=new Array(o),u=[s,i];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hW(t,e){const n=gn("int32",t.length);for(let s=0;s<t.length;++s)n[s]=Fue(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fW=Cn((t,e)=>t-e),e1e=m$((t,e,n,s)=>({real:t-n,imag:e-s})),b$=Un(Zp,fW,e1e),t1e={kernelName:Zp,backendName:"cpu",kernelFunc:b$};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=ht(n,t.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ch=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function mW(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(s,Math.floor(e+(a-l)*u/a+d));mW(t,e,h,f)}const r=t[e];let o=n,i=s;for(su(t,n,e),Ch(t[s],r)>0&&su(t,n,s);o<i;){for(su(t,o,i),o++,i--;Ch(t[o],r)<0;)o=o+1;for(;Ch(t[i],r)>0;)i=i-1}Ch(t[n],r)===0?su(t,n,i):(i=i+1,su(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function gW(t,e,n,s,r){const o=e[e.length-1],[i,a]=[t.length/o,o],l=ws(n,i*s),c=ws("int32",i*s);for(let d=0;d<i;d++){const h=d*a,f=t.subarray(h,h+a);let m=new Array(f.length);f.forEach((v,b)=>m[b]={value:v,index:b}),s<m.length&&(mW(m,s),m=m.slice(0,s)),r&&m.sort(Ch);const g=d*s,y=l.subarray(g,g+s),x=c.subarray(g,g+s);for(let v=0;v<s;v++)y[v]=m[v].value,x[v]=m[v].index}const u=e.slice();return u[u.length-1]=s,[ht(u,n,l),ht(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t,e,n,s){const r=ft(e,n)[0],o=[1,n[0],1];for(let m=0;m<r;m++)o[0]*=n[m];o[1]=n[r];for(let m=r+1;m<n.length;m++)o[2]*=n[m];const i=new Map,a=new Int32Array(n[r]),l=new ls(o,s,t),c=[],u=o[0]===1&&o[2]===1;for(let m=0;m<n[r];m++){let g;if(u)g=t[m].toString();else{const x=[];for(let v=0;v<o[0];v++)for(let b=0;b<o[2];b++)x.push(l.get(v,m,b));g=x.join(",")}const y=i.get(g);if(y!=null)a[m]=y;else{const x=i.size;i.set(g,x),a[m]=x,c.push(m)}}const d=o.slice();d[1]=i.size;const h=new ls(d,s);c.forEach((m,g)=>{for(let y=0;y<o[0];y++)for(let x=0;x<o[2];x++)h.set(l.get(y,m,x),y,g,x)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n1e=Object.freeze(Object.defineProperty({__proto__:null,addImpl:E6,bincountImpl:g$,bincountReduceImpl:$6,bitwiseAndImpl:I6,castImpl:N6,ceilImpl:T6,concatImpl:R6,equalImpl:A6,expImpl:O6,expm1Impl:P6,floorDivImpl:M6,floorImpl:_6,gatherNdImpl:L6,gatherV2Impl:j6,greaterEqualImpl:z6,greaterImpl:B6,lessEqualImpl:V6,lessImpl:U6,linSpaceImpl:W6,logImpl:H6,maxImpl:G6,maximumImpl:q6,minimumImpl:K6,multiplyImpl:x$,negImpl:X6,notEqualImpl:Y6,prodImpl:J6,raggedGatherImpl:Z6,raggedRangeImpl:Q6,raggedTensorToTensorImpl:eW,rangeImpl:tW,rsqrtImpl:nW,scatterImpl:Gl,sigmoidImpl:Ube,simpleAbsImpl:k6,sliceImpl:rW,sparseFillEmptyRowsImpl:oW,sparseReshapeImpl:iW,sparseSegmentReductionImpl:v$,sqrtImpl:Hbe,squaredDifferenceImpl:aW,staticRegexReplaceImpl:lW,stridedSliceImpl:cW,stringNGramsImpl:uW,stringSplitImpl:dW,stringToHashBucketFastImpl:hW,subImpl:fW,tileImpl:pW,topKImpl:gW,transposeImpl:y$,uniqueImpl:xW},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */MB("cpu",()=>new Yv,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yW=Ft(wp,t=>t>=0?t:Math.exp(t)-1),s1e={kernelName:wp,backendName:"cpu",kernelFunc:yW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s;Fe([r],"leakyRelu");const i=ie(r.shape),a=n.data.get(r.dataId).values,l=ws("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?o*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const r1e={kernelName:q0,backendName:"cpu",kernelFunc:vW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o1e=Cn((t,e)=>t<0?e*t:t);function bW(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Fe([s,r],"prelu");const o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,[a,l]=o1e(s.shape,r.shape,o,i,"float32");return n.makeTensorInfo(l,"float32",a)}const i1e={kernelName:hv,backendName:"cpu",kernelFunc:bW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wW=Ft(Bp,t=>Math.max(0,t)),a1e={kernelName:Bp,backendName:"cpu",kernelFunc:wW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CW=Ft(zp,t=>Math.min(Math.max(0,t),6)),l1e={kernelName:zp,backendName:"cpu",kernelFunc:CW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fy(t,e,n,s,r){if(n==="linear")return Ii({inputs:{x:e},backend:t});if(n==="relu")return wW({inputs:{x:e},backend:t});if(n==="elu")return yW({inputs:{x:e},backend:t});if(n==="relu6")return CW({inputs:{x:e},backend:t});if(n==="prelu")return bW({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return vW({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return sW({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=ie(r.shape),a=Uj(o,i),l=ie(a);T(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const c1e={kernelName:pv,backendName:"cpu",kernelFunc:Ht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;Fe([r,o],"matMul");const l=r.shape.length,c=o.shape.length,u=i?r.shape[l-2]:r.shape[l-1],d=a?o.shape[c-1]:o.shape[c-2],h=i?r.shape[l-1]:r.shape[l-2],f=a?o.shape[c-2]:o.shape[c-1],m=r.shape.slice(0,-2),g=o.shape.slice(0,-2),y=ie(m),x=ie(g),b=nt(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([h,f]);T(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const w=i?[y,u,h]:[y,h,u],C=a?[x,f,d]:[x,d,f],k=Ht({inputs:{x:r},backend:n,attrs:{shape:w}}),N=Ht({inputs:{x:o},backend:n,attrs:{shape:C}}),E=i?k.shape[1]:k.shape[2],$=i?k.shape[2]:k.shape[1],I=a?N.shape[1]:N.shape[2],A=Math.max(y,x),P=n.data.get(k.dataId).values,_=n.data.get(N.dataId).values,U=Be(k.shape),V=Be(N.shape),[D,W,R]=i?[U[0],1,U[1]]:[U[0],U[1],1],[j,G,O]=a?[1,V[1],V[0]]:[V[1],1,V[0]],B=$*I,z=ht([A,$,I],k.dtype),K=z.values,J=n.blockSize;for(let re=0;re<A;re++){const de=re%y,pe=re%x;for(let we=0;we<$;we+=J){const Ce=Math.min(we+J,$);for(let Ne=0;Ne<I;Ne+=J){const ze=Math.min(Ne+J,I);for(let _e=0;_e<E;_e+=J){const st=Math.min(_e+J,E);for(let je=we;je<Ce;je++)for(let rt=Ne;rt<ze;rt++){let ue=0;for(let Ue=_e;Ue<st;Ue++){const sn=P[de*D+je*W+Ue*R],gt=_[Ue*j+rt*G+pe*O];ue+=sn*gt}K[re*B+(je*I+rt)]+=ue}}}}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(N),n.makeTensorInfo(b,z.dtype,z.values)}const u1e={kernelName:D0,backendName:"cpu",kernelFunc:SW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,f,m;const g=[];h=SW({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(f=id({inputs:{a:h,b:i},backend:n}),g.push(h),h=f),u&&(m=fy(n,h,u,a,d),g.push(h),h=m);for(const x of g)n.disposeIntermediateTensorInfo(x);return h}const h1e={kernelName:Gx,backendName:"cpu",kernelFunc:d1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f1e=Ft(lp,t=>Math.acos(t)),p1e={kernelName:lp,backendName:"cpu",kernelFunc:f1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1e=Ft(cp,t=>Math.acosh(t)),g1e={kernelName:cp,backendName:"cpu",kernelFunc:m1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1e(t){const{inputs:e,backend:n}=t,s=e;Fe(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),o=ht(s[0].shape,s[0].dtype),i=o.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const y1e={kernelName:q2,backendName:"cpu",kernelFunc:x1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"all");const a=ft(o,r.shape);let l=a;const c=an(l,r.shape.length);let u=r;c!=null&&(u=lr({inputs:{x:r},backend:n,attrs:{perm:c}}),l=bn(l.length,r.shape.length)),ds("all",l,u.shape.length);const[d,h]=Yn(u.shape,l),f=ie(h),m=Cs(ie(d),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<m.length;++x){const v=x*f;let b=g[v];for(let w=0;w<f;++w){const C=g[v+w];b=b&&C}m[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,m);if(i){const x=An(d,a),v=Ht({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}const b1e={kernelName:K2,backendName:"cpu",kernelFunc:v1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"any");const a=ft(o,r.shape);let l=a;const c=an(l,r.shape.length);let u=r;c!=null&&(u=lr({inputs:{x:r},backend:n,attrs:{perm:c}}),l=bn(l.length,r.shape.length)),ds("any",l,u.shape.length);const[d,h]=Yn(u.shape,l),f=ie(h),m=Cs(ie(d),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<m.length;++x){const v=x*f;let b=g[v];for(let w=0;w<f;++w){const C=g[v+w];b=b||C}m[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,m);if(i){const x=An(d,a),v=Ht({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}const C1e={kernelName:X2,backendName:"cpu",kernelFunc:w1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;Fe(r,"argMax");let i=ft(o,r.shape);const a=an(i,r.shape.length);let l=r;const c=[];a!=null&&(l=lr({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=bn(i.length,l.shape.length)),i=[i[0]],ds("argMax",i,l.shape.length);const[u,d]=Yn(l.shape,i),h=ie(u),f=Cs(h,"int32"),m=ie(d),g=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const x=y*m;let v=g[x],b=0;for(let w=0;w<m;++w){const C=g[x+w];C>v&&(v=C,b=w)}f[y]=b}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}const k1e={kernelName:I0,backendName:"cpu",kernelFunc:S1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;Fe(r,"argMin");let i=ft(o,r.shape);const a=an(i,r.shape.length);let l=r;const c=[];a!=null&&(l=lr({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=bn(i.length,l.shape.length)),i=[i[0]],ds("argMin",i,l.shape.length);const[u,d]=Yn(l.shape,i),h=ie(u),f=Cs(h,"int32"),m=ie(d),g=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const x=y*m;let v=g[x],b=0;for(let w=0;w<m;++w){const C=g[x+w];C<v&&(v=C,b=w)}f[y]=b}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}const E1e={kernelName:T0,backendName:"cpu",kernelFunc:N1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1e=Ft(up,t=>Math.asin(t)),I1e={kernelName:up,backendName:"cpu",kernelFunc:$1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T1e=Ft(dp,t=>Math.asinh(t)),R1e={kernelName:dp,backendName:"cpu",kernelFunc:T1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A1e=Ft(hp,t=>Math.atan(t)),D1e={kernelName:hp,backendName:"cpu",kernelFunc:A1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O1e=Cn((t,e)=>Math.atan2(t,e)),F1e=Un(pp,O1e),P1e={kernelName:pp,backendName:"cpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _1e=Ft(fp,t=>Math.atanh(t)),M1e={kernelName:fp,backendName:"cpu",kernelFunc:_1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$(t,e,n,s,r,o){const i=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,m=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=ht(r.outShape,n),y=g.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],v=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let w=0;w<r.batchSize;++w){const C=w*x,k=w*s[0];for(let N=0;N<r.inChannels;++N)for(let E=0;E<r.outHeight;++E){const $=E*i-h,I=Math.max(0,$),A=Math.min(r.inHeight,u+$),P=C+E*v;for(let _=0;_<r.outWidth;++_){const U=_*a-f,V=Math.max(0,U),D=Math.min(r.inWidth,d+U);let W=m,R=0,j=0;for(let O=I;O<A;O+=l){const B=k+O*s[1];for(let z=V;z<D;z+=c){const K=B+z*s[2],J=t[K+N];o==="max"&&J>W?W=J:o==="avg"&&(R+=J,j++)}if(isNaN(W))break}const G=P+_*b+N;y[G]=o==="avg"?R/j:W}}}return g}function kW(t,e,n,s,r=!1,o=!1){const i=ht(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,m=s.padInfo.left,g=ht(e,n,t);for(let y=0;y<s.batchSize;++y)for(let x=0;x<s.inChannels;++x)for(let v=0;v<s.outHeight;++v){const b=v*a-f;let w=b;for(;w<0;)w+=c;const C=Math.min(s.inHeight,d+b);for(let k=0;k<s.outWidth;++k){const N=k*l-m;let E=N;for(;E<0;)E+=u;const $=Math.min(s.inWidth,h+N);let I=Number.NEGATIVE_INFINITY,A=-1;for(let P=w;P<C;P+=c){const _=P-b;for(let U=E;U<$;U+=u){const V=U-N,D=g.get(y,P,U,x);D>I&&(I=D,r?A=o?((y*s.inHeight+P)*s.inWidth+U)*s.inChannels+x:(P*s.inWidth+U)*s.inChannels+x:A=_*h+V)}}i.set(A,y,v,k,x)}}return i}function NW(t,e,n,s,r,o){const i=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,m=r.effectiveFilterWidth,g=r.padInfo.front,y=r.padInfo.top,x=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=ht(r.outShape,n),w=b.values,C=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],N=r.outShape[3]*r.outShape[4],E=r.outShape[4];for(let $=0;$<r.batchSize;++$){const I=$*C,A=$*s[0];for(let P=0;P<r.inChannels;++P)for(let _=0;_<r.outDepth;++_){const U=_*i-g;let V=U;for(;V<0;)V+=c;const D=Math.min(r.inDepth,h+U),W=I+_*k;for(let R=0;R<r.outHeight;++R){const j=R*a-y;let G=j;for(;G<0;)G+=u;const O=Math.min(r.inHeight,f+j),B=W+R*N;for(let z=0;z<r.outWidth;++z){const K=z*l-x;let J=K;for(;J<0;)J+=d;const re=Math.min(r.inWidth,m+K),de=B+z*E;let pe=v,we=0,Ce=0;for(let ze=V;ze<D;ze+=c){const _e=A+ze*s[1];for(let st=G;st<O;st+=u){const je=_e+st*s[2];for(let rt=J;rt<re;rt+=d){const ue=je+rt*s[3],Ue=t[ue+P];if(o==="max"&&Ue>pe?pe=Ue:o==="avg"&&(we+=Ue,Ce++),isNaN(pe))break}if(isNaN(pe))break}if(isNaN(pe))break}const Ne=de+P;w[Ne]=o==="avg"?we/Math.max(Ce,1):pe}}}}return b}function L1e(t,e){const n=ht(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,m=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let y=0;y<e.inChannels;++y)for(let x=0;x<e.outDepth;++x){const v=x*s-h;let b=v;for(;b<0;)b+=i;const w=Math.min(e.inDepth,c+v);for(let C=0;C<e.outHeight;++C){const k=C*r-f;let N=k;for(;N<0;)N+=a;const E=Math.min(e.inHeight,u+k);for(let $=0;$<e.outWidth;++$){const I=$*o-m;let A=I;for(;A<0;)A+=l;const P=Math.min(e.inWidth,d+I);let _=Number.NEGATIVE_INFINITY,U=-1;for(let V=b;V<w;V+=i){const D=V-v;for(let W=N;W<E;W+=a){const R=W-k;for(let j=A;j<P;j+=l){const G=j-I,O=t.get(g,V,W,j,y);O>=_&&(_=O,U=D*u*d+R*u+G)}}}n.set(U,g,x,C,$,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Fe(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(ks(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=No(r.shape,o,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Rt(u.inShape,u.outShape))d=Ii({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Be(r.shape),m=w$(h,r.shape,r.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,m.values)}return d}const B1e={kernelName:R0,backendName:"cpu",kernelFunc:j1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;Fe(r,"avgPool3d");const u=ua(r.shape,o,i,1,a,l,c),d=n.data.get(r.dataId).values,h=NW(d,r.shape,r.dtype,Be(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const U1e={kernelName:A0,backendName:"cpu",kernelFunc:z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;Fe([r,o],"avgPool3DGrad");const u=ua(o.shape,i,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,m=u.filterDepth,g=u.filterHeight,y=u.filterWidth,x=u.dilationDepth,v=u.dilationHeight,b=u.dilationWidth,w=u.effectiveFilterDepth,C=u.effectiveFilterHeight,k=u.effectiveFilterWidth,N=w-1-u.padInfo.front,E=k-1-u.padInfo.left,$=C-1-u.padInfo.top,I=ht(o.shape,"float32"),A=1/(m*g*y),P=n.bufferSync(r);for(let _=0;_<u.batchSize;++_)for(let U=0;U<u.inChannels;++U)for(let V=0;V<u.inDepth;++V)for(let D=0;D<u.inHeight;++D)for(let W=0;W<u.inWidth;++W){const R=V-N,j=D-$,G=W-E;let O=0;for(let B=0;B<w;B+=x){const z=(R+B)/d;if(!(z<0||z>=u.outDepth||Math.floor(z)!==z))for(let K=0;K<C;K+=v){const J=(j+K)/h;if(!(J<0||J>=u.outHeight||Math.floor(J)!==J))for(let re=0;re<k;re+=b){const de=(G+re)/f;if(de<0||de>=u.outWidth||Math.floor(de)!==de)continue;const pe=P.get(_,z,J,de,U);O+=pe}}}I.set(O*A,_,V,D,W,U)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const W1e={kernelName:J2,backendName:"cpu",kernelFunc:V1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;Fe([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=No(i.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,m=u.filterWidth,g=u.dilationHeight,y=u.dilationWidth,x=u.effectiveFilterHeight,v=u.effectiveFilterWidth,b=v-1-u.padInfo.left,w=x-1-u.padInfo.top,C=ht(i.shape,"float32"),k=1/(f*m),N=n.data.get(r.dataId).values,E=ht(r.shape,"float32",N);for(let $=0;$<u.batchSize;++$)for(let I=0;I<u.inChannels;++I)for(let A=0;A<u.inHeight;++A)for(let P=0;P<u.inWidth;++P){const _=A-w,U=P-b;let V=0;for(let D=0;D<x;D+=g){const W=(_+D)/d;if(!(W<0||W>=u.outHeight||Math.floor(W)!==W))for(let R=0;R<v;R+=y){const j=(U+R)/h;if(j<0||j>=u.outWidth||Math.floor(j)!==j)continue;const G=E.get($,W,j,I);V+=G}}C.set(V*k,$,A,P,I)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const G1e={kernelName:Y2,backendName:"cpu",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:o,offset:i,mean:a,variance:l}=e;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Fe([r,a,l,o,i],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=o?n.data.get(o.dataId).values:new Float32Array([1]),m=i?n.data.get(i.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),y=m.length,x=f.length,v=h.length,b=d.length;let w=0,C=0,k=0,N=0;for(let E=0;E<u.length;++E)g[E]=m[w++]+(u[E]-d[C++])*f[k++]/Math.sqrt(h[N++]+c),w>=y&&(w=0),C>=b&&(C=0),k>=x&&(k=0),N>=v&&(N=0);return n.makeTensorInfo(r.shape,r.dtype,g)}const K1e={kernelName:W0,backendName:"cpu",kernelFunc:q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;Fe([r],"batchToSpaceND");const a=o.reduce((x,v)=>x*v),l=lm(r.shape,o,a),c=cm(l.length,o.length),u=um(r.shape,o,a),d=IE(i,o.length),h=TE(u,i,o.length),f=Ht({inputs:{x:r},backend:n,attrs:{shape:l}}),m=lr({inputs:{x:f},backend:n,attrs:{perm:c}}),g=Ht({inputs:{x:m},backend:n,attrs:{shape:u}}),y=Ec({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}const Y1e={kernelName:O0,backendName:"cpu",kernelFunc:X1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=g$(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const Z1e={kernelName:Z2,backendName:"cpu",kernelFunc:J1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1e(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=nt(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const ewe={kernelName:Kj,backendName:"cpu",kernelFunc:Q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const twe=Ft(xp,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),nwe={kernelName:xp,backendName:"cpu",kernelFunc:twe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const swe=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(ie(e.shape)),r=n.data.get(e.dataId),o=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,e.shape,"float32")},rwe={kernelName:F0,backendName:"cpu",kernelFunc:swe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ad(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const owe={kernelName:gN,backendName:"cpu",kernelFunc:ad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ld(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=ft(r,e[0].shape)[0],i=e.map(g=>g.shape);NE(i,o);let a=wi(e.map(g=>g.shape),o);if(ie(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(g=>ie(g.shape)>0);if(l.length===1)return Ii({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(w=>Nc({inputs:{input:w},backend:n})),y=l.map(w=>ad({inputs:{input:w},backend:n})),x=ld({inputs:g,backend:n,attrs:{axis:o}}),v=ld({inputs:y,backend:n,attrs:{axis:o}}),b=xr({inputs:{real:x,imag:v},backend:n});return g.forEach(w=>n.disposeIntermediateTensorInfo(w)),y.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),b}const c=l.map(g=>{const x=[-1,ie(g.shape.slice(o))];return Ht({inputs:{x:g},backend:n,attrs:{shape:x}})}),u=c.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=wi(c.map(g=>g.shape),1);const d=c[0].shape[0]===1,h=R6(u,a,e[0].dtype,d),f=wi(l.map(g=>g.shape),o),m=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const iwe={kernelName:P0,backendName:"cpu",kernelFunc:ld};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;Fe([r,o],"conv2d");const d=da(l),h=us(r.shape,o.shape,i,c,a,u,!1,d),f=h.filterHeight,m=h.filterWidth,g=h.dilationHeight,y=h.dilationWidth,x=h.padInfo.left,v=h.padInfo.top,b=h.dataFormat==="channelsLast",w=new ls(h.outShape,r.dtype),C=Be(r.shape),k=Be(o.shape),N=C[0],E=b?C[1]:C[2],$=b?C[2]:1,I=b?1:C[1],A=w.strides[0],P=b?w.strides[1]:w.strides[2],_=b?w.strides[2]:1,U=b?1:w.strides[1],V=n.data.get(r.dataId).values,D=n.data.get(o.dataId).values,W=w.values;for(let R=0;R<h.batchSize;++R){const j=R*N,G=R*A;for(let O=0;O<h.outHeight;++O){const B=G+O*P,z=O*h.strideHeight-v;for(let K=0;K<f;++K){const J=z+K*g;if(J<0||J>=h.inHeight)continue;const re=K*k[0],de=j+J*E;for(let pe=0;pe<h.outWidth;++pe){const we=B+pe*_,Ce=pe*h.strideWidth-x;for(let Ne=0;Ne<m;++Ne){const ze=Ce+Ne*y;if(ze<0||ze>=h.inWidth)continue;const _e=re+Ne*k[1],st=de+ze*$;let je=_e;for(let rt=0;rt<h.inChannels;++rt){const ue=V[st+rt*I];for(let Ue=0;Ue<h.outChannels;++Ue)W[we+Ue*U]+=ue*D[je+Ue];je+=h.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,W)}const awe={kernelName:_0,backendName:"cpu",kernelFunc:EW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;Fe([r,o],"conv2dBackpropFilter");const d=da(l),h=us(r.shape,u,i,1,a,c,!1,d),{strideHeight:f,strideWidth:m,filterHeight:g,filterWidth:y}=h,x=h.dataFormat==="channelsLast",v=new ls(h.filterShape,"float32"),b=h.padInfo.left,w=h.padInfo.top,C=n.data.get(r.dataId).values,k=n.data.get(o.dataId).values,N=new ls(r.shape,r.dtype,C),E=new ls(o.shape,o.dtype,k);for(let $=0;$<g;++$){const I=Math.max(0,Math.ceil((w-$)/f)),A=Math.min(h.outHeight,(h.inHeight+w-$)/f);for(let P=0;P<y;++P){const _=Math.max(0,Math.ceil((b-P)/m)),U=Math.min(h.outWidth,(h.inWidth+b-P)/m);for(let V=0;V<h.inChannels;++V)for(let D=0;D<h.outChannels;++D){let W=0;for(let R=0;R<h.batchSize;++R)for(let j=I;j<A;++j){const G=$+j*f-w;for(let O=_;O<U;++O){const B=P+O*m-b;x?W+=N.get(R,G,B,V)*E.get(R,j,O,D):W+=N.get(R,V,G,B)*E.get(R,D,j,O)}}v.set(W,$,P,V,D)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const cwe={kernelName:tN,backendName:"cpu",kernelFunc:lwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uwe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;Fe([r,o],"conv2dBackpropInput");const d=Be(o.shape),h=Be(r.shape);let f=da(c);const m=us(i,o.shape,a,1,l,u,!1,f),g=new ls(m.inShape,"float32"),y=g.values,x=n.data.get(r.dataId).values,v=n.data.get(o.dataId).values,[b,w,C]=d,{batchSize:k,filterHeight:N,filterWidth:E,inChannels:$,inHeight:I,inWidth:A,outChannels:P,outHeight:_,outWidth:U,strideHeight:V,strideWidth:D}=m;f=m.dataFormat;const W=N-1-m.padInfo.top,R=E-1-m.padInfo.left,j=f==="channelsLast",G=g.strides[0],O=j?g.strides[1]:g.strides[2],B=j?g.strides[2]:1,z=j?1:g.strides[1],K=h[0],J=j?h[1]:h[2],re=j?h[2]:1,de=j?1:h[1];for(let pe=0;pe<k;++pe)for(let we=0;we<$;++we)for(let Ce=0;Ce<I;++Ce){const Ne=Ce-W,ze=Math.max(0,Math.ceil(Ne/V)),_e=Math.min(_,(N+Ne)/V);for(let st=0;st<A;++st){const je=st-R,rt=Math.max(0,Math.ceil(je/D)),ue=Math.min(U,(E+je)/D);let Ue=0;for(let gt=ze;gt<_e;++gt){const Jn=gt*V-Ne;for(let pn=rt;pn<ue;++pn){const Zn=pn*D-je,Vn=K*pe+J*gt+re*pn,hr=b*(N-1-Jn)+w*(E-1-Zn)+C*we;for(let it=0;it<P;++it){const Qn=x[Vn+de*it],fr=v[hr+it];Ue+=Qn*fr}}}const sn=G*pe+O*Ce+B*st+z*we;y[sn]=Ue}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const dwe={kernelName:M0,backendName:"cpu",kernelFunc:uwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s;Fe([r,o],"conv3d");const c=xl(r.shape,o.shape,i,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:m,dilationWidth:g,padInfo:y}=c,x=y.front,v=y.left,b=y.top,w=new ls(c.outShape,r.dtype),C=n.data.get(r.dataId).values,k=n.data.get(o.dataId).values,N=w.values,E=Be(r.shape),$=Be(o.shape);for(let I=0;I<c.batchSize;++I){const A=I*E[0],P=I*w.strides[0];for(let _=0;_<c.outDepth;++_){const U=P+_*w.strides[1],V=_*c.strideDepth-x;for(let D=0;D<u;++D){const W=V+D*f;if(W<0||W>=c.inDepth)continue;const R=D*$[0],j=A+W*E[1];for(let G=0;G<c.outHeight;++G){const O=U+G*w.strides[2],B=G*c.strideHeight-b;for(let z=0;z<d;++z){const K=B+z*m;if(K<0||K>=c.inHeight)continue;const J=R+z*$[1],re=j+K*E[2];for(let de=0;de<c.outWidth;++de){const pe=O+de*c.outChannels,we=de*c.strideWidth-v;for(let Ce=0;Ce<h;++Ce){const Ne=we+Ce*g;if(Ne<0||Ne>=c.inWidth)continue;const ze=J+Ce*$[2],_e=re+Ne*c.inChannels;let st=ze;for(let je=0;je<c.inChannels;++je){const rt=C[_e+je];for(let ue=0;ue<c.outChannels;++ue)N[pe+ue]+=rt*k[st+ue];st+=c.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const fwe={kernelName:L0,backendName:"cpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s;Fe([r,o],"conv3dBackpropFilterV2");const c=Be(r.shape),u=Be(o.shape),d=xl(r.shape,l,i,1,a),h=d.strideDepth,f=d.strideHeight,m=d.strideWidth,g=d.filterDepth,y=d.filterHeight,x=d.filterWidth,v=new ls(d.filterShape,"float32"),b=v.values,[w,C,k,N]=v.strides,E=n.data.get(o.dataId).values,[$,I,A,P]=u,_=n.data.get(r.dataId).values,[U,V,D,W]=c,R=d.padInfo.front,j=d.padInfo.left,G=d.padInfo.top;for(let O=0;O<g;++O){const B=Math.max(0,Math.ceil((R-O)/h)),z=Math.min(d.outDepth,(d.inDepth+R-O)/h),K=O*w;for(let J=0;J<y;++J){const re=Math.max(0,Math.ceil((G-J)/f)),de=Math.min(d.outHeight,(d.inHeight+G-J)/f),pe=J*C+K;for(let we=0;we<x;++we){const Ce=Math.max(0,Math.ceil((j-we)/m)),Ne=Math.min(d.outWidth,(d.inWidth+j-we)/m),ze=we*k+pe;for(let _e=0;_e<d.inChannels;++_e){const st=_e*N+ze;for(let je=0;je<d.outChannels;++je){let rt=0;for(let ue=0;ue<d.batchSize;++ue){const Ue=ue*U,sn=ue*$;for(let gt=B;gt<z;++gt){const pn=(O+gt*h-R)*V+Ue,Zn=gt*I+sn;for(let Vn=re;Vn<de;++Vn){const it=(J+Vn*f-G)*D+pn,Qn=Vn*A+Zn;for(let fr=Ce;fr<Ne;++fr){const sb=(we+fr*m-j)*W+it,rb=fr*P+Qn;rt+=_[sb+_e]*E[rb+je]}}}}b[st+je]=rt}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const mwe={kernelName:nN,backendName:"cpu",kernelFunc:pwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gwe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s;Fe([r],"conv3dBackpropInputV2");const c=Be(r.shape),u=Be(o.shape),d=xl(l,o.shape,a,1,i),h=new ls(d.inShape,"float32"),f=h.values,[m,g,y,x]=h.strides,v=n.data.get(r.dataId).values,[b,w,C,k]=c,N=n.data.get(o.dataId).values,[E,$,I,A]=u,{batchSize:P,filterDepth:_,filterHeight:U,filterWidth:V,inChannels:D,inDepth:W,inHeight:R,inWidth:j,outChannels:G,outDepth:O,outHeight:B,outWidth:z,strideDepth:K,strideHeight:J,strideWidth:re}=d,de=_-1-d.padInfo.front,pe=U-1-d.padInfo.top,we=V-1-d.padInfo.left;for(let Ce=0;Ce<P;++Ce)for(let Ne=0;Ne<D;++Ne)for(let ze=0;ze<W;++ze){const _e=ze-de,st=Math.max(0,Math.ceil(_e/K)),je=Math.min(O,(_+_e)/K);for(let rt=0;rt<R;++rt){const ue=rt-pe,Ue=Math.max(0,Math.ceil(ue/J)),sn=Math.min(B,(U+ue)/J);for(let gt=0;gt<j;++gt){const Jn=gt-we,pn=Math.max(0,Math.ceil(Jn/re)),Zn=Math.min(z,(V+Jn)/re);let Vn=0;for(let hr=st;hr<je;++hr){const it=hr*K-_e;for(let Qn=Ue;Qn<sn;++Qn){const fr=Qn*J-ue;for(let Wd=pn;Wd<Zn;++Wd){const sb=Wd*re-Jn,rb=b*Ce+w*hr+C*Qn+k*Wd,N5=E*(_-1-it)+$*(U-1-fr)+I*(V-1-sb)+A*Ne;for(let Nm=0;Nm<G;++Nm){const E5=v[rb+Nm],$5=N[N5+Nm];Vn+=E5*$5}}}}f[m*Ce+g*ze+y*rt+x*gt+Ne]=Vn}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const xwe={kernelName:sN,backendName:"cpu",kernelFunc:gwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ywe=Ft(yp,t=>Math.cos(t)),vwe={kernelName:yp,backendName:"cpu",kernelFunc:ywe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bwe=Ft(vp,t=>Math.cosh(t)),wwe={kernelName:vp,backendName:"cpu",kernelFunc:bwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,f]=r.shape,m=o.shape[0],[g,y]=a,x=ht([m,g,y,f],"float32"),v=n.data.get(o.dataId).values,b=n.data.get(i.dataId).values,w=n.data.get(r.dataId).values,C=Be(r.shape),k=Be(x.shape);for(let N=0;N<m;N++){const E=N*4,$=v[E],I=v[E+1],A=v[E+2],P=v[E+3],_=b[N];if(_>=u)continue;const U=g>1?(A-$)*(d-1)/(g-1):0,V=y>1?(P-I)*(h-1)/(y-1):0;for(let D=0;D<g;D++){const W=g>1?$*(d-1)+D*U:.5*($+A)*(d-1);if(W<0||W>d-1){for(let R=0;R<y;R++)for(let j=0;j<f;j++){const G=j+R*k[2]+D*k[1]+N*k[0];x.values[G]=c}continue}if(l==="bilinear"){const R=Math.floor(W),j=Math.ceil(W),G=W-R;for(let O=0;O<y;O++){const B=y>1?I*(h-1)+O*V:.5*(I+P)*(h-1);if(B<0||B>h-1){for(let re=0;re<f;re++){const de=re+O*k[2]+D*k[1]+N*k[0];x.values[de]=c}continue}const z=Math.floor(B),K=Math.ceil(B),J=B-z;for(let re=0;re<f;re++){let de=re+z*C[2]+R*C[1]+_*C[0];const pe=w[de];de=re+K*C[2]+R*C[1]+_*C[0];const we=w[de];de=re+z*C[2]+j*C[1]+_*C[0];const Ce=w[de];de=re+K*C[2]+j*C[1]+_*C[0];const Ne=w[de],ze=pe+(we-pe)*J,_e=Ce+(Ne-Ce)*J;de=re+O*k[2]+D*k[1]+N*k[0],x.values[de]=ze+(_e-ze)*G}}}else for(let R=0;R<y;++R){const j=y>1?I*(h-1)+R*V:.5*(I+P)*(h-1);if(j<0||j>h-1){for(let B=0;B<f;B++){const z=B+R*k[2]+D*k[1]+N*k[0];x.values[z]=c}continue}const G=Math.round(j),O=Math.round(W);for(let B=0;B<f;B++){const z=B+G*C[2]+O*C[1]+_*C[0],K=B+R*k[2]+D*k[1]+N*k[0];x.values[K]=w[z]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Swe={kernelName:oN,backendName:"cpu",kernelFunc:Cwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;Fe(r,"cumprod");const l=an([o],r.shape.length);let c=r;l!=null&&(c=lr({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=bn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Tr(c.dtype,"int32"),h=W2(ie(c.shape),d),f=n.data.get(c.dataId).values,m=c.shape[c.shape.length-1],g=a?(x,v)=>x+m-v-1:(x,v)=>x+v;for(let x=0;x<f.length;x+=m)for(let v=0;v<m;v++){const b=g(x,v);if(v===0)h[b]=i?1:f[b];else{const w=g(x,v-1);h[b]=i?f[w]*h[w]:f[b]*h[w]}}const y=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=yl(l),v=lr({inputs:{x:y},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}const Nwe={kernelName:rN,backendName:"cpu",kernelFunc:kwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ewe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;Fe(r,"cumsum");const l=an([o],r.shape.length);let c=r;l!=null&&(c=lr({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=bn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Tr(c.dtype,"int32"),h=Cs(ie(c.shape),d),f=n.data.get(c.dataId).values,m=c.shape[c.shape.length-1],g=a?(x,v)=>x+m-v-1:(x,v)=>x+v;for(let x=0;x<f.length;x+=m)for(let v=0;v<m;v++){const b=g(x,v);if(v===0)h[b]=i?0:f[b];else{const w=g(x,v-1);h[b]=i?f[w]+h[w]:f[b]+h[w]}}const y=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=yl(l),v=lr({inputs:{x:y},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}const $we={kernelName:j0,backendName:"cpu",kernelFunc:Ewe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=g$(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(o),u=$6(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Twe={kernelName:iN,backendName:"cpu",kernelFunc:Iwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s;T(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*o,h=c*o,f=u/(o*o),m=n.data.get(r.dataId).values,g=new Float32Array(a*d*h*f);let y=0;for(let x=0;x<a;++x)for(let v=0;v<d;++v){const b=Math.floor(v/o),w=v%o;for(let C=0;C<h;++C){const k=Math.floor(C/o),N=C%o,E=(w*o+N)*f;for(let $=0;$<f;++$){const A=$+E+u*(k+c*(b+l*x));g[y++]=m[A]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,g)}const Awe={kernelName:aN,backendName:"cpu",kernelFunc:Rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;Fe([r,o],"depthwiseConv2DNative");const u=Be(r.shape),d=Be(o.shape);let h=l;h==null&&(h=[1,1]),T(ks(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const f=us(r.shape,o.shape,i,h,a,c,!0),{filterHeight:m,filterWidth:g,dilationHeight:y,dilationWidth:x,padInfo:v}=f,b=v.left,w=v.top,C=f.outChannels/f.inChannels,k=new ls(f.outShape,r.dtype),N=n.data.get(r.dataId).values,E=n.data.get(o.dataId).values,$=k.values;for(let I=0;I<f.batchSize;++I){const A=I*u[0],P=I*k.strides[0];for(let _=0;_<f.outHeight;++_){const U=P+_*k.strides[1],V=_*f.strideHeight-w;for(let D=0;D<m;++D){const W=V+D*y;if(W<0||W>=f.inHeight)continue;const R=D*d[0],j=A+W*u[1];for(let G=0;G<f.outWidth;++G){const O=U+G*k.strides[2],B=G*f.strideWidth-b;for(let z=0;z<g;++z){const K=B+z*x;if(K<0||K>=f.inWidth)continue;const J=R+z*d[1],re=j+K*f.inChannels;let de=O,pe=J;for(let we=0;we<f.inChannels;++we){const Ce=N[re+we];for(let Ne=0;Ne<C;++Ne)$[de+Ne]+=Ce*E[pe+Ne];de+=C,pe+=C}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const Dwe={kernelName:B0,backendName:"cpu",kernelFunc:$W};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;Fe([r,o],"depthwiseConv2dNativeBackpropFilter");const d=us(r.shape,u,i,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:m,filterWidth:g}=d,y=new ls(d.filterShape,"float32"),x=d.padInfo.left,v=d.padInfo.top,b=d.outChannels/d.inChannels,w=n.data.get(r.dataId).values,C=new ls(r.shape,r.dtype,w),k=n.data.get(o.dataId).values,N=new ls(o.shape,o.dtype,k);for(let E=0;E<m;++E){const $=Math.max(0,Math.ceil((v-E)/h)),I=Math.min(d.outHeight,(d.inHeight+v-E)/h);for(let A=0;A<g;++A){const P=Math.max(0,Math.ceil((x-A)/f)),_=Math.min(d.outWidth,(d.inWidth+x-A)/f);for(let U=0;U<d.outChannels;++U){const V=Math.trunc(U/b),D=U%b;let W=0;for(let R=0;R<d.batchSize;++R)for(let j=$;j<I;++j){const G=E+j*h-v;for(let O=P;O<_;++O){const B=A+O*f-x;W+=C.get(R,G,B,V)*N.get(R,j,O,U)}}y.set(W,E,A,V,D)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Fwe={kernelName:lN,backendName:"cpu",kernelFunc:Owe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pwe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;Fe([r,o],"depthwiseConv2DNativeBackpropInput");const d=Be(r.shape),h=Be(o.shape),f=us(u,o.shape,i,a,l,c,!0),m=new ls(f.inShape,"float32"),g=m.values,[y,x,v]=m.strides,b=n.data.get(r.dataId).values,[w,C,k]=d,N=n.data.get(o.dataId).values,[E,$,I]=h,{batchSize:A,filterHeight:P,filterWidth:_,inChannels:U,inHeight:V,inWidth:D,outChannels:W,outHeight:R,outWidth:j,strideHeight:G,strideWidth:O}=f,B=P-1-f.padInfo.top,z=_-1-f.padInfo.left,K=W/U;for(let J=0;J<A;++J)for(let re=0;re<U;++re)for(let de=0;de<V;++de){const pe=de-B,we=Math.max(0,Math.ceil(pe/G)),Ce=Math.min(R,(P+pe)/G);for(let Ne=0;Ne<D;++Ne){const ze=Ne-z,_e=Math.max(0,Math.ceil(ze/O)),st=Math.min(j,(_+ze)/O);let je=0;for(let rt=we;rt<Ce;++rt){const ue=rt*G-pe;for(let Ue=_e;Ue<st;++Ue){const sn=Ue*O-ze,gt=w*J+C*rt+k*Ue,Jn=E*(P-1-ue)+$*(_-1-sn)+I*re;for(let pn=0;pn<K;++pn){const Zn=re*K+pn,Vn=b[gt+Zn],hr=N[Jn+pn];je+=Vn*hr}}}g[y*J+x*de+v*Ne+re]=je}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const _we={kernelName:cN,backendName:"cpu",kernelFunc:Pwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=ie(s.shape),o=n.data.get(s.dataId).values,i=ht([r,r],s.dtype),a=i.values;for(let c=0;c<o.length;c++)a[c*r+c]=o[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const Lwe={kernelName:Xj,backendName:"cpu",kernelFunc:Mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jwe={kernelName:z0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:o,pad:i,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:y,outHeight:x,outWidth:v,padInfo:b,strideHeight:w,strideWidth:C,filterHeight:k,filterWidth:N,dilationHeight:E,dilationWidth:$,outShape:I}=sm(s.shape,r.shape,o,i,"NHWC",a),A=ie(I),P=I.length,_=gn(s.dtype,A);for(let V=0;V<f;++V)for(let D=0;D<x;++D){const W=D*w-b.top;for(let R=0;R<v;++R){const j=R*C-b.left;for(let G=0;G<y;++G){let O=Number.MIN_SAFE_INTEGER;for(let z=0;z<k;++z){const K=W+z*E;if(K>=0&&K<m)for(let J=0;J<N;++J){const re=j+J*$;if(re>=0&&re<g){const de=vi([V,K,re,G],u,Be(s.shape)),pe=vi([z,J,G],h,Be(r.shape)),we=c[de]+d[pe];we>O&&(O=we)}}}const B=vi([V,D,R,G],P,Be(I));_[B]=O}}}return{dataId:l.write(Pc(_,s.dtype),I,s.dtype),shape:I,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bwe={kernelName:zC,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=zo(s.shape,c.data.get(s.dataId).values),d=zo(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:x,padInfo:v,strideHeight:b,strideWidth:w,filterHeight:C,filterWidth:k,dilationHeight:N,dilationWidth:E,outShape:$}=sm(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===$.length,()=>`Error in ${zC}, dy must have the same rank as output ${$.length}, but got ${o.rank}`);const I=zo($,c.data.get(o.dataId).values),A=Hj(r.shape,r.dtype);for(let _=0;_<h;++_)for(let U=0;U<y;++U){const V=U*b-v.top;for(let D=0;D<x;++D){const W=D*w-v.left;for(let R=0;R<g;++R){let j=Number.MIN_SAFE_INTEGER,G=0,O=0;for(let B=0;B<C;++B){const z=V+B*N;if(z>=0&&z<f)for(let K=0;K<k;++K){const J=W+K*E;if(J>=0&&J<m){const re=u[_][z][J][R]+d[B][K][R];re>j&&(j=re,G=B,O=K)}}}A[G][O][R]+=I[_][U][D][R]}}}return{dataId:c.write(Pc(A,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zwe={kernelName:BC,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=zo(s.shape,c.data.get(s.dataId).values),d=zo(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:x,padInfo:v,strideHeight:b,strideWidth:w,filterHeight:C,filterWidth:k,dilationHeight:N,dilationWidth:E,outShape:$}=sm(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===$.length,()=>`Error in ${BC}, dy must have the same rank as output ${$.length}, but got ${o.rank}`);const I=zo($,c.data.get(o.dataId).values),A=Hj(s.shape,s.dtype);for(let _=0;_<h;++_)for(let U=0;U<y;++U){const V=U*b-v.top;for(let D=0;D<x;++D){const W=D*w-v.left;for(let R=0;R<g;++R){let j=Number.MIN_SAFE_INTEGER,G=V<0?0:V,O=W<0?0:W;for(let B=0;B<C;++B){const z=V+B*N;if(z>=0&&z<f)for(let K=0;K<k;++K){const J=W+K*E;if(J>=0&&J<m){const re=u[_][z][J][R]+d[B][K][R];re>j&&(j=re,G=z,O=J)}}}A[_][G][O][R]+=I[_][U][D][R]}}}return{dataId:c.write(Pc(A,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uwe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:o,options:i}=s,{contextOptions:a,imageOptions:l}=i||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=o.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=r.shape.slice(0,2),m=r.shape.length===2?1:r.shape[2],g=n.data.get(r.dataId).values,y=r.dtype==="float32"?255:1,x=new Uint8ClampedArray(f*h*4);for(let b=0;b<h*f;++b){const w=[0,0,0,255*c];for(let k=0;k<m;k++){const N=g[b*m+k];if(r.dtype==="float32"){if(N<0||N>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${N}.`)}else if(r.dtype==="int32"&&(N<0||N>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${N}.`);m===1?(w[0]=N*y,w[1]=N*y,w[2]=N*y):w[k]=N*y}const C=b*4;x[C+0]=Math.round(w[0]),x[C+1]=Math.round(w[1]),x[C+2]=Math.round(w[2]),x[C+3]=Math.round(w[3])}o.width=f,o.height=h;const v=new ImageData(x,f,h);return d.putImageData(v,0,0),r}const Vwe={kernelName:Cue,backendName:"cpu",kernelFunc:Uwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vm(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"sum");let a;r.dtype==="bool"?a=al({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=Ii({inputs:{x:r},backend:n});const l=a.shape.length,c=ft(o,a.shape),u=an(c,l);let d=c,h=a;u!=null&&(h=lr({inputs:{x:a},backend:n,attrs:{perm:u}}),d=bn(d.length,l)),ds("sum",d,h.shape.length);const[f,m]=Yn(h.shape,d),g=Tr(h.dtype,"int32");let y=dy(n,f,g);const x=ie(m),v=n.data.get(y.dataId).values,b=n.data.get(h.dataId).values;for(let w=0;w<v.length;++w){const C=w*x;let k=0;for(let N=0;N<x;++N)k+=b[C+N];v[w]=k}if(i){const w=An(y.shape,c),C=y;y=Ht({inputs:{x:y},backend:n,attrs:{shape:w}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),y}const Wwe={kernelName:bv,backendName:"cpu",kernelFunc:vm};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hwe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=ME(r,o.length);jE(i.length,l,o);const{path:c,steps:u}=BE(a,l),d=u.length;let h=null,f=i.length;const m=[];for(let g=0;g<d;++g){for(const y of u[g]){const{permutationIndices:x,expandDims:v}=LE(f,l[y]);let b;zE(x)?b=o[y]:(b=lr({inputs:{x:o[y]},backend:n,attrs:{perm:x}}),m.push(b));const w=b.shape.slice();for(let C=0;C<v.length;++C)w.splice(v[C],0,1);Rt(b.shape,w)||(b=Ht({inputs:{x:b},backend:n,attrs:{shape:w}}),m.push(b)),h===null?h=b:(h=Jv({inputs:{a:b,b:h},backend:n}),m.push(h))}g<d-1&&(c[g]>=0&&(h=vm({inputs:{x:h},backend:n,attrs:{axis:c[g]-(i.length-f),keepDims:!1}}),m.push(h)),f--)}for(const g of m)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const Gwe={kernelName:uN,backendName:"cpu",kernelFunc:Hwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwe(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Fe([s,r],"eluGrad");const o=new Float32Array(ie(r.shape)),i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=0?o[l]=a[l]:o[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",o)}const Kwe={kernelName:dN,backendName:"cpu",kernelFunc:qwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xwe=RE,Ywe=AE,Jwe=DE,Zwe=OE,Qwe=FE,eCe=PE,tCe=Ft(Cp,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+Xwe*n);return e*(1-((((eCe*s+Qwe)*s+Zwe)*s+Jwe)*s+Ywe)*s*Math.exp(-n*n))}),nCe={kernelName:Cp,backendName:"cpu",kernelFunc:tCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function py(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:o}=s,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(T(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),Ht({inputs:{x:r},backend:n,attrs:{shape:a}})}const sCe={kernelName:V0,backendName:"cpu",kernelFunc:py};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rCe=Cn((t,e)=>t/e),C$=Un(bp,rCe),pS={kernelName:bp,backendName:"cpu",kernelFunc:C$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(t,e,n){const s=t.shape,r=s[0],o=s[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[r,o],u=ie(c),d=ws("float32",u),h=ws("float32",u);for(let y=0;y<r;y++){const x=Ec({inputs:{x:a},backend:n,attrs:{begin:[y,0],size:[1,o]}}),v=Ec({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,o]}}),b=xr({inputs:{real:x,imag:v},backend:n}),{real:w,imag:C}=oCe(b,e,n),k=sa(w,C);for(let N=0;N<o;N++){const E=_E(k,N);d[y*o+N]=E.real,h[y*o+N]=E.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",d),m=n.makeTensorInfo(c,"float32",h),g=xr({inputs:{real:f,imag:m},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}function oCe(t,e,n){const s=ie(t.shape),r=n.data.get(t.dataId),o=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(iCe(s)){const a=mS(o,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",gl(s,"float32")),h=Ii({inputs:{x:d},backend:n}),f=pS.kernelFunc({inputs:{a:c,b:d},backend:n}),m=pS.kernelFunc({inputs:{a:u,b:h},backend:n}),g=n.data.get(f.dataId).values,y=n.data.get(m.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),{real:g,imag:y}}return a}else{const a=sa(o,i),l=aCe(a,s,e);return Vz(l)}}function iCe(t){return(t&t-1)===0}function mS(t,e,n,s,r){if(n===1)return{real:t,imag:e};const o=sa(t,e),i=n/2,a=Wz(o),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),f=xr({inputs:{real:d,imag:h},backend:r}),m=Hz(o),g=m.real,y=m.imag,x=[g.length],v=r.makeTensorInfo(x,"float32",g),b=r.makeTensorInfo(x,"float32",y),w=xr({inputs:{real:v,imag:b},backend:r}),C=mS(l,c,i,s,r),k=C.real,N=C.imag,E=[k.length],$=r.makeTensorInfo(E,"float32",k),I=r.makeTensorInfo(E,"float32",N),A=xr({inputs:{real:$,imag:I},backend:r}),P=mS(g,y,i,s,r),_=P.real,U=P.imag,V=[_.length],D=r.makeTensorInfo(V,"float32",_),W=r.makeTensorInfo(V,"float32",U),R=xr({inputs:{real:D,imag:W},backend:r}),j=qz(n,s),G=[j.real.length],O=r.makeTensorInfo(G,"float32",j.real),B=r.makeTensorInfo(G,"float32",j.imag),z=xr({inputs:{real:O,imag:B},backend:r}),K=Jv({inputs:{a:z,b:R},backend:r}),J=id({inputs:{a:A,b:K},backend:r}),re=b$({inputs:{a:A,b:K},backend:r}),de=Nc({inputs:{input:J},backend:r}),pe=Nc({inputs:{input:re},backend:r}),we=ad({inputs:{input:J},backend:r}),Ce=ad({inputs:{input:re},backend:r}),Ne=ld({inputs:[de,pe],backend:r,attrs:{axis:0}}),ze=ld({inputs:[we,Ce],backend:r,attrs:{axis:0}}),_e=r.data.get(Ne.dataId).values,st=r.data.get(ze.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(K),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(re),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(we),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(Ce),r.disposeIntermediateTensorInfo(Ne),r.disposeIntermediateTensorInfo(ze),{real:_e,imag:st}}function aCe(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let o=0,i=0;for(let a=0;a<e;a++){const l=Kz(r*a,e,n),c=_E(t,a);o+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(o/=e,i/=e),Gz(s,o,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lCe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ie(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=Ht({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=IW(a,!1,n),c=Ht({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const cCe={kernelName:hN,backendName:"cpu",kernelFunc:lCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S$(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:o}=n,i=o||$d(r),a=gn(i,ie(s));return dCe(a,r,i),e.makeTensorInfo(s,i,a)}const uCe={kernelName:fN,backendName:"cpu",kernelFunc:S$};function dCe(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hCe={kernelName:pN,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,o=ws(s.dtype,ie(s.shape)),[i,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<i;h++){const f=h*l*a*c;for(let m=0;m<a;m++){const g=m*(l*c);for(let y=0;y<l;y++){const x=y*c;for(let v=0;v<c;v++){const b=Math.round(l-y-1),w=f+g+x+v;let C=u[w];if(b>=0&&b<l){const k=b*c,N=f+g+k+v;C=u[N]}o[w]=C}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=s;let g=EW({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const y=g;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const x=Ht({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});g=id({inputs:{a:g,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else g=id({inputs:{a:g,b:i},backend:n});n.disposeIntermediateTensorInfo(y)}if(f){const y=g;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=Ht({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=fy(n,g,f,x,m),n.disposeIntermediateTensorInfo(x)}else g=fy(n,g,f,a,m);n.disposeIntermediateTensorInfo(y)}return g}const pCe={kernelName:qx,backendName:"cpu",kernelFunc:fCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=s;let g=$W({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const y=g;g=id({inputs:{a:g,b:i},backend:n}),n.disposeIntermediateTensorInfo(y)}if(f){const y=g;g=fy(n,g,f,a,m),n.disposeIntermediateTensorInfo(y)}return g}const gCe={kernelName:pB,backendName:"cpu",kernelFunc:mCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xCe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=ie(s.shape),i=r.shape,a=i[i.length-1],[l,c,u,d]=vE(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),m=L6(h,f,s.dtype,c,a,u,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,m.values)}const yCe={kernelName:Yj,backendName:"cpu",kernelFunc:xCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s;Fe([r,o],"gatherV2");const l=ft(i,r.shape)[0],c=n.data.get(o.dataId).values,u=r.shape[l];for(let w=0;w<c.length;++w){const C=c[w];T(C<=u-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=ie(o.shape),f=VE(r,o,l,d),m=Ht({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=Ht({inputs:{x:o},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),y=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],x=n.bufferSync(g),v=n.bufferSync(m),b=j6(v,x,y);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const bCe={kernelName:H0,backendName:"cpu",kernelFunc:vCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wCe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ie(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=Ht({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=IW(a,!0,n),c=Ht({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const CCe={kernelName:mN,backendName:"cpu",kernelFunc:wCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SCe=Ft(Tp,t=>Number.isFinite(t)?1:0,"bool"),kCe={kernelName:Tp,backendName:"cpu",kernelFunc:SCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NCe=Ft(Rp,t=>Math.abs(t)===1/0?1:0,"bool"),ECe={kernelName:Rp,backendName:"cpu",kernelFunc:NCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ce=Ft(Ap,t=>Number.isNaN(t)?1:0,"bool"),ICe={kernelName:Ap,backendName:"cpu",kernelFunc:$Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TCe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=W6(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const RCe={kernelName:Jj,backendName:"cpu",kernelFunc:TCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ACe=Ft(Op,t=>Math.log1p(t)),DCe={kernelName:Op,backendName:"cpu",kernelFunc:ACe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OCe=Cn((t,e)=>t&&e),FCe=Un(Y0,OCe,null,"bool"),PCe={kernelName:Y0,backendName:"cpu",kernelFunc:FCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ce=Ft(J0,t=>t?0:1,"bool"),MCe={kernelName:J0,backendName:"cpu",kernelFunc:_Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LCe=Cn((t,e)=>t||e),jCe=Un(Z0,LCe,null,"bool"),BCe={kernelName:Z0,backendName:"cpu",kernelFunc:jCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s;Fe(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=ie(r.shape),f=new Float32Array(h);function m(g){const y=g%c;let x=g-y+Math.max(0,y-o);const v=g-y+Math.min(y+o,u);let b=0;for(;x<=v;x++){const w=d[x];b+=w*w}return b}for(let g=0;g<h;g++){const y=m(g),x=d[g]*Math.pow(i+a*y,-l);f[g]=x}return n.makeTensorInfo(r.shape,r.dtype,f)}const UCe={kernelName:Q0,backendName:"cpu",kernelFunc:zCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;Fe(i,"LRNGrad");const d=ie(i.shape),h=i.shape[3],f=n.data.get(i.dataId).values,m=n.data.get(r.dataId).values,g=n.data.get(o.dataId).values,y=new Float32Array(d),x=d;for(let v=0;v<x;v++){const b=v%h,w=v-b+Math.max(0,b-a),C=v-b+Math.min(h,b+a+1);let k=0;for(let N=w;N<C;N++)k+=Math.pow(m[N],2);k=c*k+l;for(let N=w;N<C;N++){let E=-2*c*u*m[N]*g[v]/k;v===N&&(E+=Math.pow(k,-u)),E*=f[v],y[N]+=E}}return n.makeTensorInfo(i.shape,r.dtype,y)}const WCe={kernelName:xN,backendName:"cpu",kernelFunc:VCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TW(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=n;let l=r.shape;const c=l.length,u=ft(o,l);let d=u;const h=an(d,c);let f=a.data.get(r.dataId).values;if(h!=null){const w=new Array(c);for(let C=0;C<w.length;C++)w[C]=l[h[C]];f=y$(f,l,r.dtype,h,w),d=bn(d.length,c),l=w}Fe(r,"max"),ds("max",d,c);const[m,g]=Yn(l,d),y=ie(g),x=G6(f,y,m,r.dtype),v=a.write(x,m,r.dtype);let b=m;return i&&(b=An(m,u)),{dataId:v,shape:b,dtype:r.dtype}}const HCe={kernelName:ev,backendName:"cpu",kernelFunc:TW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Fe(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(ks(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=No(r.shape,o,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Rt(u.inShape,u.outShape))d=Ii({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Be(r.shape),m=w$(h,r.shape,r.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,m.values)}return d}const qCe={kernelName:tv,backendName:"cpu",kernelFunc:GCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;Fe(r,"maxPool3d");const u=ua(r.shape,o,i,1,a,l,c),d=n.data.get(r.dataId).values,h=NW(d,r.shape,r.dtype,Be(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const XCe={kernelName:nv,backendName:"cpu",kernelFunc:KCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;Fe([r,o],"maxPool3DGrad");const u=ua(o.shape,i,a,1,l,c),d=n.bufferSync(o),h=L1e(d,u),f=u.strideDepth,m=u.strideHeight,g=u.strideWidth,y=u.dilationDepth,x=u.dilationHeight,v=u.dilationWidth,b=u.effectiveFilterDepth,w=u.effectiveFilterHeight,C=u.effectiveFilterWidth,k=b-1-u.padInfo.front,N=C-1-u.padInfo.left,E=w-1-u.padInfo.top,$=ht(o.shape,"float32"),I=n.bufferSync(r);for(let A=0;A<u.batchSize;++A)for(let P=0;P<u.inChannels;++P)for(let _=0;_<u.inDepth;++_)for(let U=0;U<u.inHeight;++U)for(let V=0;V<u.inWidth;++V){const D=_-k,W=U-E,R=V-N;let j=0;for(let G=0;G<b;G+=y){const O=(D+G)/f;if(!(O<0||O>=u.outDepth||Math.floor(O)!==O))for(let B=0;B<w;B+=x){const z=(W+B)/m;if(!(z<0||z>=u.outHeight||Math.floor(z)!==z))for(let K=0;K<C;K+=v){const J=(R+K)/g;if(J<0||J>=u.outWidth||Math.floor(J)!==J)continue;const re=b*w*C-1-h.get(A,O,z,J,P),de=G*w*C+B*C+K,pe=re===de?1:0;if(pe===0)continue;const we=I.get(A,O,z,J,P);j+=we*pe}}}$.set(j,A,_,U,V,P)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const JCe={kernelName:vN,backendName:"cpu",kernelFunc:YCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZCe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;Fe([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=No(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,m=ht(h.outShape,a.dtype,kW(f,a.shape,a.dtype,h).values),g=h.strideHeight,y=h.strideWidth,x=h.dilationHeight,v=h.dilationWidth,b=h.effectiveFilterHeight,w=h.effectiveFilterWidth,C=w-1-h.padInfo.left,k=b-1-h.padInfo.top,N=ht(a.shape,"float32"),E=n.data.get(r.dataId).values,$=ht(r.shape,"float32",E);for(let I=0;I<h.batchSize;++I)for(let A=0;A<h.inChannels;++A)for(let P=0;P<h.inHeight;++P)for(let _=0;_<h.inWidth;++_){const U=P-k,V=_-C;let D=0;for(let W=0;W<b;W+=x){const R=(U+W)/g;if(!(R<0||R>=h.outHeight||Math.floor(R)!==R))for(let j=0;j<w;j+=v){const G=(V+j)/y;if(G<0||G>=h.outWidth||Math.floor(G)!==G)continue;const O=b*w-1-m.get(I,R,G,A),B=W*w+j,z=O===B?1:0;if(z===0)continue;const K=$.get(I,R,G,A);D+=K*z}}N.set(D,I,P,_,A)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const QCe={kernelName:yN,backendName:"cpu",kernelFunc:ZCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eSe(t,e,n,s,r){const o=Be(e),i=w$(t,e,n,o,r,"max"),a=kW(t,e,n,r,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tSe={kernelName:Zj,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;Fe(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=No(s.shape,r,o,[1,1],i),[d,h]=eSe(c,s.shape,s.dtype,a,u),f=l.write(d,u.outShape,s.dtype),m=l.write(h,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:m,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=ft(o,r.shape),c=Yn(r.shape,a)[1],u=ie(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=al({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const m=C$({inputs:{a:f,b:h},backend:n});d.push(m);const g=vm({inputs:{x:m},backend:n,attrs:{axis:o,keepDims:i}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const sSe={kernelName:sv,backendName:"cpu",kernelFunc:nSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"min");const a=ft(o,r.shape);let l=a;const c=an(l,r.shape.length);let u=r;c!=null&&(u=lr({inputs:{x:r},backend:n,attrs:{perm:c}}),l=bn(l.length,r.shape.length)),ds("min",l,u.shape.length);const[d,h]=Yn(u.shape,l),f=ie(h),m=Cs(ie(d),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<m.length;++x){const v=x*f;let b=g[v];for(let w=0;w<f;++w){const C=g[v+w];(Number.isNaN(C)||C<b)&&(b=C)}m[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,m);if(i){const x=An(d,a),v=Ht({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}const oSe={kernelName:rv,backendName:"cpu",kernelFunc:rSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,mode:i}=s;Fe(r,"mirrorPad");const a=o.map((b,w)=>b[0]+r.shape[w]+b[1]),l=o.map(b=>b[0]),c=o.map((b,w)=>b[0]+r.shape[w]),u=i==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=Be(r.shape),m=ie(a),g=a.length,y=Be(a),x=ws(r.dtype,m);for(let b=0;b<m;b++){let w=Id(b,g,y);for(let k=0;k<g;k++)w[k]<l[k]?w[k]=l[k]*2-w[k]-u:w[k]>=c[k]&&(w[k]=(c[k]-1)*2-w[k]+u);w=w.map((k,N)=>k-l[N]);const C=vi(w,h,f);x[b]=d[C]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const aSe={kernelName:ov,backendName:"cpu",kernelFunc:iSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lSe=Cn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),cSe=Un(_p,lSe),uSe={kernelName:_p,backendName:"cpu",kernelFunc:cSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=r.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=ft([a],r.shape),c=TW({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=An(c.shape,l),d=Ht({inputs:{x:c},backend:n,attrs:{shape:u}}),h=b$({inputs:{a:r,b:d},backend:n}),f=F6({inputs:{x:h},backend:n}),m=vm({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=Ht({inputs:{x:m},backend:n,attrs:{shape:u}}),y=C$({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}const dSe={kernelName:Sv,backendName:"cpu",kernelFunc:RW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hSe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s;Fe(r,"multinomial");const l=a?r:RW({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,o],f=Cs(ie(h),"int32");for(let m=0;m<c;++m){const g=m*u,y=new Float32Array(u-1);y[0]=d[g];for(let b=1;b<y.length;++b)y[b]=y[b-1]+d[g+b];const x=oE.alea(i.toString()),v=m*o;for(let b=0;b<o;++b){const w=x();f[v+b]=y.length;for(let C=0;C<y.length;C++)if(w<y[C]){f[v+b]=C;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const fSe={kernelName:Qj,backendName:"cpu",kernelFunc:hSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pSe=pE;function mSe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;Fe(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,{selectedIndices:d}=pSe(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const gSe={kernelName:bN,backendName:"cpu",kernelFunc:mSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xSe=mE;function ySe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;Fe(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,{selectedIndices:h,validOutputs:f}=xSe(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const vSe={kernelName:wN,backendName:"cpu",kernelFunc:ySe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bSe=gE;function wSe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;Fe(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,h=i,f=a,m=l,g=c,{selectedIndices:y,selectedScores:x}=bSe(u,d,h,f,m,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const CSe={kernelName:CN,backendName:"cpu",kernelFunc:wSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SSe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s;Fe(r,"oneHot");const c=ie(r.shape),u=new Float32Array(c*i);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<i&&(u[h*i+d[h]]=a);return n.makeTensorInfo([...r.shape,i],o,u)}const kSe={kernelName:cv,backendName:"cpu",kernelFunc:SSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function my(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Nc({inputs:{input:s},backend:n}),o=my({inputs:{x:r},backend:n}),i=ad({inputs:{input:s},backend:n}),a=my({inputs:{x:i},backend:n}),l=xr({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return S$({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const NSe={kernelName:Ev,backendName:"cpu",kernelFunc:my};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Nc({inputs:{input:s},backend:n}),o=AW({inputs:{x:r},backend:n}),i=ad({inputs:{input:s},backend:n}),a=my({inputs:{x:i},backend:n}),l=xr({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return S$({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const ESe={kernelName:lv,backendName:"cpu",kernelFunc:AW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return py({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(u=>{V2(o,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=py({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=ld({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const $Se={kernelName:uv,backendName:"cpu",kernelFunc:DW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;Fe(r,"pad");const a=o.map((v,b)=>v[0]+r.shape[b]+v[1]),l=o.map(v=>v[0]),c=n.data.get(r.dataId).values,u=ie(r.shape),d=r.shape.length,h=Be(r.shape),f=ie(a),m=a.length,g=Be(a),y=ws(r.dtype,f);i!==0&&y.fill(i);for(let v=0;v<u;v++){const w=Id(v,d,h).map((k,N)=>k+l[N]),C=vi(w,m,g);y[C]=c[v]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const OW={kernelName:dv,backendName:"cpu",kernelFunc:ISe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TSe=Cn((t,e)=>Math.pow(t,e)),RSe=Un(Lp,TSe),ASe={kernelName:Lp,backendName:"cpu",kernelFunc:RSe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DSe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(x=>n.data.get(x.dataId).values),c=r.map(x=>x.shape),u=n.data.get(o.dataId).values,d=n.data.get(i.dataId).values,[h,f,m]=Z6(l,c,u,o.shape,o.dtype,d,i.shape),g=h.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(m,o.dtype,f);return g.concat([y])}const OSe={kernelName:eB,backendName:"cpu",kernelFunc:DSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FSe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=Q6(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const PSe={kernelName:tB,backendName:"cpu",kernelFunc:FSe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Se(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,d=n.data.get(i.dataId).values,h=a.map(y=>n.data.get(y.dataId).values),f=a.map(y=>y.shape),[m,g]=eW(c,r.shape,u,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(m,o.dtype,g)}const MSe={kernelName:nB,backendName:"cpu",kernelFunc:_Se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LSe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:o,step:i}=n,a=tW(s,r,i,o);return e.makeTensorInfo([a.length],o,a)}const jSe={kernelName:SN,backendName:"cpu",kernelFunc:LSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BSe=Ft(jp,t=>1/t),zSe={kernelName:jp,backendName:"cpu",kernelFunc:BSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function USe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;Fe(r,"resizeBilinear");const l=Be(r.shape),[c,u]=a,[d,h,f,m]=r.shape,g=n.data.get(r.dataId).values,y=new Float32Array(ie([d,c,u,m])),x=[o&&c>1?h-1:h,o&&u>1?f-1:f],v=[o&&c>1?c-1:c,o&&u>1?u-1:u];let b=0;const w=x[0]/v[0],C=x[1]/v[1];for(let k=0;k<d;k++)for(let N=0;N<c;N++){let E;i?E=w*(N+.5)-.5:E=w*N;const $=Math.max(0,Math.floor(E)),I=E-$,A=Math.min(h-1,Math.ceil(E)),P=k*l[0]+$*l[1],_=k*l[0]+A*l[1];for(let U=0;U<u;U++){let V;i?V=C*(U+.5)-.5:V=C*U;const D=Math.max(0,Math.floor(V)),W=V-D,R=Math.min(f-1,Math.ceil(V)),j=P+D*l[2],G=_+D*l[2],O=P+R*l[2],B=_+R*l[2];for(let z=0;z<m;z++){const K=g[j+z],J=g[G+z],re=g[O+z],de=g[B+z],pe=K+(re-K)*W,we=J+(de-J)*W,Ce=pe+(we-pe)*I;y[b++]=Ce}}}return n.makeTensorInfo([d,c,u,m],"float32",y)}const VSe={kernelName:gv,backendName:"cpu",kernelFunc:USe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WSe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;Fe([o,r],"resizeBilinearGrad");const a=Be(r.shape),[l,c,u,d]=r.shape,[,h,f]=o.shape,m=new Float32Array(l*c*u*d),g=[i&&h>1?c-1:c,i&&f>1?u-1:u],y=[i&&h>1?h-1:h,i&&f>1?f-1:f],x=g[0]/y[0],v=g[1]/y[1],b=n.data.get(o.dataId).values;let w=0;for(let C=0;C<l;C++){const k=C*a[0];for(let N=0;N<h;N++){const E=N*x,$=Math.floor(E),I=Math.min(Math.ceil(E),c-1),A=k+$*a[1],P=k+I*a[1],_=E-$,U=1-_;for(let V=0;V<f;V++){const D=V*v,W=Math.floor(D),R=Math.min(Math.ceil(D),u-1),j=D-W,G=1-j,O=A+W*a[2],B=A+R*a[2],z=P+W*a[2],K=P+R*a[2],J=U*G,re=U*j,de=_*G,pe=_*j;for(let we=0;we<d;we++){const Ce=b[w++];m[O+we]+=Ce*J,m[B+we]+=Ce*re,m[z+we]+=Ce*de,m[K+we]+=Ce*pe}}}}return n.makeTensorInfo([l,u,c,d],"float32",m)}const HSe={kernelName:EN,backendName:"cpu",kernelFunc:WSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GSe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;Fe(r,"resizeNearestNeighbor");const l=Be(r.shape),[c,u]=a,[d,h,f,m]=r.shape,g=n.data.get(r.dataId).values,y=new Float32Array(d*c*u*m),x=[o&&c>1?h-1:h,o&&u>1?f-1:f],v=[o&&c>1?c-1:c,o&&u>1?u-1:u],b=x[0]/v[0],w=x[1]/v[1];let C=0;for(let k=0;k<d;k++){const N=k*l[0];for(let E=0;E<c;E++){const $=i?b*(E+.5):b*E;let I=Math.min(h-1,o?Math.round($):Math.floor($));i&&(I=Math.max(0,I));const A=N+I*l[1];for(let P=0;P<u;P++){const _=i?w*(P+.5):w*P;let U=Math.min(f-1,o?Math.round(_):Math.floor(_));i&&(U=Math.max(0,U));const V=A+U*l[2];for(let D=0;D<m;D++){const W=g[V+D];y[C++]=W}}}}return n.makeTensorInfo([d,c,u,m],r.dtype,y)}const qSe={kernelName:mv,backendName:"cpu",kernelFunc:GSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KSe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;Fe([o,r],"resizeNearestNeighborGrad");const a=Be(r.shape),l=Be(o.shape),[c,u,d,h]=r.shape,[,f,m]=o.shape,g=new Float32Array(c*u*d*h),y=n.data.get(o.dataId).values,x=[i&&f>1?u-1:u,i&&m>1?d-1:d],v=[i&&f>1?f-1:f,i&&m>1?m-1:m],b=x[0]/v[0],w=x[1]/v[1],C=1/b,k=1/w,N=Math.ceil(C)*2+2,E=Math.ceil(k)*2+2;for(let $=0;$<c;$++){const I=$*a[0];for(let A=0;A<u;A++){const P=I+A*a[1],_=Math.floor(A*C),U=Math.floor(_-N/2);for(let V=0;V<d;V++){const D=P+V*a[2],W=Math.floor(V*k),R=Math.floor(W-E/2);for(let j=0;j<h;j++){let G=0;for(let O=0;O<N;O++){const B=O+U;if(B<0||B>=f)continue;const z=I+B*l[1],K=B*b,J=Math.min(u-1,i?Math.round(K):Math.floor(K));if(A===J)for(let re=0;re<E;re++){const de=re+R;if(de<0||de>=m)continue;const pe=z+de*l[2],we=de*w,Ce=Math.min(d-1,i?Math.round(we):Math.floor(we));V===Ce&&(G+=y[pe+j])}}g[D+j]=G}}}}return n.makeTensorInfo(r.shape,r.dtype,g)}const XSe={kernelName:NN,backendName:"cpu",kernelFunc:KSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s;Fe(r,"reverse");const i=r.shape.length,a=ft(o,r.shape);if(i===0)return Ii({inputs:{x:r},backend:n});const l=new ls(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const JSe={kernelName:xv,backendName:"cpu",kernelFunc:YSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZSe={kernelName:ON,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=ws(s.dtype,ie(s.shape)),[c,u,d,h]=s.shape,[f,m]=$E(i,u,d),g=255,y=Math.sin(r),x=Math.cos(r),v=a.data.get(s.dataId).values;for(let w=0;w<c;w++){const C=w*d*u*h;for(let k=0;k<u;k++){const N=k*(d*h);for(let E=0;E<d;E++){const $=E*h;for(let I=0;I<h;I++){const A=[c,k,E,I],P=A[2],_=A[1];let U=(P-f)*x-(_-m)*y,V=(P-f)*y+(_-m)*x;U=Math.round(U+f),V=Math.round(V+m);let D=o;if(typeof o!="number"&&(I===3?D=g:D=o[I]),U>=0&&U<d&&V>=0&&V<u){const R=V*(d*h),j=U*h,G=C+R+j+I;D=v[G]}const W=C+N+$+I;l[W]=D}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QSe=Ft(Up,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),eke={kernelName:Up,backendName:"cpu",kernelFunc:QSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tke(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=jc(o,r,i),h=!0,f=n.bufferSync(r),m=n.bufferSync(o),g=Gl(f,m,i,d,c,l,a,u,0,h);return n.makeTensorInfo(i,g.dtype,g.values)}const nke={kernelName:sB,backendName:"cpu",kernelFunc:tke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ske(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function rke(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function oke(t,e,n,s,r,o){const i=gn("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)i[c+u]=o==="left"?ske(l,e[u+c]):rke(l,e[u+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ike(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=oke(a,l,r.shape[0],r.shape[1],o.shape[1],i);return n.makeTensorInfo(o.shape,"int32",c)}const ake={kernelName:oB,backendName:"cpu",kernelFunc:ike};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lke(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e;Fe([s,r,o],"select");const i=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=Tr(r.dtype,o.dtype),d=Cs(ie(r.shape),u);let h=0;const f=i===0||i>1||r.shape.length===1?1:ie(r.shape.slice(1));for(let m=0;m<a.length;m++)for(let g=0;g<f;g++)a[m]===1?d[h++]=l[m]:d[h++]=c[m];return n.makeTensorInfo(r.shape,u,d)}const cke={kernelName:yv,backendName:"cpu",kernelFunc:lke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uke=Lv,dke=jv,hke=Ft(Wp,t=>t>=0?dke*t:uke*(Math.exp(t)-1)),fke={kernelName:Wp,backendName:"cpu",kernelFunc:hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pke=Ft(qp,t=>t<0?-1:t>0?1:0),mke={kernelName:qp,backendName:"cpu",kernelFunc:pke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gke=Ft(Hp,t=>Math.sin(t)),xke={kernelName:Hp,backendName:"cpu",kernelFunc:gke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yke=Ft(Gp,t=>Math.sinh(t)),vke={kernelName:Gp,backendName:"cpu",kernelFunc:yke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bke=11920928955078125e-23,HO=Math.log(bke)+2,wke=Ft(Xp,t=>{const e=t>-HO,n=t<HO,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),Cke={kernelName:Xp,backendName:"cpu",kernelFunc:wke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ske(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;Fe([r],"spaceToBatchND");const a=ie(o),l=[[0,0]];l.push(...i);for(let k=1+o.length;k<r.shape.length;++k)l.push([0,0]);const c=OW.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=lm(c.shape,o,a,!1),d=cm(u.length,o.length,!1),h=um(c.shape,o,a,!1),g=Ht({inputs:{x:c},backend:n,attrs:{shape:u}}),v=lr({inputs:{x:g},backend:n,attrs:{perm:d}}),C=Ht({inputs:{x:v},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),C}const kke={kernelName:wv,backendName:"cpu",kernelFunc:Ske};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values[0],[d,h,f,m,g]=oW(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const Eke={kernelName:iB,backendName:"cpu",kernelFunc:Nke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(o.dataId).values),[c,u,d]=iW(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const Ike={kernelName:aB,backendName:"cpu",kernelFunc:$ke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tke(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=v$(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const Rke={kernelName:lB,backendName:"cpu",kernelFunc:Tke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=v$(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const Dke={kernelName:cB,backendName:"cpu",kernelFunc:Ake};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oke(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=jc(o,r,a),f=!1,m=n.bufferSync(r);let g;switch(o.dtype){case"bool":{const y=n.bufferSync(o),x=!!n.data.get(i.dataId).values[0];g=Gl(m,y,a,h,u,c,l,d,x,f);break}case"float32":{const y=n.bufferSync(o),x=n.data.get(i.dataId).values[0];g=Gl(m,y,a,h,u,c,l,d,x,f);break}case"int32":{const y=n.bufferSync(o),x=n.data.get(i.dataId).values[0];g=Gl(m,y,a,h,u,c,l,d,x,f);break}case"string":{const y=n.bufferSync(o),x=nl(n.data.get(i.dataId).values[0]);g=Gl(m,y,a,h,u,c,l,d,x,f);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const Fke={kernelName:uB,backendName:"cpu",kernelFunc:Oke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=ft(i,r.shape)[0],l=UE(r,o,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=Ec({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const _ke={kernelName:Cv,backendName:"cpu",kernelFunc:Pke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mke={kernelName:$N,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Fe(n,"square");const r=s.data.get(n.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];o[a]=l*l}return{dataId:s.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lke=Ft(nm,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),jke={kernelName:nm,backendName:"cpu",kernelFunc:Lke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;Fe(r,"stridedSlice");const{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:x,begin:v,end:b,strides:w}=kE(r.shape,o,i,a,l,c,u,d,h);let C;if(g)C=Ht({inputs:{x:r},backend:n,attrs:{shape:m}});else if(y||x){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const k=wE(v,b,w),N=Ec({inputs:{x:r},backend:n,attrs:{begin:v,size:k}});C=Ht({inputs:{x:N},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(N)}else{const k=n.bufferSync(r),N=cW(f,k,w,v);C=n.makeTensorInfo(m,N.dtype,N.values)}return C}const zke={kernelName:TN,backendName:"cpu",kernelFunc:Bke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uke(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[m,g]=uW(h,f,r,o,i,a,l,c);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",g)]}const Vke={kernelName:dB,backendName:"cpu",kernelFunc:Uke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wke(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,d]=dW(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Hke={kernelName:hB,backendName:"cpu",kernelFunc:Wke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gke(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(o.dataId).values,a=hW(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const qke={kernelName:fB,backendName:"cpu",kernelFunc:Gke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kke=Ft(Qp,t=>Math.tan(t)),Xke={kernelName:Qp,backendName:"cpu",kernelFunc:Kke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yke=Ft(em,t=>Math.tanh(t)),Jke={kernelName:em,backendName:"cpu",kernelFunc:Yke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zke(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:o}=e,{sliceRank:i,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=jc(o,r,s.shape),d=!1,h=n.bufferSync(r),f=n.bufferSync(o),m=n.bufferSync(s),g=Gl(h,f,s.shape,u,l,a,i,c,m,d);return n.makeTensorInfo(s.shape,g.dtype,g.values)}const Qke={kernelName:rB,backendName:"cpu",kernelFunc:Zke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;Fe(r,"tile");const i=pW(n.bufferSync(r),o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const t2e={kernelName:tm,backendName:"cpu",kernelFunc:e2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s;Fe(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=gW(a,r.shape,r.dtype,o,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const s2e={kernelName:RN,backendName:"cpu",kernelFunc:n2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2e(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=r.shape,[m,g]=c??[d,h],y=[u,m,g,f],x=Be(r.shape),v=x[0],b=x[1],w=x[2],C=Be(y),k=C[0],N=C[1],E=C[2],$=ws(r.dtype,ie(y));$.fill(l);const I=s.data.get(r.dataId).values,A=s.data.get(o.dataId).values;for(let _=0;_<u;++_){const U=o.shape[0]===1?A:A.subarray(_*8,_*8+8);for(let V=0;V<m;++V)for(let D=0;D<g;++D)for(let W=0;W<f;++W){let R;const j=U[6]*D+U[7]*V+1;if(j===0)continue;const G=(U[0]*D+U[1]*V+U[2])/j,O=(U[3]*D+U[4]*V+U[5])/j,B=GO(G,h,a),z=GO(O,d,a);switch(i){case"nearest":R=u2e(I,d,h,v,b,w,_,z,B,W,l);break;case"bilinear":R=d2e(I,d,h,v,b,w,_,z,B,W,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const K=_*k+V*N+D*E+W;$[K]=R}return s.makeTensorInfo(y,r.dtype,$)}return{dataId:s.write($,y,r.dtype),shape:r.shape,dtype:r.dtype}}const o2e={kernelName:AN,backendName:"cpu",kernelFunc:r2e};function GO(t,e,n){switch(n){case"reflect":return i2e(t,e);case"wrap":return a2e(t,e);case"nearest":return c2e(t,e);case"constant":default:return l2e(t)}}function i2e(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return pc(0,n,e-1)}function a2e(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return pc(0,n,e-1)}function l2e(t,e){return t}function c2e(t,e){return pc(0,t,e-1)}function Sh(t,e,n,s,r,o,i,a,l,c,u){const d=i*s+a*r+l*o+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function u2e(t,e,n,s,r,o,i,a,l,c,u){const d=Math.round(a),h=Math.round(l);return Sh(t,e,n,s,r,o,i,d,h,c,u)}function d2e(t,e,n,s,r,o,i,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,m=h+1,g=(m-l)*Sh(t,e,n,s,r,o,i,d,h,c,u)+(l-h)*Sh(t,e,n,s,r,o,i,d,m,c,u),y=(m-l)*Sh(t,e,n,s,r,o,i,f,h,c,u)+(l-h)*Sh(t,e,n,s,r,o,i,f,m,c,u);return(f-a)*g+(a-d)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2e(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;Fe(o,"unique");const i=s.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:c}=xW(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const f2e={kernelName:DN,backendName:"cpu",kernelFunc:h2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2e(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r.shape.length,a=r.shape[o],l=new Array(i-1);let c=0;for(let f=0;f<i;f++)f!==o&&(l[c++]=r.shape[f]);const u=new Array(i).fill(0),d=r.shape.slice();d[o]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[o]=f;const m=Ec({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[f]=Ht({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return h}const m2e={kernelName:kv,backendName:"cpu",kernelFunc:p2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s;Fe(r,"unsortedSegmentSum");const a=r.shape.length,l=o.shape.length,c=[],u=[],d=a-l;let h=o;for(let m=0;m<d;++m){const g=py({inputs:{input:h},backend:n,attrs:{dim:m+1}});h=g,u.push(g)}for(let m=0;m<i;++m){const g=gl(m,"int32"),y=n.makeTensorInfo([],"int32",g),x=D6({inputs:{a:y,b:h},backend:n}),v=al({inputs:{x},backend:n,attrs:{dtype:"float32"}}),b=Jv({inputs:{a:v,b:r},backend:n}),w=vm({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(w),u.push(y),u.push(x),u.push(v),u.push(b),u.push(w)}const f=DW({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const x2e={kernelName:Nv,backendName:"cpu",kernelFunc:g2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y2e=[h1e,Gve,p1e,g1e,Zve,y1e,b1e,C1e,k1e,E1e,I1e,R1e,D1e,P1e,M1e,B1e,U1e,W1e,G1e,u1e,K1e,Y1e,Z1e,ebe,ewe,Yve,nbe,nwe,qve,rwe,iwe,awe,cwe,dwe,fwe,mwe,xwe,vwe,wwe,Swe,Nwe,$we,Twe,Awe,Dwe,Fwe,_we,Lwe,jwe,Bwe,zwe,Vwe,Gwe,s1e,Kwe,sbe,nCe,rbe,sCe,ibe,cCe,uCe,hCe,lbe,ube,pCe,gCe,yCe,bCe,hbe,pbe,Kve,CCe,owe,kCe,ECe,ICe,r1e,gbe,ybe,RCe,bbe,DCe,PCe,MCe,BCe,UCe,WCe,HCe,Cbe,qCe,XCe,JCe,QCe,tSe,sSe,oSe,kbe,aSe,uSe,fSe,Ebe,Ibe,gSe,vSe,CSe,Rbe,kSe,ESe,$Se,OW,ASe,i1e,Obe,OSe,PSe,MSe,jSe,Xve,pS,zSe,a1e,l1e,c1e,VSe,HSe,qSe,XSe,JSe,ZSe,eke,zbe,nke,ake,cke,fke,Vbe,mke,xke,vke,Wbe,dSe,Cke,kke,Eke,Ike,Rke,Dke,Fke,_ke,qbe,Mke,Xbe,Jbe,jke,zke,Vke,Hke,qke,t1e,Wwe,Xke,Jke,Qke,t2e,s2e,o2e,Abe,f2e,m2e,x2e,NSe];for(const t of y2e)mB(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _l={},fg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function v2e(t,e){_l[t]=e}function qo(t,e){if(!(t in _l)||e!=null){const s=w2e(t,e);if(s!==null)_l[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=_l[t];return n==null||n.isContextLost()?(delete _l[t],qo(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),_l[t])}function b2e(t){if(!se().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function w2e(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??b2e(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete _l[t]},!1),se().getBool("SOFTWARE_WEBGL_ENABLED")&&(fg.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",fg)||n.getContext("experimental-webgl",fg):n.getContext("webgl2",fg)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var jf;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(jf||(jf={}));var Ur;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Ur||(Ur={}));var rs;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(rs||(rs={}));function bm(t,e){return[e,t]}function C2e(t,e){return t*e}function pg(t){const e=ie(t),n=Math.ceil(e/4);return _C(n)}function _d(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function S2e(t,e){const[n,s]=_d(t,e);return n*s*4}function k$(t,e){const n=t;let s,r,o,i,a,l,c,u,d,h;return se().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(t,e){const n=e();return se().getBool("DEBUG")&&k2e(t),n}function k2e(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+I2e(t,e))}const N2e=596e-10,E2e=65504;function $2e(t){return!!(se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||N2e<Math.abs(t)&&Math.abs(t)<E2e)}function I2e(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function mg(t,e){return ha(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function T2e(t,e){const n=ha(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ee(t,()=>t.shaderSource(n,e)),Ee(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function R2e(t,e){const n=ha(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ee(t,()=>t.shaderSource(n,e)),Ee(t,()=>t.compileShader(n)),se().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw FW(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const A2e=/ERROR: [0-9]+:([0-9]+):/g;function FW(t,e){const n=A2e.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),o=r.length.toString().length+2,i=r.map((d,h)=>Au((h+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,s-1),c=i.slice(s-1,s),u=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Au(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function D2e(t){return ha(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function O2e(t,e){if(Ee(t,()=>t.linkProgram(e)),!se().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function G1(t,e){if(Ee(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function F2e(t,e){const n=ha(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ee(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ee(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function P2e(t,e){const n=ha(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ee(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ee(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function _2e(t){return ha(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function M2e(t,e){const n=se().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function L2e(t){return ha(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function qO(t,e,n,s,r,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(Ee(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),Ee(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,o,i)),Ee(t,()=>t.enableVertexAttribArray(a)),!0)}function j2e(t,e,n){W2e(t,n),Ee(t,()=>t.activeTexture(t.TEXTURE0+n)),Ee(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function B2e(t,e,n){return ha(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function z2e(t,e,n){return t.getUniformLocation(e,n)}function U2e(t,e,n,s){Ee(t,()=>j2e(t,e,s)),Ee(t,()=>t.uniform1i(n,s))}function q1(t,e,n){Ee(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ee(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function KO(t,e){Ee(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ee(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function gg(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+V2e(t,e))}function V2e(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function ha(t,e,n){const s=Ee(t,()=>e());if(s==null)throw new Error(n);return s}function W2e(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function cd(t,e=2){return ie(t.slice(0,t.length-e))}function ud(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function xg(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[cd(t),...ud(t)]),e}function H2e(t,e=!1){let n=se().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=se().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&se().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?U2(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=ml(t).newShape);let r=ie(t),o=null;t.length<=1&&r<=n?o=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>s&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=cd(t);let l=2,c=2;t.length&&([l,c]=ud(t)),r=a*(l/2)*(c/2),o=_C(r).map(u=>u*2)}else o=_C(r);return o}function yg(t){return t%2===0}function gy(t,e){if(t=t.slice(-2),e=e.slice(-2),Rt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||yg(n)&&yg(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&yg(t[0])&&yg(e[0])}let K1,X1;function G2e(t){if(K1==null){const e=qo(t);K1=e.getParameter(e.MAX_TEXTURE_SIZE)}return K1}function q2e(t){if(X1==null){const e=qo(t);X1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,X1)}function K2e(t){if(t===0)return 0;let e;const n=qo(t);return xo(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:xo(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function xo(t,e){return t.getExtension(e)!=null}function XO(t){try{if(qo(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function X2e(t){if(t===0)return!1;const e=qo(t);if(t===1){if(!xo(e,"OES_texture_float"))return!1}else if(!xo(e,"EXT_color_buffer_float"))return!1;return gS(e)}function Y2e(t){if(t===0)return!1;const e=qo(t);if(t===1){if(!xo(e,"OES_texture_float")||!xo(e,"WEBGL_color_buffer_float"))return!1}else{if(xo(e,"EXT_color_buffer_float"))return gS(e);const s="EXT_color_buffer_half_float";if(xo(e,s)){const r=e.getExtension(s);return J2e(e,r)}return!1}return gS(e)}function gS(t){const e=k$(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function J2e(t,e){const n=k$(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),a}function Z2e(t){return t!==2?!1:qo(t).fenceSync!=null}function wm(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pe=se();Pe.registerFlag("HAS_WEBGL",()=>Pe.getNumber("WEBGL_VERSION")>0);Pe.registerFlag("WEBGL_VERSION",()=>XO(2)?2:XO(1)?1:0);Pe.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Pe.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Pe.get("WEBGL_VERSION")===2);Pe.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Pe.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Pe.registerFlag("WEBGL_PACK",()=>Pe.getBool("HAS_WEBGL"));Pe.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_CLIP",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_REDUCE",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_LAZILY_UNPACK",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_CONV_IM2COL",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Pe.getBool("WEBGL_PACK"));Pe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>G2e(Pe.getNumber("WEBGL_VERSION")));Pe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>q2e(Pe.getNumber("WEBGL_VERSION")));Pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Pe.getNumber("WEBGL_VERSION");return t===0?0:K2e(t)});Pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Pe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!DB());Pe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>X2e(Pe.getNumber("WEBGL_VERSION")));Pe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Pe.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Pe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Pe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Y2e(Pe.getNumber("WEBGL_VERSION")));Pe.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Z2e(Pe.getNumber("WEBGL_VERSION")));Pe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Pe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Pe.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Pe.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>DB()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Pe.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Pe.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Pe.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Pe.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Pe.registerFlag("WEBGL_EXP_CONV",()=>!1);Pe.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Pe.getBool("IS_TEST"));Pe.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Pe.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Pe.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Pe.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qs(){let t,e,n,s,r,o,i,a,l,c;return se().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",o="outputColor",i="out vec4 outputColor;",a=se().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uc(t,e,n="index"){const s=Be(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / ${r}`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r}`:`index -= ${t[o]} * ${r}`;return`${i}; ${a};`}).join("")}function Zv(t,e,n="index"){const s=Be(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function Q2e(t,e){const n=t.length,s=t.map(o=>`${e}[${o}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let o=n-3;o>=0;--o)r[o]=`(${r[o+1]} * ${s[o+1]})`;return r}function eNe(t,e,n="index"){const s=t.map((o,i)=>i),r=Q2e(s,e);return r.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${r[i]}`,l=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r[i]}`:`index -= ${t[i]} * ${r[i]}`;return`${a}; ${l};`}).join("")}function N$(t){const e=Be(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function E$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const PW=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:_W}=Vge;function tNe(t,e,n){const s=[];if(t.forEach(f=>{const m=ie(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${m>1?`[${m}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=$$(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),o=t.map(f=>nNe(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=qs(),l=oNe(a);let c,u,d=lNe(a);return e.isPacked?(c=sNe(e.logicalShape,i,n.enableShapeUniforms),u=aNe(a)):(c=rNe(e.logicalShape,i,n.enableShapeUniforms),u=iNe(a)),n.packedInputs&&(d+=hNe),[d,l,u,r,c,o,n.userCode].join(`
`)}function Md(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return kNe(t,e);case 1:return ENe(t,e);case 2:return INe(t,e);case 3:return RNe(t,e);case 4:return DNe(t,e);case 5:return ONe(t);case 6:return FNe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function MW(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return SNe(t);case 1:return NNe(t,e);case 2:return $Ne(t,e);case 3:return TNe(t,e);default:return ANe(t,e)}}function nNe(t,e,n=!1,s){let r="";n?r+=MW(t,s):r+=Md(t,s);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?r+=PNe(t,e):r+=_Ne(t,e)),r}function sNe(t,e,n){switch(t.length){case 0:return LW();case 1:return fNe(t,e,n);case 2:return wNe(t,e,n);case 3:return mNe(t,e,n);default:return xNe(t,e,n)}}function rNe(t,e,n){switch(t.length){case 0:return LW();case 1:return pNe(t,e,n);case 2:return CNe(t,e,n);case 3:return gNe(t,e,n);case 4:return yNe(t,e,n);case 5:return vNe(t,e);case 6:return bNe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function oNe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function iNe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function aNe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function lNe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${cNe}
    ${uNe}
    ${dNe}
  `}const cNe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,uNe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,dNe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,hNe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function LW(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function fNe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function pNe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function mNe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),o=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function gNe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Zv(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Uc(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function xNe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),o=r*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function yNe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Zv(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Uc(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function vNe(t,e){const n=Uc(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function bNe(t,e){const n=Uc(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function wNe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Rt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function CNe(t,e,n){return Rt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Vc(t){return`offset${t}`}function SNe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=qs();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function kNe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,o]=t.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Vc(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function NNe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,o=qs();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function ENe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Ld(t)}
      }
    `;const r=t.shapeInfo.texShape,o=r[0],i=r[1];if(i===1&&o===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Vc(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function $Ne(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=qs();if(o!=null&&Rt(n,o))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function INe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape;if(o!=null&&Rt(n,o)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=o[0],f=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=ml(n),l=i;if(l.length<n.length){const h=jd(t,l),f=["row","col"];return`
      ${Md(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${Bd(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Ld(t)}
      }
    `;const c=o[0],u=o[1],d=Vc(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function TNe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],m=jd(t,h),g=["b","row","col"];return`
        ${MW(m,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Bd(g,f)});
        }
      `}const a=qs();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],c=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function RNe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=ml(n),c=a;if(c.length<n.length){const g=jd(t,c),y=["row","col","depth"];return`
        ${Md(g,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Bd(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${Ld(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const m=Vc(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${m};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function ANe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=qs();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(o[i-1]/2);let h=d*Math.ceil(o[i-2]/2),f="int b, int row, int col",m=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<i-1;g++)f=`int b${g}, `+f,h*=o[i-g-1],m=`b${g} * ${h} + `+m;return`
    vec4 ${s}(${f}) {
      int index = ${m};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function DNe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:c}=ml(n);if(l.length<n.length){const v=jd(t,l),b=["row","col","depth","depth2"];return`
      ${Md(v,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Bd(b,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${Ld(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],m=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,y=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${m}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===o&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=Vc(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${g}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function ONe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],o=e[3]*r,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:c}=ml(e);if(l.length<e.length){const g=jd(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${Md(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Bd(y,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${r})) +
          depth3;
        ${Ld(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Vc(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${r} + depth3 + ${m};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function FNe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:o}=ml(e);if(r.length<e.length){const y=jd(t,r),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${Md(y)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Bd(x,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Ld(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],m=h[1];if(m===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Vc(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ld(t){const e=t.name,n=ie(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function PNe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=_W(t.shapeInfo.logicalShape,e.logicalShape),l=_t(i),c=i-o;let u;const d=["x","y","z","w","u","v"];o===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(v=>`coords.${d[v+c]} = 0;`).join(`
`);let h="";i<2&&o>0?h="coords":h=t.shapeInfo.logicalShape.map((v,b)=>`coords.${d[b+c]}`).join(", ");let f="return outputValue;";const g=ie(t.shapeInfo.logicalShape)===1,x=ie(e.logicalShape)===1;if(o===1&&!g&&!x)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!x)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=o-2,b=o-1;a.indexOf(v)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(v)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function _Ne(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Rt(i,o))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=_t(l),u=_W(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(g=>`coords.${f[g+d]} = 0;`).join(`
`);let m="";return l<2&&a>0?m="coords":m=t.shapeInfo.logicalShape.map((g,y)=>`coords.${f[y+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${m});
    }
  `}function _t(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function $$(t,e,n){const{newShape:s,keptDims:r}=ml(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):s,l=!t&&o>1&&!Rt(e,n)&&s.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function jd(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Bd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MNe(t,e,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),o=r.map(u=>u.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=tNe(r,i,e),l=R2e(t.gl,a),c=t.createProgram(l);return se().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i},jW(t,e,c)))}function jW(t,e,n){const s=[],r=[];let o,i,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),se().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),s.push(h)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),i=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function YO(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,o=e[s],i=o.shape;if(!Rt(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!Rt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function LNe(t,e,n,s,r){e.program.enableShapeUniforms||(YO(e.inShapeInfos,n),YO([e.outShapeInfo],[s]));const o=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),se().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:m}=$$(e.program.packedInputs,c.shape,c.texData.texShape);switch(m.length){case 1:t.gl.uniform1iv(h,new Int32Array(m));break;case 2:t.gl.uniform2iv(h,new Int32Array(m));break;case 3:t.gl.uniform3iv(h,new Int32Array(m));break;case 4:t.gl.uniform4iv(h,new Int32Array(m));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(ie(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let m=c.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),t.gl.uniform1fv(u,m)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Be(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=r[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function jNe(t,e,n){let s="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=$$(t.packedInputs,i.shape,l);let h="",f="",m="";if(u.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${C[0]>1}_${C[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const C=Be(u);m=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const g=i.shape.length,y=u.length===2&&Rt(i.shape,l),x=ie(i.shape)===1,v=sd(i.shape,n.shape),b=!t.packedInputs&&g===n.shape.length&&Rt(l,n.texData.texShape),w=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${b}_${c?d:""}_${u.length}_${x}_${v}_${y}_${h}_${f}_${m}_${w}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const r=t.userCode;let o=t.constructor.name;return o+="_"+s+"_"+r+`${se().getNumber("WEBGL_VERSION")}`,o}function Es(t){return se().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BNe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=jf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=qs();this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Zv(["r","c","d"],e):Uc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zNe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=jf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=qs();this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Zv(["r","c","d"],e):Uc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UNe{constructor(e){this.variableNames=["A"],this.outTexUsage=Ur.DOWNLOAD;const n=qs();this.outputShape=e,this.userCode=`
      ${PW}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VNe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ur.DOWNLOAD;const n=qs();this.outputShape=e,this.userCode=`
      ${PW}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WNe={R:0,G:1,B:2,A:3};class JO{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=qs();this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<s.length;a++){const l=s[a];i+=`
          if(offset == ${a}) {
            result = values[${WNe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?E$():N$(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HNe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=qs();this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length);let r="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?E$():N$(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GNe(t){const e=qs(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return T2e(t,n)}function qNe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return F2e(t,e)}function KNe(t){const e=new Uint16Array([0,1,2,2,1,3]);return P2e(t,e)}function Cm(t,e,n,s,r,o){M2e(e,n);const i=_2e(t),a=t.TEXTURE_2D;return Ee(t,()=>t.bindTexture(a,i)),Ee(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ee(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ee(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ee(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),se().getNumber("WEBGL_VERSION")===1?Ee(t,()=>t.texImage2D(a,0,s,e,n,0,r,o,null)):Ee(t,()=>t.texStorage2D(a,1,s,e,n)),Ee(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function BW(t){return t.internalFormatFloat}function XNe(t,e,n,s){const[r,o]=bm(e,n);return Cm(t,r,o,BW(s),s.textureFormatFloat,t.FLOAT)}function zW(t){return t.internalFormatHalfFloat}function YNe(t,e,n,s){const[r,o]=bm(e,n);return Cm(t,r,o,zW(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function UW(t){return t.downloadTextureFormat}function JNe(t,e,n,s){const[r,o]=bm(e,n);return Cm(t,r,o,UW(s),t.RGBA,t.UNSIGNED_BYTE)}function VW(t){return t.internalFormatPackedFloat}function ZNe(t,e,n,s){const[r,o]=_d(e,n);return Cm(t,r,o,VW(s),t.RGBA,t.FLOAT)}function WW(t){return t.internalFormatPackedHalfFloat}function QNe(t,e,n,s){const[r,o]=_d(e,n);return Cm(t,r,o,WW(s),t.RGBA,s.textureTypeHalfFloat)}function eEe(t,e,n){return Ee(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),qO(t,e,"clipSpacePos",n,3,20,0)&&qO(t,e,"uv",n,2,20,12)}function tEe(t,e,n,s,r,o){Ee(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;r instanceof Uint8Array?(i=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(r),se().getNumber("WEBGL_VERSION")===2?Ee(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,i)):Ee(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,i)),Ee(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function nEe(t,e,n){Ee(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?se().getNumber("WEBGL_VERSION")===2?Ee(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ee(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):se().getNumber("WEBGL_VERSION")===2?Ee(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ee(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ee(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function sEe(t,e,n,s){const r=t.createBuffer();Ee(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return Ee(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Ee(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ee(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function rEe(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function oEe(t,e,n,s){const[r,o]=bm(e,n),i=4,a=new Uint8Array(C2e(e*n,i));return Ee(t,()=>t.readPixels(0,0,r,o,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function iEe(t,e,n,s,r,o,i,a){const l=t,c=new Float32Array(S2e(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function aEe(t,e,n){const s=new Float32Array(e*n*4);return Ee(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=se().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,v2e(n,e)):this.gl=qo(n),e=this.gl,se().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>Ee(o,()=>o.createVertexArray()),this.bindVertexArray=i=>Ee(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>Ee(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>Ee(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ee(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>Ee(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>Ee(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>Ee(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),se().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=mg(this.gl,o),xo(this.gl,i))this.textureHalfFloatExtension=mg(this.gl,i);else if(se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),xo(this.gl,r))this.colorBufferHalfFloatExtension=mg(this.gl,r);else if(se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",xo(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(xo(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=qNe(this.gl),this.indexBuffer=KNe(this.gl),this.framebuffer=L2e(this.gl),this.textureConfig=k$(this.gl,this.textureHalfFloatExtension)}get debug(){return se().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ee(e,()=>e.finish()),Ee(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ee(e,()=>e.deleteFramebuffer(this.framebuffer)),Ee(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ee(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ee(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),XNe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),YNe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),JNe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),nEe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),tEe(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),QNe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),ZNe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(KO(this.gl,this.framebuffer),this.outputTexture=null),Ee(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>oEe(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,o,i){return iEe(this.gl,e,n,s,r,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return rEe(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=sEe(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(se().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(o,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},n=o}else se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>aEe(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=GNe(n));const s=D2e(n);Ee(n,()=>n.attachShader(s,this.vertexShader)),Ee(n,()=>n.attachShader(s,e)),O2e(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&G1(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Ee(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),eEe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ee(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&G1(this.gl,this.program),Ee(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?B2e(this.gl,e,n):z2e(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ee(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),U2e(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,o]=_d(n,s);this.setOutputMatrixTextureDriver(e,r,o)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&G1(this.gl,this.program),gg(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ee(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ee(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=mg(this.gl,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await _D(()=>this.disposed||this.isQueryAvailable(e,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=lEe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in se().platform&&(s=se().platform.setTimeoutCustom.bind(se().platform)),_D(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),q1(this.gl,e,this.framebuffer),this.debug&&gg(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(q1(this.gl,this.outputTexture,this.framebuffer),this.debug&&gg(this.gl)):KO(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;q1(r,e,this.framebuffer),this.debug&&gg(r),this.outputTexture=e,Ee(r,()=>r.viewport(0,0,n,s)),Ee(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),Ee(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function lEe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:cEe,bincountImpl:HW,bincountReduceImpl:uEe,bitwiseAndImpl:dEe,castImpl:hEe,ceilImpl:fEe,concatImpl:pEe,equalImpl:mEe,expImpl:gEe,expm1Impl:xEe,floorImpl:yEe,gatherNdImpl:vEe,gatherV2Impl:bEe,greaterImpl:wEe,greaterEqualImpl:CEe,lessImpl:SEe,lessEqualImpl:kEe,linSpaceImpl:NEe,logImpl:EEe,maxImpl:$Ee,maximumImpl:IEe,minimumImpl:TEe,multiplyImpl:REe,negImpl:AEe,notEqualImpl:DEe,prodImpl:OEe,raggedGatherImpl:FEe,raggedRangeImpl:PEe,raggedTensorToTensorImpl:_Ee,rangeImpl:MEe,rsqrtImpl:LEe,scatterImpl:jEe,sigmoidImpl:BEe,simpleAbsImpl:GW,sliceImpl:zEe,sparseFillEmptyRowsImpl:UEe,sparseReshapeImpl:VEe,sparseSegmentReductionImpl:qW,sqrtImpl:WEe,staticRegexReplaceImpl:HEe,stridedSliceImpl:GEe,stringNGramsImpl:qEe,stringSplitImpl:KEe,stringToHashBucketFastImpl:XEe,subImpl:YEe,tileImpl:JEe,topKImpl:ZEe,transposeImpl:I$,uniqueImpl:QEe}=n1e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Bs(t,e){return e===1?[t]:KW(t,e)}function e$e(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t$e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Es(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Bs("rc",this.rank),s=_t(this.rank),r=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XW{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length);let s="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),s+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${n$e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?E$():N$(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function n$e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?eNe(["r","c","d"],"inputShape"):Uc(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s$e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=QO(n,s),o=eF(e,r,s);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=ZO(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return r===rs.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===rs.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===rs.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===rs.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===rs.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const o=QO(s,r),i=eF(n,o,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=ZO(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=se().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[i],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function r$e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function ZO(t,e,n,s,r){const o=o$e(e,s);let i;if(r){const[l,c]=_d(t[0],t[1]);i=l*c}else{const[l,c]=bm(t[0],t[1]);i=l*c}const a=r$e(n,o);return i*a}function o$e(t,e){switch(t){case rs.PACKED_2X2_FLOAT32:return VW(e);case rs.PACKED_2X2_FLOAT16:return WW(e);case rs.UNPACKED_FLOAT32:return BW(e);case rs.UNPACKED_FLOAT16:return zW(e);case rs.PACKED_4X1_UNSIGNED_BYTE:return UW(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function i$e(t){return se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?rs.PACKED_2X2_FLOAT32:rs.UNPACKED_FLOAT32:t?rs.PACKED_2X2_FLOAT16:rs.UNPACKED_FLOAT16}function QO(t,e){if(t===Ur.UPLOAD)return rs.PACKED_2X2_FLOAT32;if(t===Ur.RENDER||t==null)return i$e(e);if(t===Ur.DOWNLOAD||t===Ur.PIXELS)return rs.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function eF(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class di{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const $o="if (isnan(x)) return x;",a$e="return x;",tF="return abs(x);",l$e="return (x >= 0.0) ? x : (exp(x) - 1.0);",c$e=$o+`
  return (x < 0.0) ? 0.0 : x;
`,u$e=$o+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ca="return x;",d$e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$e="return x;",f$e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,p$e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,m$e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,g$e="return 1.0 / (1.0 + exp(-1.0 * x));";class Fa{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x$e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length);const n=e.length,s=Bs("rc",n),r=_t(n),o=e$e(n,s),i=s.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y$e=wz,v$e=1e-7,b$e=1e-4,vg={};function w$e(t){return t in vg||(vg[t]={}),vg[t]}const C$e=se().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),S$e=600;function k$e(){return se().global.screen==null?1024:se().global.screen.height*se().global.screen.width*window.devicePixelRatio*S$e/1024/1024}class Qv extends z2{nextDataId(){return Qv.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!se().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Y1)n=e;else{const s=qo(se().getNumber("WEBGL_VERSION"),e);n=new Y1(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=qo(se().getNumber("WEBGL_VERSION"));n=new Y1(s),this.binaryCache=w$e(se().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new s$e(this.gpgpu),this.numMBBeforeWarning=k$e(),this.texData=new Bj(this,si())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,o,i){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,o]},l.texShape=[r,o];const c=xg(n),u=new JO(c,!1,i),d=this.runWebGLProgram(u,[a],s,[[r,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((se().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||se().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:Ur.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,o){if(se().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:Ur.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let h;l?h=new Fa(a,Ca):h=new di(a,Ca);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),m=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),m}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=Qs());let d;if(r==="complex64"){const h=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);d=sa(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Qs()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const m=this.pendingRead.get(e);return new Promise(g=>m.push(g))}const n=this.texData.get(e),{values:s,shape:r,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let m;l?m=new Fa(r,Ca):m=new di(r,Ca);const g=this.runWebGLProgram(m,[{dataId:e,shape:r,dtype:i}],i),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(se().getBool("DEBUG")&&!se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&se().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(i!=="complex64"&&se().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const m=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(m.texture.texture,...pg(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const m=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=m[0],y=m[1];d=sa(g,y)}else if(c==null)d=this.getValuesFromTexture(e);else{const m=ie(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,m)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const m=this.gpgpu.gl;Ee(m,()=>m.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(m=>m(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&si().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:o,slice:i,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new Fa(o,Ca):f=new di(o,Ca);const m=this.runWebGLProgram(f,[{dataId:e,shape:o,dtype:a}],a),g=this.readToGPU(m,n);return this.disposeIntermediateTensorInfo(m),g}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=si().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>nl(r));return ht(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ht(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!$2e(s))throw se().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),o=ie(n);if(se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...pg(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(h),m}const i=se().getBool("WEBGL_PACK")&&r===!0,a=i?xg(n):n,l=i?new VNe(a):new UNe(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const o=mc(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=mc(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=cue(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:i[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Qs(),endMs:null}}endTimer(e){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Qs(),e)}async getQueryTime(e){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,o,i)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=C$e){return se().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&ie(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){jr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return y$e(e.shape,n)}packedUnaryOp(e,n,s){const r=new Fa(e.shape,n),o=this.compileAndRun(r,[e],s);return si().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=GW(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tF,e.dtype);const n=new di(e.shape,tF),s=this.compileAndRun(n,[e]);return si().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&ap(s[0])){const o=s.map(i=>qa(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return si().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new x$e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new t$e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[cd(e.shape),...ud(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[cd(n),...ud(n)],i=new XW(o,s),a=!0,l=[s],c=this.runWebGLProgram(i,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:o,dtype:i}=s;if(n!=null){const h=ie(o),f=n[0]*n[1]*4;T(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=xg(o);let l;r?l=new zNe(a):l=new BNe(a);const c=!0,u=[n??pg(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,u,c,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,s,r,o=!1,i){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===jf.DENSE){const x=i??pg(e.outputShape);l.texShape=x.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),ie(a.shape)===0)return l.values=ws(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(x.dataId);if(v.texture==null){if(!e.packedInputs&&ie(x.shape)<=se().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!v.isPacked!=!!e.packedInputs)x=v.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),v=this.texData.get(x.dataId);else if(v.isPacked&&!gy(v.shape,x.shape)){const b=x,w=x.shape;x.shape=v.shape,x=this.packedReshape(x,w),c.push(x),v=this.texData.get(x.dataId),b.shape=w}return{shape:x.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=jNe(e,u,d),f=this.getAndSaveBinary(h,()=>MNe(this.gpgpu,e,u,d)),m=this.activeTimers!=null;let g;m&&(g=this.startTimer()),se().get("ENGINE_COMPILE_ONLY")||LNe(this.gpgpu,f,u,d,r),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),m&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const y=se().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const x=Qs();x-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!se().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(e,n,s,r,o=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(se().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ee(()=>{if(!se().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=se().getBool("DEBUG");se().set("DEBUG",!1);const n=this.abs(Tt(1e-8)).dataSync()[0];if(se().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?v$e:b$e}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const c=this.activeTimers!=null;let u;c&&(u=Qs());let d=n.texShape;if(d==null&&(d=H2e(s,l),n.texShape=d),o!=null){const h=xg(s);let f,m=d[1],g=d[0];const y=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!y)&&([m,g]=_d(d[0],d[1])),l?f=new HNe(h,y):f=new JO(h,y);const x=y?[g,m]:d,v=this.makeTensorInfo(x,r),b=this.texData.get(v.dataId);y?b.usage=Ur.PIXELS:b.usage=Ur.UPLOAD,b.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),m,g,o);const w=[[g,m]],k=this.runWebGLProgram(f,[v],r,w,!0),N=this.texData.get(k.dataId);n.texShape=N.texShape,n.isPacked=N.isPacked,n.usage=N.usage,se().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=N.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(v),c&&(this.uploadWaitMs+=Qs()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=N$e(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*Hx(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(o){throw o}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await Lz(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(FW(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=jW(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:o,width:i,channels:a}=e,l=si().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,o,i,a);return si().makeTensorFromDataId(c,n,s,l)}}Qv.nextDataId=0;function N$e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */OB()&&MB("webgl",()=>new Qv,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class $c{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=nt(n,s),this.enableShapeUniforms=Es(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wc=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class zd{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=nt(n,s);const o=this.outputShape.length;this.enableShapeUniforms=Es(o);let i="";if(r)if(o===0||ie(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${_t(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Bs("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ar(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const E$e={kernelName:Ip,backendName:"webgl",kernelFunc:Ar};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kl(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(o.dataId),a=Ar({inputs:{x:s},backend:n}),l=Ar({inputs:{x:r},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const $$e={kernelName:eN,backendName:"webgl",kernelFunc:kl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW="return (a < 0.) ? b * a : a;",JW=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function I$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s,i=n.makeTensorInfo([],"float32",gl(o,"float32")),a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zd(JW,r.shape,i.shape):new $c(YW,r.shape,i.shape),l=n.runWebGLProgram(a,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const T$e={kernelName:q0,backendName:"webgl",kernelFunc:I$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZW="return (a < 0.) ? b * a : a;",QW=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function R$e(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,o=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zd(QW,s.shape,r.shape):new $c(ZW,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],"float32")}const A$e={kernelName:hv,backendName:"webgl",kernelFunc:R$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ud="if (isnan(x)) return x;";function kt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:o})=>{const{x:i}=r,a=o,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),h=n(d.values,l);return a.makeTensorInfo(i.shape,l,h)}const c=se().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Fa(i.shape,e):u=new di(i.shape,t),a.runWebGLProgram(u,[i],l)}}function hs({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:c}=i,u=a;if(s&&l.dtype==="complex64"){const m=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[y,x]=[[m.complexTensorInfos.real,g.complexTensorInfos.real],[m.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[w,C]=b,k={dataId:w.dataId,dtype:w.dtype,shape:l.shape},N={dataId:C.dataId,dtype:C.dtype,shape:c.shape},E=new $c(t,l.shape,c.shape);return u.runWebGLProgram(E,[k,N],Tr(w.dtype,C.dtype))}),v=kl({inputs:{real:y,imag:x},backend:u});return u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(x),v}const d=o||Tr(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const m=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,y=l.dtype==="string"?ra(m):m,x=l.dtype==="string"?ra(g):g,[v,b]=r(l.shape,c.shape,y,x,d),w=u.makeTensorInfo(b,d),C=u.texData.get(w.dataId);return C.values=v,w}const h=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new zd(e,l.shape,c.shape,n):f=new $c(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function Bf(t,e=!1){if(t==="linear")return e?h$e:a$e;if(t==="relu")return e?p$e:c$e;if(t==="elu")return e?f$e:l$e;if(t==="relu6")return e?m$e:u$e;if(t==="prelu")return e?QW:ZW;if(t==="leakyrelu")return e?JW:YW;if(t==="sigmoid")return e?g$e:d$e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e5{constructor(e,n,s,r=!1,o=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Es(this.outputShape.length);const u=r?e[1]:e[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",m=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",x="";a&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",w="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(w=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${w};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${g[0]});
          result += (${m[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nF={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class sF{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=nt(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rF="return a * b;";function R$(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=Tr(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new sF(nF.REAL,s.shape,r.shape),u=new sF(nF.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),m=kl({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=REe(s.shape,r.shape,a.values,l.values,o),d=n.makeTensorInfo(u,o),h=n.texData.get(d.dataId);return h.values=c,d}let i;return se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new zd(rF,s.shape,r.shape):i=new $c(rF,s.shape,r.shape),n.runWebGLProgram(i,[s,r],o)}const D$e={kernelName:Mp,backendName:"webgl",kernelFunc:R$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$e(t,e,n){const s=[cd(t.shape),...ud(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},o=[cd(e),...ud(e)],i=new XW(o,s),a=!0,l=[s],c=n.runWebGLProgram(i,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Se(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=n,a=ie(r.shape),l=Uj(o,a),c=ie(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=i.texData.get(r.dataId);return u.isPacked&&!gy(r.shape,l)&&!(u.texture!==null&&gy(u.shape,l))?O$e(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const F$e={kernelName:pv,backendName:"webgl",kernelFunc:Se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oF{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${Qu(d)?d.toPrecision(2):d}, ones);`}let u="";o%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P$e{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let m="";o%s>0&&(m=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Mv(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Hc(t,e,n,s){const r=_$e(t.shape);let o=t;for(let i=0;i<r.length;i++){const{inSize:a,windowSize:l,outSize:c}=r[i];let u,d;n==="mean"?u=i===0?new oF({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new oF({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new P$e({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=o,o=s.runWebGLProgram(u,[o],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M$e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const r=_t(this.rank),o=L$e(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function L$e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j$e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=_t(this.rank),o=KW("rc",this.rank),i=new Array(this.rank);for(let u=0;u<n.length;u++)i[n[u]]=o[u];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eb(t,e,n){const s=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new j$e(t.shape,e):new M$e(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B$e(t,e,n,s){const r=e,o=t.shape.length,i=ft(r,t.shape);let a=i;const l=an(a,o),c=l!=null;let u=t;c&&(u=eb(t,l,s),a=bn(a.length,o)),ds("sum",a,o);const[d,h]=Yn(u.shape,a);let f=d;n&&(f=An(d,i));const m=ie(h),y=ie(t.shape)/m,x=Se({inputs:{x:u},attrs:{shape:[y,m]},backend:s}),v=PN(t.dtype),b=Hc(x,v,"sum",s),w=Se({inputs:{x:b},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(b),c&&s.disposeIntermediateTensorInfo(u),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tb(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;return B$e(r,o,i,n)}const z$e={kernelName:bv,backendName:"webgl",kernelFunc:tb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ws(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:o}=s,i=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[o[u]];let c;if(i.shouldExecuteOnCPU([r])){const d=i.texData.get(r.dataId).values,h=I$(d,r.shape,r.dtype,o,l);c=i.makeTensorInfo(l,r.dtype);const f=i.texData.get(c.dataId);f.values=h}else c=eb(r,o,i);return c}const U$e={kernelName:Du,backendName:"webgl",kernelFunc:Ws};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5=1e3;function xy({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],m=s?e.shape[u-2]:e.shape[u-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),x=ie(g),v=ie(y),w=nt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,m]);T(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const C=n?[x,d,f]:[x,f,d],k=s?[v,m,h]:[v,h,m],N=Se({inputs:{x:t},backend:r,attrs:{shape:C}}),E=Se({inputs:{x:e},backend:r,attrs:{shape:k}}),$=[N,E],I=Math.max(x,v),A=n?N.shape[1]:N.shape[2],P=o!=null,_=i!=null,U=l==="leakyrelu",V=l!=null?Bf(l,!0):null,D=P||_||U||V!=null;let W;if((f===1||m===1)&&A>t5&&D===!1){let j=N,G=E;n&&(j=Ws({inputs:{x:N},backend:r,attrs:{perm:[0,2,1]}}),$.push(j)),s&&(G=Ws({inputs:{x:E},backend:r,attrs:{perm:[0,2,1]}}),$.push(G));const O=m!==1,B=m===1;let z=j;O&&(z=Se({inputs:{x:j},backend:r,attrs:{shape:[I,A,1]}}),$.push(z));const K=m===1?2:1;let J=G;B&&(J=Se({inputs:{x:G},backend:r,attrs:{shape:[I,1,A]}}),$.push(J));const re=R$({inputs:{a:z,b:J},backend:r});W=tb({inputs:{x:re},backend:r,attrs:{axis:K,keepDims:!0}}),$.push(re)}else{const j=Tr(t.dtype,e.dtype),G=new e5(C,k,[I,f,m],n,s,P,V,_,U),O=[N,E];if(o!=null&&O.push(o),_&&O.push(i),U){const B=r.makeTensorInfo([],"float32",gl(a,"float32"));O.push(B),$.push(B)}W=r.runWebGLProgram(G,O,j)}const R=Se({inputs:{x:W},backend:r,attrs:{shape:w}});$.push(W);for(const j of $)r.disposeIntermediateTensorInfo(j);return R}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V$e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return xy({a:r,b:o,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const W$e={kernelName:Gx,backendName:"webgl",kernelFunc:V$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iF="return abs(x);";function H$e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const o=n.texData.get(s.dataId),i=GW(o.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let r;return se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Fa(s.shape,iF):r=new di(s.shape,iF),n.runWebGLProgram(r,[s],s.dtype)}const G$e={kernelName:$0,backendName:"webgl",kernelFunc:H$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q$e=$o+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,K$e=kt({opSnippet:q$e}),X$e={kernelName:lp,backendName:"webgl",kernelFunc:K$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y$e=$o+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,J$e=kt({opSnippet:Y$e}),Z$e={kernelName:cp,backendName:"webgl",kernelFunc:J$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aF="return a + b;",Q$e=hs({opSnippet:aF,packedOpSnippet:aF,supportsComplex:!0,cpuKernelImpl:cEe}),eIe={kernelName:Td,backendName:"webgl",kernelFunc:Q$e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tIe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`float v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nIe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`vec4 v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qg(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return Ar({inputs:{x:s[0]},backend:n});if(s.length>se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=qg({inputs:s.slice(0,l),backend:n}),u=qg({inputs:s.slice(l),backend:n});return qg({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>Tr(l,c)),o=s.map(l=>l.shape),a=se().getBool("WEBGL_PACK")?new nIe(s[0].shape,o):new tIe(s[0].shape,o);return n.runWebGLProgram(a,s,r)}const sIe={kernelName:q2,backendName:"webgl",kernelFunc:qg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=ft(o,r.shape);let c=l;const u=an(c,a);let d=r;u!=null&&(d=Ws({inputs:{x:r},backend:n,attrs:{perm:u}}),c=bn(c.length,a)),ds("all",c,a);const[h,f]=Yn(d.shape,c),m=ie(f),g=Se({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),y=Hc(g,g.dtype,"all",n);let x;if(i){const v=An(h,l);x=Se({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=Se({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),x}const oIe={kernelName:K2,backendName:"webgl",kernelFunc:rIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=ft(o,r.shape);let c=l;const u=an(c,a);let d=r;u!=null&&(d=Ws({inputs:{x:r},backend:n,attrs:{perm:u}}),c=bn(c.length,a)),ds("any",c,a);const[h,f]=Yn(d.shape,c),m=ie(f),g=Se({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),y=Hc(g,g.dtype,"any",n);let x;if(i){const v=An(h,l);x=Se({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=Se({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),x}const aIe={kernelName:X2,backendName:"webgl",kernelFunc:iIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lIe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cIe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=_t(l),u=Bs("coords",l);let d,h;if(i===1){h=l+1;const E=_t(h);d=`
        ${E} sourceLocR = ${E}(${u.join()}, 0);
        ++${u[l-1]};
        ${E} sourceLocG = ${E}(${u.join()}, 0);
        ++${u[l-2]};
        ${E} sourceLocA = ${E}(${u.join()}, 0);
        --${u[l-1]};
        ${E} sourceLocB = ${E}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),m="."+f[h-1],g=f.map(E=>"int "+E),y=Bs("sourceLocR",h-1).concat("inIdx.r"),x=Bs("sourceLocG",h-1).concat("inIdx.g"),v=Bs("sourceLocB",h-1).concat("inIdx.b"),b=Bs("sourceLocA",h-1).concat("inIdx.a"),w=s==="max"?"greaterThan":"lessThan",C=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${b.join()})));`,k=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,N=r?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${N}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n5(t,e,n,s=null){let r=e.shape[0],o=e.shape[1];s!=null&&(r=s.shape[0],o=s.shape[1]);const i=Mv(o),a={windowSize:i,inSize:o,batchSize:r,outSize:Math.ceil(o/i)},l=new lIe(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=n5(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function s5(t,e,n,s=null){const r=s!=null?s.shape:e.shape,o=r[r.length-1],i=Mv(o),a=new cIe(r,i,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=s5(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function r5(t,e,n,s){const r=[n];if(ds("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!se().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[c,u]=Yn(l.shape,r),d=ie(u),h=Se({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(h);const f=n5(t,h,s);o.push(f);const m=Se({inputs:{x:f},backend:t,attrs:{shape:c}});return o.forEach(g=>t.disposeIntermediateTensorInfo(g)),m}return s5(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=ft(o,r.shape);const a=an(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Ws({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=bn(i.length,l.shape.length)),ds("argMax",[i[0]],l.shape.length);const u=r5(n,l,i[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const dIe={kernelName:I0,backendName:"webgl",kernelFunc:uIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=ft(o,r.shape);const a=an(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Ws({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=bn(i.length,l.shape.length)),ds("argMin",[i[0]],l.shape.length);const u=r5(n,l,i[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const fIe={kernelName:T0,backendName:"webgl",kernelFunc:hIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pIe=$o+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,mIe=kt({opSnippet:pIe}),gIe={kernelName:up,backendName:"webgl",kernelFunc:mIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xIe=$o+"return log(x + sqrt(x * x + 1.0));",yIe=kt({opSnippet:xIe}),vIe={kernelName:dp,backendName:"webgl",kernelFunc:yIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bIe=$o+`
  return atan(x);
`,wIe=kt({opSnippet:bIe}),CIe={kernelName:hp,backendName:"webgl",kernelFunc:wIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SIe=T$+`
  return atan(a, b);
`,kIe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Wc+`
  return result;
`,NIe=hs({opSnippet:SIe,packedOpSnippet:kIe}),EIe={kernelName:pp,backendName:"webgl",kernelFunc:NIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ie=$o+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,IIe=kt({opSnippet:$Ie}),TIe={kernelName:fp,backendName:"webgl",kernelFunc:IIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zf{constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(g||(v="-1.0 / 1e-20"),s){const E=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?y:x:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let w=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(w="avgValue / max(count, 1.0)");const C=Math.floor(i/4)*4,k=i%4,N=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${m});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${N}
          }

          int xC = xCCorner + ${C};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${N}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${N}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${N}
          }
        }
        setOutput(${w});
      }
    `}}class A${constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,m=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=e.padInfo.front,x=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let w="0.0";if(b||(w="-1.0 / 1e-20"),s){const I=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${y}, ${x}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${I} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const N=Math.floor(i/4)*4,E=i%4,$=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${y}, ${x}, ${v});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${N}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${$}
            }

            int xC = xCCorner + ${N};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${$}
            }
          }
        }
        setOutput(${k});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;wm(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(ks(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=No(r.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Rt(u.inShape,u.outShape))return Ar({inputs:{x:r},backend:n});const d=new zf(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const AIe={kernelName:R0,backendName:"webgl",kernelFunc:RIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=ua(r.shape,o,i,u,a,l,c),h=new A$(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const OIe={kernelName:A0,backendName:"webgl",kernelFunc:DIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FIe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class PIe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=d-1-e.padInfo.front,g=h-1-e.padInfo.top,y=f-1-e.padInfo.left,x=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${g}, ${y});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ie(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=ua(i.shape,a,l,d,c,u),f=new PIe(h);return n.runWebGLProgram(f,[r],i.dtype)}const MIe={kernelName:J2,backendName:"webgl",kernelFunc:_Ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LIe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;wm([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=No(i.shape,a,l,1,c),d=new FIe(u);return n.runWebGLProgram(d,[r],i.dtype)}const jIe={kernelName:Y2,backendName:"webgl",kernelFunc:LIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BIe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;return xy({a:r,b:o,transposeA:i,transposeB:a,backend:n})}const zIe={kernelName:D0,backendName:"webgl",kernelFunc:BIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UIe{constructor(e,n,s,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],nt(e,n),nt(e,s);let a="0.0";r!=null&&(nt(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(nt(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VIe{constructor(e,n,s,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],nt(e,n),nt(e,s);let a="vec4(0.0)";r!=null&&(nt(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(nt(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WIe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:o,offset:i,scale:a}=t;T(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,o];let u=null;i!=null&&(u=i.shape,c.push(i));let d=null;a!=null&&(d=a.shape,c.push(a));const h=se().getBool("WEBGL_PACK_NORMALIZATION")?new VIe(s.shape,r.shape,o.shape,u,d,l):new UIe(s.shape,r.shape,o.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},HIe={kernelName:W0,backendName:"webgl",kernelFunc:WIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GIe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=_t(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=qIe(this.rank);let r;const o=e.map((i,a)=>`sourceLoc.${xS[a]} = start[${a}] + coords.${xS[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const xS=["x","y","z","w","u","v"];function qIe(t){if(t===1)return"sourceLoc";if(t<=6)return xS.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KIe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=_t(this.rank),s=Bs("coords",this.rank),r=Bs("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XIe(t,e,n,s){const r=s.texData.get(t.dataId),o=s.makeTensorInfo(n,t.dtype),i=s.texData.get(o.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=SE(e,Be(t.shape));r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),o}function Vd(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s,[a,l]=_v(r,o,i);if(bE(r,a,l),ie(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=zEe(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=CE(r.shape,a,l);if(c||!u){const d=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new KIe(l):new GIe(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),XIe(r,a,l,n)}const YIe={kernelName:vv,backendName:"webgl",kernelFunc:Vd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JIe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;T(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((v,b)=>v*b),l=lm(r.shape,o,a),c=cm(l.length,o.length),u=um(r.shape,o,a),d=IE(i,o.length),h=TE(u,i,o.length),f=[],m=Se({inputs:{x:r},backend:n,attrs:{shape:l}}),g=Ws({inputs:{x:m},backend:n,attrs:{perm:c}}),y=Se({inputs:{x:g},backend:n,attrs:{shape:u}}),x=Vd({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return f.push(m),f.push(g),f.push(y),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),x},ZIe={kernelName:O0,backendName:"webgl",kernelFunc:JIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.readSync(r.dataId),l=n.readSync(o.dataId),c=HW(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const eTe={kernelName:Z2,backendName:"webgl",kernelFunc:QIe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,nTe=`
  return float(int(a.r) & int(b.r));
`;function sTe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=se().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=se().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||i===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,d]=dEe(s.shape,r.shape,l,c,s.dtype),h=n.makeTensorInfo(d,s.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let a;return o?a=new zd(tTe,s.shape,r.shape,!1):a=new $c(nTe,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const rTe={kernelName:Q2,backendName:"webgl",kernelFunc:sTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oTe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.readSync(s.dataId),i=n.readSync(r.dataId),a=nt(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const iTe={kernelName:Kj,backendName:"webgl",kernelFunc:oTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aTe="return float(a != b);",o5=hs({opSnippet:aTe,cpuKernelImpl:DEe,dtype:"bool"}),lTe={kernelName:av,backendName:"webgl",kernelFunc:o5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sm(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ar({inputs:{x:r.complexTensorInfos.real},backend:n})}const cTe={kernelName:kN,backendName:"webgl",kernelFunc:Sm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uTe="return float(int(x));";function dTe(t,e){const n=new di(t.shape,uTe),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yS(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return Ar({inputs:{x:r},backend:n});const i=qn(r.shape),a=yS({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=kl({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const i=Sm({inputs:{input:r},backend:n}),a=yS({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!Vj(r.dtype,o)){const i=Ar({inputs:{x:r},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId).values,[a,l,c]=hEe(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,c)}if(o==="int32")return dTe(r,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",ws("bool",1)),l=o5({inputs:{a:r,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}const hTe={kernelName:mp,backendName:"webgl",kernelFunc:yS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lF="return ceil(x);",fTe=kt({opSnippet:lF,packedOpSnippet:lF,cpuKernelImpl:fEe}),pTe={kernelName:gp,backendName:"webgl",kernelFunc:fTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mTe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gTe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:o,clipValueMax:i}=s;let a;se().getBool("WEBGL_PACK_CLIP")?a=new gTe(r.shape):a=new mTe(r.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[r],r.dtype,l)}const yTe={kernelName:xp,backendName:"webgl",kernelFunc:xTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vTe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cF(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function bTe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),o=new vTe(s.shape),i=[cF(s,r.complexTensorInfos.real),cF(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const wTe={kernelName:F0,backendName:"webgl",kernelFunc:bTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CTe{constructor(e){this.outputShape=[],this.outputShape=wi(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const r=n.length,o=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class STe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=wi(e,n);const s=this.outputShape,r=s.length,o=_t(r),i=Bs("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((g,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let g=1;g<l.length;g++){const y=l[g-1];h+=`
        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${bg(a,c,y)}),
            vec2(${bg(u,c,y)}));
        }`}const f=l.length,m=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${bg(a,c,m)}),
          vec2(${bg(u,c,m)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function bg(t,e,n){const s=t.indexOf(e);return t.map((o,i)=>i===s?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nb(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ar({inputs:{x:r.complexTensorInfos.imag},backend:n})}const kTe={kernelName:gN,backendName:"webgl",kernelFunc:nb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kh(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(v=>Sm({inputs:{input:v},backend:n})),m=t.map(v=>nb({inputs:{input:v},backend:n})),g=kh(f,e,n),y=kh(m,e,n),x=kl({inputs:{real:g,imag:y},backend:n});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),m.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),x}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(w=>{const k=[-1,ie(w.shape.slice(e))];return Se({inputs:{x:w},backend:n,attrs:{shape:k}})}),m=f.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),g=wi(f.map(w=>w.shape),1),y=f[0].shape[0]===1,x=pEe(m,g,s,y),v=wi(t.map(w=>w.shape),e),b=n.makeTensorInfo(v,s,x);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const o=t.filter(f=>ie(f.shape)>0),i=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const f=i?new di(t[0].shape,Ca):new Fa(t[0].shape,Ca);return n.runWebGLProgram(f,t,s)}const a=se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const f=[];for(let g=0;g<o.length;g+=a){const y=o.slice(g,g+a);f.push(kh(y,e,n))}const m=kh(f,e,n);for(const g of f)n.disposeIntermediateTensorInfo(g);return m}if(i){const f=new STe(o.map(m=>m.shape),e);return n.runWebGLProgram(f,o,s)}const{tensors2D:l,outShape:c}=NTe(o,e,n),u=new CTe(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=Se({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function NTe(t,e,n){const s=wi(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>Se({inputs:{x:o},attrs:{shape:[-1,ie(o.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i5(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=ft(r,e[0].shape)[0],i=e.map(c=>c.shape);NE(i,o);const a=wi(e.map(c=>c.shape),o);if(ie(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>ie(c.shape)>0);return l.length===1?Ar({inputs:{x:l[0]},backend:n}):kh(l,o,n)}const ETe={kernelName:P0,backendName:"webgl",kernelFunc:i5};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a5{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,y=e.dataFormat==="channelsLast",x=y?1:2,v=y?2:3,b=y?3:1;let w="",C="";s&&(r?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:w=`
          float activation(float x) {
            ${s}
          }
        `,C="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${C}
        setOutput(result);
      }
    `}}class $Te{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l5{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Es(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<u;y++)h+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<u;y++)h+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const x=y*2;if(h+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?h+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const v=i%2===0?U2(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:h+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):v===1?h+=`
                     xC${x+1} = xTexelC${x};
                     `:h+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(h+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(h+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(h+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",m="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:o?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${m}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ITe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Es(this.outputShape.length);const{dataFormat:s}=n,r=qs(),o=s==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function c5({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",m=!1,g=!1;let y;const x=[];if(o!=null){const w=yy(o.shape,f);w!=null&&(o=Se({inputs:{x:o},backend:s,attrs:{shape:w}}),x.push(o))}if(r!=null){const w=yy(r.shape,f);w!=null&&(r=Se({inputs:{x:r},backend:s,attrs:{shape:w}}),x.push(r))}if(!((d===1||h===1)&&u>t5)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Rt(c.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,w,n.inChannels],dtype:t.dtype},k=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(gy(c.shape,C.shape),()=>`packed reshape ${c.shape} to ${C.shape} isn't free`);const N=Se({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(N);const E=xy({a:C,b:N,backend:s,transposeA:m,transposeB:g,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),$=s.texData.get(E.dataId);T($.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=k,$.shape=n.outShape,y=Ar({inputs:{x:E},backend:s}),y.shape=n.outShape,x.push(E)}else{const w=n.outHeight*n.outWidth,C=Se({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,w,n.inChannels]:[n.batchSize,n.inChannels,w]}}),k=Se({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),N=xy({a:f?C:k,b:f?k:C,transposeA:!f,transposeB:g,backend:s,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i});y=Se({inputs:{x:N},backend:s,attrs:{shape:n.outShape}}),x.push(C),x.push(k),x.push(N)}for(const w of x)s.disposeIntermediateTensorInfo(w);return y}function u5({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,m=f==="channelsLast",g=l*c*u,y=h*d,x=[n.batchSize,g,y],v=!0,b=!1,w=[];if(o!=null){const R=yy(o.shape,m);R!=null&&(o=Se({inputs:{x:o},backend:s,attrs:{shape:R}}),w.push(o))}if(r!=null){const R=yy(r.shape,m);R!=null&&(r=Se({inputs:{x:r},backend:s,attrs:{shape:R}}),w.push(r))}const C=Se({inputs:{x:e},backend:s,attrs:{shape:[1,g,ie(e.shape)/g]}});w.push(C);const k=new ITe(x,n),N=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=s.runWebGLProgram(k,[t],"float32",N),$=Se({inputs:{x:E},backend:s,attrs:{shape:x}});w.push(E),w.push($);const I=r!=null,A=o!=null,P=a==="leakyrelu",_=a?Bf(a,!0):null,U=new e5(m?$.shape:C.shape,m?C.shape:$.shape,m?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],v,b,I,_,A,P),V=m?[$,C]:[C,$];if(r&&V.push(r),A&&V.push(o),P){const R=s.makeTensorInfo([],"float32",gl(i,"float32"));V.push(R),w.push(R)}const D=s.runWebGLProgram(U,V,"float32"),W=Se({inputs:{x:D},backend:s,attrs:{shape:n.outShape}});w.push(D);for(const R of w)s.disposeIntermediateTensorInfo(R);return W}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=da(l),h=us(r.shape,o.shape,i,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=c5({x:r,filter:o,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&se().getBool("WEBGL_EXP_CONV")){const g=new l5(h),y=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(g,[r,o],"float32",y)}else if(se().getBool("WEBGL_CONV_IM2COL"))f=u5({x:r,filter:o,convInfo:h,backend:n});else{const g=new a5(h);f=n.runWebGLProgram(g,[r,o],"float32")}const m=Se({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),m}const RTe={kernelName:_0,backendName:"webgl",kernelFunc:TTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ATe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class DTe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=i?1:2,u=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class OTe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class FTe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=da(l),h=us(r.shape,u,i,1,a,c,!1,d),f=new ATe(h);return n.runWebGLProgram(f,[r,o],"float32")}const _Te={kernelName:tN,backendName:"webgl",kernelFunc:PTe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MTe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Es(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,o=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LTe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=da(c),h=us(i,o.shape,a,1,l,u,!1,d);if(se().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],m=new MTe(h);return n.runWebGLProgram(m,[r,o],"float32",f)}else{const f=new DTe(h);return n.runWebGLProgram(f,[r,o],"float32")}}const jTe={kernelName:M0,backendName:"webgl",kernelFunc:LTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,c=xl(r.shape,o.shape,i,l,a),u=new $Te(c);return n.runWebGLProgram(u,[r,o],"float32")}const zTe={kernelName:L0,backendName:"webgl",kernelFunc:BTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s,c=xl(r.shape,l,i,1,a),u=new OTe(c);return n.runWebGLProgram(u,[r,o],"float32")}const VTe={kernelName:nN,backendName:"webgl",kernelFunc:UTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WTe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s,c=xl(l,o.shape,a,1,i),u=new FTe(c);return n.runWebGLProgram(u,[r,o],"float32")}const HTe={kernelName:sN,backendName:"webgl",kernelFunc:WTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTe=Ud+`
  return cos(x);
`,qTe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Wc}
  return result;
`,KTe=kt({opSnippet:GTe,packedOpSnippet:qTe}),XTe={kernelName:yp,backendName:"webgl",kernelFunc:KTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YTe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,JTe=kt({opSnippet:YTe}),ZTe={kernelName:vp,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QTe{constructor(e,n,s,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,c]=e,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const f=r==="bilinear"?1:0,[m,g]=[`${a-1}.0`,`${l-1}.0`],[y,x,v]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[b,w,C]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${w};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eRe=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new QTe(r.shape,o.shape,a,l,c);return n.runWebGLProgram(u,[r,o,i],"float32")},tRe={kernelName:oN,backendName:"webgl",kernelFunc:eRe};var Uf;(function(t){t.Prod="*",t.Sum="+"})(Uf||(Uf={}));class uF{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===Uf.Prod?"1.0":"0.0",a=s?i:`getX(${dF(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${_t(o)} coords = getOutputCoords();
        int end = ${hF(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${hF(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${dF(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function dF(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function hF(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d5(t,e,n,s,r,o){const i=e.shape.length,a=an([s],i);let l=e;a!=null&&(l=Ws({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=bn(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=Ar({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new uF(t,l.shape,!1,o),m=[[h]],g=d;d=n.runWebGLProgram(f,[d],d.dtype,m),n.disposeIntermediateTensorInfo(g)}if(r){const h=new uF(t,l.shape,r,o),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=yl(a),f=Ws({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return d5(Uf.Prod,r,n,o,i,a)}const sRe={kernelName:rN,backendName:"webgl",kernelFunc:nRe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return d5(Uf.Sum,r,n,o,i,a)}const oRe={kernelName:j0,backendName:"webgl",kernelFunc:rRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(o.dataId),u=HW(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(o),u=uEe(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const aRe={kernelName:iN,backendName:"webgl",kernelFunc:iRe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lRe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s,a=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],c=i==="NHWC"?r.shape[2]:r.shape[3],u=i==="NHWC"?r.shape[3]:r.shape[1],d=l*o,h=c*o,f=u/(o*o),m=i==="NHWC"?[a,d,h,f]:[a,f,d,h],g=new lRe(m,o,i);return n.runWebGLProgram(g,[r],r.dtype)}const uRe={kernelName:aN,backendName:"webgl",kernelFunc:cRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h5{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Es(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f5{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Es(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<d;x++)f+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<d;x++)f+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(h+1)/2;x++){const v=x*2;if(f+=`
          xC = xCCorner + ${v*c};
          `,l===1){if(v<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,c===1&&v>0?f+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const b=a%2===0?U2(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:f+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):b===1?f+=`
                    xC${v+1} = xTexelC${v};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(f+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(f+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(f+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let m="",g="";s&&(r?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:m=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),T(ks(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=us(r.shape,o.shape,i,u,a,c,!0);let h;se().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new f5(d):h=new h5(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,o],"float32",f)}const hRe={kernelName:B0,backendName:"webgl",kernelFunc:dRe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fRe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pRe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=us(r.shape,u,i,a,l,c,!0),h=new fRe(d);return n.runWebGLProgram(h,[r,o],"float32")}const gRe={kernelName:lN,backendName:"webgl",kernelFunc:mRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xRe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=us(u,o.shape,i,a,l,c,!0),h=new pRe(d);return n.runWebGLProgram(h,[r,o],"float32")}const yRe={kernelName:cN,backendName:"webgl",kernelFunc:xRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vRe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bRe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],o=ie(s.shape),i=Se({inputs:{x:s},backend:n,attrs:{shape:[o]}}),a=new vRe(o),l=n.runWebGLProgram(a,[i],i.dtype),c=Se({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}const wRe={kernelName:Xj,backendName:"webgl",kernelFunc:bRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CRe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,c=sm(r.shape,o.shape,i,a,"NHWC",l);let u;const d=new CRe(c);u=n.runWebGLProgram(d,[r,o],"float32");const h=Se({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const kRe={kernelName:z0,backendName:"webgl",kernelFunc:SRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NRe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=ME(r,o.length);jE(i.length,l,o);const{path:c,steps:u}=BE(a,l),d=u.length;let h=null,f=i.length;const m=[];for(let g=0;g<d;++g){for(const y of u[g]){const{permutationIndices:x,expandDims:v}=LE(f,l[y]);let b;zE(x)?b=o[y]:(b=Ws({inputs:{x:o[y]},backend:n,attrs:{perm:x}}),m.push(b));const w=b.shape.slice();for(let C=0;C<v.length;++C)w.splice(v[C],0,1);Rt(b.shape,w)||(b=Se({inputs:{x:b},backend:n,attrs:{shape:w}}),m.push(b)),h===null?h=b:(h=R$({inputs:{a:b,b:h},backend:n}),m.push(h))}g<d-1&&(c[g]>=0&&(h=tb({inputs:{x:h},backend:n,attrs:{axis:c[g]-(i.length-f),keepDims:!1}}),m.push(h)),f--)}for(const g of m)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const ERe={kernelName:uN,backendName:"webgl",kernelFunc:NRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Re="return (x >= 0.0) ? x : (exp(x) - 1.0);",IRe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,TRe=kt({opSnippet:$Re,packedOpSnippet:IRe}),RRe={kernelName:wp,backendName:"webgl",kernelFunc:TRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ARe="return (b >= 0.0) ? a : a * (b + 1.0);",DRe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,ORe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,o=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zd(DRe,s.shape,r.shape):new $c(ARe,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],s.dtype)},FRe={kernelName:dN,backendName:"webgl",kernelFunc:ORe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PRe=`
  return vec4(equal(a, b));
`,_Re="return float(a == b);",MRe=hs({opSnippet:_Re,packedOpSnippet:PRe,dtype:"bool",cpuKernelImpl:mEe}),LRe={kernelName:U0,backendName:"webgl",kernelFunc:MRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jRe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${RE};
  float a1 = ${AE};
  float a2 = ${DE};
  float a3 = ${OE};
  float a4 = ${FE};
  float a5 = ${PE};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,BRe=kt({opSnippet:jRe}),zRe={kernelName:Cp,backendName:"webgl",kernelFunc:BRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const URe=Ud+`
  return exp(x);
`,VRe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,p5=kt({opSnippet:URe,packedOpSnippet:VRe,cpuKernelImpl:gEe,dtype:"float32"}),WRe={kernelName:Sp,backendName:"webgl",kernelFunc:p5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vS(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(T(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),Se({inputs:{x:o},backend:s,attrs:{shape:a}})}const HRe={kernelName:V0,backendName:"webgl",kernelFunc:vS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fF="return exp(x) - 1.0;",GRe=kt({opSnippet:fF,packedOpSnippet:fF,cpuKernelImpl:xEe}),qRe={kernelName:kp,backendName:"webgl",kernelFunc:GRe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pF{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const o=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(t,e,n){const s=n.texData.get(t.dataId),r=ie(t.shape),o=t.shape[t.shape.length-1],i=r/o,a=Se({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,c=new pF("real",l,e),u=new pF("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),m=kl({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const g=Se({inputs:{x:m},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(m),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KRe(t){const{inputs:e,backend:n}=t,{input:s}=e;return m5(s,!1,n)}const XRe={kernelName:hN,backendName:"webgl",kernelFunc:KRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YRe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function km(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:o}=n;if(o=o||$d(r),o==="string"){const i=gn(o,ie(s));return i.fill(r),e.makeTensorInfo(s,o,i)}else{const i=new YRe(s,r),a=[[r]];return e.runWebGLProgram(i,[],o,a)}}const JRe={kernelName:fN,backendName:"webgl",kernelFunc:km};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZRe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QRe={kernelName:pN,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new ZRe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mF="return floor(x);",eAe=kt({opSnippet:mF,packedOpSnippet:mF,cpuKernelImpl:yEe}),tAe={kernelName:Np,backendName:"webgl",kernelFunc:eAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nAe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,sAe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,rAe=hs({opSnippet:nAe,packedOpSnippet:sAe,dtype:"int32"}),oAe={kernelName:Ep,backendName:"webgl",kernelFunc:rAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iAe{constructor(e){this.variableNames=["A"];const n=qs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aAe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=qs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lAe={kernelName:kue,backendName:"webgl",kernelFunc:cAe};let nu,J1=se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function cAe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:o}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,o];if(a||i){const g=se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(nu==null||g!==J1)&&(J1=g,nu=document.createElement("canvas").getContext("2d",{willReadFrequently:J1})),nu.canvas.width=l,nu.canvas.height=c,nu.drawImage(r,0,0,l,c),r=nu.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=Ur.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=se().getBool("WEBGL_PACK")?new aAe(d):new iAe(d),m=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:m}=s,g=da(u),y=us(r.shape,o.shape,l,d,c,h,!1,g);let x;const v=[],b=i!=null,w=a!=null,C=f==="leakyrelu",k=()=>{const E=[r,o],$=(I,A)=>{if(A==="NCHW"&&I.shape.length===1&&I.shape[0]!==1){const P=Se({inputs:{x:I},backend:n,attrs:{shape:[I.shape[0],1,1]}});return v.push(P),P}return I};if(b&&E.push($(i,u)),w&&E.push($(a,u)),C){const I=n.makeTensorInfo([],"float32",gl(m,"float32"));E.push(I),v.push(I)}return E};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))x=c5({x:r,filter:o,convInfo:y,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:m});else if(y.strideWidth<=2&&g==="channelsLast"&&se().getBool("WEBGL_EXP_CONV")){const E=f?Bf(f,!0):null,$=new l5(y,b,E,w,C),I=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],A=k();x=n.runWebGLProgram($,A,"float32",I)}else if(se().getBool("WEBGL_CONV_IM2COL"))x=u5({x:r,filter:o,convInfo:y,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:m});else{const E=f?Bf(f,!1):null,$=new a5(y,b,E,w,C),I=k();x=n.runWebGLProgram($,I,"float32")}const N=Se({inputs:{x},backend:n,attrs:{shape:y.outShape}});return v.push(x),v.forEach(E=>n.disposeIntermediateTensorInfo(E)),N}const dAe={kernelName:qx,backendName:"webgl",kernelFunc:uAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,m=[];let g=u;g==null&&(g=[1,1]),T(ks(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=us(r.shape,o.shape,l,g,c,d,!0),x=se().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,v=h?Bf(h,x):null,b=[r,o],w=i!=null,C=a!=null,k=h==="leakyrelu";if(w&&b.push(i),C&&b.push(a),k){const I=n.makeTensorInfo([],"float32",gl(f,"float32"));b.push(I),m.push(I)}let N;x?N=new f5(y,w,v,C,k):N=new h5(y,w,v,C,k);const E=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],$=n.runWebGLProgram(N,b,"float32",E);return m.forEach(I=>n.disposeIntermediateTensorInfo(I)),$}const fAe={kernelName:pB,backendName:"webgl",kernelFunc:hAe};class pAe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const o=_t(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mAe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=r.shape,i=o[o.length-1],a=ie(s.shape),[l,c,u,d]=vE(s,r),h=Se({inputs:{x:r},backend:n,attrs:{shape:[c,i]}}),f=Se({inputs:{x:s},backend:n,attrs:{shape:[ie(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const x=n.readSync(r.dataId),v=n.bufferSync(s),b=vEe(x,v,s.dtype,c,i,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,b.values)}const m=new pAe(i,d,[c,u],s.shape),g=n.runWebGLProgram(m,[f,h],f.dtype),y=Se({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}const gAe={kernelName:Yj,backendName:"webgl",kernelFunc:mAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xAe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=_t(this.rank),r=yAe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function yAe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g5(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s,l=ft(i,r.shape)[0];if(se().get("DEBUG")){const v=n.readSync(o.dataId),b=r.shape[l];for(let w=0;w<v.length;++w){const C=v[w];T(C<=b-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${b-1}]`)}}const c=VE(r,o,l,a),u=ie(o.shape),d=[],h=Se({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=Se({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const m=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const v=n.bufferSync(f),b=n.bufferSync(h),w=bEe(b,v,m);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(c.outputShape,w.dtype,w.values)}const g=new xAe(h.shape,m),y=n.runWebGLProgram(g,[h,f],h.dtype);d.push(y);const x=Se({inputs:{x:y},backend:n,attrs:{shape:c.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),x}const vAe={kernelName:H0,backendName:"webgl",kernelFunc:g5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bAe="return float(a > b);",wAe=`
  return vec4(greaterThan(a, b));
`,CAe=hs({opSnippet:bAe,packedOpSnippet:wAe,cpuKernelImpl:wEe,dtype:"bool"}),SAe={kernelName:G0,backendName:"webgl",kernelFunc:CAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kAe="return float(a >= b);",NAe=`
  return vec4(greaterThanEqual(a, b));
`,EAe=hs({opSnippet:kAe,packedOpSnippet:NAe,dtype:"bool",cpuKernelImpl:CEe}),$Ae={kernelName:$p,backendName:"webgl",kernelFunc:EAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IAe(t){const{inputs:e,backend:n}=t,{input:s}=e;return m5(s,!0,n)}const TAe={kernelName:mN,backendName:"webgl",kernelFunc:IAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RAe="return float(!isnan(x) && !isinf(x));",AAe=kt({opSnippet:RAe,dtype:"bool"}),DAe={kernelName:Tp,backendName:"webgl",kernelFunc:AAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OAe="return float(isinf(x));",FAe=kt({opSnippet:OAe,dtype:"bool"}),PAe={kernelName:Rp,backendName:"webgl",kernelFunc:FAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ae="return float(isnan(x));",MAe=kt({opSnippet:_Ae,dtype:"bool"}),LAe={kernelName:Ap,backendName:"webgl",kernelFunc:MAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jAe="return float(a < b);",BAe=`
  return vec4(lessThan(a, b));
`,zAe=hs({opSnippet:jAe,packedOpSnippet:BAe,cpuKernelImpl:SEe,dtype:"bool"}),UAe={kernelName:K0,backendName:"webgl",kernelFunc:zAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VAe="return float(a <= b);",WAe=`
  return vec4(lessThanEqual(a, b));
`,HAe=hs({opSnippet:VAe,packedOpSnippet:WAe,cpuKernelImpl:kEe,dtype:"bool"}),GAe={kernelName:X0,backendName:"webgl",kernelFunc:HAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qAe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=NEe(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const KAe={kernelName:Jj,backendName:"webgl",kernelFunc:qAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XAe=Ud+`
  return x < 0.0 ? 0./0. : log(x);
`,YAe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,JAe=kt({opSnippet:XAe,packedOpSnippet:YAe,cpuKernelImpl:EEe}),ZAe={kernelName:Dp,backendName:"webgl",kernelFunc:JAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QAe=Ud+`
  return log(1.0 + x);
`,eDe=kt({opSnippet:QAe}),tDe={kernelName:Op,backendName:"webgl",kernelFunc:eDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nDe="return float(a >= 1.0 && b >= 1.0);",sDe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,rDe=hs({opSnippet:nDe,packedOpSnippet:sDe,dtype:"bool"}),oDe={kernelName:Y0,backendName:"webgl",kernelFunc:rDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iDe="return float(!(x >= 1.0));",aDe=kt({opSnippet:iDe}),lDe={kernelName:J0,backendName:"webgl",kernelFunc:aDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cDe="return float(a >= 1.0 || b >= 1.0);",uDe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dDe=hs({opSnippet:cDe,packedOpSnippet:uDe,dtype:"bool"}),hDe={kernelName:Z0,backendName:"webgl",kernelFunc:dDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fDe{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pDe{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mDe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s,c=se().getBool("WEBGL_PACK_NORMALIZATION")?new pDe(r.shape,o,i,a,l):new fDe(r.shape,o,i,a,l);return n.runWebGLProgram(c,[r],r.dtype)},gDe={kernelName:Q0,backendName:"webgl",kernelFunc:mDe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xDe{constructor(e,n,s,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yDe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new xDe(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,o,i],r.dtype)},vDe={kernelName:xN,backendName:"webgl",kernelFunc:yDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bDe(t,e,n,s){const r=ie(e),i=ie(t.shape)/r,a=Se({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Hc(a,t.dtype,"max",s),c=Se({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=r.shape.length,l=ft(o,r.shape);let c=l;const u=an(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const b=n.texData.get(f.dataId).values,w=new Array(a);for(let N=0;N<w.length;N++)w[N]=r.shape[u[N]];const C=I$(b,r.shape,r.dtype,u,w);f=n.makeTensorInfo(w,r.dtype);const k=n.texData.get(f.dataId);k.values=C}else f=eb(r,u,n);c=bn(c.length,a)}ds("max",c,a);const[m,g]=Yn(f.shape,c);let y=m;i&&(y=An(m,l));let x;if(h){const b=n.texData.get(f.dataId).values,w=$Ee(b,ie(g),y,r.dtype);x=n.makeTensorInfo(y,r.dtype);const C=n.texData.get(x.dataId);C.values=w}else x=bDe(f,g,y,n);return d&&n.disposeIntermediateTensorInfo(f),x}const wDe={kernelName:ev,backendName:"webgl",kernelFunc:x5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CDe=T$+`
  return max(a, b);
`,SDe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Wc+`
  return result;
`,kDe=hs({opSnippet:CDe,packedOpSnippet:SDe,cpuKernelImpl:IEe}),NDe={kernelName:Fp,backendName:"webgl",kernelFunc:kDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;wm(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(ks(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=No(r.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Rt(u.inShape,u.outShape))return Ar({inputs:{x:r},backend:n});const d=new zf(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const $De={kernelName:tv,backendName:"webgl",kernelFunc:EDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=ua(r.shape,o,i,u,a,c,l),h=new A$(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const TDe={kernelName:nv,backendName:"webgl",kernelFunc:IDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RDe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,c=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class ADe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,m=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=ua(i.shape,a,l,d,c,u),f=new A$(h,"max",!0),m=n.runWebGLProgram(f,[i],i.dtype),g=new ADe(h),y=n.runWebGLProgram(g,[r,m],i.dtype);return n.disposeIntermediateTensorInfo(m),y}const ODe={kernelName:vN,backendName:"webgl",kernelFunc:DDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FDe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;wm([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=No(a.shape,l,c,1,u,d),f=!0,m=new zf(h,"max",f),g=n.runWebGLProgram(m,[a],a.dtype),y=new RDe(h),x=n.runWebGLProgram(y,[r,g],a.dtype);return n.disposeIntermediateTensorInfo(g),x}const PDe={kernelName:yN,backendName:"webgl",kernelFunc:FDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _De(t,e,n,s){let r=new zf(n,"max",!1);const o=s.runWebGLProgram(r,[t],"float32");r=new zf(n,"max",!0,!0,e);const i=s.runWebGLProgram(r,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MDe={kernelName:Zj,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;T(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];T(ks(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=No(s.shape,r,o,c,i),[d,h]=_De(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDe(t,e,n,s){const r=ie(e),i=ie(t.shape)/r,a=Se({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Hc(a,"float32","mean",s),c=Se({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jDe={kernelName:sv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:o}=e,i=n,a=s.shape.length,l=ft(o,s.shape);let c=l;const u=an(c,a),d=u!=null,h=i.shouldExecuteOnCPU([s]),f=[];let m=s;if(d){if(h){const w=i.texData.get(m.dataId).values,C=new Array(a);for(let E=0;E<C.length;E++)C[E]=s.shape[u[E]];const k=I$(w,s.shape,s.dtype,u,C);m=i.makeTensorInfo(C,s.dtype);const N=i.texData.get(m.dataId);N.values=k}else m=eb(s,u,i);f.push(m),c=bn(c.length,a)}ds("sum",c,a);const[g,y]=Yn(m.shape,c);let x=g;r&&(x=An(g,l));const v=LDe(m,y,x,i);for(const b of f)i.disposeIntermediateTensorInfo(b);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=ft(o,r.shape);let c=l;const u=an(c,a);let d=r;u!=null&&(d=Ws({inputs:{x:r},backend:n,attrs:{perm:u}}),c=bn(c.length,r.shape.length)),ds("min",c,a);const[h,f]=Yn(d.shape,c),m=ie(f),g=Se({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),y=Hc(g,g.dtype,"min",n);let x;if(i){const v=An(h,l);x=Se({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=Se({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),x}const zDe={kernelName:rv,backendName:"webgl",kernelFunc:BDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UDe=T$+`
  return min(a, b);
`,VDe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Wc+`
  return result;
`,WDe=hs({opSnippet:UDe,packedOpSnippet:VDe,cpuKernelImpl:TEe}),HDe={kernelName:Pp,backendName:"webgl",kernelFunc:WDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GDe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,o=_t(r),i=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qDe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const r=e.length,o=_t(r),i=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=Bs("rc",r),c=Bs("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const m=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${m}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const m=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${m}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${m}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${m}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KDe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:o}=n,i=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qDe(s.shape,r,o):new GDe(s.shape,r,o);return e.runWebGLProgram(i,[s],s.dtype)},XDe={kernelName:ov,backendName:"webgl",kernelFunc:KDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YDe=`if (b == 0.0) return NAN;
  return mod(a, b);`,JDe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Wc+`
  return result;
`,ZDe=hs({opSnippet:YDe,packedOpSnippet:JDe}),QDe={kernelName:_p,backendName:"webgl",kernelFunc:ZDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eOe{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tOe=`
if (a == b) {
  return 1.0;
};
return a / b;`,nOe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,y5=hs({opSnippet:tOe,packedOpSnippet:nOe,checkOutOfBounds:!0}),sOe={kernelName:bp,backendName:"webgl",kernelFunc:y5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gF="return a - b;",v5=hs({opSnippet:gF,packedOpSnippet:gF,supportsComplex:!0,cpuKernelImpl:YEe}),rOe={kernelName:Zp,backendName:"webgl",kernelFunc:v5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b5(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=ft([o],r.shape),a=x5({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=An(a.shape,i),c=Se({inputs:{x:a},backend:n,attrs:{shape:l}}),u=v5({inputs:{a:r,b:c},backend:n}),d=p5({inputs:{x:u},backend:n}),h=tb({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),f=Se({inputs:{x:h},backend:n,attrs:{shape:l}}),m=y5({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}const oOe={kernelName:Sv,backendName:"webgl",kernelFunc:b5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iOe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s,l=a?r:b5({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new eOe(c,u,o),h=[[i]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const aOe={kernelName:Qj,backendName:"webgl",kernelFunc:iOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lOe=$o+`
  return -x;
`,cOe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function uOe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId),[i,a]=AEe(o.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,i)}let r;return se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Fa(s.shape,cOe):r=new di(s.shape,lOe),n.runWebGLProgram(r,[s],s.dtype)}const dOe={kernelName:iv,backendName:"webgl",kernelFunc:uOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hOe=pE;function fOe(t){jr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(o.dataId),{selectedIndices:d}=hOe(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const pOe={kernelName:bN,backendName:"webgl",kernelFunc:fOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mOe=mE;function gOe(t){jr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(o.dataId),{selectedIndices:h,validOutputs:f}=mOe(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const xOe={kernelName:wN,backendName:"webgl",kernelFunc:gOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yOe=gE;function vOe(t){jr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(o.dataId),h=i,f=a,m=l,g=c,{selectedIndices:y,selectedScores:x}=yOe(u,d,h,f,m,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const bOe={kernelName:CN,backendName:"webgl",kernelFunc:vOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wOe{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const COe=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s,c=ie(r.shape),u=new wOe(c,i,a,l),d=Se({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],o);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,i],m=Se({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),m},SOe={kernelName:cv,backendName:"webgl",kernelFunc:COe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vy(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=Sm({inputs:{input:s},backend:n}),o=vy({inputs:{x:r},backend:n}),i=nb({inputs:{input:s},backend:n}),a=vy({inputs:{x:i},backend:n}),l=kl({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return km({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const kOe={kernelName:Ev,backendName:"webgl",kernelFunc:vy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Sm({inputs:{input:s},backend:n}),o=w5({inputs:{x:r},backend:n}),i=nb({inputs:{input:s},backend:n}),a=vy({inputs:{x:i},backend:n}),l=kl({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return km({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const NOe={kernelName:lv,backendName:"webgl",kernelFunc:w5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EOe(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return vS({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(u=>{V2(o,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=vS({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=i5({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const $Oe={kernelName:uv,backendName:"webgl",kernelFunc:EOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IOe{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,o=_t(r),i=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TOe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,y)=>g[0]+e[y]+g[1]);const r=e.length,o=_t(r),i=n.map(g=>g[0]).join(","),a=n.map((g,y)=>g[0]+e[y]).join(","),l=Bs("rc",r),c=Bs("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let m="";for(let g=0,y=r===1?2:4;g<y;g++)m+=`
        ${h[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${g}] = getChannel(getX(${c.join()}), ${d});
        }
      `;m+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C5=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;if(ie(r.shape)===0){const c=o.map((u,d)=>u[0]+r.shape[d]+u[1]);return km({backend:n,attrs:{shape:c,value:i,dtype:r.dtype}})}const a=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TOe(r.shape,o,i):new IOe(r.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[r],r.dtype,l)},ROe={kernelName:dv,backendName:"webgl",kernelFunc:C5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AOe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,DOe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Wc+`
  return result;
`,OOe=hs({opSnippet:AOe,packedOpSnippet:DOe}),FOe={kernelName:Lp,backendName:"webgl",kernelFunc:OOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=[],c=ft(o,r.shape);let u=c;const d=an(u,a);let h=r;d!=null&&(h=Ws({inputs:{x:r},backend:n,attrs:{perm:d}}),u=bn(u.length,a),l.push(h)),ds("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const m=n.texData.get(h.dataId).values,{outVals:g,outShape:y,outDtype:x}=OEe(h.shape,h.dtype,m,u);f=n.makeTensorInfo(y,x,g)}else{const[m,g]=Yn(h.shape,u),y=ie(g),x=Se({inputs:{x:h},backend:n,attrs:{shape:[-1,y]}}),v=PN(r.dtype),b=Hc(x,v,"prod",n);f=Se({inputs:{x:b},backend:n,attrs:{shape:m}}),l.push(x),l.push(b)}if(i){l.push(f);const m=An(f.shape,c);f=Se({inputs:{x:f},backend:n,attrs:{shape:m}})}return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const _Oe={kernelName:fv,backendName:"webgl",kernelFunc:POe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MOe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(x=>n.readSync(x.dataId)),c=r.map(x=>x.shape),u=n.readSync(o.dataId),d=n.readSync(i.dataId),[h,f,m]=FEe(l,c,u,o.shape,o.dtype,d,i.shape,a),g=h.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(m,o.dtype,f);return g.concat([y])}const LOe={kernelName:eB,backendName:"webgl",kernelFunc:MOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jOe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=PEe(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const BOe={kernelName:tB,backendName:"webgl",kernelFunc:jOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zOe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(o.dataId),d=n.readSync(i.dataId),h=a.map(y=>n.readSync(y.dataId)),f=a.map(y=>y.shape),[m,g]=_Ee(c,r.shape,u,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(m,o.dtype,g)}const UOe={kernelName:nB,backendName:"webgl",kernelFunc:zOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:o,dtype:i}=n,a=MEe(s,r,o,i);return e.makeTensorInfo([a.length],i,a)},VOe={kernelName:SN,backendName:"webgl",kernelFunc:S5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WOe="return 1.0 / x;",HOe=kt({opSnippet:WOe}),GOe={kernelName:jp,backendName:"webgl",kernelFunc:HOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qOe=$o+`
  return (x < 0.0) ? 0.0 : x;
`,KOe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XOe=kt({opSnippet:qOe,packedOpSnippet:KOe}),YOe={kernelName:Bp,backendName:"webgl",kernelFunc:XOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JOe=$o+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ZOe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,QOe=kt({opSnippet:JOe,packedOpSnippet:ZOe}),eFe={kernelName:zp,backendName:"webgl",kernelFunc:QOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tFe{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nFe{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,c]=a,u=se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new nFe(r.shape,l,c,o,i):new tFe(r.shape,l,c,o,i);return n.runWebGLProgram(u,[r],"float32")}const rFe={kernelName:gv,backendName:"webgl",kernelFunc:sFe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oFe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,m=Math.ceil(h)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iFe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new oFe(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const aFe={kernelName:EN,backendName:"webgl",kernelFunc:iFe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lFe{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cFe{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uFe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,c]=a,u=se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new cFe(r.shape,l,c,o,i):new lFe(r.shape,l,c,o,i);return n.runWebGLProgram(u,[r],r.dtype)}const dFe={kernelName:mv,backendName:"webgl",kernelFunc:uFe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hFe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,m=Math.ceil(h)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fFe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new hFe(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const pFe={kernelName:NN,backendName:"webgl",kernelFunc:fFe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mFe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>r(l)).join(","),i=_t(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gFe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=Bs("rc",s),o=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=_t(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${c(r.slice())};
          }
          if(${i}) {
            result.b = ${u(r.slice())};
            if(${o}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(m){return h(m)}function c(m){return m[s-1]="("+m[s-1]+" + 1)",h(m)}function u(m){return m[s-2]="("+m[s-2]+" + 1)",h(m)}function d(m){return m[s-1]="("+m[s-1]+" + 1)",m[s-2]="("+m[s-2]+" + 1)",h(m)}function h(m){const g=e.map((v,b)=>f(b,m)),y=g.join(","),x=g.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${x}))`}function f(m,g){return n.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${g[m]} - 1`:`${g[m]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xFe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s,i=r.shape.length,a=ft(o,r.shape);if(i===0)return Ar({inputs:{x:r},backend:n});const l=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new gFe(r.shape,a):new mFe(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const yFe={kernelName:xv,backendName:"webgl",kernelFunc:xFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vFe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bFe={kernelName:ON,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=new vFe(s.shape,o),[c,u]=$E(i,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wFe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,CFe=kt({opSnippet:wFe}),SFe={kernelName:Up,backendName:"webgl",kernelFunc:CFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kFe="return inversesqrt(x);",NFe=kt({opSnippet:kFe,cpuKernelImpl:LEe}),EFe={kernelName:Vp,backendName:"webgl",kernelFunc:NFe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D${constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const c=_t(o.length),u=_t(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const m=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Fe{constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const c=_t(o.length),u=_t(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const m=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${m};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IFe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=jc(o,r,i),h=[d/c,c];if(d===0)return n.makeTensorInfo(i,r.dtype);const f=Se({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),m=Se({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;se().getBool("WEBGL_PACK")?y=new $Fe(l,a,f.shape.length,m.shape.length,u,h):y=new D$(l,a,f.shape.length,m.shape.length,u,h);const x=n.runWebGLProgram(y,[m,f,g],m.dtype),v=Se({inputs:{x},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(g),v}const TFe={kernelName:sB,backendName:"webgl",kernelFunc:IFe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RFe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=se().getNumber("WEBGL_VERSION")===2?o:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AFe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=new RFe(r.shape[0],r.shape[1],o.shape[1],i),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,o],"int32",l)}const DFe={kernelName:oB,backendName:"webgl",kernelFunc:AFe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OFe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,o;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)o="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),o=c.join()}const i=_t(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FFe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e,i=new OFe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[s,r,o],Tr(r.dtype,o.dtype))}const PFe={kernelName:yv,backendName:"webgl",kernelFunc:FFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Fe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Lv};
  float scale = ${jv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,MFe=kt({opSnippet:_Fe}),LFe={kernelName:Wp,backendName:"webgl",kernelFunc:MFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jFe=Ud+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,BFe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zFe=kt({opSnippet:jFe,packedOpSnippet:BFe,cpuKernelImpl:BEe}),UFe={kernelName:Kp,backendName:"webgl",kernelFunc:zFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VFe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,WFe=kt({opSnippet:VFe}),HFe={kernelName:qp,backendName:"webgl",kernelFunc:WFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GFe=Ud+`
  return sin(x);
`,qFe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Wc}
  return result;
`,KFe=kt({opSnippet:GFe,packedOpSnippet:qFe}),XFe={kernelName:Hp,backendName:"webgl",kernelFunc:KFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YFe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,JFe=kt({opSnippet:YFe}),ZFe={kernelName:Gp,backendName:"webgl",kernelFunc:JFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QFe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,e3e=kt({opSnippet:QFe}),t3e={kernelName:Xp,backendName:"webgl",kernelFunc:e3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;T(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((x,v)=>x*v),l=[[0,0]];l.push(...i);for(let x=1+o.length;x<r.shape.length;++x)l.push([0,0]);const c=[],u=C5({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=lm(u.shape,o,a,!1),h=cm(d.length,o.length,!1),f=um(u.shape,o,a,!1),m=Se({inputs:{x:u},backend:n,attrs:{shape:d}}),g=Ws({inputs:{x:m},backend:n,attrs:{perm:h}}),y=Se({inputs:{x:g},backend:n,attrs:{shape:f}});return c.push(u),c.push(m),c.push(g),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),y},s3e={kernelName:wv,backendName:"webgl",kernelFunc:n3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3e(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(o.dataId),u=n.readSync(i.dataId)[0],[d,h,f,m,g]=UEe(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const o3e={kernelName:iB,backendName:"webgl",kernelFunc:r3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3e(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(o.dataId)),[c,u,d]=VEe(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const a3e={kernelName:aB,backendName:"webgl",kernelFunc:i3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=qW(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const c3e={kernelName:lB,backendName:"webgl",kernelFunc:l3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=qW(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const d3e={kernelName:cB,backendName:"webgl",kernelFunc:u3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3e(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=jc(o,r,a),f=!1;if(o.dtype==="string"){const x=n.bufferSync(r),v=n.bufferSync(o),b=nl(n.readSync(i.dataId)[0]),w=jEe(x,v,a,h,u,c,l,d,b,f);return n.makeTensorInfo(a,w.dtype,w.values)}const m=new D$(c,l,r.shape.length,o.shape.length,d,[h,1],f),g=n.runWebGLProgram(m,[o,r,i],o.dtype),y=Se({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),y}const f3e={kernelName:uB,backendName:"webgl",kernelFunc:h3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=ft(i,r.shape)[0],l=UE(r,o,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const m=Vd({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,m})}const m3e={kernelName:Cv,backendName:"webgl",kernelFunc:p3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xF="return sqrt(x);",g3e=kt({opSnippet:xF,packedOpSnippet:xF,cpuKernelImpl:WEe}),x3e={kernelName:Yp,backendName:"webgl",kernelFunc:g3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y3e="return x * x;",v3e=kt({opSnippet:y3e}),b3e={kernelName:$N,backendName:"webgl",kernelFunc:v3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yF="return (a - b) * (a - b);",w3e=hs({opSnippet:yF,packedOpSnippet:yF}),C3e={kernelName:Jp,backendName:"webgl",kernelFunc:w3e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(r.dataId),i=ra(o),a=HEe(i,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const k3e={kernelName:IN,backendName:"webgl",kernelFunc:S3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3e({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=$o+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new di(s.shape,r);return n.runWebGLProgram(o,[s],s.dtype)}const E3e={kernelName:nm,backendName:"webgl",kernelFunc:N3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $3e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,o=_t(s.length),i=_t(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:y,isSimpleSlice:x,begin:v,end:b,strides:w}=kE(r.shape,o,i,a,l,c,u,d,h);let C;if(g)C=Se({inputs:{x:r},backend:n,attrs:{shape:m}});else if(y||x){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const N=wE(v,b,w),E=Vd({inputs:{x:r},backend:n,attrs:{begin:v,size:N}});C=Se({inputs:{x:E},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([r])){const E=n.readSync(r.dataId),$=ht(r.shape,r.dtype,E),I=GEe(f,$,w,v);C=n.makeTensorInfo(m,r.dtype,I.values)}else{const E=new $3e(v,w,f);C=n.runWebGLProgram(E,[r],r.dtype)}const k=Se({inputs:{x:C},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(C),k}const T3e={kernelName:TN,backendName:"webgl",kernelFunc:I3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[m,g]=qEe(h,f,r,o,i,a,l,c);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",g)]}const A3e={kernelName:dB,backendName:"webgl",kernelFunc:R3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[c,u,d]=KEe(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const O3e={kernelName:hB,backendName:"webgl",kernelFunc:D3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=XEe(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const P3e={kernelName:fB,backendName:"webgl",kernelFunc:F3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _3e="return tan(x);",M3e=kt({opSnippet:_3e}),L3e={kernelName:Qp,backendName:"webgl",kernelFunc:M3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j3e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,B3e=kt({opSnippet:j3e}),z3e={kernelName:em,backendName:"webgl",kernelFunc:B3e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3e(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=jc(i,o,r.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,o.dtype);const f=Se({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),m=Se({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),g=Se({inputs:{x:r},backend:n,attrs:{shape:h}}),y=new D$(l,a,f.shape.length,m.shape.length,u,h,!1,!0),x=n.runWebGLProgram(y,[m,f,g],g.dtype),v=Se({inputs:{x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),v}const V3e={kernelName:rB,backendName:"webgl",kernelFunc:U3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W3e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const r=_t(this.rank),o=H3e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function H3e(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k5(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>nl(h)):l,u=ht(r.shape,r.dtype,c),d=JEe(u,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new W3e(r.shape,o);return n.runWebGLProgram(i,[r],r.dtype)}const G3e={kernelName:tm,backendName:"webgl",kernelFunc:k5};class q3e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class K3e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function vF(t){let e=1;for(;e<t;)e*=2;return e}function X3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s,a=se().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=se().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||o>l){const I=n.readSync(r.dataId),[A,P]=ZEe(I,c,r.dtype,o,i);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(P.shape,P.dtype,P.values)]}if(o===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,km({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,g=ie(c)/u,y=Se({inputs:{x:f},attrs:{shape:[g,u]},backend:n});h&&Il(n,f);const x=vF(o),v=vF(u);let b=null;const w=()=>b===null?[y,y]:[y,b],C=(I,A,P)=>{const _=w(),U=new q3e(P),D=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[I],[A]],W=b;b=n.runWebGLProgram(U,_,"int32",D),Il(n,W)};for(let I=1;I<x;I*=2){const A=I*2;for(let P=I;P>=1;P/=2)C(A,P,[g,v])}for(let I=v;I>x;I/=2){const A=w(),P=new K3e([g,I/2]),U=[[u],[b===null?1:0],[x]],V=b;b=n.runWebGLProgram(P,A,"int32",U),Il(n,V);const D=x/2,W=D*2;for(let R=D;R>=1;R/=2)C(W,R,b.shape)}let k=b;b=Vd({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,o]}}),Il(n,k);let N=g5({inputs:{x:y,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Il(n,y);const E=c.slice(0,-1);E.push(o),k=b,b=Se({inputs:{x:b},attrs:{shape:E},backend:n}),Il(n,k);const $=N;return N=Se({inputs:{x:N},attrs:{shape:E},backend:n}),Il(n,$),[N,b]}const Y3e={kernelName:RN,backendName:"webgl",kernelFunc:X3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J3e{constructor(e,n,s,r,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,f]=r.shape,[m,g]=c??[d,h],y=[u,m,g,f],x=new J3e(d,h,i,a,l,y);return n.runWebGLProgram(x,[r,o],"float32")}const Q3e={kernelName:AN,backendName:"webgl",kernelFunc:Z3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ePe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;wm(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(o.dataId),{outputValues:a,outputShape:l,indices:c}=QEe(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const tPe={kernelName:DN,backendName:"webgl",kernelFunc:ePe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nPe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r,a=i.shape.length,l=r.shape[o],c=new Array(a-1);let u=0;for(let g=0;g<a;g++)g!==o&&(c[u++]=i.shape[g]);const d=[],h=new Array(a).fill(0),f=i.shape.slice();f[o]=1;const m=new Array(l);for(let g=0;g<m.length;g++){h[o]=g;const y=Vd({inputs:{x:i},backend:n,attrs:{begin:h,size:f}}),x=Se({inputs:{x:y},backend:n,attrs:{shape:c}});m[g]=x,d.push(y)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const sPe={kernelName:kv,backendName:"webgl",kernelFunc:nPe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rPe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";o%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let m="";o%s>0&&(m=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s,a=r.shape.length,l=[];let c=0;const u=an([c],a);let d=r;u!=null&&(d=Ws({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=bn(1,a)[0]);const h=aU(d.shape,c,i),f=ie([d.shape[c]]),m=Se({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(m);const g=PN(r.dtype),y=(w,C,k,N,E)=>{const $=w.shape[0],I=w.shape[1],A=iU(I,E),P={windowSize:A,inSize:I,batchSize:$,numSegments:E},_=new rPe(P,C),U=n.compileAndRun(_,[w,k],N);if(l.push(U),U.shape[1]===E)return U;const V=S5({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),D=k5({inputs:{x:V},backend:n,attrs:{reps:[I/A]}});return l.push(V),l.push(D),y(U,C,D,N,E)},x=y(m,"unsortedSegmentSum",o,g,i),v=Se({inputs:{x},backend:n,attrs:{shape:h}});let b=v;if(u!=null){l.push(v);const w=yl(u);b=Ws({inputs:{x:b},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const iPe={kernelName:Nv,backendName:"webgl",kernelFunc:oPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aPe=[W$e,G$e,X$e,Z$e,eIe,sIe,oIe,aIe,dIe,fIe,gIe,vIe,CIe,EIe,TIe,AIe,OIe,MIe,jIe,zIe,HIe,ZIe,eTe,rTe,iTe,hTe,pTe,yTe,$$e,wTe,ETe,RTe,_Te,jTe,zTe,VTe,HTe,XTe,ZTe,tRe,sRe,oRe,aRe,uRe,hRe,gRe,yRe,wRe,kRe,ERe,RRe,FRe,LRe,zRe,WRe,HRe,qRe,XRe,JRe,QRe,tAe,oAe,lAe,dAe,fAe,gAe,vAe,SAe,$Ae,E$e,TAe,kTe,DAe,PAe,LAe,T$e,UAe,GAe,KAe,ZAe,tDe,oDe,lDe,hDe,gDe,vDe,wDe,NDe,$De,TDe,ODe,PDe,MDe,jDe,zDe,HDe,XDe,QDe,aOe,D$e,dOe,pOe,xOe,bOe,lTe,SOe,NOe,$Oe,ROe,FOe,A$e,_Oe,LOe,BOe,UOe,VOe,cTe,sOe,GOe,YOe,eFe,F$e,rFe,aFe,dFe,pFe,yFe,bFe,SFe,EFe,TFe,DFe,PFe,LFe,UFe,HFe,XFe,ZFe,YIe,oOe,t3e,s3e,o3e,a3e,c3e,d3e,f3e,m3e,x3e,b3e,C3e,k3e,E3e,T3e,A3e,O3e,P3e,rOe,z$e,L3e,z3e,V3e,G3e,Y3e,Q3e,U$e,tPe,sPe,iPe,kOe];for(const t of aPe)mB(t);class lPe{constructor(){this.model=null,this.userEmbedding=null,this.itemEmbedding=null,this.initialized=!1}async initialize(e,n,s=50){const r=AO({shape:[1]}),o=MO({inputDim:e,outputDim:s,name:"user_embedding"}).apply(r),i=AO({shape:[1]}),a=MO({inputDim:n,outputDim:s,name:"item_embedding"}).apply(i),l=Uve({axes:2}).apply([o,a]),c=H1({units:32,activation:"relu"}).apply(l),u=H1({units:16,activation:"relu"}).apply(c),d=H1({units:1,activation:"sigmoid"}).apply(u);this.model=kve({inputs:[r,i],outputs:d}),this.model.compile({optimizer:"adam",loss:"binaryCrossentropy",metrics:["accuracy"]}),this.initialized=!0}async train(e,n,s,r=10){if(!this.initialized)throw new Error("Model not initialized");const o=Ea(s.map(l=>[l.userId])),i=Ea(s.map(l=>[l.itemId])),a=Ea(s.map(l=>[l.rating]));await this.model.fit([o,i],a,{epochs:r,batchSize:32,validationSplit:.2,callbacks:{onEpochEnd:(l,c)=>{console.log(`Epoch ${l+1}: loss = ${c.loss.toFixed(4)}`)}}})}async getRecommendations(e,n,s=5){if(!this.initialized)throw new Error("Model not initialized");const r=Ea([[e]]),o=[];for(let i=0;i<n.length;i++){const a=Ea([[i]]),l=this.model.predict([r,a]);o.push({itemId:i,score:(await l.data())[0]})}return o.sort((i,a)=>a.score-i.score).slice(0,s)}processFreelancerData(e,n,s,r){return e.map(o=>{var l;const i=r===s?.5:((((l=o.hourlyRate)==null?void 0:l.amount)||0)-s)/(r-s),a=n.map(c=>(o.skills||[]).includes(c)?1:0);return{id:o._id,features:[i,...a]}})}calculateSimilarity(e,n){const s=e.features,r=n.features;if(s.length!==r.length)throw new Error("Feature vectors must be same length");let o=0,i=0,a=0;for(let l=0;l<s.length;l++)o+=s[l]*r[l],i+=s[l]*s[l],a+=r[l]*r[l];return i=Math.sqrt(i),a=Math.sqrt(a),o/(i*a)}getSimilarFreelancers(e,n,s=5){const r=n.map(h=>{var f;return((f=h.hourlyRate)==null?void 0:f.amount)||0}),o=Math.max(...r),i=Math.min(...r),a=new Set;n.forEach(h=>{(h.skills||[]).forEach(f=>a.add(f))});const l=Array.from(a),c=this.processFreelancerData([e],l,i,o)[0];return this.processFreelancerData(n,l,i,o).filter(h=>h.id!==e._id).map(h=>{const f=n.find(m=>m._id===h.id);return f?{freelancer:f,similarity:this.calculateSimilarity(c,h)}:null}).filter(h=>h!==null&&!isNaN(h.similarity)).sort((h,f)=>f.similarity-h.similarity).slice(0,s).map(h=>h.freelancer)}}const Z1=new lPe;function cPe(){const[t,e]=S.useState([]),[n,s]=S.useState([]),[r,o]=S.useState(!0),[i,a]=S.useState(null);Dr();const{user:l}=Hs(),[c,u]=S.useState({keyword:"",location:"",hourlyRate:""}),d=async()=>{try{o(!0),a(null),console.log("Making request to fetch freelancers...");const g=new URLSearchParams;if(c.keyword&&g.append("keyword",c.keyword),c.location&&g.append("location",c.location),c.hourlyRate){const[v,b]=c.hourlyRate.split("-");v&&g.append("minRate",v),b&&b!=="+"&&g.append("maxRate",b),b==="+"&&g.append("minRate",v)}const y=`/freelancers?${g.toString()}`;console.log("Request URL:",y);const x=await We.get(y);if(console.log("Response received:",x.data),Array.isArray(x.data)){if(e(x.data),x.data.length>0){Z1.initialized||await Z1.initialize(100,x.data.length);const v=Z1.getSimilarFreelancers(x.data[0],x.data,5);s(v)}}else console.error("Invalid response format, expected array:",x.data),a("Invalid data received from server"),e([])}catch(g){console.error("Error fetching freelancers:",g),g.response?(console.error("Response data:",g.response.data),console.error("Response status:",g.response.status),a(`Server error: ${g.response.data.message||"Unknown error"}`)):g.request?(console.error("No response received:",g.request),a("Could not connect to the server. Please try again later.")):(console.error("Error setting up request:",g.message),a("An error occurred while setting up the request.")),e([])}finally{o(!1)}};S.useEffect(()=>{d()},[]);const h=g=>{const{name:y,value:x}=g.target;u(v=>({...v,[y]:x}))},f=g=>{g.preventDefault(),d()},m=g=>{var y,x,v,b,w,C,k,N,E;return p.jsx(ve,{md:6,lg:4,className:"mb-4",children:p.jsx(be,{className:"h-100 hover:shadow-lg transition-shadow",children:p.jsxs(be.Body,{children:[p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("img",{src:`https://ui-avatars.com/api/?name=${(y=g.user)==null?void 0:y.firstName}+${(x=g.user)==null?void 0:x.lastName}&background=random`,alt:`${(v=g.user)==null?void 0:v.firstName} ${(b=g.user)==null?void 0:b.lastName}`,className:"rounded-full w-20 h-20 mx-auto mb-3"}),p.jsxs("h5",{className:"font-bold mb-1",children:[(w=g.user)==null?void 0:w.firstName," ",(C=g.user)==null?void 0:C.lastName]}),p.jsx("p",{className:"text-gray-600 mb-2",children:g.title})]}),p.jsxs("div",{className:"mb-3",children:[p.jsxs("div",{className:"flex items-center mb-2",children:[p.jsx(Qa,{size:16,className:"mr-2 text-gray-500"}),p.jsx("span",{className:"text-gray-600",children:"Remote"})]}),p.jsxs("div",{className:"flex items-center mb-2",children:[p.jsx(op,{size:16,className:"mr-2 text-gray-500"}),p.jsxs("span",{className:"text-gray-600",children:["$",(k=g.hourlyRate)==null?void 0:k.amount,"/hr"]})]}),p.jsxs("div",{className:"flex items-center mb-2",children:[p.jsx(_i,{size:16,className:"mr-2 text-gray-500"}),p.jsxs("span",{className:"text-gray-600",children:["Available ",g.availability]})]}),g.rating>0&&p.jsxs("div",{className:"flex items-center",children:[p.jsx(Gk,{size:16,className:"mr-2 text-gray-500"}),p.jsxs("span",{className:"text-gray-600",children:[g.rating.toFixed(1)," Rating"]})]})]}),p.jsxs("div",{className:"mb-3",children:[p.jsx("h6",{className:"font-semibold mb-2",children:"Skills"}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[(N=g.skills)==null?void 0:N.slice(0,4).map(($,I)=>p.jsx("span",{className:"badge bg-light text-dark",children:$},I)),((E=g.skills)==null?void 0:E.length)>4&&p.jsxs("span",{className:"badge bg-light text-dark",children:["+",g.skills.length-4]})]})]}),p.jsx(Ve,{variant:"primary",href:`/freelancers/${g._id}`,className:"w-100",children:"View Profile"})]})})},g._id)};return p.jsxs(Kt,{className:"py-8",children:[p.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Find Candidates"}),p.jsx(be,{className:"mb-6",children:p.jsx(be.Body,{children:p.jsxs(L,{onSubmit:f,children:[p.jsxs(ot,{children:[p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Keyword"}),p.jsxs("div",{className:"relative",children:[p.jsx(i0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),p.jsx(L.Control,{type:"text",name:"keyword",placeholder:"Skills or expertise",value:c.keyword,onChange:h,className:"pl-10"})]})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Location"}),p.jsxs("div",{className:"relative",children:[p.jsx(Qa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),p.jsx(L.Control,{type:"text",name:"location",placeholder:"City or remote",value:c.location,onChange:h,className:"pl-10"})]})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Hourly Rate"}),p.jsxs(L.Select,{name:"hourlyRate",value:c.hourlyRate,onChange:h,children:[p.jsx("option",{value:"",children:"Any Rate"}),p.jsx("option",{value:"0-25",children:"$0 - $25"}),p.jsx("option",{value:"25-50",children:"$25 - $50"}),p.jsx("option",{value:"50-100",children:"$50 - $100"}),p.jsx("option",{value:"100+",children:"$100+"})]})]})})]}),p.jsx(ot,{children:p.jsx(ve,{className:"text-end",children:p.jsx(Ve,{type:"submit",variant:"primary",className:"search-candidates-btn",children:"Search Candidates"})})})]})})}),i&&p.jsx(Wa,{variant:"danger",className:"mb-4",children:i}),r?p.jsx("div",{className:"text-center py-5",children:p.jsx(ir,{animation:"border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):p.jsxs(p.Fragment,{children:[n.length>0&&p.jsxs("div",{className:"mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Recommended for You"}),p.jsx(ot,{children:n.map(g=>m(g))})]}),p.jsxs("div",{children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:"All Candidates"}),p.jsx(ot,{children:t.length===0?p.jsx(ve,{children:p.jsx(Wa,{variant:"info",children:"No freelancers found matching your criteria. Try adjusting your filters."})}):t.map(g=>m(g))})]})]})]})}function uPe(){const[t,e]=S.useState([]),[n,s]=S.useState({keyword:"",location:"",industry:""});S.useEffect(()=>{(async()=>{try{const i=await fn.get("http://localhost:5000/api/employers");e(i.data)}catch(i){console.error("Error fetching employers:",i)}})()},[]);const r=o=>{s({...n,[o.target.name]:o.target.value})};return p.jsxs(Kt,{className:"py-8",children:[p.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Find Employers"}),p.jsx(be,{className:"mb-6",children:p.jsx(be.Body,{children:p.jsxs(ot,{children:[p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Keyword"}),p.jsxs("div",{className:"relative",children:[p.jsx(i0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),p.jsx(L.Control,{type:"text",name:"keyword",placeholder:"Company name or keyword",value:n.keyword,onChange:r,className:"pl-10"})]})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Location"}),p.jsxs("div",{className:"relative",children:[p.jsx(Qa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),p.jsx(L.Control,{type:"text",name:"location",placeholder:"City or country",value:n.location,onChange:r,className:"pl-10"})]})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Industry"}),p.jsxs(L.Select,{name:"industry",value:n.industry,onChange:r,children:[p.jsx("option",{value:"",children:"All Industries"}),p.jsx("option",{value:"technology",children:"Technology"}),p.jsx("option",{value:"healthcare",children:"Healthcare"}),p.jsx("option",{value:"finance",children:"Finance"}),p.jsx("option",{value:"education",children:"Education"}),p.jsx("option",{value:"retail",children:"Retail"})]})]})})]})})}),p.jsx(ot,{children:t.map(o=>p.jsx(ve,{md:6,lg:4,className:"mb-4",children:p.jsx(be,{className:"h-100 hover:shadow-lg transition-shadow",children:p.jsxs(be.Body,{children:[p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("div",{className:"w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-3",children:p.jsx(qk,{size:40,className:"text-white"})}),p.jsxs("h5",{className:"font-bold mb-1",children:[o.firstName," ",o.lastName]}),p.jsx("p",{className:"text-gray-600 mb-2",children:"Company Name"})]}),p.jsxs("div",{className:"mb-3",children:[p.jsxs("div",{className:"flex items-center mb-2",children:[p.jsx(Qa,{size:16,className:"mr-2 text-gray-500"}),p.jsx("span",{className:"text-gray-600",children:"Location"})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(a0,{size:16,className:"mr-2 text-gray-500"}),p.jsx("span",{className:"text-gray-600",children:"5-10 employees"})]})]}),p.jsxs("div",{className:"mb-3",children:[p.jsx("h6",{className:"font-semibold mb-2",children:"Recent Job Posts"}),p.jsxs("ul",{className:"list-none p-0",children:[p.jsx("li",{className:"text-gray-600 mb-1",children:"• Senior Frontend Developer"}),p.jsx("li",{className:"text-gray-600 mb-1",children:"• UI/UX Designer"}),p.jsx("li",{className:"text-gray-600",children:"• Project Manager"})]})]}),p.jsx(Ve,{variant:"primary",href:`/employers/${o._id}`,className:"w-100",children:"View Profile"})]})})},o._id))})]})}function dPe(){const{id:t}=yd(),e=Dr(),{user:n}=Hs(),[s,r]=S.useState(!0),[o,i]=S.useState(!1),[a,l]=S.useState({title:"",description:"",category:"web-development",type:"full-time",location:"",isRemote:!1,skills:[],salary:{min:"",max:"",currency:"USD"}});S.useEffect(()=>{(async()=>{try{const f=(await We.get(`/jobs/${t}`)).data;f.skills=f.skills.join(", "),l(f)}catch(h){console.error("Error fetching job:",h),xe.error("Failed to load job details"),e("/dashboard/projects")}finally{r(!1)}})()},[t,e]);const c=async d=>{var h,f;d.preventDefault();try{i(!0);const g=["title","description","category","type","location"].filter(w=>!a[w]);if(g.length>0){xe.error(`Please fill in all required fields: ${g.join(", ")}`);return}if(!a.salary.min||!a.salary.max){xe.error("Please specify salary range");return}const y=Number(a.salary.min),x=Number(a.salary.max);if(isNaN(y)||isNaN(x)){xe.error("Salary must be a valid number");return}if(y<=0||x<=0){xe.error("Salary must be greater than 0");return}if(y>=x){xe.error("Maximum salary must be greater than minimum salary");return}const v=a.skills.split(",").map(w=>w.trim()).filter(Boolean);if(v.length===0){xe.error("Please specify at least one skill");return}const b={...a,skills:v,salary:{...a.salary,min:y,max:x}};await We.put(`/jobs/${t}`,b),xe.success("Job updated successfully"),e("/dashboard/projects")}catch(m){console.error("Error updating job:",m),xe.error(((f=(h=m.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to update job")}finally{i(!1)}},u=d=>{const{name:h,value:f,type:m,checked:g}=d.target;if(h.startsWith("salary.")){const y=h.split(".")[1];l(x=>({...x,salary:{...x.salary,[y]:f}}))}else l(y=>({...y,[h]:m==="checkbox"?g:f}))};return s?p.jsx(Kt,{className:"py-5",children:p.jsx("div",{className:"text-center",children:p.jsx("div",{className:"spinner-border",role:"status",children:p.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):p.jsxs(Kt,{className:"py-5",children:[p.jsxs("div",{className:"d-flex align-items-center mb-4",children:[p.jsx(Ve,{variant:"link",className:"p-0 me-3",onClick:()=>e(-1),children:p.jsx(dL,{size:24})}),p.jsx("h2",{className:"mb-0",children:"Edit Job"})]}),p.jsx(be,{children:p.jsx(be.Body,{children:p.jsxs(L,{onSubmit:c,children:[p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Job Title"}),p.jsx(L.Control,{type:"text",name:"title",value:a.title,onChange:u,required:!0})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Description"}),p.jsx(L.Control,{as:"textarea",rows:5,name:"description",value:a.description,onChange:u,required:!0})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Category"}),p.jsxs(L.Select,{name:"category",value:a.category,onChange:u,required:!0,children:[p.jsx("option",{value:"web-development",children:"Web Development"}),p.jsx("option",{value:"mobile-development",children:"Mobile Development"}),p.jsx("option",{value:"design",children:"Design"}),p.jsx("option",{value:"writing",children:"Writing"}),p.jsx("option",{value:"admin-support",children:"Admin Support"}),p.jsx("option",{value:"customer-service",children:"Customer Service"}),p.jsx("option",{value:"marketing",children:"Marketing"}),p.jsx("option",{value:"accounting",children:"Accounting"})]})]})}),p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Type"}),p.jsxs(L.Select,{name:"type",value:a.type,onChange:u,required:!0,children:[p.jsx("option",{value:"full-time",children:"Full Time"}),p.jsx("option",{value:"part-time",children:"Part Time"}),p.jsx("option",{value:"contract",children:"Contract"}),p.jsx("option",{value:"freelance",children:"Freelance"})]})]})})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:6,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Location"}),p.jsx(L.Control,{type:"text",name:"location",value:a.location,onChange:u,required:!0})]})}),p.jsx(ve,{md:6,children:p.jsx(L.Group,{className:"mb-3",children:p.jsx(L.Check,{type:"checkbox",label:"Remote Work Available",name:"isRemote",checked:a.isRemote,onChange:u})})})]}),p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Required Skills (comma-separated)"}),p.jsx(L.Control,{type:"text",name:"skills",value:a.skills,onChange:u,placeholder:"e.g. JavaScript, React, Node.js",required:!0})]}),p.jsxs(ot,{children:[p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Minimum Salary"}),p.jsx(L.Control,{type:"number",name:"salary.min",value:a.salary.min,onChange:u,required:!0})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Maximum Salary"}),p.jsx(L.Control,{type:"number",name:"salary.max",value:a.salary.max,onChange:u,required:!0})]})}),p.jsx(ve,{md:4,children:p.jsxs(L.Group,{className:"mb-3",children:[p.jsx(L.Label,{children:"Currency"}),p.jsxs(L.Select,{name:"salary.currency",value:a.salary.currency,onChange:u,required:!0,children:[p.jsx("option",{value:"USD",children:"USD"}),p.jsx("option",{value:"EUR",children:"EUR"}),p.jsx("option",{value:"GBP",children:"GBP"}),p.jsx("option",{value:"INR",children:"INR"})]})]})})]}),p.jsxs("div",{className:"d-flex gap-2 justify-content-end",children:[p.jsx(Ve,{variant:"secondary",onClick:()=>e("/dashboard/projects"),disabled:o,children:"Cancel"}),p.jsx(Ve,{type:"submit",variant:"primary",disabled:o,children:o?"Updating...":"Update Job"})]})]})})})]})}function hPe(){var v,b,w,C,k,N,E,$,I,A,P,_,U,V;const{id:t}=yd(),e=Dr(),{user:n}=Hs(),[s,r]=S.useState(null),[o,i]=S.useState(!0),[a,l]=S.useState([]),[c,u]=S.useState([]),[d,h]=S.useState(0),[f,m]=S.useState({5:0,4:0,3:0,2:0,1:0});S.useEffect(()=>{const D=async()=>{try{const R=await We.get(`/freelancers/${t}`);r(R.data)}catch(R){console.error("Error fetching freelancer:",R)}finally{i(!1)}},W=async()=>{try{const R=await We.get("/chat");l(R.data)}catch(R){console.error("Error fetching chats:",R)}};D(),W()},[t]),S.useEffect(()=>{s&&s.user&&s.user._id&&(async()=>{try{console.log(`Fetching reviews for user ID: ${s.user._id}`);const W=await We.get(`/reviews/user/${s.user._id}`);if(console.log("Reviews API response:",W.data),W.data&&W.data.length>0){const R=W.data;if(console.log("Filtered reviews:",R),u(R),R.length>0){const j=R.reduce((B,z)=>(console.log(`Review rating: ${z.rating}, type: ${typeof z.rating}`),B+Number(z.rating)),0),G=j/R.length;console.log(`Total rating: ${j}, Count: ${R.length}, Average: ${G}`),h(G);const O={5:0,4:0,3:0,2:0,1:0};R.forEach(B=>{const z=Number(B.rating),K=Math.round(z);console.log(`Processing rating: ${z} -> ${K}`),O[K]!==void 0&&O[K]++}),console.log("Rating distribution:",O),m(O)}}else console.log("No reviews found in the response")}catch(W){console.error("Error fetching reviews:",W)}})()},[s]);const g=D=>{const W={year:"numeric",month:"long",day:"numeric"};return new Date(D).toLocaleDateString(void 0,W)},y=async()=>{try{if(!n){e("/login?redirect="+encodeURIComponent(`/freelancers/${t}`));return}if(console.log("=== DEBUG: Starting Chat Creation Process ==="),console.log("Current User:",{_id:n._id,name:`${n.firstName} ${n.lastName}`,role:n.role}),!s||!s.user||!s.user._id){console.error("Error: Freelancer data is incomplete",s),alert("Unable to contact freelancer. Missing information.");return}const D=s.user._id;console.log("Freelancer:",{_id:D,name:`${s.user.firstName} ${s.user.lastName}`,role:s.user.role});const W=String(n._id),R=String(D);if(W===R){console.error("Error: Cannot chat with self - IDs match"),alert("You cannot chat with yourself.");return}console.log(`ID Comparison: ${R} === ${W} ? ${R===W}`),console.log("Checking for existing chats..."),console.log("Available chats:",a.length);const j=a.find(G=>{console.log(`Checking chat: ${G._id}`);const O=G.participants.map(K=>{const J=typeof K.user=="object"?String(K.user._id||""):String(K.user||"");return console.log(`- Participant: ${J}`),J}),B=O.includes(W),z=O.includes(R);return console.log(`- Contains user? ${B}, Contains freelancer? ${z}`),B&&z});if(j)console.log("Found existing chat, navigating to:",j._id),e(`/chat?chatId=${j._id}`);else{console.log("Creating new chat with freelancer ID:",R);const G=await We.post("/chat",{participantId:D,message:"Hello! I would like to discuss a potential collaboration."});console.log("Chat creation response:",G.data),console.log("New chat participants:",G.data.participants),G.data&&G.data._id?(console.log("Chat created successfully with ID:",G.data._id),e(`/chat?chatId=${G.data._id}`)):(console.error("Error: Chat creation response is missing _id",G.data),alert("Unable to create chat. Please try again later."))}}catch(D){console.error("Error creating chat:",D),D.response&&console.error("Server response:",D.response.data),alert("An error occurred while trying to contact this freelancer. Please try again later.")}};if(o)return p.jsx(Kt,{className:"py-8",children:p.jsx("div",{className:"text-center",children:"Loading..."})});if(!s)return p.jsx(Kt,{className:"py-8",children:p.jsx("div",{className:"text-center",children:"Freelancer not found"})});const x=D=>{console.log(`Rendering stars for rating: ${D}`);const W=Number(D),R=[];for(let j=1;j<=5;j++)R.push(p.jsx(_i,{size:16,fill:j<=W?"#ffc107":"none",className:j<=W?"text-warning me-1":"text-muted me-1"},j));return R};return p.jsx(Kt,{className:"py-8",children:p.jsxs(ot,{children:[p.jsxs(ve,{lg:8,children:[p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsxs("div",{className:"d-flex align-items-center mb-4",children:[p.jsx("img",{src:`https://ui-avatars.com/api/?name=${(v=s.user)==null?void 0:v.firstName}+${(b=s.user)==null?void 0:b.lastName}&size=128&background=random`,alt:`${(w=s.user)==null?void 0:w.firstName} ${(C=s.user)==null?void 0:C.lastName}`,className:"rounded-circle me-4",style:{width:"128px",height:"128px"}}),p.jsxs("div",{children:[p.jsxs("h1",{className:"h3 mb-2",children:[(k=s.user)==null?void 0:k.firstName," ",(N=s.user)==null?void 0:N.lastName]}),p.jsx("p",{className:"text-muted mb-3",children:s.title}),p.jsxs("div",{className:"d-flex gap-4",children:[p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx(Qa,{size:16,className:"me-1 text-muted"}),p.jsx("span",{className:"text-muted",children:"Remote"})]}),p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx(_i,{size:16,className:"me-1 text-muted"}),p.jsx("span",{className:"text-muted",children:s.availability})]}),c.length>0&&p.jsxs("div",{className:"d-flex align-items-center",children:[p.jsx("div",{className:"d-flex",children:x(d)}),p.jsxs("span",{className:"text-muted ms-1",children:["(",d.toFixed(1),")"]})]})]})]})]}),p.jsxs("div",{className:"d-flex gap-3 mb-4",children:[((E=s.socialLinks)==null?void 0:E.website)&&p.jsx("a",{href:s.socialLinks.website,target:"_blank",rel:"noopener noreferrer",className:"text-muted",children:p.jsx(pL,{size:20})}),(($=s.socialLinks)==null?void 0:$.linkedin)&&p.jsx("a",{href:s.socialLinks.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-muted",children:p.jsx(gL,{size:20})}),((I=s.socialLinks)==null?void 0:I.github)&&p.jsx("a",{href:s.socialLinks.github,target:"_blank",rel:"noopener noreferrer",className:"text-muted",children:p.jsx(kJ,{size:20})})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("h2",{className:"h5 mb-3",children:"About Me"}),p.jsx("p",{className:"text-muted",children:s.bio})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("h2",{className:"h5 mb-3",children:"Skills"}),p.jsx("div",{className:"d-flex flex-wrap gap-2",children:(A=s.skills)==null?void 0:A.map((D,W)=>p.jsx("span",{className:"badge bg-light text-dark",children:D},W))})]})]})}),p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsx("h2",{className:"h5 mb-4",children:"Experience"}),(P=s.experience)==null?void 0:P.map((D,W)=>p.jsxs("div",{className:"mb-4",children:[p.jsx("h3",{className:"h6",children:D.title}),p.jsxs("p",{className:"text-muted",children:[D.company," • ",D.location]}),p.jsxs("p",{className:"text-muted",children:[new Date(D.from).toLocaleDateString()," -",D.current?"Present":new Date(D.to).toLocaleDateString()]}),p.jsx("p",{className:"text-muted mt-2",children:D.description})]},W))]})}),p.jsx(be,{className:"mb-4",children:p.jsxs(be.Body,{children:[p.jsx("h2",{className:"h5 mb-4",children:"Education"}),(_=s.education)==null?void 0:_.map((D,W)=>p.jsxs("div",{className:"mb-4",children:[p.jsx("h3",{className:"h6",children:D.degree}),p.jsx("p",{className:"text-muted",children:D.school}),p.jsx("p",{className:"text-muted",children:D.field}),p.jsxs("p",{className:"text-muted",children:[new Date(D.from).toLocaleDateString()," -",new Date(D.to).toLocaleDateString()]})]},W))]})}),p.jsx(be,{children:p.jsxs(be.Body,{children:[p.jsxs("h2",{className:"h5 mb-4",children:["Client Reviews (",c.length,")"]}),c.length>0?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"d-flex align-items-center mb-4",children:[p.jsxs("div",{className:"me-4 text-center",children:[p.jsx("h3",{className:"h2 mb-0",children:d.toFixed(1)}),p.jsx("div",{className:"d-flex justify-content-center mb-1",children:x(d)}),p.jsxs("p",{className:"text-muted small",children:[c.length," reviews"]})]}),p.jsx("div",{className:"flex-grow-1",children:[5,4,3,2,1].map(D=>p.jsxs("div",{className:"d-flex align-items-center mb-2",children:[p.jsx("div",{className:"me-2",style:{width:"10px"},children:D}),p.jsx(Hk,{now:c.length>0?f[D]/c.length*100:0,className:"flex-grow-1 me-2",style:{height:"8px"}}),p.jsx("div",{style:{width:"30px"},children:f[D]})]},D))})]}),p.jsx("div",{children:c.map((D,W)=>{var R,j;return p.jsxs("div",{className:W<c.length-1?"mb-4 pb-4 border-bottom":"mb-4 pb-4",children:[p.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[p.jsxs("div",{children:[p.jsxs("h5",{className:"mb-1",children:[((R=D.reviewer)==null?void 0:R.firstName)||"Anonymous"," ",((j=D.reviewer)==null?void 0:j.lastName)||""]}),p.jsxs("div",{className:"d-flex align-items-center",children:[x(D.rating),p.jsx("span",{className:"text-muted ms-2",children:g(D.createdAt)})]})]}),D.job&&p.jsxs("div",{className:"text-muted small",children:["Project: ",typeof D.job=="object"?D.job.title||"Unnamed Project":"Project"]})]}),p.jsx("p",{className:"mt-2",children:D.comment}),D.skills&&D.skills.length>0&&p.jsxs("div",{className:"mt-3",children:[p.jsx("h6",{className:"mb-2",children:"Skill Ratings"}),p.jsx("div",{className:"d-flex flex-wrap gap-3",children:D.skills.map((G,O)=>p.jsxs("div",{className:"bg-light p-2 rounded",children:[p.jsx("div",{className:"mb-1",children:G.skill}),p.jsx("div",{className:"d-flex",children:x(G.rating)})]},O))})]}),(D.communication||D.quality||D.timeliness)&&p.jsxs("div",{className:"d-flex flex-wrap gap-4 mt-3",children:[D.communication&&p.jsxs("div",{children:[p.jsx("div",{className:"text-muted small",children:"Communication"}),p.jsx("div",{className:"d-flex",children:x(D.communication)})]}),D.quality&&p.jsxs("div",{children:[p.jsx("div",{className:"text-muted small",children:"Quality"}),p.jsx("div",{className:"d-flex",children:x(D.quality)})]}),D.timeliness&&p.jsxs("div",{children:[p.jsx("div",{className:"text-muted small",children:"Timeliness"}),p.jsx("div",{className:"d-flex",children:x(D.timeliness)})]})]})]},W)})})]}):p.jsxs("div",{className:"text-center py-5",children:[p.jsx("div",{className:"mb-3",children:p.jsx(_i,{size:48,className:"text-muted"})}),p.jsx("h5",{children:"No Reviews Yet"}),p.jsx("p",{className:"text-muted",children:"This freelancer hasn't received any reviews from clients yet."})]})]})})]}),p.jsx(ve,{lg:4,children:p.jsx(be,{className:"sticky-top",style:{top:"1rem"},children:p.jsxs(be.Body,{children:[p.jsxs("h3",{className:"h5 mb-4",children:["Hire ",(U=s.user)==null?void 0:U.firstName]}),p.jsx("div",{className:"mb-4",children:p.jsxs("div",{className:"d-flex align-items-center mb-2",children:[p.jsx(op,{size:20,className:"me-2 text-muted"}),p.jsxs("span",{className:"text-muted",children:["$",(V=s.hourlyRate)==null?void 0:V.amount,"/hr"]})]})}),p.jsx(Ve,{variant:"primary",size:"lg",className:"w-100 mb-3",onClick:y,children:"Contact"})]})})})]})})}function wg({children:t}){const{user:e,loading:n}=Hs();return n?p.jsx("div",{children:"Loading..."}):e?t:p.jsx(HG,{to:"/login"})}function fPe(){return p.jsx(jq,{children:p.jsx(e7,{children:p.jsxs("div",{className:"min-h-screen flex flex-col",children:[p.jsx(BJ,{}),p.jsx("main",{className:"flex-grow",children:p.jsxs(WP,{children:[p.jsx(ln,{path:"/",element:p.jsx(UJ,{})}),p.jsx(ln,{path:"/login",element:p.jsx(VJ,{})}),p.jsx(ln,{path:"/register",element:p.jsx(WJ,{})}),p.jsx(ln,{path:"/find-projects",element:p.jsx(oue,{})}),p.jsx(ln,{path:"/find-candidates",element:p.jsx(cPe,{})}),p.jsx(ln,{path:"/find-employers",element:p.jsx(uPe,{})}),p.jsx(ln,{path:"/jobs/:id",element:p.jsx(Lj,{})}),p.jsx(ln,{path:"/jobs/:id/edit",element:p.jsx(wg,{children:p.jsx(dPe,{})})}),p.jsx(ln,{path:"/jobs/:id/applications",element:p.jsx(wg,{children:p.jsx(jj,{})})}),p.jsx(ln,{path:"/freelancers/:id",element:p.jsx(hPe,{})}),p.jsx(ln,{path:"/dashboard/*",element:p.jsx(wg,{children:p.jsx(rue,{})})}),p.jsx(ln,{path:"/chat",element:p.jsx(wg,{children:p.jsx(vL,{})})})]})}),p.jsx(zJ,{}),p.jsx(g7,{position:"top-right"}),p.jsx(i9,{position:"top-right"})]})})})}OP(document.getElementById("root")).render(p.jsx(S.StrictMode,{children:p.jsx(fPe,{})}));
